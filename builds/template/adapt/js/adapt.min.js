require(["bowser","underscore","backbone","semver","react","react-dom","html-react-parser","libraries/mediaelement-and-player","libraries/pdfmake.min.js","handlebars","libraries/SCORM_API_wrapper","libraries/lzma-min","libraries/lzma_worker-min.js","libraries/js-cookie.js"],(function(Bowser,_$1,Backbone$1,semver,React,ReactDOM,HTMLReactParser,mediaelementAndPlayer,pdfMake,Handlebars$1,pipwerks,lzmaMin,lzma_workerMin_js,Cookies){function _interopDefaultLegacy(e){return e&&typeof e==="object"&&"default"in e?e:{default:e}}var Bowser__default=_interopDefaultLegacy(Bowser);var ___default=_interopDefaultLegacy(_$1);var Backbone__default=_interopDefaultLegacy(Backbone$1);var semver__default=_interopDefaultLegacy(semver);var React__default=_interopDefaultLegacy(React);var ReactDOM__default=_interopDefaultLegacy(ReactDOM);var HTMLReactParser__default=_interopDefaultLegacy(HTMLReactParser);var pdfMake__default=_interopDefaultLegacy(pdfMake);var Handlebars__default=_interopDefaultLegacy(Handlebars$1);var pipwerks__default=_interopDefaultLegacy(pipwerks);var Cookies__default=_interopDefaultLegacy(Cookies);class Wait extends Backbone.Controller{initialize(){this._waitCount=0;this._callbackHandle=null;this.being=this.begin.bind(this);this.end=this.end.bind(this)}isWaiting(){return this._waitCount!==0}begin(){if(!this.isWaiting())this.trigger("wait");this._waitCount++;if(this._callbackHandle){clearTimeout(this._callbackHandle);this._callbackHandle=null}return this}end(){if(!this.isWaiting())return this;this._waitCount--;if(this.isWaiting()||this._callbackHandle)return this;this._callbackHandle=setTimeout(function(){this._callbackHandle=null;this.trigger("ready")}.bind(this),0);return this}queue(callback){if(!callback){this.begin();return new Promise((resolve=>{this.once("ready",resolve);this.end()}))}this.begin();this.once("ready",callback);this.end();return this}for(callback){this.begin();_.defer((()=>callback(_.once(this.end))));return this}}const wait=new Wait;var wait$1=__AMD("core/js/wait",wait);var LockingModel=__AMD("core/js/models/lockingModel",class LockingModel extends Backbone.Model{lockedAttributes(){return null}set(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}if(typeof args[0]!=="object"){const[name,value]=args.splice(0,2);args.unshift({[name]:value})}const options=args[1]??{};const attrValues=args[0];const newValues={};for(const attrName in attrValues){const attrVal=attrValues[attrName];const willChange=this.attributes[attrName]!==attrValues[attrName];if(!willChange)continue;const isNotLocking=typeof attrVal!=="boolean"||!this.isLocking(attrName);if(isNotLocking){newValues[attrName]=attrVal;continue}const defaults=_.result(this,"defaults");const isDefault=defaults[attrName]!==undefined;const isInitialDefault=isDefault&&!this.changed;if(isInitialDefault){this._lockedAttributes[attrName]=!defaults[attrName]}const isSettingValueForSpecificPlugin=options?.pluginName;if(!isSettingValueForSpecificPlugin){if(!isInitialDefault){console.error("Must supply a pluginName to change a locked attribute")}options.pluginName="compatibility"}const pluginName=options.pluginName;const lockingValue=this._lockedAttributes[attrName];const isAttemptingToLock=lockingValue===attrVal;if(isAttemptingToLock){this.setLockState(attrName,true,{pluginName:pluginName,skipcheck:true});newValues[attrName]=lockingValue;continue}this.setLockState(attrName,false,{pluginName:pluginName,skipcheck:true});const totalLockValue=this.getLockCount(attrName,{skipcheck:true});if(totalLockValue===0){newValues[attrName]=!lockingValue;continue}}if(!Object.keys(newValues))return this;super.set(newValues,options);return this}setLocking(attrName,defaultLockValue){if(this.isLocking(attrName))return;if(!this._lockedAttributes)this._lockedAttributes={};this._lockedAttributes[attrName]=defaultLockValue}unsetLocking(attrName){if(!this.isLocking(attrName))return;if(!this._lockedAttributes)return;delete this._lockedAttributes[attrName];delete this._lockedAttributesValues[attrName];if(Object.keys(this._lockedAttributes).length===0){delete this._lockedAttributes;delete this._lockedAttributesValues}}isLocking(attrName){const isCheckingGeneralLockingState=attrName===undefined;let hasDerivedLockedAttributes=Object.prototype.hasOwnProperty.call(this,"_lockedAttributes");if(!hasDerivedLockedAttributes){this._lockedAttributes=_.result(this,"lockedAttributes");hasDerivedLockedAttributes=true}const isUsingLockedAttributes=Boolean(this._lockedAttributes);if(isCheckingGeneralLockingState){return isUsingLockedAttributes}if(!isUsingLockedAttributes)return false;const isAttributeALockingAttribute=Object.prototype.hasOwnProperty.call(this._lockedAttributes,attrName);if(!isAttributeALockingAttribute)return false;if(!this._lockedAttributesValues){this._lockedAttributesValues={}}if(!this._lockedAttributesValues[attrName]){this._lockedAttributesValues[attrName]={}}return true}isLocked(attrName,options){const shouldSkipCheck=options?.skipcheck;if(!shouldSkipCheck){const stopProcessing=!this.isLocking(attrName);if(stopProcessing)return}return this.getLockCount(attrName)>0}getLockCount(attrName,options){const shouldSkipCheck=options?.skipcheck;if(!shouldSkipCheck){const stopProcessing=!this.isLocking(attrName);if(stopProcessing)return}const isGettingValueForSpecificPlugin=options?.pluginName;if(isGettingValueForSpecificPlugin){return this._lockedAttributesValues[attrName][options.pluginName]?1:0}const lockingAttributeValues=Object.values(this._lockedAttributesValues[attrName]);const lockingAttributeValuesSum=lockingAttributeValues.reduce(((sum,value)=>sum+(value?1:0)),0);return lockingAttributeValuesSum}setLockState(attrName,value,options){const shouldSkipCheck=options?.skipcheck;if(!shouldSkipCheck){const stopProcessing=!this.isLocking(attrName);if(stopProcessing)return this}const isSettingValueForSpecificPlugin=options?.pluginName;if(!isSettingValueForSpecificPlugin){console.error("Must supply a pluginName to set a locked attribute lock value");options.pluginName="compatibility"}if(value){this._lockedAttributesValues[attrName][options.pluginName]=value}else{delete this._lockedAttributesValues[attrName][options.pluginName]}return this}});class AdaptSingleton extends LockingModel{initialize(){this.loadScript=window.__loadScript}defaults(){return{_canScroll:true,_outstandingCompletionChecks:0,_pluginWaitCount:0,_isStarted:false,_shouldDestroyContentObjects:true}}lockedAttributes(){return{_canScroll:false}}async init(){this.addDirection();this.disableAnimation();this.trigger("adapt:preInitialize");await wait$1.queue();this.deferUntilCompletionChecked((async()=>{this.trigger("adapt:start");await wait$1.queue();if(!Backbone.History.started){Backbone.history.start()}this.set("_isStarted",true);this.trigger("adapt:initialize");await wait$1.queue()}))}checkingCompletion(){const outstandingChecks=this.get("_outstandingCompletionChecks");this.set("_outstandingCompletionChecks",outstandingChecks+1)}checkedCompletion(){const outstandingChecks=this.get("_outstandingCompletionChecks");this.set("_outstandingCompletionChecks",outstandingChecks-1)}async deferUntilCompletionChecked(){let callback=arguments.length>0&&arguments[0]!==undefined?arguments[0]:()=>{};if(this.get("_outstandingCompletionChecks")===0)return callback();return new Promise((resolve=>{const checkIfAnyChecksOutstanding=(model,outstandingChecks)=>{if(outstandingChecks!==0)return;this.off("change:_outstandingCompletionChecks",checkIfAnyChecksOutstanding);callback();resolve()};this.on("change:_outstandingCompletionChecks",checkIfAnyChecksOutstanding)}))}isWaitingForPlugins(){this.log.deprecated("Use wait.isWaiting() as Adapt.isWaitingForPlugins() will be removed in the future");return wait$1.isWaiting()}checkPluginsReady(){this.log.deprecated("Use wait.isWaiting() as Adapt.checkPluginsReady() will be removed in the future");if(this.isWaitingForPlugins()){return}this.trigger("plugins:ready")}parseRelativeString(relativeString){const parts=relativeString.replace(/\s*([+\-=]+\d+){1}/g,"$1").split(/[@ ]/).filter(Boolean);const parsed=parts.map((part=>{let splitIndex=part.search(/[+\-=\d]{1}/);if(splitIndex===-1)splitIndex=part.length;const symbol=part.slice(splitIndex,splitIndex+1);const type=part.slice(0,splitIndex).replace(/^@/,"");let offset=null;let inset=null;switch(symbol){case"=":inset=parseInt(part.slice(splitIndex+1).trim()||0);break;default:offset=parseInt(part.slice(splitIndex).trim()||0);break}return{type:type,offset:offset,inset:inset}}));return parsed.length===1?parsed[0]:parsed}addDirection(){const defaultDirection=this.config.get("_defaultDirection");$("html").addClass("dir-"+defaultDirection).attr("dir",defaultDirection)}disableAnimation(){const disableAnimationArray=this.config.get("_disableAnimationFor");const disableAnimation=this.config.get("_disableAnimation");if(disableAnimationArray){for(let i=0,l=disableAnimationArray.length;i<l;i++){if(!$("html").is(disableAnimationArray[i]))continue;this.config.set("_disableAnimation",true);$("html").addClass("disable-animation");console.log("Animation disabled.")}return}$("html").toggleClass("disable-animation",disableAnimation===true)}async remove(){const currentView=this.parentView;if(currentView){currentView.model.setOnChildren({_isReady:false,_isRendered:false})}this.trigger("preRemove",currentView);await wait$1.queue();if(currentView&&this.get("_shouldDestroyContentObjects")){currentView.destroy()}this.trigger("remove",currentView);_.defer(this.trigger.bind(this),"postRemove",currentView)}get a11y(){}get componentStore(){}get data(){}get device(){}get drawer(){}get location(){}get notify(){}get offlineStorage(){}get router(){}get scrolling(){}get startController(){}get store(){}get tracking(){}get wait(){}async navigateToElement(){}async scrollTo(){}register(name,object){}getViewName(){}getViewClass(){}getModelName(){}getModelClass(){}findById(){}findViewByModelId(){}findByTrackingPosition(){}}const Adapt=new AdaptSingleton;var Adapt$1=__AMD("core/js/adapt",Adapt);class OfflineStorage$1 extends Backbone.Controller{initialize(handler){this.ready=true;this._handler=undefined;if(!handler){return}this.ready=false;this._handler=handler}hasHandler(){return this._handler!==undefined}save(){Adapt$1.trigger("tracking:save");return this._handler?.save?.(...arguments)}serialize(value){if(this._handler?.serialize){return this._handler.serialize(...arguments)}return JSON.stringify(value)}deserialize(value){if(this._handler?.deserialize){return this._handler.deserialize(...arguments)}return JSON.parse(value)}set(name,value){if(this._handler?.set){return this._handler.set(...arguments)}this[name]=value}get(name){if(this._handler?.get){return this._handler.get(...arguments)}return this[name]}clear(){if(this._handler?.clear){return this._handler.clear(...arguments)}return false}setReadyStatus(){this.ready=true;Adapt$1.trigger("offlineStorage:ready")}}const offlineStorage=new OfflineStorage$1;var offlineStorage$1=__AMD("core/js/offlineStorage",offlineStorage);class Device extends Backbone.Controller{initialize(){___default["default"].bindAll(this,"onWindowResize","calculateResize");this.bowser=Bowser__default["default"].parse(window.navigator.userAgent);this.$html=$("html");this.$window=$(window);this.touch=Modernizr.touchevents;this.screenWidth=this.getScreenWidth();this.screenHeight=this.getScreenHeight();this.setViewportHeight();this.browser=(this.bowser.browser.name||"").toLowerCase();this.version=(this.bowser.browser.version||"").toLowerCase();this.OS=this.getOperatingSystem().toLowerCase();this.osVersion=this.bowser.os.version||"";this.renderingEngine=this.getRenderingEngine();this.listenTo(Adapt$1,{"configModel:dataLoaded":this.onConfigDataLoaded,"navigationView:postRender":this.setNavigationHeight});const browser=this.browser.toLowerCase();let browserString=browser.replace(/msie|internet explorer/,"ie");browserString+=` version-${this.version} OS-${this.OS} ${this.getAppleDeviceType()}`;browserString+=browserString.replace(".","-").toLowerCase();browserString+=` ${browserString.replace(/\./g,"-").toLowerCase()}`;browserString+=` pixel-density-${this.pixelDensity()}`;this.$html.addClass(browserString)}get orientation(){return this.screenWidth>=this.screenHeight?"landscape":"portrait"}get aspectRatio(){return this.screenWidth/this.screenHeight}onConfigDataLoaded(){this.screenSize=this.checkScreenSize();this.$html.addClass("size-"+this.screenSize);if(this.orientation){this.$html.addClass("orientation-"+this.orientation)}this.$window.on("resize orientationchange",this.onWindowResize)}get screenSizes(){const screenSizes={...Adapt$1.config.get("screenSize")};const screenSizesList=Object.entries(screenSizes);const screensizeEmThreshold=300;const baseFontSize=16;for(const[name,value]of screenSizesList){screenSizes[name]=value>screensizeEmThreshold?value/baseFontSize:value}return screenSizes}isScreenSizeMin(name){return Boolean(window.matchMedia(`(min-width: ${this.screenSizes[name]}em)`)?.matches)}checkScreenSize(){const screenSizesList=Object.entries(this.screenSizes);screenSizesList.sort(((a,b)=>a[1]-b[1]));const fontSize=parseFloat($("html").css("font-size"));const screenSizeEmWidth=window.innerWidth/fontSize;const smallestScreenSize=screenSizesList[0][0];const screenSize=screenSizesList.reduce(((screenSize,_ref)=>{let[name,value]=_ref;if(screenSizeEmWidth>=value)return name;return screenSize}),smallestScreenSize);return screenSize}getScreenWidth(){return this.isAppleDevice()?this.getAppleScreenWidth():window.innerWidth||this.$window.width()}getScreenHeight(){return this.isAppleDevice()?this.getAppleScreenHeight():window.innerHeight||this.$window.height()}setViewportHeight(){document.documentElement.style.setProperty("--adapt-viewport-height",`${window.innerHeight}px`)}setNavigationHeight(){document.documentElement.style.setProperty("--adapt-navigation-height",`${$(".nav").height()}px`)}getOperatingSystem(){let os=this.bowser.os.name.toLowerCase()||"";if(os===""){const platform=navigator.platform.toLowerCase();const match=platform.match(/win|mac|linux/);if(match)os=match[0];if(os==="win")os="windows";if(!os)os=""}if(!os)os="platformunknown";return os}getRenderingEngine(){return this.bowser.engine.name||""}onWindowResize(){if(this.hasWindowResized)return;requestAnimationFrame(this.calculateResize);this.hasWindowResized=true}calculateResize(){this.hasWindowResized=false;const previousWidth=this.screenWidth;const previousHeight=this.screenHeight;this.screenWidth=this.getScreenWidth();this.screenHeight=this.getScreenHeight();this.setViewportHeight();this.setNavigationHeight();if(previousWidth===this.screenWidth&&previousHeight===this.screenHeight){return}if(this.orientation){this.$html.toggleClass("orientation-landscape",this.orientation==="landscape");this.$html.toggleClass("orientation-portrait",this.orientation==="portrait")}const newScreenSize=this.checkScreenSize();if(newScreenSize!==this.screenSize){this.screenSize=newScreenSize;const screenSizes=this.screenSizes;for(const name in screenSizes){if(name===this.screenSize)continue;this.$html.removeClass(`size-${name}`)}this.$html.toggleClass(`size-${this.screenSize}`,true);Adapt$1.trigger("device:changed",this.screenSize)}Adapt$1.trigger("device:preResize device:resize device:postResize",this.screenWidth)}isAppleDevice(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream||navigator.userAgent.match(/Mac/)&&navigator?.maxTouchPoints>2}get shouldReportInvertedAppleScreenSize(){const windowRatio=window.innerWidth/window.innerHeight;const screenRatio=window.screen.width/window.screen.height;const isWindowPortrait=windowRatio<1;const isScreenPortrait=screenRatio<1;const isDeviceBadlyReportingScreenOrientation=isWindowPortrait!==isScreenPortrait;return isDeviceBadlyReportingScreenOrientation}getAppleScreenWidth(){return this.shouldReportInvertedAppleScreenSize?window.screen.height:window.screen.width}getAppleScreenHeight(){return this.shouldReportInvertedAppleScreenSize?window.screen.width:window.screen.height}getAppleDeviceType(){const platformType=this.bowser.platform.type?.toLowerCase()||"";const browserName=this.bowser.browser.name?.toLowerCase()||"";const isIPhone=platformType==="mobile"&&browserName==="safari";const isIPad=platformType==="tablet"&&browserName==="safari";if(isIPhone)return"iphone";if(isIPad)return"ipad";return""}pixelDensity(){const pixelDensity=window.devicePixelRatio||1;if(pixelDensity>=3){return"ultra-high"}else if(pixelDensity>=2){return"high"}else if(pixelDensity>=1.5){return"medium"}else{return"low"}}}const device=new Device;var device$1=__AMD("core/js/device",device);class Location extends Backbone__default["default"].Controller{initialize(){this._previousId=null;this._previousContentType=null;this._previousModel=null;this._previousClasses=null;this._lastVisitedType=null;this._lastVisitedMenu=null;this._lastVisitedPage=null;this._currentId=null;this._currentModel=null;this._currentLocation=null;this._contentType=null}}const location=new Location;var location$1=__AMD("core/js/location",location);var BrowserConfig=__AMD("core/js/a11y/browserConfig",class BrowserConfig extends Backbone.Controller{initialize(_ref){let{a11y:a11y}=_ref;this.a11y=a11y;this.listenTo(Adapt$1,{"accessibility:ready":this._onReady})}_onReady(){if(this.a11y.config._options._isPrefersReducedMotionEnabled)this._enablePrefersReducedMotion()}_enablePrefersReducedMotion(){if(!window.matchMedia)return;const isEnabledInBrowser=window.matchMedia("(prefers-reduced-motion: reduce");$("html").toggleClass("is-prefers-reduced-motion",Boolean(isEnabledInBrowser?.matches))}});var BrowserFocus=__AMD("core/js/a11y/browserFocus",class BrowserFocus extends Backbone.Controller{initialize(_ref){let{a11y:a11y}=_ref;this.a11y=a11y;this._onBlur=this._onBlur.bind(this);this._onClick=this._onClick.bind(this);this.$body=$("body");this.listenTo(Adapt$1,{"accessibility:ready":this._attachEventListeners})}_attachEventListeners(){this.$body.on("blur","*",this._onBlur).on("blur",this._onBlur);this.$body[0].addEventListener("click",this._onClick,true)}_onBlur(event){const config=this.a11y.config;if(!config._isEnabled||!config._options._isFocusNextOnDisabled){return}const $element=$(event.target);if($element.is("[data-a11y-force-focus]")){$element.removeAttr("tabindex data-a11y-force-focus")}if(event.target!==event.currentTarget){return}if(!$element.is("[disabled]")&&$element.css("display")!=="none"&&$element.css("visibility")!=="hidden"){return}this.a11y.focusNext($element)}_onClick(event){if(!event.isTrusted)return;const $element=$(event.target);const isAriaDisabled=$element.closest("[aria-disabled=true]").length===1;if(isAriaDisabled){event.preventDefault();event.stopImmediatePropagation()}const config=this.a11y.config;if(!config._isEnabled||!config._options._isFocusOnClickEnabled){return}const $stack=$([...$element.toArray(),...$element.parents().toArray()]);const $focusable=$stack.filter(config._options._tabbableElements);if(!$focusable.length){return}const $closestFocusable=$element.closest(config._options._tabbableElements);if($closestFocusable[0]!==document.activeElement){this.a11y._isForcedFocus=true;$closestFocusable[0].focus();this.a11y._isForcedFocus=false}if(!config._options._isClickDelayedAfterFocusEnabled)return;event.preventDefault();event.stopImmediatePropagation();setTimeout((()=>{$element[0].click()}),50)}});var FocusOptions=__AMD("core/js/a11y/focusOptions",class FocusOptions{constructor(){let{preventScroll:preventScroll=false,defer:defer=false}=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.preventScroll=preventScroll;this.defer=defer}});var KeyboardFocusOutline=__AMD("core/js/a11y/keyboardFocusOutline",class KeyboardFocusOutline extends Backbone.Controller{initialize(_ref){let{a11y:a11y}=_ref;this.a11y=a11y;this._onKeyDown=this._onKeyDown.bind(this);this.$html=$("html");this.showOnKeys={9:true,13:true,32:true,37:true,38:true,39:true,40:true};this.listenTo(Adapt$1,{"accessibility:ready":this._attachEventListeners})}_attachEventListeners(){document.addEventListener("keydown",this._onKeyDown);this._start()}_start(){const config=this.a11y.config;if(config._options._isFocusOutlineDisabled){this.$html.addClass("a11y-disable-focusoutline");return}if(!config._isEnabled||!config._options._isFocusOutlineKeyboardOnlyEnabled){return}this.$html.addClass("a11y-disable-focusoutline")}_onKeyDown(event){const config=this.a11y.config;if(config._options._isFocusOutlineDisabled){this.$html.addClass("a11y-disable-focusoutline");return}if(!config._isEnabled||!config._options._isFocusOutlineKeyboardOnlyEnabled||!this.showOnKeys[event.keyCode]){return}const $element=$(event.target);if(!$element.is(config._options._tabbableElements)||$element.is(config._options._focusOutlineKeyboardOnlyIgnore)){return}this.$html.removeClass("a11y-disable-focusoutline")}});const LOG_LEVEL=ENUM(["DEBUG","INFO","WARN","ERROR","FATAL"]);var LOG_LEVEL$1=__AMD("core/js/enums/logLevelEnum",LOG_LEVEL);class Logging extends Backbone.Controller{initialize(){this._config={_isEnabled:true,_level:LOG_LEVEL$1.INFO.asLowerCase,_console:true,_warnFirstOnly:true};this._warned={};this.listenToOnce(Adapt$1,"configModel:dataLoaded",this.onLoadConfigData)}onLoadConfigData(){this.loadConfig();this.debug("Logging config loaded");this.trigger("log:ready")}loadConfig(){if(Adapt$1.config.has("_logging")){this._config=Adapt$1.config.get("_logging")}this.checkQueryStringOverride()}checkQueryStringOverride(){const matches=window.location.search.match(/[?&]loglevel=([a-z]*)/i);if(!matches||matches.length<2)return;const override=LOG_LEVEL$1(matches[1].toUpperCase());if(!override)return;this._config._level=override.asLowerCase;this.debug("Loglevel override in query string:",this._config._level)}debug(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}this._log(LOG_LEVEL$1.DEBUG,args)}info(){for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++){args[_key2]=arguments[_key2]}this._log(LOG_LEVEL$1.INFO,args)}warn(){for(var _len3=arguments.length,args=new Array(_len3),_key3=0;_key3<_len3;_key3++){args[_key3]=arguments[_key3]}this._log(LOG_LEVEL$1.WARN,args)}error(){for(var _len4=arguments.length,args=new Array(_len4),_key4=0;_key4<_len4;_key4++){args[_key4]=arguments[_key4]}this._log(LOG_LEVEL$1.ERROR,args)}fatal(){for(var _len5=arguments.length,args=new Array(_len5),_key5=0;_key5<_len5;_key5++){args[_key5]=arguments[_key5]}this._log(LOG_LEVEL$1.FATAL,args)}removed(){for(var _len6=arguments.length,args=new Array(_len6),_key6=0;_key6<_len6;_key6++){args[_key6]=arguments[_key6]}args=["REMOVED"].concat(args);this.warnOnce(...args)}deprecated(){for(var _len7=arguments.length,args=new Array(_len7),_key7=0;_key7<_len7;_key7++){args[_key7]=arguments[_key7]}args=["DEPRECATED"].concat(args);this.warnOnce(...args)}warnOnce(){for(var _len8=arguments.length,args=new Array(_len8),_key8=0;_key8<_len8;_key8++){args[_key8]=arguments[_key8]}if(this._hasWarned(args)){return}this._log(LOG_LEVEL$1.WARN,args)}_log(level,data){const isEnabled=this._config._isEnabled;if(!isEnabled)return;const configLevel=LOG_LEVEL$1(this._config._level.toUpperCase());const isLogLevelAllowed=level>=configLevel;if(!isLogLevelAllowed)return;this._logToConsole(level,data);this.trigger("log",level,data);this.trigger("log:"+level.asLowerCase,level,data)}_logToConsole(level,data){const shouldLogToConsole=this._config._console;if(!shouldLogToConsole)return;const log=[level.asUpperCase+":"];data&&log.push(...data);if(console[level.asLowerCase]){console[level.asLowerCase](...log)}else{console.log(...log)}}_hasWarned(args){if(!this._config._warnFirstOnly){return false}const hash=args.map(String).join(":");if(this._warned[hash]){return true}this._warned[hash]=true;return false}}const logging=new Logging;var logging$1=__AMD("core/js/logging",logging);var Log=__AMD("core/js/a11y/log",class Log extends Backbone.Controller{initialize(_ref){let{a11y:a11y}=_ref;this.a11y=a11y;this._warned={}}_hasWarned(args){const config=this.a11y.config;if(!config._options._warnFirstOnly){return false}const hash=args.map(String).join(":");if(this._warned[hash]){return true}this._warned[hash]=true;return false}_canWarn(){const config=this.a11y.config;return Boolean(config._options._warn)}removed(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}if(!this._canWarn){return}args=["A11Y"].concat(args);if(this._hasWarned(args)){return}logging$1.removed(...args);return this}deprecated(){for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++){args[_key2]=arguments[_key2]}if(!this._canWarn){return}args=["A11Y"].concat(args);if(this._hasWarned(args)){return}logging$1.deprecated(...args);return this}});var Scroll=__AMD("core/js/a11y/scroll",class Scroll extends Backbone.Controller{initialize(_ref){let{a11y:a11y}=_ref;this._a11y=a11y;this._onTouchStart=this._onTouchStart.bind(this);this._onTouchEnd=this._onTouchEnd.bind(this);this._onScrollEvent=this._onScrollEvent.bind(this);this._onKeyDown=this._onKeyDown.bind(this);this._scrollDisabledElements=$([]);this.$window=$(window);this.$body=$("body");this._preventScrollOnKeys={33:true,34:true,35:true,36:true,37:true,38:true,39:true,40:true};this._arrowKeys={37:true,38:true,39:true,40:true};this._ignoreKeysOnElementsMatching="textarea, input[type=radio], select";this._isRunning=false;this._touchStartEventObject=null;window.addEventListener("touchstart",this._onTouchStart);window.addEventListener("touchend",this._onTouchEnd);window.addEventListener("touchmove",this._onScrollEvent,{passive:false});window.addEventListener("wheel",this._onScrollEvent,{passive:false});document.addEventListener("wheel",this._onScrollEvent,{passive:false});document.addEventListener("keydown",this._onKeyDown)}disable($elements){$elements=$($elements);this._scrollDisabledElements=this._scrollDisabledElements.add($elements);this._checkRunning();return this}enable($elements){$elements=$($elements);if(!$elements.length){this.clear();return this}this._scrollDisabledElements=this._scrollDisabledElements.not($elements);this._checkRunning();return this}clear(){this._scrollDisabledElements=$([]);this._checkRunning();return this}_checkRunning(){if(!this._scrollDisabledElements.length){this._stop();return}this._start()}_start(){if(this._isRunning){return}this._isRunning=true}_onTouchStart(event){if(!this._isRunning)return;event=$.event.fix(event);this._touchStartEventObject=event;return true}_onTouchEnd(){if(!this._isRunning)return;this._touchStartEventObject=null;return true}_onScrollEvent(event){if(!this._isRunning)return;event=$.event.fix(event);return this._preventScroll(event)}_onKeyDown(event){if(!this._isRunning)return;event=$.event.fix(event);if(this._arrowKeys[event.which]&&this._a11y.isArrowable(event.target)){return}if(!this._preventScrollOnKeys[event.which]){return}if(this._a11y.isPopupOpen&&!this._isScrollable($(event.target))){const $openPopup=this._a11y.popupStack[this._a11y.popupStack.length-1];const $firstScrollable=this._isScrollable($openPopup)?$openPopup:this._a11y._findFirstForwardDescendant($openPopup,this._isScrollable);if($firstScrollable.length){event.target=$firstScrollable}}const $target=$(event.target);if($target.is(this._ignoreKeysOnElementsMatching)){return}return this._preventScroll(event)}_preventScroll(event){const isGesture=event.touches?.length>1;if(isGesture){return}const $target=$(event.target);if(this._scrollDisabledElements.length){const scrollingParent=this._getScrollingParent(event,$target);if(scrollingParent.filter(this._scrollDisabledElements).length===0){this.$window.scroll();return}}event.preventDefault();return false}_getScrollingParent(event,$target){const isTouchEvent=event.type==="touchmove";const isKeyDownEvent=event.type==="keydown";const hasTouchStartEvent=this._touchStartEventObject?.originalEvent;if(isTouchEvent&&!hasTouchStartEvent&&!isKeyDownEvent){return $target}const directionY=this._getScrollDirection(event);if(directionY==="none"){return this.$body}const parents=[$target[0],...$target.parents()];for(let i=0,l=parents.length;i<l;i++){const $parent=$(parents[i]);if($parent.is("body")){return this.$body}if(!this._isScrollable($parent)){continue}if(!this._isScrolling($parent,directionY)){continue}return $parent}return this.$body}_isScrollable($target){const scrollType=$target.css("overflow-y");if(scrollType!=="auto"&&scrollType!=="scroll"){return false}const pointerEvents=$target.css("pointer-events");if(pointerEvents==="none"){return false}return true}_isScrolling($target,directionY){const scrollTop=Math.ceil($target.scrollTop());const innerHeight=$target.outerHeight();const scrollHeight=$target[0].scrollHeight;let hasScrollingSpace=false;switch(directionY){case"down":hasScrollingSpace=scrollTop+innerHeight<scrollHeight;if(hasScrollingSpace){return true}break;case"up":hasScrollingSpace=scrollTop>0;if(hasScrollingSpace){return true}break}return false}_getScrollDirection(event){const deltaY=this._getScrollDelta(event);if(deltaY===0){return"none"}return deltaY>0?"up":"down"}_getScrollDelta(event){let deltaY=0;const isTouchEvent=event.type==="touchmove";const isKeyDownEvent=event.type==="keydown";const originalEvent=event.originalEvent;if(isTouchEvent){const startOriginalEvent=this._touchStartEventObject.originalEvent;let currentY=originalEvent.pageY;let previousY=startOriginalEvent.pageY;if(currentY===0||currentY===previousY){currentY=originalEvent.touches[0].pageY;previousY=startOriginalEvent.touches[0].pageY}deltaY=currentY-previousY}else if(isKeyDownEvent){deltaY=[33,36,38].includes(event.which)?1:[34,35,40].includes(event.which)?-1:0}else{const hasDeltaY=originalEvent.wheelDeltaY||originalEvent.deltaY!==undefined;if(hasDeltaY){deltaY=-originalEvent.deltaY}else{deltaY=originalEvent.wheelDelta||0}}return deltaY}_stop(){if(!this._isRunning){return}this._isRunning=false}});var WrapFocus=__AMD("core/js/a11y/wrapFocus",class WrapFocus extends Backbone.Controller{initialize(_ref){let{a11y:a11y}=_ref;this.a11y=a11y;_.bindAll(this,"_onWrapAround");this.listenTo(Adapt$1,{"accessibility:ready":this._attachEventListeners})}_attachEventListeners(){const config=this.a11y.config;$("body").on("click focus",config._options._focusguard,this._onWrapAround)}_onWrapAround(event){const config=this.a11y.config;if(!config._isEnabled||!config._options._isPopupWrapFocusEnabled){return}event.preventDefault();event.stopPropagation();this.a11y.focusFirst("body",{defer:false})}});var Popup=__AMD("core/js/a11y/popup",class Popup extends Backbone.Controller{initialize(_ref){let{a11y:a11y}=_ref;this.a11y=a11y;this._floorStack=[$("body")];this._focusStack=[];this._tabIndexes={};this._ariaHiddens={};this._elementUIDIndex=0;this.listenTo(Adapt$1,{"popup:opened"($element,ignoreInternalTrigger){if(ignoreInternalTrigger){return}this.a11y.log.deprecated('Adapt.trigger("popup:opened", $element) is replaced with a11y.popupOpened($element);');this.opened($element,true)},"popup:closed"($target,ignoreInternalTrigger){if(ignoreInternalTrigger){return}this.a11y.log.deprecated('Adapt.trigger("popup:closed", $target) is replaced with a11y.popupClosed($target);');this.closed($target,true)}})}get isOpen(){return this._floorStack.length>1}get stack(){return this._floorStack.slice(1)}opened($popupElement,silent){$popupElement=$popupElement||$(document.activeElement);this._addPopupLayer($popupElement);if(!silent){Adapt$1.trigger("popup:opened",$popupElement,true)}return this}_addPopupLayer($popupElement){$popupElement=$($popupElement);const config=this.a11y.config;if(!config._isEnabled||!config._options._isPopupManagementEnabled||$popupElement.length===0){return $popupElement}this._floorStack.push($popupElement);this._focusStack.push($(document.activeElement));let $elements=$(config._options._tabbableElements).filter(config._options._tabbableElementsExcludes);const $branch=$popupElement.add($popupElement.parents());const $siblings=$branch.siblings().filter(config._options._tabbableElementsExcludes);$elements=$elements.add($siblings);$elements.each(((index,item)=>{const $item=$(item);if(typeof item.a11y_uid==="undefined"){item.a11y_uid="UID"+ ++this._elementUIDIndex}const elementUID=item.a11y_uid;if(this._tabIndexes[elementUID]===undefined){this._tabIndexes[elementUID]=[]}if(this._ariaHiddens[elementUID]===undefined){this._ariaHiddens[elementUID]=[]}const tabindex=$item.attr("tabindex");const ariaHidden=$item.attr("aria-hidden");this._tabIndexes[elementUID].push(tabindex===undefined?"":tabindex);this._ariaHiddens[elementUID].push(ariaHidden===undefined?"":ariaHidden);if(config._options._isPopupTabIndexManagementEnabled){$item.attr("tabindex",-1)}if(config._options._isPopupAriaHiddenManagementEnabled){$item.attr("aria-hidden",true)}}));const $items=$popupElement.find(config._options._tabbableElements).filter(config._options._tabbableElementsExcludes);if(config._options._isPopupTabIndexManagementEnabled){$items.attr("tabindex",0)}if(config._options._isPopupAriaHiddenManagementEnabled){$items.removeAttr("aria-hidden").removeClass("aria-hidden").parents(config._options._ariaHiddenExcludes).removeAttr("aria-hidden").removeClass("aria-hidden")}}closed($focusElement,silent){const $previousFocusElement=this._removeLastPopupLayer();$focusElement=$focusElement||$previousFocusElement||$("body");if(!silent){Adapt$1.trigger("popup:closed",$focusElement,true)}this.a11y.focusFirst($($focusElement),{preventScroll:true});return this}_removeLastPopupLayer(){const config=this.a11y.config;if(!config._isEnabled||!config._options._isPopupManagementEnabled){return $(document.activeElement)}if(this._floorStack.length<=1){return}this._floorStack.pop();$(config._options._tabbableElements).filter(config._options._tabbableElementsExcludes).each(((index,item)=>{const $item=$(item);let previousTabIndex="";let previousAriaHidden="";if(typeof item.a11y_uid==="undefined"){item.a11y_uid="UID"+ ++this._elementUIDIndex}const elementUID=item.a11y_uid;if(this._tabIndexes[elementUID]?.length){previousTabIndex=this._tabIndexes[elementUID].pop();previousAriaHidden=this._ariaHiddens[elementUID].pop()}if(this._tabIndexes[elementUID]?.length){delete this._tabIndexes[elementUID];delete this._ariaHiddens[elementUID]}if(config._options._isPopupTabIndexManagementEnabled){if(previousTabIndex===""){$item.removeAttr("tabindex")}else{$item.attr({tabindex:previousTabIndex})}}if(config._options._isPopupAriaHiddenManagementEnabled){if(previousAriaHidden===""){$item.removeAttr("aria-hidden")}else{$item.attr({"aria-hidden":previousAriaHidden})}}}));return this._focusStack.pop()}setCloseTo($focusElement){const $original=this._focusStack.pop();this._focusStack.push($focusElement);return $original}});var defaultAriaLevels=__AMD("core/js/enums/defaultAriaLevels",{_menu:1,_menuGroup:2,_menuItem:2,_page:1,_article:2,_block:3,_component:4,_componentItem:5,_notify:1});var deprecated=__AMD("core/js/a11y/deprecated",(function(a11y){Object.assign($.fn,{isFixedPostion(){a11y.log.removed('$("..").isFixedPostion was unneeded and has been removed, let us know if you need it back.');return false},a11y_aria_label(){a11y.log.removed('$("..").a11y_aria_label was incorrect behaviour.');return this},limitedScrollTo(){a11y.log.removed("$.limitedScrollTo had no impact on the screen reader cursor.");return this},a11y_text(){a11y.log.removed("a11y_text is no longer required. https://tink.uk/understanding-screen-reader-interaction-modes/");return this},a11y_selected(){a11y.log.removed('$("..").a11y_selected is removed. Please use aria-live instead.');return this},a11y_on(isOn){a11y.log.deprecated('$("..").a11y_on, use a11y.findTabbable($element); and a11y.toggleAccessible($elements, isAccessible); instead.');const $tabbable=a11y.findTabbable(this);a11y.toggleAccessible($tabbable,isOn);return this},a11y_only(){a11y.log.removed('$("..").a11y_only, use a11y.popupOpened($popupElement); instead.');return this},scrollDisable(){if(a11y.config._options._isScrollDisableEnabled===false){return this}a11y.log.deprecated('$("..").scrollDisable, use a11y.scrollDisable($elements); instead.');a11y.scrollDisable(this);return this},scrollEnable(){if(a11y.config._options._isScrollDisableEnabled===false){return this}a11y.log.deprecated('$("..").scrollEnable, use a11y.scrollEnable($elements); instead.');a11y.scrollEnable(this);return this},a11y_popup(){a11y.log.deprecated('$("..").a11y_popup, use a11y.popupOpened($popupElement); instead.');return a11y.popupOpened(this)},a11y_cntrl(isOn,withDisabled){a11y.log.deprecated('$("..").a11y_cntrl, use a11y.toggleAccessible($elements, isAccessible); and if needed a11y.toggleEnabled($elements, isEnabled); instead.');a11y.toggleAccessible(this,isOn);if(withDisabled)a11y.toggleEnabled(this,isOn);return this},a11y_cntrl_enabled(isOn){a11y.log.deprecated('$("..").a11y_cntrl_enabled, use a11y.toggleAccessibleEnabled($elements, isAccessibleEnabled); instead.');a11y.toggleAccessibleEnabled(this,isOn);return this},isReadable(){a11y.log.deprecated('$("..").isReadable, use a11y.isReadable($element); instead.');return a11y.isReadable(this)},findForward(selector){a11y.log.removed('$("..").findForward has been removed as the use cases are very small, let us know if you need it back.');return a11y._findFirstForward(this,selector)},findWalk(selector){a11y.log.removed('$("..").findWalk has been removed as the use cases are very small, let us know if you need it back.');return a11y._findFindForwardDescendant(this,selector)},focusNoScroll(){a11y.log.deprecated('$("..").focusNoScroll, use a11y.focus($element); instead.');return a11y.focus(this)},focusNext(returnOnly){a11y.log.deprecated('$("..").focusNext, use a11y.focusNext($element); or if needed a11y.findFirstReadable($element); instead.');if(returnOnly){return a11y.findFirstReadable(this)}return a11y.focusNext(this)},focusOrNext(returnOnly){a11y.log.deprecated('$("..").focusOrNext, use a11y.focusFirst($element); or if needed a11y.findFirstReadable($element); or a11y.isReadable($element); instead.');if(returnOnly){if(a11y.isReadable(this))return this;return a11y.findFirstReadable(this)}return a11y.focusFirst(this)},a11y_focus(dontDefer){a11y.log.deprecated('$("..").a11y_focus, use a11y.focusFirst($element, { defer: true }); instead.');a11y.focusFirst(this,{defer:!dontDefer});return this}});Object.assign($,{a11y_alert(){a11y.log.removed("$.a11y_alert is removed. Please use aria-live instead.");return this},a11y_update(){a11y.log.removed("a11y_update is no longer required.");return this},a11y_text(text){a11y.log.removed("a11y_text is no longer required. https://tink.uk/understanding-screen-reader-interaction-modes/");return text},a11y_on(isOn,selector){a11y.log.deprecated('$("..").a11y_on, use a11y.toggleHidden($elements, isHidden); instead.');return a11y.toggleHidden(selector,!isOn)},a11y_popdown($focusTarget){a11y.log.removed("$.a11y_popdown, use a11y.popupClosed($focusTarget); instead.");return a11y.popupClosed($focusTarget)},a11y_focus(dontDefer){a11y.log.deprecated('$.a11y_focus, use a11y.focusFirst("body", { defer: true }); instead.');a11y.focusFirst("body",{defer:!dontDefer});return this},a11y_normalize(html){a11y.log.deprecated('$.a11y_normalize, use a11y.normalize("html"); instead.');return a11y.normalize(html)},a11y_remove_breaks(html){a11y.log.deprecated('$.a11y_remove_breaks, use a11y.removeBreaks("html"); instead.');return a11y.removeBreaks(html)}})}));class Components extends Backbone__default["default"].Controller{initialize(){this._register={};this.register=this.register.bind(this);this.getViewName=this.getViewName.bind(this);this.getViewClass=this.getViewClass.bind(this);this.getModelName=this.getModelName.bind(this);this.getModelClass=this.getModelClass.bind(this)}register(name,object){if(Array.isArray(name)){name.forEach((name=>this.register(name,object)));return object}if(name.split(" ").length>1){this.register(name.split(" "),object);return object}if(!object.view&&!object.model||object instanceof Backbone__default["default"].View){logging$1.deprecated("View-only registrations are no longer supported");object={view:object}}if(object.view&&!object.view.template){object.view.template=name}const isModelSetAndInvalid=object.model&&!(object.model.prototype instanceof Backbone__default["default"].Model)&&!(object.model instanceof Function);if(isModelSetAndInvalid){throw new Error("The registered model is not a Backbone.Model or Function")}const isViewSetAndInvalid=object.view&&!(object.view.prototype instanceof Backbone__default["default"].View)&&!(object.view instanceof Function);if(isViewSetAndInvalid){throw new Error("The registered view is not a Backbone.View or Function")}this._register[name]=Object.assign({},this._register[name],object);return object}getViewName(nameModelViewOrData){if(typeof nameModelViewOrData==="string"){return nameModelViewOrData}if(nameModelViewOrData instanceof Backbone__default["default"].Model){nameModelViewOrData=nameModelViewOrData.toJSON()}if(nameModelViewOrData instanceof Backbone__default["default"].View){let foundName;Object.entries(this._register).forEach((_ref=>{let[key,entry]=_ref;if(!entry?.view)return;if(!(nameModelViewOrData instanceof entry.view))return;foundName=key;return true}));return foundName}if(nameModelViewOrData instanceof Object){const names=[typeof nameModelViewOrData._view==="string"&&nameModelViewOrData._view,typeof nameModelViewOrData._component==="string"&&nameModelViewOrData._component,typeof nameModelViewOrData._type==="string"&&nameModelViewOrData._type].filter(Boolean);if(names.length){const name=names.find((name=>this._register[name]?.view));return name||names.pop()}}throw new Error("Cannot derive view class name from input")}getViewClass(nameModelViewOrData){const name=this.getViewName(nameModelViewOrData);const object=this._register[name];if(!object){logging$1.error(`A view for '${name}' isn't registered in your project`);return}const isBackboneView=object.view?.prototype instanceof Backbone__default["default"].View;if(!isBackboneView&&object.view instanceof Function){return object.view()}return object.view}getModelName(nameModelOrData){if(typeof nameModelOrData==="string"){return nameModelOrData}if(nameModelOrData instanceof Backbone__default["default"].Model){nameModelOrData=nameModelOrData.toJSON()}if(nameModelOrData instanceof Object){const name=nameModelOrData._component;const entry=this._register[name];const isViewOnlyQuestion=entry&&!entry.model&&entry.view?._isQuestionType;if(isViewOnlyQuestion){logging$1.deprecated(`Assuming a question model for a view-only question: ${name}`);return"question"}const names=[typeof nameModelOrData._model==="string"&&nameModelOrData._model,typeof nameModelOrData._component==="string"&&nameModelOrData._component,typeof nameModelOrData._type==="string"&&nameModelOrData._type].filter(Boolean);if(names.length){const name=names.find((name=>this._register[name]?.model));return name||names.pop()}}throw new Error("Cannot derive model class name from input")}getModelClass(nameModelOrData){const name=this.getModelName(nameModelOrData);const object=this._register[name];if(!object){logging$1.error(`A model for '${name}' isn't registered in your project`);return}const isBackboneModel=object.model?.prototype instanceof Backbone__default["default"].Model;if(!isBackboneModel&&object.model instanceof Function){return object.model()}return object.model}}const components=new Components;var components$1=__AMD("core/js/components",components);var AdaptCollection=__AMD("core/js/collections/adaptCollection",class AdaptCollection extends Backbone.Collection{initialize(models,options){this.once("reset",this.loadedData,this)}loadedData(){Adapt$1.trigger("adaptCollection:dataLoaded")}});var BuildModel=__AMD("core/js/models/buildModel",class BuildModel extends LockingModel{defaults(){return{jsonext:"json"}}initialize(attrs,options){this.url=options.url;this.fetch({success:()=>{this.isLoaded=true;Adapt$1.trigger("buildModel:dataLoaded")},error:()=>{console.log("Unable to load adapt/js/build.js");Adapt$1.trigger("buildModel:dataLoaded")}})}isFrameworkVersion(version){return semver__default["default"].satisfies(this.get("package").version,version,{includePrerelease:true})}isPluginInstalled(name){let version=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"*";const plugin=this.get("plugins").find((plugin=>{if(plugin.name!==name)return false;return semver__default["default"].satisfies(plugin.version,version,{includePrerelease:true})}));return Boolean(plugin)}whenReady(){if(this.isLoaded)return Promise.resolve();return new Promise((resolve=>{Adapt$1.once("buildModel:dataLoaded",resolve)}))}});var ConfigModel=__AMD("core/js/models/configModel",class ConfigModel extends LockingModel{defaults(){return{screenSize:null,_forceRouteLocking:false,_canLoadData:true,_disableAnimation:false}}setValuesFromURLParams(){const paramMappings={dir:"_defaultDirection",lang:"_defaultLanguage"};const params=new URLSearchParams(window.location.search);Object.entries(paramMappings).forEach((_ref=>{let[key,value]=_ref;const passedVal=params.get(key);if(!passedVal)return;if(key==="lang"&&Adapt$1.build.get("availableLanguageNames")?.includes(passedVal)===false)return;this.set(value,passedVal)}))}initialize(attrs,options){this.url=options.url;this.fetch({success:()=>{this.setValuesFromURLParams();Adapt$1.trigger("offlineStorage:prepare");wait$1.queue((()=>{Adapt$1.trigger("configModel:dataLoaded");if(!this.get("_canLoadData"))return;Adapt$1.trigger("configModel:loadCourseData")}))},error:()=>logging$1.error("Unable to load course/config.json")})}loadData(){}});class Data extends AdaptCollection{model(json){const ModelClass=components$1.getModelClass(json);if(!ModelClass){return new LockingModel(json)}return new ModelClass(json,{parse:true})}initialize(){super.initialize();this.findById=this.findById.bind(this);this.findViewByModelId=this.findViewByModelId.bind(this);this.findByTrackingPosition=this.findByTrackingPosition.bind(this);this.on({add:this.onAdded,remove:this.onRemoved})}async init(){this.reset();this._byAdaptID={};Adapt$1.build=new BuildModel(null,{url:"adapt/js/build.min.js",reset:true});await Adapt$1.build.whenReady();$("html").attr("data-adapt-framework-version",Adapt$1.build.get("package").version);this.loadConfigData()}onAdded(model){this._byAdaptID[model.get("_id")]=model}onRemoved(model){delete this._byAdaptID[model.get("_id")]}loadConfigData(){Adapt$1.config=new ConfigModel(null,{url:Adapt$1.build.get("coursedir")+"/config."+Adapt$1.build.get("jsonext"),reset:true});this.listenToOnce(Adapt$1,"configModel:loadCourseData",this.onLoadCourseData);this.listenTo(Adapt$1.config,{"change:_activeLanguage":this.onLanguageChange,"change:_defaultDirection":this.onDirectionChange})}onDirectionChange(model,direction){if(direction==="rtl"){$("html").removeClass("dir-ltr").addClass("dir-rtl").attr("dir","rtl")}else{$("html").removeClass("dir-rtl").addClass("dir-ltr").attr("dir","ltr")}}onLoadCourseData(){if(!Adapt$1.config.get("_activeLanguage")){Adapt$1.config.set("_activeLanguage",Adapt$1.config.get("_defaultLanguage"));return}this.loadCourseData()}async onLanguageChange(model,language){await wait$1.queue();const previousAttributes=model.previousAttributes();const previousLanguage=previousAttributes._activeLanguage;offlineStorage$1.set("lang",language);if(Adapt$1.get("_isStarted")){Adapt$1.set("_isStarted",false)}this.loadCourseData(language,previousLanguage)}async loadCourseData(newLanguage,previousLanguage){const language=Adapt$1.config.get("_activeLanguage");const courseFolder=Adapt$1.build.get("coursedir")+"/"+language+"/";$("html").attr("lang",language);await this.loadManifestFiles(courseFolder);await this.triggerDataLoaded();await this.triggerDataReady(newLanguage,previousLanguage);this.triggerInit()}getJSON(path){return new Promise(((resolve,reject)=>{$.getJSON(path,(data=>{data.__path__=path;resolve(data)})).fail((()=>{reject(new Error(`Unable to load ${path}`))}))}))}async loadManifestFiles(languagePath){this.trigger("loading");this.reset();this._byAdaptID={};const manifestPath=languagePath+"language_data_manifest.js";let manifest;try{manifest=await this.getJSON(manifestPath)}catch(err){manifest=["course.json","contentObjects.json","articles.json","blocks.json","components.json"];logging$1.error(`Manifest path '${manifestPath} not found. Using traditional files: ${manifest.join(", ")}`)}let allFileData;try{allFileData=await Promise.all(manifest.map((filePath=>this.getJSON(`${languagePath}${filePath}`))))}catch(error){logging$1.error(error);return}const allModelData=allFileData.reduce(((result,fileData)=>{if(Array.isArray(fileData)){fileData.forEach(((datum,index)=>{datum.__path__=fileData.__path__;datum.__index__=index}));result.push(...fileData)}else if(fileData instanceof Object){result.push(fileData)}else{logging$1.warnOnce(`File data isn't an array or object: ${fileData.__path__}`)}return result}),[]);const course=allModelData.find((modelData=>modelData._type==="course"));if(!course){throw new Error('Expected a model data with "_type": "course", none found.')}Adapt$1.trigger("courseModel:dataLoading");Adapt$1.course=this.push(course);Adapt$1.trigger("courseModel:dataLoaded");allModelData.forEach((modelData=>{if(modelData._type==="course"){return}try{components$1.getModelName(modelData)}catch(error){logging$1.error(`Failed to load object ${modelData.__path__}${Object.hasOwn(modelData,"__index__")?`[${modelData.__index__}]`:""}`);logging$1.error(error);return}this.push(modelData)}));this.checkData();this.trigger("reset");this.trigger("loaded");await wait$1.queue()}async triggerDataLoaded(){logging$1.debug("Firing app:dataLoaded");try{this.forEach((model=>model.setupModel?.()));Adapt$1.trigger("app:dataLoaded")}catch(e){logging$1.error("Error during app:dataLoading trigger",e)}await wait$1.queue()}async triggerDataReady(newLanguage,previousLanguage){if(newLanguage){Adapt$1.trigger("app:languageChanged",newLanguage,previousLanguage);await wait$1.queue()}logging$1.debug("Firing app:dataReady");try{Adapt$1.trigger("app:dataReady")}catch(e){logging$1.error("Error during app:dataReady trigger",e)}await wait$1.queue()}triggerInit(){this.isReady=true;this.trigger("ready")}whenReady(){if(this.isReady)return Promise.resolve();return new Promise((resolve=>{this.once("ready",resolve)}))}hasId(id){return Boolean(this._byAdaptID[id])}findById(id){const model=this._byAdaptID[id];if(!model){logging$1.warn(`data.findById() unable to find id: ${id}`);return}return model}findViewByModelId(id){const model=this.findById(id);if(!model||!Adapt$1.parentView)return;const idPathToView=[id];const currentLocationId=location$1._currentId;const currentLocationModel=model.getAncestorModels().find((model=>{const modelId=model.get("_id");if(modelId===currentLocationId)return true;idPathToView.unshift(modelId);return false}));if(!currentLocationModel){return logging$1.warn(`data.findViewByModelId() unable to find view for model id: ${id}`)}const foundView=idPathToView.reduce(((view,currentId)=>{if(!view)return null;const childViews=view.getChildViews();return childViews?.find((view=>view.model.get("_id")===currentId))}),Adapt$1.parentView);return foundView}findByTrackingPosition(trackingPosition){const[trackingId,indexInTrackingIdDescendants]=trackingPosition;const trackingIdModel=this.find((model=>model.get("_trackingId")===trackingId));if(!trackingIdModel){logging$1.warn(`data.findByTrackingPosition() unable to find trackingPosition: ${trackingPosition}`);return}if(indexInTrackingIdDescendants>=0){let trackingIdDescendants=[trackingIdModel].concat(trackingIdModel.getAllDescendantModels(true));trackingIdDescendants=trackingIdDescendants.filter((model=>!(model.isTypeGroup("component")&&model.get("_isTrackable")===false)));return trackingIdDescendants[indexInTrackingIdDescendants]}const trackingIdAncestors=trackingIdModel.getAncestorModels();const ancestorDistance=Math.abs(indexInTrackingIdDescendants)-1;return trackingIdAncestors[ancestorDistance]}logReadyError(view){const notReadyDescendants=view.model.getAllDescendantModels(true).filter((model=>!model.get("_isReady")));logging$1.error(`View ${notReadyDescendants.map((model=>`${model.get("_id")} (${model.get("_component")??model.get("_type")})`)).join(", ")} failed to become ready, forcing ready status.`);notReadyDescendants.reverse().forEach((model=>model.set("_isReady",true)))}checkData(){this.checkIds();this.checkTrackingIds()}checkIds(){const items=this.toJSON();const idIndex=___default["default"].indexBy(items,"_id");const idGroups=___default["default"].groupBy(items,"_id");const parentIdGroups=___default["default"].groupBy(items,"_parentId");let orphanedIds={};let emptyIds={};let duplicateIds={};let missingIds={};items.forEach((o=>{const isCourseType=o._type==="course";const isComponentType=o._type==="component";if(idGroups[o._id].length>1){duplicateIds[o._id]=true}if(!isComponentType&&!parentIdGroups[o._id]){emptyIds[o._id]=true}if(!isCourseType&&(!o._parentId||!idIndex[o._parentId])){orphanedIds[o._id]=true}if(!isCourseType&&o._parentId&&!idIndex[o._parentId]){missingIds[o._parentId]=true}}));orphanedIds=Object.keys(orphanedIds);emptyIds=Object.keys(emptyIds);duplicateIds=Object.keys(duplicateIds);missingIds=Object.keys(missingIds);const hasErrored=orphanedIds.length||emptyIds.length||duplicateIds.length||missingIds.length;if(orphanedIds.length){logging$1.error(`Orphaned _ids: ${orphanedIds.join(", ")}`)}if(missingIds.length){logging$1.error(`Missing _ids: ${missingIds.join(", ")}`)}if(emptyIds.length){logging$1.error(`Empty _ids: ${emptyIds.join(", ")}`)}if(duplicateIds.length){logging$1.error(`Duplicate _ids: ${duplicateIds.join(", ")}`)}if(hasErrored){const err=new Error("Oops, looks like you have some json errors.");err.number=10011;throw err}}checkTrackingIds(){const items=this.toJSON();const trackingIdType=Adapt$1.build.get("trackingIdType")||"block";const trackingIdCounts=___default["default"].groupBy(items.filter((item=>item._type===trackingIdType)),"_trackingId");const missingTrackingIds=items.filter((item=>item._type===trackingIdType&&item._trackingId===undefined)).map((item=>item._id));if(missingTrackingIds.length){logging$1.error(`Missing _trackingIds: ${missingTrackingIds.join(", ")}`)}const duplicateTrackingIds=Object.entries(trackingIdCounts).filter((_ref=>{let[id,group]=_ref;return group.length>1})).map((_ref2=>{let[id,group]=_ref2;return`${id}:[${group.map((item=>item._id)).join(", ")}]`}));if(duplicateTrackingIds.length){logging$1.error(`Duplicate _trackingIds: ${duplicateTrackingIds.join(", ")}`)}const hasErrored=missingTrackingIds.length||duplicateTrackingIds.length;if(hasErrored){const err=new Error("Oops, looks like you have some json errors with trackingIds.");err.number=10011;throw err}}}const data=new Data;var data$1=__AMD("core/js/data",data);class A11y extends Backbone.Controller{defaults(){return{_isPrefersReducedMotionEnabled:true,_isFocusOutlineKeyboardOnlyEnabled:true,_isFocusOutlineDisabled:false,_isFocusAssignmentEnabled:true,_isFocusOnClickEnabled:true,_isClickDelayedAfterFocusEnabled:false,_isFocusNextOnDisabled:true,_isScrollDisableEnabled:true,_isAriaHiddenManagementEnabled:true,_isPopupManagementEnabled:true,_isPopupWrapFocusEnabled:true,_isPopupAriaHiddenManagementEnabled:true,_isPopupTabIndexManagementEnabled:true,_ariaHiddenExcludes:":not(#wrapper):not(body)",_tabbableElements:"a,button,input,select,textarea,[tabindex]:not([data-a11y-force-focus])",_focusOutlineKeyboardOnlyIgnore:"input,textarea",_tabbableElementsExcludes:":not(.a11y-ignore):not([data-a11y-force-focus])",_focusableElements:"a,button,input,select,textarea,[tabindex],label",_readableElements:"[role=heading],[aria-label],[aria-labelledby],[alt]",_focusForwardElementsExcludes:":not([aria-labelledby][role=dialog],[aria-labelledby][role=main],[aria-labelledby][role=region],[aria-labelledby][role=radiogroup],[aria-labelledby][role=group],[aria-labelledby][role=tablist],[aria-labelledby][role=list],[aria-labelledby][role=tree],[aria-labelledby][role=treegrid],[aria-labelledby][role=table],[aria-labelledby][role=grid][aria-labelledby],[role=menu],[aria-labelledby][role=rowgroup])",_focusguard:".a11y-focusguard",_wrapStyleElements:"b,i,abbr,strong,em,small,sub,sup,ins,del,mark,zw,nb",_arrowElements:"input[type=radio]",_warnFirstOnly:true,_warn:true}}initialize(){this.isFocusable=this.isFocusable.bind(this);this.isReadable=this.isReadable.bind(this);this.isTabbable=this.isTabbable.bind(this);this.$html=$("html");this._htmlCharRegex=/&.*;/g;this.config=null;this._browserConfig=new BrowserConfig({a11y:this});this._browserFocus=new BrowserFocus({a11y:this});this._keyboardFocusOutline=new KeyboardFocusOutline({a11y:this});this._wrapFocus=new WrapFocus({a11y:this});this._popup=new Popup({a11y:this});this._scroll=new Scroll({a11y:this});this._isForcedFocus=false;this.log=new Log({a11y:this});deprecated(this);this._removeLegacyElements();this.listenToOnce(Adapt$1,{"configModel:dataLoaded":this._onConfigDataLoaded,"navigationView:postRender":this._removeLegacyElements},this);Adapt$1.on("device:changed",this._setupNoSelect);this.listenTo(Adapt$1,{"router:location":this._onNavigationStart,"contentObjectView:ready router:plugin":this._onNavigationEnd})}_onConfigDataLoaded(){this.config=Adapt$1.config.get("_accessibility");this.config._isActive=false;this.config._options=_.defaults(this.config._options||{},this.defaults());offlineStorage$1.set("a11y",false);this.$html.toggleClass("has-accessibility",this.isEnabled());this._setupNoSelect();this._addFocuserDiv();if(this._isReady){return}this._isReady=true;Adapt$1.trigger("accessibility:ready")}_setupNoSelect(){if(!this.config?._disableTextSelectOnClasses){return}const classes=this.config._disableTextSelectOnClasses.split(" ");const isMatch=classes.some((className=>this.$html.is(className)));this.$html.toggleClass("u-no-select",isMatch)}_addFocuserDiv(){if($("#a11y-focuser").length){return}$("body").append($('<div id="a11y-focuser" class="a11y-ignore" tabindex="-1">&nbsp;</div>'))}_removeLegacyElements(){const $legacyElements=$("body").children("#accessibility-toggle, #accessibility-instructions");const $navigationElements=$(".nav").find("#accessibility-toggle, #accessibility-instructions");if(!$legacyElements.length&&!$navigationElements.length){return}logging$1.warn("REMOVED: #accessibility-toggle and #accessibility-instructions have been removed. Please remove them from all of your .html files.");$legacyElements.remove();$navigationElements.remove()}_onNavigationStart(){if(!this.isEnabled()){return}_.defer((()=>this.toggleHidden(".contentobject",true)))}_onNavigationEnd(view){if(view?.model?.get("_id")!==location$1._currentId||!this.isEnabled()){return}this.toggleHidden(".contentobject",false)}isActive(){this.log.removed("Accessibility is now always active when enabled. Please unify your user experiences.");return false}isEnabled(){return this.config?._isEnabled}ariaLevel(){let{id:id=null,level:level="1",override:override=null}=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};if(arguments.length===2){level=arguments[0];override=arguments[1];id=null}const ariaLevels=Adapt$1.config.get("_accessibility")?._ariaLevels??defaultAriaLevels;if(override===0)override=null;function calculateLevel(){let id=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;let level=arguments.length>1?arguments[1]:undefined;let offset=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;const isNumber=!isNaN(level);const isTypeName=/[a-zA-z]/.test(level);if(!isTypeName&&isNumber){return parseInt(level)+offset}const relativeDescriptor=Adapt$1.parseRelativeString(level);const nextLevel=ariaLevels?.["_"+relativeDescriptor.type];const hasModelId=Boolean(id);if(!hasModelId){logging$1.warnOnce("Cannot calculate appropriate heading level, no model id was specified");return calculateLevel(id,nextLevel,offset+relativeDescriptor.offset)}const nextModel=data$1.findById(id)?.findAncestor(relativeDescriptor.type?.toLowerCase())??data$1.findById(id);const nextModelId=nextModel?.get("_id")??id;const hasNextTitle=Boolean(nextModel.get("displayTitle"));let nextModelOverride=nextModel.get("_ariaLevel");if(nextModelOverride===0)nextModelOverride=null;const accumulatedOffset=offset+(hasNextTitle?relativeDescriptor.offset:0);const resolvedLevel=nextModelOverride??nextLevel;return calculateLevel(nextModelId,resolvedLevel,accumulatedOffset)}return calculateLevel(id,override??level)}toggleHidden($elements){let isHidden=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;$elements=$($elements);const config=this.config;if(!config._isEnabled||!config._options._isAriaHiddenManagementEnabled){return this}if(isHidden===true){$elements.attr("aria-hidden",true)}else{$elements.removeAttr("aria-hidden")}return this}toggleAccessibleEnabled($elements,isAccessibleEnabled){this.toggleAccessible($elements,isAccessibleEnabled);this.toggleEnabled($elements,isAccessibleEnabled);return this}toggleAccessible($elements){let isReadable=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;$elements=$($elements);const config=this.config;if(!config._isEnabled||!config._options._isAriaHiddenManagementEnabled||$elements.length===0){return this}if(!isReadable){$elements.attr({tabindex:"-1","aria-hidden":"true"}).addClass("aria-hidden")}else{$elements.removeAttr("aria-hidden tabindex").removeClass("aria-hidden");$elements.parents(config._options._ariaHiddenExcludes).removeAttr("aria-hidden").removeClass("aria-hidden")}return this}toggleEnabled($elements){let isEnabled=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;$elements=$($elements);if($elements.length===0){return this}if(!isEnabled){$elements.attr({"aria-disabled":"true"}).addClass("is-disabled")}else{$elements.removeAttr("aria-disabled").removeClass("is-disabled")}return this}toggleTabbableDescendants($element){let isTabbable=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;const $tabbable=this.findTabbable($element);if(!isTabbable){$tabbable.each(((index,element)=>{if(element.isAdaptTabHidden)return;const $element=$(element);element.isAdaptTabHidden=true;element.adaptPreviousTabIndex=$element.attr("tabindex")??null;$element.attr("tabindex",-1)}));return this}$tabbable.each(((index,element)=>{if(!element.isAdaptTabHidden)return;const $element=$(element);if(element.adaptPreviousTabIndex===null)$element.removeAttr("tabindex");else $element.attr("tabindex",element.adaptPreviousTabIndex);delete element.isAdaptTabHidden;delete element.adaptPreviousTabIndex}));return this}findFirstTabbable($element){$element=$($element).first();return this._findFirstForward($element,this.isTabbable)}findFirstReadable($element){$element=$($element).first();return this._findFirstForward($element,this.isReadable)}findFirstFocusable($element){$element=$($element).first();return this._findFirstForward($element,this.isFocusable)}findTabbable($element){const config=this.config;return $($element).find(config._options._tabbableElements).filter(config._options._tabbableElementsExcludes)}findReadable($element){return $($element).find("*").filter(((index,element)=>this.isReadable(element)))}findFocusable($element){return $($element).find("*").filter(((index,element)=>this.isFocusable(element)))}isTabbable($element){const config=this.config;const value=$($element).is(config._options._tabbableElements).is(config._options._tabbableElementsExcludes);if(!value){return null}return value}isReadable($element){let checkParents=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;const config=this.config;$element=$($element).first();const $branch=checkParents?$element.add($element.parents()):$element;const isNotVisible=$branch.toArray().some((item=>{const style=window.getComputedStyle(item);return style.display==="none"||style.visibility==="hidden"||item.getAttribute("aria-hidden")==="true"}));if(isNotVisible){return false}const hasReadableContent=!/^\s*$/.test($element.text())||!/^\s*$/.test($element.attr("aria-label")??"")||!/^\s*$/.test($element.attr("aria-labelledby")??"");const hasNativeFocusOrIsScreenReadable=($element.is(config._options._focusableElements)||$element.is(config._options._readableElements))&&hasReadableContent;if(hasNativeFocusOrIsScreenReadable){return true}const childNodes=$element[0].childNodes;for(let c=0,cl=childNodes.length;c<cl;c++){const childNode=childNodes[c];const isTextNode=childNode.nodeType===3;if(!isTextNode){continue}const isOnlyWhiteSpace=/^\s*$/.test(childNode.nodeValue);if(isOnlyWhiteSpace){continue}return true}return null}isFocusable($element){let checkParents=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;const config=this.config;$element=$($element).first();if(!$element.is(config._options._focusForwardElementsExcludes))return null;return this.isReadable($element,checkParents)}isArrowable($element){const config=this.config;$element=$($element).first();return $element.is(config._options._arrowElements)}_findFirstForward($element,selector){$element=$($element).first();let iterator;switch(typeof selector){case"string":iterator=function($tag){return $tag.is(selector)||undefined};break;case"function":iterator=selector;break;case"undefined":iterator=Boolean}if($element.length===0){return $element.not("*")}let $found=this._findFirstForwardDescendant($element,iterator);if($found.length){return $found}$element.nextAll().toArray().some((sibling=>{const $sibling=$(sibling);const value=iterator($sibling);if(value===false){return false}if(value){$found=$sibling;return true}$found=this._findFirstForwardDescendant($sibling,iterator);return Boolean($found.length)}));if($found.length){return $found}$element.add($element.parents()).toArray().reverse().some((parent=>{const $parent=$(parent);if(iterator($parent)===false){return false}return $parent.nextAll().toArray().some((sibling=>{const $sibling=$(sibling);const value=iterator($sibling);if(value===false){return false}if(value){$found=$sibling;return true}$found=this._findFirstForwardDescendant($sibling,iterator);return Boolean($found.length)}))}));if(!$found.length){return $element.not("*")}return $found}_findFirstForwardDescendant($element,selector){$element=$($element).first();let iterator;switch(typeof selector){case"string":iterator=function($tag){return $tag.is(selector)||undefined};break;case"function":iterator=selector;break;case"undefined":iterator=Boolean}const $notFound=$element.not("*");if($element.length===0){return $notFound}const stack=[{item:$element[0],value:undefined}];let stackIndexPosition=0;let childIndexPosition=stackIndexPosition+1;do{const stackEntry=stack[stackIndexPosition];const $stackItem=$(stackEntry.item);switch(stackEntry.value){case true:return $stackItem;case false:return $notFound}$stackItem.children().toArray().forEach((item=>{const $item=$(item);const value=iterator($item);if(value===false){return}stack.splice(childIndexPosition++,0,{item:item,value:value})}));stackIndexPosition++;childIndexPosition=stackIndexPosition+1}while(stackIndexPosition<stack.length);return $notFound}focusNext($element,options){options=new FocusOptions(options);$element=$($element).first();$element=this.findFirstFocusable($element);this.focus($element,options);return this}focusFirst($element,options){options=new FocusOptions(options);$element=$($element).first();if(this.isReadable($element)){this.focus($element,options);return $element}$element=this.findFirstFocusable($element);this.focus($element,options);return $element}focus($element,options){options=new FocusOptions(options);$element=$($element).first();const config=this.config;if(!config._isEnabled||!config._options._isFocusAssignmentEnabled||$element.length===0){return this}const perform=()=>{if($element.attr("tabindex")===undefined){$element.attr({tabindex:"0","data-a11y-force-focus":"true"})}if(options.preventScroll){const y=$(window).scrollTop();try{this._isForcedFocus=true;$element[0].focus({preventScroll:true});this._isForcedFocus=false}catch(e){}switch(device$1.browser){case"internet explorer":case"microsoft edge":case"safari":window.scrollTo(null,y)}}else{this._isForcedFocus=true;$element[0].focus();this._isForcedFocus=false}};if(options.defer){_.defer(perform)}else{perform()}return this}get isForcedFocus(){return this._isForcedFocus}normalize(htmls){htmls=[...arguments].filter(Boolean).filter(_.isString).join(" ");const text=$("<div>"+htmls+"</div>").text();return text.replace(this._htmlCharRegex,"")}removeBreaks(htmls){htmls=[...arguments].filter(Boolean).filter(_.isString).join(" ");const $div=$("<div>"+htmls+"</div>");const stack=[$div[0]];let stackIndex=0;const outputs=[];do{if(stack[stackIndex].childNodes.length){const nodes=stack[stackIndex].childNodes;const usable=nodes.filter((node=>{const isTextNode=node.nodeType===3;if(isTextNode){return true}const isStyleElement=$(node).is(this.config._options._wrapStyleElements);if(isStyleElement){return true}return false}));outputs.push.apply(outputs,usable);stack.push.apply(stack,nodes)}stackIndex++}while(stackIndex<stack.length);let rtnText="";outputs.forEach((function(item){rtnText+=item.outerHTML||item.textContent}));return rtnText}scrollEnable($elements){this._scroll.enable($elements);return this}scrollDisable($elements){this._scroll.disable($elements);return this}popupOpened($popupElement){this._popup.opened($popupElement);return this}popupClosed($focusElement){this._popup.closed($focusElement);return this}setPopupCloseTo($focusElement){return this._popup.setCloseTo($focusElement)}get isPopupOpen(){return this._popup.isOpen}get popupStack(){return this._popup.stack}}const a11y=new A11y;var a11y$1=__AMD("core/js/a11y",a11y);class DrawerItemView extends Backbone.View{className(){return"drawer__menu drawer__item"}attributes(){return{role:"listitem"}}initialize(){this.listenTo(Adapt$1,"drawer:empty",this.remove);this.render()}events(){return{"click .drawer__item-btn":"onDrawerItemClicked"}}render(){const data=this.model.toJSON();const template=Handlebars.templates.drawerItem;$(this.el).html(template(data)).appendTo(".drawer__holder");return this}onDrawerItemClicked(event){event.preventDefault();const eventCallback=this.model.get("eventCallback");Adapt$1.trigger(eventCallback)}}DrawerItemView.type="drawerItem";var DrawerItemView$1=__AMD("core/js/views/drawerItemView",DrawerItemView);class DrawerView extends Backbone__default["default"].View{className(){return["drawer","u-display-none"].filter(Boolean).join(" ")}attributes(){return{role:"dialog","aria-modal":"true","aria-labelledby":"drawer-heading","aria-hidden":"true"}}events(){return{"click .drawer__back":"onBackButtonClicked","click .drawer__close":"onCloseClicked"}}initialize(){this._isVisible=false;this.disableAnimation=Adapt$1.config.has("_disableAnimation")?Adapt$1.config.get("_disableAnimation"):false;this._globalDrawerPosition=Adapt$1.config.get("_drawer")?._position??"auto";this.drawerDuration=Adapt$1.config.get("_drawer")?._duration??400;this.setupEventListeners();this.render()}setupEventListeners(){this.onKeyUp=this.onKeyUp.bind(this);$(window).on("keyup",this.onKeyUp)}onKeyUp(event){if(event.which!==27)return;event.preventDefault();this.hideDrawer()}render(){const template=Handlebars.templates.drawer;$(this.el).html(template({_globals:Adapt$1.course.get("_globals")})).prependTo("body");const shadowTemplate=Handlebars.templates.shadow;$(shadowTemplate()).prependTo("body");_.defer(this.postRender.bind(this));return this}postRender(){this.$("a, button, input, select, textarea").attr("tabindex",-1);this.checkIfDrawerIsAvailable()}setDrawerPosition(position){if(this._useMenuPosition)position=null;const isGlobalPositionAuto=this._globalDrawerPosition==="auto";const isRTL=Adapt$1.config.get("_defaultDirection")==="rtl";if(position&&isGlobalPositionAuto&&isRTL)position=position==="left"?"right":"left";if(!isGlobalPositionAuto||!position)position=this._globalDrawerPosition;this.$el.removeClass(`is-position-${this.drawerPosition}`).addClass(`is-position-${position}`);this.drawerPosition=position;this.drawerAnimationDir=position==="auto"?isRTL?"left":"right":position}openCustomView(view){let hasBackButton=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;let position=arguments.length>2?arguments[2]:undefined;this.$(".js-drawer-holder").removeAttr("role");this._hasBackButton=hasBackButton;this._isCustomViewVisible=true;this._customView=view;Adapt$1.trigger("drawer:empty");this.showDrawer(null,position);this.$(".drawer__holder").html(view instanceof Backbone__default["default"].View?view.$el:view)}checkIfDrawerIsAvailable(){const isEmptyDrawer=this.collection.length===0;$(".js-nav-drawer-btn").toggleClass("u-display-none",isEmptyDrawer);if(isEmptyDrawer){Adapt$1.trigger("drawer:noItems")}}onBackButtonClicked(event){event.preventDefault();this.showDrawer(true)}onCloseClicked(event){event.preventDefault();this.hideDrawer()}get isOpen(){return this._isVisible&&this._isCustomViewVisible===false}showDrawer(emptyDrawer){let position=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;this.setDrawerPosition(position);this.$el.removeClass("u-display-none").removeAttr("aria-hidden");if(!this._isVisible){a11y$1.popupOpened(this.$el);a11y$1.scrollDisable("body");this._isVisible=true}this.$("a, button, input, select, textarea").attr("tabindex",0);if(emptyDrawer){this.$(".drawer__back").addClass("u-display-none");this._isCustomViewVisible=false;this.emptyDrawer();if(this.collection.models.length===1){Adapt$1.trigger(this.collection.models[0].get("eventCallback"));this._isCustomViewVisible=false}else{this._useMenuPosition=true;this.renderItems();Adapt$1.trigger("drawer:openedItemView")}}else{const hideDrawerBackButton=!this._hasBackButton||this.collection.models.length<=1;this.$(".drawer__back").toggleClass("u-display-none",hideDrawerBackButton);Adapt$1.trigger("drawer:openedCustomView")}$(".js-shadow").removeClass("u-display-none");$(".js-drawer-holder").scrollTop(0);const direction={};direction[this.drawerAnimationDir]=0;const complete=()=>{this.addShadowEvent();$(".js-nav-drawer-btn").attr("aria-expanded",true);Adapt$1.trigger("drawer:opened");a11y$1.focusFirst(this.$el,{defer:true})};if(this.disableAnimation){this.$el.css(direction);complete()}else{const easing=Adapt$1.config.get("_drawer")?._showEasing||"easeOutQuart";this.$el.velocity(direction,this.drawerDuration,easing);$(".js-shadow").velocity({opacity:1},{duration:this.drawerDuration,begin:()=>{complete()}})}}emptyDrawer(){this.$(".drawer__holder").empty()}renderItems(){Adapt$1.trigger("drawer:empty");this.emptyDrawer();const isList=this.collection.length>1;if(isList)this.$(".js-drawer-holder").attr("role","list");else this.$(".js-drawer-holder").removeAttr("role");this.collection.forEach((model=>new DrawerItemView$1({model:model})))}hideDrawer($toElement){if(!this._isVisible)return;this._useMenuPosition=false;const direction={};a11y$1.popupClosed($toElement);this._isVisible=false;a11y$1.scrollEnable("body");direction[this.drawerAnimationDir]=-this.$el.width();const complete=()=>{this.$el.removeAttr("style").addClass("u-display-none").attr("aria-hidden","true");this.$(".js-drawer-holder").removeAttr("role");this._customView=null;$(".js-nav-drawer-btn").attr("aria-expanded",false);Adapt$1.trigger("drawer:closed");this.setDrawerPosition(this._globalDrawerPosition)};if(this.disableAnimation){this.$el.css(direction);$(".js-shadow").addClass("u-display-none");complete()}else{const easing=Adapt$1.config.get("_drawer")?._hideEasing||"easeInQuart";this.$el.velocity(direction,this.drawerDuration,easing,(()=>{complete()}));$(".js-shadow").velocity({opacity:0},{duration:this.drawerDuration,complete(){$(".js-shadow").addClass("u-display-none")}})}this._isCustomViewVisible=false;this.removeShadowEvent()}addShadowEvent(){$(".js-shadow").one("click touchstart",(()=>this.hideDrawer()))}removeShadowEvent(){$(".js-shadow").off("click touchstart")}remove(){this.hideDrawer();super.remove();$(window).off("keyup",this.onKeyUp);Adapt$1.trigger("drawer:empty");this.collection.reset();$(".js-shadow").remove()}}Object.assign(DrawerView,{childContainer:".js-drawer-holder",childView:DrawerItemView$1});var DrawerView$1=__AMD("core/js/views/drawerView",DrawerView);var TemplateRenderEvent=__AMD("core/js/templateRenderEvent",class TemplateRenderEvent{constructor(type,name,mode,value,args){this.type=type;this.name=name;this.mode=mode;this.value=value;this.args=args}});var register=__AMD("core/js/reactHelpers",(function register(name,component){templates[name]=function(){const mode="reactTemplate";for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}const preRenderEvent=new TemplateRenderEvent(`${mode}:preRender`,name,mode,null,args);Adapt$1.trigger(preRenderEvent.type,preRenderEvent);const value=component(...preRenderEvent.args);const postRenderEvent=new TemplateRenderEvent(`${mode}:postRender`,name,mode,value,preRenderEvent.args);Adapt$1.trigger(postRenderEvent.type,postRenderEvent);return postRenderEvent.value}}));(function(){const original=React__default["default"].createElement;React__default["default"].createElement=function(){for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++){args[_key2]=arguments[_key2]}const name=args[0];const mode="reactElement";const preRenderEvent=new TemplateRenderEvent(`${mode}:preRender`,name,mode,null,args);Adapt$1.trigger(preRenderEvent.type,preRenderEvent);const value=original(...preRenderEvent.args);const postRenderEvent=new TemplateRenderEvent(`${mode}:postRender`,name,mode,value,preRenderEvent.args);Adapt$1.trigger(postRenderEvent.type,postRenderEvent);return postRenderEvent.value}})();const templates={};function html(html){if(!html)return;logging$1.deprecated("reactHelpers.html please use react dangerouslySetInnerHTML instead: https://reactjs.org/docs/dom-elements.html#dangerouslysetinnerhtml");return{__html:html}}function compile(template){for(var _len3=arguments.length,args=new Array(_len3>1?_len3-1:0),_key3=1;_key3<_len3;_key3++){args[_key3-1]=arguments[_key3]}const output=Handlebars.compile(template)(...args);return output}function classes(){for(var _len5=arguments.length,args=new Array(_len5),_key5=0;_key5<_len5;_key5++){args[_key5]=arguments[_key5]}return _.uniq(_.flatten(args).filter(Boolean).join(" ").split(" ")).join(" ")}function prefixClasses(prefixes){for(var _len6=arguments.length,args=new Array(_len6>1?_len6-1:0),_key6=1;_key6<_len6;_key6++){args[_key6-1]=arguments[_key6]}const classes=_.flatten(args).filter(Boolean);const prefixed=_.flatten(prefixes.map((prefix=>classes.map((className=>`${prefix}${className}`)))));return _.uniq(prefixed.join(" ").split(" ")).join(" ")}const FIRST_PASS=1;const SECOND_PASS=2;const THIRD_PASS=3;var TooltipItemView=__AMD("core/js/views/TooltipItemView",class TooltipItemView extends Backbone.View{className(){return["tooltip",this.model.get("isTargetFixedPosition")&&"is-fixed",this.model.get("tooltipClasses")||"is-vertical-axis is-arrow-middle is-bottom is-middle",this.model.get("isShown")&&"is-shown",this.model.get("_classes")].filter(Boolean).join(" ")}attributes(){return{id:`tooltip-${this.model.get("_id")}`,style:Object.entries(this.model.get("tooltipStyles")??{}).map((_ref=>{let[name,value]=_ref;return`${name}: ${value};`})).join(" ")}}updateViewProperties(){const classesToAdd=_.result(this,"className").trim().split(/\s+/);classesToAdd.forEach((i=>this._classSet.add(i)));const classesToRemove=[...this._classSet].filter((i=>!classesToAdd.includes(i)));classesToRemove.forEach((i=>this._classSet.delete(i)));this._setAttributes({..._.result(this,"attributes"),id:_.result(this,"id")});this.$el.removeClass(classesToRemove).addClass(classesToAdd)}initialize(_ref2){let{$target:$target,parent:parent}=_ref2;_.bindAll(this,"onDeviceResize","onMouseOut","doSubsequentPasses");this._classSet=new Set(_.result(this,"className").trim().split(/\s+/));this.$target=$target;this.parent=parent;this.$target.attr("aria-describedby",`tooltip-${this.model.get("_id")}`);this.model.set("ariaLabel",this.$target.attr("aria-label")||this.$target.find(".aria-label").text());this.listenTo(Adapt$1,"device:resize",this.onDeviceResize);$(document).on("mouseleave blur","[data-tooltip-id]",this.onMouseOut);this.doFirstPass();setTimeout(this.doSubsequentPasses,17)}get environment(){const navigationAlignment=Adapt$1.course.get("_navigation")?._navigationAlignment??"top";const navHeight=$(".nav").outerHeight(true);const $target=this.$target;return{position:this.model.get("_position")||"outside bottom middle right",isDisabled:$target.attr("aria-disabled")!==undefined||$target.hasClass("is-disabled")||$target.is(":disabled"),isTargetFixedPosition:Boolean(this.$target.add(this.$target.parents()).filter(((index,el)=>$(el).css("position")==="fixed")).length),isRTL:Adapt$1.config.get("_defaultDirection")==="rtl",topNavOffset:navigationAlignment==="top"?navHeight:0,bottomNavOffset:navigationAlignment==="bottom"?navHeight:0,targetDOMRect:$target[0]?.getBoundingClientRect(),clientDOMRect:{width:parseInt(getComputedStyle(document.body).width),height:$("html")[0].clientHeight},tooltipDOMRect:this.$(".tooltip__body")[0]?.getBoundingClientRect(),arrowDOMRect:this.$(".tooltip__arrow")[0]?.getBoundingClientRect(),ariaHidden:document.activeElement===this.$target[0]}}doFirstPass(){this.model.set("isShown",false);const environment=this.environment;const positions=position$1(environment,{},FIRST_PASS);const{isDisabled:isDisabled,isTargetFixedPosition:isTargetFixedPosition,ariaHidden:ariaHidden}=environment;this.model.set({isDisabled:isDisabled,isTargetFixedPosition:isTargetFixedPosition,ariaHidden:ariaHidden,...positions});this.render()}doSubsequentPasses(){if(!this.model)return;this.model.set("hasLoaded",true);const multipassCache={};for(let pass=SECOND_PASS,l=THIRD_PASS;pass<=l;pass++){const environment=this.environment;const positions=position$1(this.environment,multipassCache,pass);const{isDisabled:isDisabled,isTargetFixedPosition:isTargetFixedPosition,ariaHidden:ariaHidden}=environment;this.model.set({isDisabled:isDisabled,isTargetFixedPosition:isTargetFixedPosition,ariaHidden:ariaHidden,...positions});this.render()}this.model.set("isShown",true);this.render()}render(){if(!this.model)return;const Template=templates.tooltip;this.updateViewProperties();ReactDOM__default["default"].render(React__default["default"].createElement(Template,this.model.toJSON()),this.el)}onDeviceResize(){this.remove()}onMouseOut(){this.remove()}remove(){if(this.$el.hasClass("test"))return;this.stopListening(Adapt$1);$(document).off("mouseleave blur","[data-tooltip-id]",this.onMouseOut);this.model?.set("isShown",false);this.render();this.model=null;this.$target=null;if(this.$target)this.$target.removeAttr("aria-describedby");const rem=super.remove.bind(this);setTimeout((()=>{rem();this.parent.removeItem(this)}),1e3)}});function fetchCSSVariables(){const computed=getComputedStyle(document.documentElement);return{offset:lengthToPx("@tooltip-offset",computed.getPropertyValue("--adapt-tooltip-offset")),distance:lengthToPx("@tooltip-distance",computed.getPropertyValue("--adapt-tooltip-distance")),viewPortPadding:lengthToPx("@tooltip-viewport-padding",computed.getPropertyValue("--adapt-tooltip-viewport-padding"))}}function lengthToPx(name,length){const unit=String(length).replaceAll(/[\d.]+/g,"").trim();const value=parseFloat(length);if(unit==="rem")return value*parseInt(getComputedStyle(document.body).fontSize);if(unit==="px")return value;throw new Error(`Cannot convert ${name} ${length} to pixels`)}function parseRelativePosition(_ref3){let{position:position}=_ref3;function fixConditions(positions,item1,item2,type){positions=positions.slice(0);const indexOf1=positions.indexOf(item1);const indexOf2=positions.indexOf(item2);let has1=indexOf1!==-1;let has2=indexOf2!==-1;let assume3=false;let specifiedAtIndex=null;if(has1&&has2){const isItem1=has1<has2;specifiedAtIndex=isItem1?indexOf1:indexOf2;has1=isItem1;has2=!isItem1}else if(has1){specifiedAtIndex=indexOf1}else if(has2){specifiedAtIndex=indexOf2}else{assume3=true}if(specifiedAtIndex!==null){positions[specifiedAtIndex]=type;positions=positions.filter(((item,index)=>{if(index<=specifiedAtIndex)return true;return item!==item1&&item!==item2}))}const hasSpecified=has1||has2;return[positions,has1,has2,assume3,hasSpecified,specifiedAtIndex]}position=position.toLowerCase().split(" ").filter(Boolean).join(" ");let positions=position.split(" ");let isArrowStart=null;let isArrowEnd=null;let isArrowMiddle=null;let isTop=null;let isCenter=null;let isBottom=null;let isLeft=null;let isMiddle=null;let isRight=null;let isOutside=null;let isInside=null;let isAreaAuto=null;let hasArrowSpecified=null;let hasVerticalSpecified=null;let verticalIndex=null;let hasHorizontalSpecified=null;let horizontalIndex=null;[positions,isOutside,isInside,isAreaAuto]=fixConditions(positions,"outside","inside","area");if(isAreaAuto)positions.unshift("area");[positions,isArrowStart,isArrowEnd,isArrowMiddle,hasArrowSpecified]=fixConditions(positions,"start","end","arrow");[positions,isTop,isBottom,isCenter,hasVerticalSpecified,verticalIndex]=fixConditions(positions,"top","bottom","vertical");[positions,isLeft,isRight,isMiddle,hasHorizontalSpecified,horizontalIndex]=fixConditions(positions,"left","right","horizontal");if(positions.length>4){positions.length=4}if(positions.length<4){const start=positions.length;positions.length=4;positions.fill("auto",start)}let specifiedCount=[hasArrowSpecified,hasHorizontalSpecified,hasVerticalSpecified].reduce(((sum,bool)=>sum+(bool?1:0)),0);let wasVerticalFilled=false;let wasHorizontalFilled=false;let wasArrowFilled=false;while(true){let isAuto=false;const indexOfMiddle=positions.indexOf("middle");const indexOfAuto=positions.indexOf("auto");const hasMiddleSpecified=indexOfMiddle!==-1;const hasAutoSpecified=indexOfAuto!==-1;let indexOf;let hasValue=false;if(hasMiddleSpecified&&hasAutoSpecified){isAuto=indexOfAuto<indexOfMiddle;indexOf=isAuto?indexOfAuto:indexOfMiddle;hasValue=true}else if(hasAutoSpecified){isAuto=true;indexOf=indexOfAuto;hasValue=true}else if(hasMiddleSpecified){isAuto=false;indexOf=indexOfMiddle;hasValue=true}if(!hasValue)break;const requiresHorizontal=!hasHorizontalSpecified&&!wasHorizontalFilled;const requiresVertical=!hasVerticalSpecified&&!wasVerticalFilled;const requiresArrow=!hasArrowSpecified&&!wasArrowFilled;const shouldArrow=requiresArrow&&(specifiedCount===1||specifiedCount===0||!requiresHorizontal&&!requiresVertical);const shouldHorizontal=!shouldArrow&&requiresHorizontal;const shouldVertical=!shouldHorizontal&&!shouldArrow&&requiresVertical;if(shouldHorizontal){positions[indexOf]="horizontal";if(isAuto)wasHorizontalFilled=true;else hasHorizontalSpecified=true;horizontalIndex=indexOf}else if(shouldArrow){positions[indexOf]="arrow";if(isAuto)wasArrowFilled=true;else hasArrowSpecified=true}else if(shouldVertical){positions[indexOf]="vertical";if(isAuto)wasVerticalFilled=true;else hasVerticalSpecified=true;verticalIndex=indexOf}if(!isAuto)specifiedCount+=1}const isVerticalAxis=verticalIndex<horizontalIndex;const isHorizontalAxis=horizontalIndex<verticalIndex;const isInsideMiddleCenter=isVerticalAxis&&isCenter||isHorizontalAxis&&isMiddle;if(isAreaAuto){isOutside=!isInsideMiddleCenter;isInside=!isOutside}if(isOutside&&isVerticalAxis&&isCenter){isTop=true;isCenter=false;logging$1.info(`tooltips: "${position}"(${positions.join(" ")}) is not a valid location, assuming side 'top'`)}else if(isOutside&&isHorizontalAxis&&isMiddle){isLeft=true;isMiddle=false;logging$1.info(`tooltips: "${position}"(${positions.join(" ")}) is not a valid location, assuming side 'left'`)}const shouldSensibleDefaults=specifiedCount===2;if(shouldSensibleDefaults){if(isOutside&&!hasArrowSpecified&&isVerticalAxis&&hasVerticalSpecified){isArrowMiddle=false;isArrowEnd=isRight;isArrowStart=!isArrowEnd}if(isOutside&&!hasArrowSpecified&&isHorizontalAxis&&hasHorizontalSpecified){isArrowMiddle=false;isArrowEnd=isBottom;isArrowStart=!isArrowEnd}if(isInside&&!hasArrowSpecified&&isVerticalAxis&&hasVerticalSpecified){isArrowMiddle=false;isArrowEnd=!isRight;isArrowStart=!isArrowEnd}if(isInside&&!hasArrowSpecified&&isHorizontalAxis&&hasHorizontalSpecified){isArrowMiddle=false;isArrowEnd=!isBottom;isArrowStart=!isArrowEnd}if(isOutside&&!hasHorizontalSpecified&&isVerticalAxis&&hasArrowSpecified&&!isArrowMiddle){isMiddle=false;isRight=!isArrowStart;isLeft=!isRight}if(isOutside&&!hasVerticalSpecified&&isHorizontalAxis&&hasArrowSpecified&&!isArrowMiddle){isCenter=false;isBottom=!isArrowStart;isTop=!isBottom}if(isInside&&!hasHorizontalSpecified&&isVerticalAxis&&hasArrowSpecified&&!isArrowMiddle){isMiddle=false;isRight=isArrowStart;isLeft=!isRight}if(isInside&&!hasVerticalSpecified&&isHorizontalAxis&&hasArrowSpecified&&!isArrowMiddle){isCenter=false;isBottom=isArrowStart;isTop=!isBottom}}return{isOutside:isOutside,isInside:isInside,isVerticalAxis:isVerticalAxis,isHorizontalAxis:isHorizontalAxis,isLeft:isLeft,isMiddle:isMiddle,isRight:isRight,isTop:isTop,isCenter:isCenter,isBottom:isBottom,isArrowStart:isArrowStart,isArrowMiddle:isArrowMiddle,isArrowEnd:isArrowEnd}}function convertToDistanceRect(DOMRect,clientDOMRect){return{top:DOMRect.top,left:DOMRect.left,right:clientDOMRect.width-DOMRect.right,bottom:clientDOMRect.height-DOMRect.bottom,width:DOMRect.width,height:DOMRect.height}}function invertRTL(bool,isRTL){if(!isRTL)return bool;return!bool}function constrainDimensions(distanceRect,viewPortPadding,isTargetFixedPosition,topNavOffset,bottomNavOffset){return{top:distanceRect.top-viewPortPadding-(isTargetFixedPosition?0:topNavOffset),left:distanceRect.left-viewPortPadding,right:distanceRect.right-viewPortPadding,bottom:distanceRect.bottom-viewPortPadding-(isTargetFixedPosition?0:bottomNavOffset),width:distanceRect.width,height:distanceRect.height}}function swapValues(a,b){return[b,a]}function calculateScrollOffset(_ref4){let{isTargetFixedPosition:isTargetFixedPosition}=_ref4;const scrollOffsetTop=isTargetFixedPosition?0:$(window).scrollTop();const scrollOffsetLeft=isTargetFixedPosition?0:$(window).scrollLeft();return{scrollOffsetLeft:scrollOffsetLeft,scrollOffsetTop:scrollOffsetTop}}function position$1(){let{isTargetFixedPosition:isTargetFixedPosition,position:position,isRTL:isRTL,topNavOffset:topNavOffset,bottomNavOffset:bottomNavOffset,targetDOMRect:targetDOMRect,clientDOMRect:clientDOMRect,tooltipDOMRect:tooltipDOMRect,arrowDOMRect:arrowDOMRect}=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};let multipassCache=arguments.length>1?arguments[1]:undefined;let pass=arguments.length>2?arguments[2]:undefined;const{offset:offset,distance:distance,viewPortPadding:viewPortPadding}=fetchCSSVariables();const targetDistRect=convertToDistanceRect(targetDOMRect,clientDOMRect);const constrainedClientDistRect={width:clientDOMRect.width-viewPortPadding*2,height:clientDOMRect.height-viewPortPadding*2-(isTargetFixedPosition?0:topNavOffset+bottomNavOffset)};let{isOutside:isOutside,isInside:isInside,isVerticalAxis:isVerticalAxis,isHorizontalAxis:isHorizontalAxis,isLeft:isLeft,isMiddle:isMiddle,isRight:isRight,isFillWidth:isFillWidth=false,isTop:isTop,isCenter:isCenter,isBottom:isBottom,isFillHeight:isFillHeight=false,isArrowStart:isArrowStart,isArrowMiddle:isArrowMiddle,isArrowEnd:isArrowEnd}=parseRelativePosition({position:position});if(pass>=THIRD_PASS){({isOutside:isOutside,isInside:isInside,isVerticalAxis:isVerticalAxis,isHorizontalAxis:isHorizontalAxis,isLeft:isLeft,isMiddle:isMiddle,isRight:isRight,isFillWidth:isFillWidth=false,isTop:isTop,isCenter:isCenter,isBottom:isBottom,isFillHeight:isFillHeight=false}=multipassCache)}let isSnapTop=false;let isSnapLeft=false;let isSnapBottom=false;let isSnapRight=false;let isArrowSnap=false;const tooltipStyles={};if(pass>=SECOND_PASS){const tooltipDistRect=convertToDistanceRect(tooltipDOMRect,clientDOMRect);const arrowDistRect=convertToDistanceRect(arrowDOMRect,clientDOMRect);const constrainedTargetDistRect=constrainDimensions(targetDistRect,viewPortPadding,isTargetFixedPosition,topNavOffset,bottomNavOffset);const constrainedTooltipDistRect=constrainDimensions(tooltipDistRect,viewPortPadding,isTargetFixedPosition,topNavOffset,bottomNavOffset);const constrainedArrowDistRect=constrainDimensions(arrowDistRect,viewPortPadding,isTargetFixedPosition,topNavOffset,bottomNavOffset);const overallHeight=isOutside&&isVerticalAxis?constrainedTooltipDistRect.height+constrainedArrowDistRect.height+distance:constrainedTooltipDistRect.height;const overallWidth=isOutside&&isHorizontalAxis?constrainedTooltipDistRect.width+constrainedArrowDistRect.width+distance:constrainedTooltipDistRect.width;const isOverflowTop=constrainedTooltipDistRect.top<0;const isOverflowBottom=constrainedTooltipDistRect.bottom<0;const isOverflowLeft=constrainedTooltipDistRect.left<0;const isOverflowRight=constrainedTooltipDistRect.right<0;const isOverflowHorizontal=isOverflowLeft||isOverflowRight;const isOverflowVertical=isOverflowTop||isOverflowBottom;const isOverflow=isOverflowHorizontal||isOverflowVertical;const tooltipArea=overallHeight*overallWidth;const topArea=constrainedTargetDistRect.top*constrainedClientDistRect.width;const bottomArea=constrainedTargetDistRect.bottom*constrainedClientDistRect.width;const leftArea=constrainedTargetDistRect.left*constrainedClientDistRect.height;const rightArea=constrainedTargetDistRect.right*constrainedClientDistRect.height;const maxHorizontalArea=Math.max(leftArea,rightArea);const maxVerticalArea=Math.max(topArea,bottomArea);const isVerticalAreaLarger=maxVerticalArea>=maxHorizontalArea;const isHorizontalAreaLarger=maxHorizontalArea>=maxVerticalArea;const canFitWidthLength=isVerticalAxis?overallWidth<=constrainedClientDistRect.width:overallWidth<=constrainedTargetDistRect.left||overallWidth<=constrainedTargetDistRect.right;const canFitHeightLength=isHorizontalAxis?overallHeight<=constrainedClientDistRect.height:overallHeight<=constrainedTargetDistRect.top||overallHeight<=constrainedTargetDistRect.bottom;const canFitInLeftArea=tooltipArea<leftArea;const canFitInRightArea=tooltipArea<rightArea;const canFitInTopArea=tooltipArea<topArea;const canFitInBottomArea=tooltipArea<bottomArea;const canFitInVerticalArea=tooltipArea<maxVerticalArea;const canFitInHorizontalArea=tooltipArea<maxHorizontalArea;const isArrowOffscreen=isVerticalAxis&&(constrainedArrowDistRect.left<offset||constrainedArrowDistRect.right<offset)||isHorizontalAxis&&(constrainedArrowDistRect.top<offset||constrainedArrowDistRect.bottom<offset);const isBadShape=!canFitHeightLength||!canFitWidthLength;const isSwapAxis=isArrowOffscreen&&isHorizontalAxis&&isOverflowVertical||isArrowOffscreen&&isVerticalAxis&&isOverflowHorizontal||isHorizontalAxis&&!canFitInHorizontalArea&&isVerticalAreaLarger||isVerticalAxis&&!canFitInVerticalArea&&isHorizontalAreaLarger;const isFillArea=isSwapAxis&&isBadShape||isVerticalAxis&&isOverflow&&isBadShape&&(canFitInVerticalArea||isVerticalAreaLarger)||isHorizontalAxis&&isOverflow&&isBadShape&&(canFitInHorizontalArea||isHorizontalAreaLarger);if(pass===SECOND_PASS&&(isBadShape||isOverflow)){if(isSwapAxis){[isVerticalAxis,isHorizontalAxis]=swapValues(isVerticalAxis,isHorizontalAxis);if(isCenter){[isMiddle,isLeft,isRight]=[true,false,false];[isBottom,isTop,isCenter]=[true,false,false]}}if(isFillArea){if(isVerticalAxis)isFillWidth=true;if(isHorizontalAxis)isFillHeight=true}const isSwapVerticalSide=!(isHorizontalAxis&&canFitInHorizontalArea)&&(isFillArea&&!(isTop&&canFitInTopArea||isBottom&&canFitInBottomArea)||!isFillArea&&(isBottom&&isOverflowBottom||isTop&&isOverflowTop));if(isSwapVerticalSide&&isFillArea&&(canFitInTopArea||canFitInBottomArea)){isTop=!canFitInBottomArea;isBottom=canFitInBottomArea}else if(isSwapVerticalSide){isTop=constrainedTargetDistRect.top>=constrainedTargetDistRect.bottom;isBottom=constrainedTargetDistRect.top<constrainedTargetDistRect.bottom}const isSwapHorizontalSide=!(isVerticalAxis&&canFitInVerticalArea)&&(isFillArea&&!(isLeft&&canFitInLeftArea||isRight&&canFitInRightArea)||!isFillArea&&(isLeft&&isOverflowLeft||isRight&&isOverflowRight));if(isSwapHorizontalSide&&isFillArea&&(canFitInLeftArea||canFitInRightArea)){isLeft=invertRTL(!canFitInRightArea,isRTL);isRight=invertRTL(canFitInRightArea,isRTL)}else if(isSwapHorizontalSide){isLeft=invertRTL(constrainedTargetDistRect.left>=constrainedTargetDistRect.right,isRTL);isRight=invertRTL(constrainedTargetDistRect.left<constrainedTargetDistRect.right,isRTL)}else if(isSwapAxis){isLeft=invertRTL(isLeft,isRTL);isRight=invertRTL(isRight,isRTL)}if(isSwapVerticalSide||isSwapHorizontalSide||isSwapAxis){isMiddle=!isLeft&&!isRight;isCenter=!isTop&&!isBottom}}if(pass===THIRD_PASS){if(isVerticalAxis){isSnapLeft=isOverflowLeft;isSnapRight=!isSnapLeft&&isOverflowRight}if(isHorizontalAxis){isSnapTop=isOverflowTop;isSnapBottom=!isSnapTop&&isOverflowBottom}isArrowSnap=isArrowOffscreen}Object.assign(tooltipStyles,{"--adapt-tooltip-target-distancetoedge-left":`${constrainedTargetDistRect.left}px`,"--adapt-tooltip-target-distancetoedge-top":`${constrainedTargetDistRect.top}px`,"--adapt-tooltip-target-distancetoedge-right":`${constrainedTargetDistRect.right}px`,"--adapt-tooltip-target-distancetoedge-bottom":`${constrainedTargetDistRect.bottom}px`,"--adapt-tooltip-target-distancetoedge-height":`${constrainedTargetDistRect.height}px`,"--adapt-tooltip-target-distancetoedge-width":`${constrainedTargetDistRect.width}px`});if(pass>=2){Object.assign(multipassCache,{isOutside:isOutside,isInside:isInside,isVerticalAxis:isVerticalAxis,isHorizontalAxis:isHorizontalAxis,isLeft:isLeft,isMiddle:isMiddle,isRight:isRight,isFillWidth:isFillWidth,isTop:isTop,isCenter:isCenter,isBottom:isBottom,isFillHeight:isFillHeight})}}const tooltipClasses=[isOutside&&"is-outside",isInside&&"is-inside",isArrowSnap&&"is-arrow-snap",isVerticalAxis&&"is-vertical-axis",isHorizontalAxis&&"is-horizontal-axis",isLeft&&"is-left",isMiddle&&"is-middle",isRight&&"is-right",isFillWidth&&"is-fill-width",isSnapLeft&&"is-snap-left",isSnapRight&&"is-snap-right",isTop&&"is-top",isCenter&&"is-center",isBottom&&"is-bottom",isFillHeight&&"is-fill-height",isSnapTop&&"is-snap-top",isSnapBottom&&"is-snap-bottom",isArrowStart&&"is-arrow-start",isArrowMiddle&&"is-arrow-middle",isArrowEnd&&"is-arrow-end"].filter(Boolean).join(" ");const{scrollOffsetLeft:scrollOffsetLeft,scrollOffsetTop:scrollOffsetTop}=calculateScrollOffset({isTargetFixedPosition:isTargetFixedPosition});Object.assign(tooltipStyles,{"--adapt-tooltip-viewport-constrained-height":`${constrainedClientDistRect.height}px`,"--adapt-tooltip-viewport-constrained-width":`${constrainedClientDistRect.width}px`,"--adapt-tooltip-scroll-top":`${scrollOffsetTop}px`,"--adapt-tooltip-scroll-left":`${scrollOffsetLeft}px`,"--adapt-tooltip-target-position-top":`${targetDistRect.top}px`,"--adapt-tooltip-target-position-left":`${targetDistRect.left}px`,"--adapt-tooltip-target-position-width":`${targetDistRect.width}px`,"--adapt-tooltip-target-position-height":`${targetDistRect.height}px`});return{tooltipClasses:tooltipClasses,tooltipStyles:tooltipStyles}}var TooltipItemModel=__AMD("core/js/models/TooltipItemModel",class TooltipItemModel extends Backbone__default["default"].Model{defaults(){return{...Adapt$1.course.get("_tooltips")||{},_id:null,_isEnabled:true,_classes:"",disabledText:"{{text}}",text:""}}});var TooltipView=__AMD("core/js/views/TooltipView",class TooltipView extends Backbone.View{className(){return"tooltip__container"}attributes(){return{role:"region","aria-live":"assertive"}}initialize(){_.bindAll(this,"onMouseOver","onKeyDown","onMouseOut");this._tooltipData={};this._tooltips=[];this.listenTo(Adapt$1,"adapt:preInitialize",this.onAdaptPreInitialize);this.render()}onAdaptPreInitialize(){var _this=this;if(this.config?._isEnabled===false)return;this.onMouseOver=_.debounce(this.onMouseOver,500);$(document).on("keydown",this.onKeyDown);$(document).on("focus","[data-tooltip-id]",(function(){if(a11y$1.isForcedFocus)return;_this.onMouseOver(...arguments)}));$(document).on("mouseenter","[data-tooltip-id]",this.onMouseOver);$(document).on("mouseleave blur","[data-tooltip-id]",this.onMouseOut)}get config(){return{_position:"outside bottom middle right",...Adapt$1.course.get("_tooltips")}}onKeyDown(event){if(event.key!=="Escape")return;this.hide()}onMouseOver(event){const $mouseoverEl=$(event.currentTarget);if(!a11y$1.isFocusable($mouseoverEl))return;const id=$mouseoverEl.data("tooltip-id");if(this._currentId===id&&event.name==="focusin")return;this._currentId=id;const tooltip=this.getTooltip(id);if(!tooltip?.get("_isEnabled"))return this.hide();if(event.ctrlKey&&this.config._allowTest){this.showTest(tooltip,$mouseoverEl)}else{this.show(tooltip,$mouseoverEl)}$(document).on("scroll",this.onScroll)}onMouseOut(){this.onMouseOver.cancel()}render(){this.$el.appendTo("body")}show(tooltip,$mouseoverEl){const tooltipItem=new TooltipItemView({model:tooltip,$target:$mouseoverEl,parent:this});this._tooltips.push(tooltipItem);this.$el.append(tooltipItem.$el)}hide(){let tooltipItem=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;tooltipItem=tooltipItem??this._tooltips.pop();this.removeItem(tooltipItem);if(!tooltipItem)return;tooltipItem.remove()}removeItem(tooltipItem){const currentIndex=this._tooltips.findIndex((item=>tooltipItem===item));if(currentIndex===-1)return;this._tooltips.splice(currentIndex,1)}register(tooltipData){if(!tooltipData._id)return logging$1.warn("Tooltip cannot be registered with no id");this._tooltipData[tooltipData._id]=new TooltipItemModel(tooltipData)}getTooltip(id){return this._tooltipData[id]}showTest(tooltip,$target){const produce=parts=>{const lastIndex=parts.length-1;const partIndex=new Array(parts.length).fill(0);const tooltips=[];const json=tooltip.toJSON();while(true){const position=parts.map(((part,index)=>part[partIndex[index]])).join(" ");tooltips.push(new TooltipItemModel({...json,disabledText:`D ${position}`,text:`T ${position}`,_position:position,_classes:"test"}));for(let i=lastIndex;i>=0;i--){partIndex[i]+=1;if(partIndex[i]<parts[i].length)break;if(i===0)break;partIndex[i]=0}if(partIndex[0]>=parts[0].length)break}tooltips.forEach((model=>{const tooltipItem=new TooltipItemView({model:model,$target:$target,parent:this});this._tooltips.push(tooltipItem);this.$el.append(tooltipItem.$el)}))};const areaOutside=["outside"];const areaInside=["inside"];const arrowPosition=["middle","start","end",""];const vertical=["middle","top","bottom",""];const horizontal=["middle","right","left",""];const partsVertical=[areaOutside,vertical,arrowPosition,horizontal];const partsHorizontal=[areaOutside,horizontal,arrowPosition,vertical];const partsVerticalInside=[areaInside,vertical,arrowPosition,horizontal];const partsHorizontalInside=[areaInside,horizontal,arrowPosition,vertical];produce(partsVertical);produce(partsHorizontal);produce(partsVerticalInside);produce(partsHorizontalInside)}});const tooltips=new TooltipView;var tooltips$1=__AMD("core/js/tooltips",tooltips);const DrawerCollection=new Backbone__default["default"].Collection(null,{comparator:"drawerOrder"});class Drawer extends Backbone__default["default"].Controller{initialize(){this.listenTo(Adapt$1,{"adapt:start":this.onAdaptStart,"app:languageChanged":this.onLanguageChanged,"navigation:toggleDrawer":this.toggle})}onAdaptStart(){this._drawerView=new DrawerView$1({collection:DrawerCollection})}onLanguageChanged(){tooltips$1.register({_id:"drawer",...Adapt$1.course.get("_globals")?._extensions?._drawer?._navTooltip||{}});this.remove()}toggle(){this.isOpen?this.close():this.open()}get isOpen(){return this._drawerView?.isOpen??false}open(){this._drawerView?.showDrawer(true)}openCustomView(view,hasBackButton,position){this._drawerView?.openCustomView(view,hasBackButton,position)}addItem(drawerObject,eventCallback){if(this.hasItem(eventCallback)){DrawerCollection.remove(DrawerCollection.find((item=>item.eventCallback===eventCallback)))}drawerObject.eventCallback=eventCallback;DrawerCollection.add(drawerObject)}hasItem(eventCallback){return Boolean(DrawerCollection.find((item=>item.eventCallback===eventCallback)))}close(){let $toElement=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;this._drawerView?.hideDrawer($toElement)}remove(){this._drawerView?.remove();this._drawerView=null}}var drawer=__AMD("core/js/drawer",new Drawer);var AdaptSubsetCollection=__AMD("core/js/collections/adaptSubsetCollection",class AdaptSubsetCollection extends AdaptCollection{initialize(models,options){super.initialize(models,options);this.parent=options.parent;this.listenTo(this.parent,"reset",this.loadSubset)}loadSubset(){this.set(this.parent.filter((model=>model instanceof this.model)));this._byAdaptID=this.groupBy("_id")}});var ModelEvent=__AMD("core/js/modelEvent",class ModelEvent extends Backbone.Controller{initialize(type,target,value){this.type=type;this.target=target;this.value=value;this.canBubble=true;this.deepPath=[target];this.timeStamp=null}stopPropagation(){this.canBubble=false}addPath(target){this.deepPath.unshift(target)}});var AdaptModel=__AMD("core/js/models/adaptModel",class AdaptModel extends LockingModel{toJSON(){const json={...this.attributes};delete json._children;delete json._parent;return $.extend(true,{},json)}get(name){switch(name){case"_parent":case"_children":logging$1.deprecated("Use model.getChildren() or model.getParent() instead of model.get('_children') or model.get('_parent')")}return super.get(name)}defaults(){return{_canShowFeedback:true,_classes:"",_canReset:true,_canRequestChild:false,_isComplete:false,_isInteractionComplete:false,_isA11yRegionEnabled:false,_isA11yCompletionDescriptionEnabled:true,_requireCompletionOf:-1,_isEnabled:true,_isResetOnRevisit:false,_isAvailable:true,_isOptional:false,_isRendered:false,_isReady:false,_isVisible:true,_isVisited:false,_isLocked:false,_isHidden:false}}get trackingPosition(){const firstDescendant=this.getAllDescendantModels(false).concat([this])[0];const nearestTrackingIdModel=[firstDescendant].concat(firstDescendant.getAncestorModels()).find((model=>model.has("_trackingId")));if(!nearestTrackingIdModel)return;const trackingId=nearestTrackingIdModel.get("_trackingId");let trackingIdDescendants=[nearestTrackingIdModel].concat(nearestTrackingIdModel.getAllDescendantModels(true));trackingIdDescendants=trackingIdDescendants.filter((model=>!(model.isTypeGroup("component")&&model.get("_isTrackable")===false)));const indexInTrackingIdDescendants=trackingIdDescendants.findIndex((descendant=>descendant===this));if(indexInTrackingIdDescendants>=0){return[trackingId,indexInTrackingIdDescendants]}const trackingIdAncestors=nearestTrackingIdModel.getAncestorModels();const ancestorDistance=trackingIdAncestors.findIndex((ancestor=>ancestor===this));return[trackingId,-(ancestorDistance+1)]}parse(data){if(data._isResetOnRevisit==="false"){data._isResetOnRevisit=false}return data}trackable(){return["_id","_isComplete","_isInteractionComplete","_isVisited"]}trackableType(){return[String,Boolean,Boolean,Boolean]}bubblingEvents(){return["change:_isComplete","change:_isInteractionComplete","change:_isActive","change:_isVisited"]}setupModel(){if(this.hasManagedChildren){this.setupChildListeners()}this.init();_.defer((()=>{if(this.hasManagedChildren){this.checkCompletionStatus();this.checkInteractionCompletionStatus();this.checkLocking();this.checkVisitedStatus()}this.setupTrackables()}))}setupTrackables(){const originalTrackableStateFunction=this.triggerTrackableState;this.triggerTrackableState=_.compose((()=>{this.triggerTrackableState.isQueued=true}),_.debounce((()=>{originalTrackableStateFunction.apply(this);this.triggerTrackableState.isQueued=false}),17));this.listenTo(this,"change",(_ref=>{let{changed:changed}=_ref;if(this.triggerTrackableState.isQueued||!Adapt$1.attributes._isStarted){return}const trackablePropertyNames=_.result(this,"trackable",[]);const changedPropertyNames=Object.keys(changed);const isTrackable=changedPropertyNames.find((item=>trackablePropertyNames.includes(item)));if(isTrackable){this.triggerTrackableState()}}))}setupChildListeners(){const children=this.getChildren();if(!children.length){return}this.listenTo(children,{all:this.onAll,bubble:this.bubble,"change:_isVisited":this.checkVisitedStatus,"change:_isReady":this.checkReadyStatus,"change:_isComplete":this.onIsComplete,"change:_isInteractionComplete":this.checkInteractionCompletionStatus})}init(){}getTrackableState(){const trackable=this.resultExtend("trackable",[]);const json=this.toJSON();const args=trackable;args.unshift(json);return _.pick(...args)}setTrackableState(state){const trackable=this.resultExtend("trackable",[]);const args=trackable;args.unshift(state);state=_.pick(...args);this.set(state);return this}triggerTrackableState(){Adapt$1.trigger("state:change",this,this.getTrackableState())}reset(){let type=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"hard";let canReset=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.get("_canReset");if(!canReset)return false;const isHardReset=type==="hard"||type===true;const isSoftReset=type==="soft";if(!isHardReset&&!isSoftReset)return false;const resetData={_isEnabled:true,_isInteractionComplete:false};if(isHardReset)resetData._isComplete=false;this.set(resetData);this.trigger("reset");return true}checkReadyStatus(model,value){if(value===false){return false}const children=this.getAvailableChildModels();if(children.find((child=>child.get("_isReady")===false&&child.get("_isRendered")))){return false}this.set("_isReady",true);return true}setReadyStatus(){this.set("_isReady",true)}checkVisitedStatus(){const children=this.getAvailableChildModels();const isVisited=children.some((child=>child.get("_isVisited")||child.get("_isComplete")||child.get("_isInteractionComplete")));if(isVisited)this.set("_isVisited",true);return isVisited}setVisitedStatus(){if(!this.get("_isReady")||!this.get("_isRendered"))return;this.set("_isVisited",true)}setCompletionStatus(){if(!this.get("_isVisible"))return;this.set({_isComplete:true,_isInteractionComplete:true,_isVisited:true})}checkCompletionStatus(){Adapt$1.checkingCompletion();_.defer(this.checkCompletionStatusFor.bind(this),"_isComplete")}checkInteractionCompletionStatus(){Adapt$1.checkingCompletion();_.defer(this.checkCompletionStatusFor.bind(this),"_isInteractionComplete")}checkCompletionStatusFor(){let completionAttribute=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"_isComplete";let completed=false;const children=this.getAvailableChildModels();const requireCompletionOf=this.get("_requireCompletionOf");const isOptional=this.get("_isOptional");const isEveryChildOptional=children.every((child=>child.get("_isOptional")));if(isOptional&&isEveryChildOptional){completed=children.every((child=>child.get(completionAttribute)))}else if(requireCompletionOf===-1){completed=children.every((child=>child.get(completionAttribute)||child.get("_isOptional")))}else{completed=children.filter((child=>child.get(completionAttribute)&&!child.get("_isOptional"))).length>=requireCompletionOf}this.set(completionAttribute,completed);Adapt$1.checkedCompletion()}getTypeGroup(){}isTypeGroup(typeGroup){const hasUpperCase=/[A-Z]+/.test(typeGroup);const isPluralized=typeGroup.slice(-1)==="s";const lowerCased=typeGroup.toLowerCase();const singular=isPluralized&&lowerCased.slice(0,-1);const singularLowerCased=(singular||lowerCased).toLowerCase();if(isPluralized||hasUpperCase){logging$1.deprecated(`'${typeGroup}' appears pluralized or contains uppercase characters, suggest using the singular, lowercase type group '${singularLowerCased}'.`)}const pluralizedLowerCaseTypes=[singularLowerCased,!isPluralized&&`${lowerCased}s`].filter(Boolean);const typeGroups=this.getTypeGroups();if(_.intersection(pluralizedLowerCaseTypes,typeGroups).length){return true}return false}getTypeGroups(){if(this._typeGroups)return this._typeGroups;const typeGroups=[this.get("_type")];let parentClass=this;while(parentClass=Object.getPrototypeOf(parentClass)){if(!Object.prototype.hasOwnProperty.call(parentClass,"getTypeGroup"))continue;typeGroups.push(parentClass.getTypeGroup.call(this))}return this._typeGroups=_.uniq(typeGroups.filter(Boolean).map((s=>s.toLowerCase())))}findAncestor(ancestorType){const parent=this.getParent();if(!parent)return;if(!ancestorType||parent.isTypeGroup(ancestorType)){return parent}return parent.findAncestor(ancestorType)}findDescendantModels(descendants,options){const allDescendantsModels=this.getAllDescendantModels();const returnedDescendants=allDescendantsModels.filter((model=>model.isTypeGroup(descendants)));if(!options){return returnedDescendants}if(options.where){return returnedDescendants.filter((descendant=>{for(const property in options.where){const value=options.where[property];if(descendant.get(property)!==value){return false}}return true}))}}getAllDescendantModels(isParentFirst){const descendants=[];if(!this.hasManagedChildren){return descendants}const children=this.getChildren();children.models.forEach((child=>{if(!child.hasManagedChildren){descendants.push(child);return}const subDescendants=child.getAllDescendantModels(isParentFirst);if(isParentFirst===true){descendants.push(child)}descendants.push(...subDescendants);if(isParentFirst!==true){descendants.push(child)}}));return descendants}findRelativeModel(relativeString){let options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};if(!relativeString)return this;let relativeDescriptorObjects=Adapt$1.parseRelativeString(relativeString);if(!Array.isArray(relativeDescriptorObjects))relativeDescriptorObjects=[relativeDescriptorObjects];const find=_ref2=>{let{type:type,offset:offset,inset:inset}=_ref2;const isInset=inset!==null;const isOffset=offset!==null;const rootModel=options.limitParentId?data$1.findById(options.limitParentId):isInset?this:Adapt$1.course;const increment=isOffset?offset:inset;const searchBackwards=increment<0;let moveBy=Math.abs(increment);let movementCount=0;const hasDescendantsOfType=Boolean(this.findDescendantModels(type).length);if(isInset&&!hasDescendantsOfType)return undefined;if(isOffset&&hasDescendantsOfType){moveBy--}if(isInset&&searchBackwards){moveBy--}const searchDescendants=searchBackwards?[rootModel,...rootModel.getAllDescendantModels(true)].reverse():[...rootModel.getAllDescendantModels(false),rootModel];const modelId=this.get("_id");const searchFromIndex=isInset?0:searchDescendants.findIndex((searchDescendant=>searchDescendant.get("_id")===modelId));const hasFilterFunction=typeof options.filter==="function";if(options.loop){const totalOfType=searchDescendants.reduce(((count,model)=>{if(!model.isTypeGroup(type))return count;return++count}),0);moveBy=moveBy%totalOfType;searchDescendants.push(...searchDescendants.slice(0))}for(let i=searchFromIndex,l=searchDescendants.length;i<l;i++){const descendant=searchDescendants[i];if(!descendant.isTypeGroup(type))continue;const isSelf=i===searchFromIndex;if(!isSelf&&hasFilterFunction&&!options.filter(descendant))continue;if(movementCount>moveBy){break}if(movementCount===moveBy){return descendant}movementCount++}};const nextDescriptor=relativeDescriptorObjects.slice(1).reduce(((output,_ref3)=>{let{type:type,offset:offset,inset:inset}=_ref3;const isInset=inset!==null;const isOffset=offset!==null;if(isOffset)return`${output}@${type}${offset<0?offset:`+${offset}`}`;if(isInset)return`${output}@${type}=${inset}`;return`${output}@${type}`}),"");const foundModel=find(relativeDescriptorObjects[0]);if(nextDescriptor){return foundModel?.findRelativeModel(nextDescriptor)}return foundModel}get hasManagedChildren(){return true}getChildren(){if(this._childrenCollection){return this._childrenCollection}let childrenCollection;if(!this.hasManagedChildren){childrenCollection=new Backbone.Collection}else{const id=this.get("_id");const children=data$1.filter((model=>model.get("_parentId")===id));childrenCollection=new Backbone.Collection(children)}if(this.get("_type")==="block"&&childrenCollection.length===2&&childrenCollection.models[0].get("_layout")!=="left"){childrenCollection.comparator="_layout";childrenCollection.sort()}this.setChildren(childrenCollection);return this._childrenCollection}setChildren(children){this._childrenCollection=children;this.set("_children",children)}getAvailableChildModels(){return this.getChildren().where({_isAvailable:true})}getParent(){if(this._parentModel){return this._parentModel}const parentId=this.get("_parentId");if(!parentId)return;const parent=data$1.findById(parentId);if(!parent){logging$1.warn("adaptModel.getParent(): parent is empty");return}this.setParent(parent);return this._parentModel}setParent(parent){this._parentModel=parent;this.set("_parentId",this._parentModel.get("_id"));this.set("_parent",this._parentModel)}getAncestorModels(shouldIncludeChild){const parents=[];let context=this;if(shouldIncludeChild)parents.push(context);while(context.has("_parentId")){context=context.getParent();parents.push(context)}return parents.length?parents:null}getSiblings(passSiblingsAndIncludeSelf){const id=this.get("_id");const parentId=this.get("_parentId");let siblings;if(!passSiblingsAndIncludeSelf){if(this._hasSiblingsAndSelf===false){return this.get("_siblings")}siblings=data$1.filter((model=>model.get("_parentId")===parentId&&model.get("_id")!==id));this._hasSiblingsAndSelf=false}else{if(this._hasSiblingsAndSelf){return this.get("_siblings")}siblings=data$1.filter((model=>model.get("_parentId")===parentId));this._hasSiblingsAndSelf=true}const siblingsCollection=new Backbone.Collection(siblings);this.set("_siblings",siblingsCollection);return siblingsCollection}setOnChildren(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}this.set(...args);if(!this.hasManagedChildren)return;const children=this.getChildren();children.models.forEach((child=>child.setOnChildren(...args)))}setOptional(value){logging$1.deprecated("Use model.set('_isOptional', value) as setOptional() may be removed in the future");this.set({_isOptional:value})}checkLocking(){const lockType=this.get("_lockType");if(!lockType)return;switch(lockType){case"sequential":this.setSequentialLocking();break;case"unlockFirst":this.setUnlockFirstLocking();break;case"lockLast":this.setLockLastLocking();break;case"custom":this.setCustomLocking();break;default:logging$1.warn(`AdaptModel.checkLocking: unknown _lockType '${lockType}' found on ${this.get("_id")}`)}}setSequentialLocking(){const children=this.getAvailableChildModels();children.slice(1).forEach(((child,index)=>{const previousChild=children[index];const isLockedByPreviousChild=previousChild.get("_isLocked")||!previousChild.get("_isComplete")&&!previousChild.get("_isOptional");child.set("_isLocked",isLockedByPreviousChild)}),false)}setUnlockFirstLocking(){const children=this.getAvailableChildModels();const firstChild=children.shift();const isLockedByFirstChild=!firstChild.get("_isComplete")&&!firstChild.get("_isOptional");children.forEach((child=>child.set("_isLocked",isLockedByFirstChild)))}setLockLastLocking(){const children=this.getAvailableChildModels();const lastChild=children.pop();const isLockedByChildren=children.some((child=>!child.get("_isComplete")&&!child.get("_isOptional")));lastChild.set("_isLocked",isLockedByChildren)}setCustomLocking(){const children=this.getAvailableChildModels();children.forEach((child=>child.set("_isLocked",this.shouldLock(child))))}shouldLock(child){const lockedBy=child.get("_lockedBy");if(!lockedBy)return false;return lockedBy.some((id=>{try{const anotherModel=data$1.findById(id);return anotherModel.get("_isAvailable")&&(anotherModel.get("_isLocked")||!anotherModel.get("_isComplete")&&!anotherModel.get("_isOptional"))}catch(e){logging$1.warn(`AdaptModel.shouldLock: unknown _lockedBy ID '${id}' found on ${child.get("_id")}`);return false}}))}onIsComplete(){this.checkCompletionStatus();this.checkLocking()}checkIfResetOnRevisit(){const isResetOnRevisit=this.get("_isResetOnRevisit");this.reset(isResetOnRevisit)}deepClone(){let modifier=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;const ModelClass=this.constructor;const clonedModel=new ModelClass(this.toJSON());if(modifier){modifier(clonedModel,this)}let clonedId=clonedModel.get("_id");const hasId=Boolean(clonedId);const shouldAssignUniqueId=this.get("_id")===clonedId;if(hasId&&shouldAssignUniqueId){const cid=_.uniqueId(ModelClass.prototype.cidPrefix||"c");clonedId=`${clonedId}_${cid}`;clonedModel.set("_id",clonedId)}if(hasId){data$1.add(clonedModel)}if(this.hasManagedChildren){this.getChildren().each((child=>{if(!child.deepClone){throw new Error("Cannot deepClone child.")}child.deepClone(((clone,child)=>{if(hasId){clone.set("_parentId",clonedId)}if(modifier){modifier(clone,child)}}))}))}clonedModel.getParent().getChildren().add(clonedModel);clonedModel.setupModel();return clonedModel}onAll(type,model,value){if(!_.result(this,"bubblingEvents").includes(type))return;const event=new ModelEvent(type,model,value);this.bubble(event)}bubble(event){if(!event.canBubble)return;event.addPath(this);this.trigger(`bubble:${event.type} bubble`,event)}});var ContentObjectModel=__AMD("core/js/models/contentObjectModel",class ContentObjectModel extends AdaptModel{get _parent(){logging$1.deprecated("contentObjectModel._parent, use contentObjectModel.getParent() instead, parent models are defined by the JSON");const isParentCourse=this.get("_parentId")===Adapt$1.course.get("_id");if(isParentCourse){return"course"}return"contentObjects"}get _siblings(){logging$1.deprecated("contentObjectModel._siblings, use contentObjectModel.getSiblings() instead, sibling models are defined by the JSON");return"contentObjects"}get _children(){logging$1.deprecated("contentObjectModel._children, use contentObjectModel.hasManagedChildren instead, child models are defined by the JSON");return null}getTypeGroup(){return"contentobject"}});class ArticleModel extends AdaptModel{get _parent(){logging$1.deprecated("articleModel._parent, use articleModel.getParent() instead, parent models are defined by the JSON");return"contentObjects"}get _siblings(){logging$1.deprecated("articleModel._siblings, use articleModel.getSiblings() instead, sibling models are defined by the JSON");return"articles"}get _children(){logging$1.deprecated("articleModel._children, use articleModel.hasManagedChildren instead, child models are defined by the JSON");return"blocks"}getTypeGroup(){return"article"}}components$1.register("article",{model:ArticleModel});var ArticleModel$1=__AMD("core/js/models/articleModel",ArticleModel);class BlockModel extends AdaptModel{get _parent(){logging$1.deprecated("blockModel._parent, use blockModel.getParent() instead, parent models are defined by the JSON");return"articles"}get _siblings(){logging$1.deprecated("blockModel._siblings, use blockModel.getSiblings() instead, sibling models are defined by the JSON");return"blocks"}get _children(){logging$1.deprecated("blockModel._children, use blockModel.hasManagedChildren instead, child models are defined by the JSON");return"components"}getTypeGroup(){return"block"}}components$1.register("block",{model:BlockModel});var BlockModel$1=__AMD("core/js/models/blockModel",BlockModel);class ComponentModel extends AdaptModel{get _parent(){logging$1.deprecated("componentModel._parent, use componentModel.getParent() instead, parent models are defined by the JSON");return"blocks"}get _siblings(){logging$1.deprecated("componentModel._siblings, use componentModel.getSiblings() instead, sibling models are defined by the JSON");return"components"}getTypeGroup(){return"component"}defaults(){return AdaptModel.resultExtend("defaults",{_isA11yComponentDescriptionEnabled:true,_shouldStoreAttempts:true,_userAnswer:null,_attemptStates:null})}trackable(){return AdaptModel.resultExtend("trackable",["_userAnswer","_attemptStates"])}trackableType(){return AdaptModel.resultExtend("trackableType",[Array,Array])}get hasManagedChildren(){return false}init(){if(Adapt$1.get("_isStarted")){this.onAdaptInitialize();return}this.listenToOnce(Adapt$1,"adapt:initialize",this.onAdaptInitialize)}onAdaptInitialize(){this.restoreUserAnswers()}restoreUserAnswers(){}storeUserAnswer(){}resetUserAnswer(){this.set("_userAnswer",null)}reset(){let type=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"hard";let canReset=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.get("_canReset");const wasReset=super.reset(type,canReset);if(!wasReset)return false;this.resetUserAnswer();return true}getAttemptState(){let object=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.toJSON();const trackables=this.trackable();const types=this.trackableType();trackables.find(((name,index)=>{if(name!=="_attemptStates")return false;trackables.splice(index,1);types.splice(index,1);return true}));const values=trackables.map((n=>object[n]));const booleans=values.filter(((v,i)=>types[i]===Boolean)).map(Boolean);const numbers=values.filter(((v,i)=>types[i]===Number)).map((v=>Number(v)||0));const arrays=values.filter(((v,i)=>types[i]===Array));return[numbers,booleans,arrays]}getAttemptObject(){let state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.getAttemptState();const trackables=this.trackable();const types=this.trackableType();trackables.find(((name,index)=>{if(name!=="_attemptStates")return false;trackables.splice(index,1);types.splice(index,1);return true}));const numbers=(state[0]||[]).slice(0);const booleans=(state[1]||[]).slice(0);const arrays=(state[2]||[]).slice(0);const object={};trackables.forEach(((n,i)=>{if(n==="_id")return;switch(types[i]){case Number:object[n]=numbers.shift();break;case Boolean:object[n]=booleans.shift();break;case Array:object[n]=arrays.shift();break}}));return object}setAttemptObject(object){let silent=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;this.set(object,{silent:silent})}addAttemptObject(){let object=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.getAttemptObject();const attemptStates=this.get("_attemptStates")||[];const state=this.getAttemptState(object);attemptStates.push(state);this.set("_attemptStates",attemptStates)}getAttemptObjects(){const states=this.get("_attemptStates")||[];return states.map((state=>this.getAttemptObject(state)))}}components$1.register("component",{model:ComponentModel});var ComponentModel$1=__AMD("core/js/models/componentModel",ComponentModel);class MenuModel extends ContentObjectModel{get _children(){logging$1.deprecated("menuModel._children, use menuModel.hasManagedChildren instead, child models are defined by the JSON");return"contentObjects"}getTypeGroup(){return"menu"}setCustomLocking(){const children=this.getAvailableChildModels();children.forEach((child=>{child.set("_isLocked",this.shouldLock(child));if(!(child instanceof MenuModel))return;child.checkLocking()}))}}components$1.register("menu",{model:MenuModel});var MenuModel$1=__AMD("core/js/models/menuModel",MenuModel);class CourseModel extends MenuModel$1{get _parent(){logging$1.deprecated("courseModel._parent, use courseModel.getParent() instead, parent models are defined by the JSON");return null}get _siblings(){logging$1.deprecated("courseModel._siblings, use courseModel.getSiblings() instead, sibling models are defined by the JSON");return null}getTypeGroup(){return"course"}}components$1.register("course",{model:CourseModel});var CourseModel$1=__AMD("core/js/models/courseModel",CourseModel);class PageModel extends ContentObjectModel{get _children(){logging$1.deprecated("pageModel._children, use menuModel.hasManagedChildren instead, child models are defined by the JSON");return"articles"}getTypeGroup(){return"page"}}components$1.register("page",{model:PageModel});__AMD("core/js/models/pageModel",PageModel);var ChildEvent=__AMD("core/js/childEvent",class ChildEvent extends Backbone.Controller{initialize(type,target,model){this.type=type;this.target=target;this.isForced=false;this.isStoppedImmediate=false;this.isStoppedNext=false;this.hasRequestChild=false;this._model=model}get model(){return this._model}set model(model){if(this.type!=="requestChild"){logging$1.warn(`Cannot change model in ${this.type} event.`);return}if(this._model){logging$1.warn(`Cannot inject two models in one sitting. ${model.get("_id")} attempts to overwrite ${this._model.get("_id")}`);return}this._model=model;this.hasRequestChild=true}reset(){this.isStoppedImmediate=false;this.isStoppedNext=false}force(){this.isForced=true}stop(){let immediate=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;if(!immediate){return this.stopNext()}this.isStoppedImmediate=true}stopNext(){this.isStoppedNext=true}close(){this.trigger("closed")}});class AdaptView extends Backbone.View{attributes(){return{"data-adapt-id":this.model.get("_id"),role:"presentation"}}initialize(){this._jsxIgnoreChanges=0;this.listenTo(this.model,{"change:_isVisible":this.toggleVisibility,"change:_isHidden":this.toggleHidden,"change:_isComplete":this.onIsCompleteChange});this.isJSX=(this.constructor.template||"").includes(".jsx");if(this.isJSX){this._classSet=new Set(_.result(this,"className").trim().split(/\s+/));this.listenTo(this.model,"change",this.changed);const children=this.model?.getChildren?.();children&&this.listenTo(children,"change",this.changed);this.listenTo(Adapt$1,"device:changed",this.changed)}this.model.set({_globals:Adapt$1.course.get("_globals"),_isReady:false});this._isRemoved=false;if(location$1._currentId===this.model.get("_id")){Adapt$1.parentView=this}this.preRender();this.render();this.setupOnScreenHandler()}preRender(){}async postRender(){await this.addChildren()}render(){const type=this.constructor.type;Adapt$1.trigger(`${type}View:preRender view:preRender`,this);if(this.isJSX){this.changed()}else{const data=this.model.toJSON();data.view=this;const template=Handlebars.templates[this.constructor.template];this.$el.html(template(data))}Adapt$1.trigger(`${type}View:render view:render`,this);_.defer((async()=>{if(this._isRemoved)return;await this.postRender();Adapt$1.trigger(`${type}View:postRender view:postRender`,this)}));return this}changed(){let eventName=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;if(this._jsxIgnoreChanges!==0)return;if(!this.isJSX)return;if(typeof eventName==="string"&&eventName.startsWith("bubble")){return}if(!this.model.get("_isRendered"))return;const props={...this,...this.model.toJSON(),_globals:Adapt$1.course.get("_globals")};const Template=templates[this.constructor.template.replace(".jsx","")];this.updateViewProperties();ReactDOM__default["default"].render(React__default["default"].createElement(Template,props),this.el)}stopRendering(){this._jsxIgnoreChanges++}startRendering(){this._jsxIgnoreChanges--;if(this._jsxIgnoreChanges<0){this._jsxIgnoreChanges=0}}updateViewProperties(){const classesToAdd=_.result(this,"className").trim().split(/\s+/);classesToAdd.forEach((i=>this._classSet.add(i)));const classesToRemove=[...this._classSet].filter((i=>!classesToAdd.includes(i)));classesToRemove.forEach((i=>this._classSet.delete(i)));this._setAttributes({..._.result(this,"attributes"),id:_.result(this,"id")});this.$el.removeClass(classesToRemove).addClass(classesToAdd)}setupOnScreenHandler(){const onscreen=this.model.get("_onScreen");if(!onscreen?._isEnabled)return;this.$el.addClass(`has-animation ${onscreen._classes}-before`);this.$el.on("onscreen.adaptView",((e,m)=>{if(!m.onscreen)return;const minVerticalInview=onscreen._percentInviewVertical||33;if(m.percentInviewVertical<minVerticalInview)return;this.$el.addClass(`${onscreen._classes}-after`).off("onscreen.adaptView")}))}async addChildren(){this.nthChild=this.nthChild||0;let addedCount=await this.addDescendants(false);while(true){const models=this.model.getAvailableChildModels();const event=this._getAddChildEvent(models[this.nthChild]);if(!event){break}if(event.isForced){event.reset()}if(event.isStoppedImmediate||!event.model){const subsequentModels=models.slice(this.nthChild);subsequentModels.forEach((model=>model.setOnChildren("_isRendered",false)));break}const model=event.model;model.set({_isRendered:true,_nthChild:++this.nthChild});const ChildView=this.constructor.childView||components$1.getViewClass(model);if(!ChildView){throw new Error(`The component '${model.attributes._id}' ('${model.attributes._component}') has not been installed, and so is not available in your project.`)}const childView=new ChildView({model:model});this.addChildView(childView);addedCount++;if(event.isStoppedNext){break}}if(!addedCount){return addedCount}this.model.set("_isReady",false);return addedCount}addChildView(childView){const childModel=childView.model;const type=childModel.get("_type");const childViews=this.getChildViews()||[];childViews.push(childView);this.setChildViews(childViews);const $parentContainer=this.$(this.constructor.childContainer);switch(childModel.get("_renderPosition")){case"outer-append":this.$el.append(childView.$el);break;case"inner-append":default:$parentContainer.append(childView.$el);break}Adapt$1.trigger(`${type}View:childAdded view:childAdded`,this,childView);return childView}async addDescendants(){let addedDescendantCount=0;const childViews=this.getChildViews();if(!childViews){return addedDescendantCount}for(let i=0,l=childViews.length;i<l;i++){const view=childViews[i];addedDescendantCount=view.addChildren?await view.addChildren():0;if(addedDescendantCount){break}}if(!addedDescendantCount){this.model.checkReadyStatus();return addedDescendantCount}this.model.set("_isReady",false);return addedDescendantCount}async whenReady(){if(this.model.get("_isReady"))return;return new Promise((resolve=>{const onReadyChange=(model,value)=>{if(!value)return;this.stopListening(this.model,"change:_isReady",onReadyChange);resolve()};this.listenTo(this.model,"change:_isReady",onReadyChange);this.model.checkReadyStatus()}))}_getAddChildEvent(model){const isRequestChild=!model;const event=new ChildEvent(null,this,model);if(isRequestChild){const canRequestChild=this.model.get("_canRequestChild");if(!canRequestChild){return}event.type="requestChild";Adapt$1.trigger("view:requestChild",event);if(!event.hasRequestChild){event.close();return}model=event.model}const type=model.get("_type");event.type="addChild";Adapt$1.trigger(`${type}View:addChild view:addChild`,event);event.close();return event}findDescendantViews(isParentFirst){const descendants=[];const childViews=this.getChildViews();childViews?.forEach((view=>{if(isParentFirst)descendants.push(view);const children=view.findDescendantViews?.(isParentFirst);if(children)descendants.push(...children);if(!isParentFirst)descendants.push(view)}));return descendants}setReadyStatus(){this.model.setReadyStatus()}setCompletionStatus(){this.model.setCompletionStatus()}resetCompletionStatus(type){if(!this.model.get("_canReset"))return;const descendantComponents=this.model.findDescendantModels("component");if(descendantComponents.length===0){this.model.reset(type)}else{descendantComponents.forEach((model=>model.reset(type)))}}preRemove(){const type=this.constructor.type;Adapt$1.trigger(`${type}View:preRemove view:preRemove`,this)}remove(){const type=this.constructor.type;this.preRemove();Adapt$1.trigger(`${type}View:remove view:remove`,this);this._isRemoved=true;this.stopListening();wait$1.for((end=>{if(this.isJSX){ReactDOM__default["default"].unmountComponentAtNode(this.el)}this.$el.off("onscreen.adaptView");super.remove();_.defer((()=>{Adapt$1.trigger(`${type}View:postRemove view:postRemove`,this)}));end()}));return this}setVisibility(){return this.model.get("_isVisible")?"":"u-visibility-hidden"}toggleVisibility(){this.$el.toggleClass("u-visibility-hidden",!this.model.get("_isVisible"))}setHidden(){return this.model.get("_isHidden")?"u-display-none":""}toggleHidden(){this.$el.toggleClass("u-display-none",this.model.get("_isHidden"))}onIsCompleteChange(model,isComplete){this.$el.toggleClass("is-complete",isComplete)}getChildViews(){if(!this._childViews)return this._childViews;return Object.entries(this._childViews).map((_ref=>{let[key,value]=_ref;return value}))}setChildViews(value){this._childViews=value}get childViews(){logging$1.deprecated("view.childViews use view.getChildViews() and view.setChildViews([])");if(Array.isArray(this._childViews)){return _.indexBy(this._childViews,(view=>view.model.get("_id")))}return this._childViews}set childViews(value){logging$1.deprecated("view.childViews use view.getChildViews() and view.setChildViews([])");this.setChildViews(value)}}AdaptView.className="";var AdaptView$1=__AMD("core/js/views/adaptView",AdaptView);var ContentObjectView=__AMD("core/js/views/contentObjectView",class ContentObjectView extends AdaptView$1{attributes(){return AdaptView$1.resultExtend("attributes",{role:"main"},this)}className(){return[this.constructor.type,"contentobject",this.constructor.className,this.model.get("_id"),this.model.get("_classes"),this.setVisibility(),this.model.get("_isComplete")?"is-complete":"",this.model.get("_isOptional")?"is-optional":""].filter(Boolean).join(" ")}preRender(){$.inview.lock(this.constructor.type+"View");this.disableAnimation=Adapt$1.config.has("_disableAnimation")?Adapt$1.config.get("_disableAnimation"):false;this.$el.css("opacity",0);this.listenTo(this.model,"change:_isReady",this.isReady);this._loadingErrorTimeout=setTimeout((()=>data$1.logReadyError(this)),1e4)}render(){const type=this.constructor.type;Adapt$1.trigger(`${type}View:preRender contentObjectView:preRender view:preRender`,this);if(this.isJSX){this.changed()}else{const data=this.model.toJSON();data.view=this;const template=Handlebars.templates[this.constructor.template];this.$el.html(template(data))}Adapt$1.trigger(`${type}View:render contentObjectView:render view:render`,this);_.defer((()=>{if(this._isRemoved)return;this.postRender();Adapt$1.trigger(`${type}View:postRender contentObjectView:postRender view:postRender`,this)}));return this}async isReady(){if(!this.model.get("_isReady")||this._isTriggeredReady)return;this._isTriggeredReady=true;clearTimeout(this._loadingErrorTimeout);delete this._loadingErrorTimeout;const type=this.constructor.type;const performIsReady=async()=>{Adapt$1.trigger(`${type}View:preReady contentObjectView:preReady view:preReady`,this);await wait$1.queue();$(".js-loading").hide();if(Adapt$1.get("_shouldContentObjectScrollTop")!==false){$(window).scrollTop(0)}Adapt$1.trigger(`${type}View:ready contentObjectView:ready view:ready`,this);$.inview.unlock(`${type}View`);const styleOptions={opacity:1};if(this.disableAnimation){this.$el.css(styleOptions);$.inview();_.defer((()=>{Adapt$1.trigger(`${type}View:postReady contentObjectView:postReady view:postReady`,this)}))}else{this.$el.velocity(styleOptions,{duration:"fast",complete:()=>{$.inview();Adapt$1.trigger(`${type}View:postReady contentObjectView:postReady view:postReady`,this)}})}$(window).scroll()};_.defer(performIsReady)}async renderTo(id){const isRenderToSelf=id===this.model.get("_id");if(isRenderToSelf)return;let models=this.model.getAllDescendantModels(true).filter((model=>model.get("_isAvailable")));const index=models.findIndex((model=>model.get("_id")===id));if(index===-1){throw new Error(`Cannot renderTo "${id}" as it isn't a descendant.`)}const model=models[index];if(model.get("_isRendered")&&model.get("_isReady")){return}models=models.slice(0,index+1);const isLocked=models.some((model=>model.get("_isLocked")));if(isLocked)throw new Error(`Cannot renderTo ${id} as it is preceded by locked content`);const ids=_.indexBy(models,(model=>model.get("_id")));const forceUntilId=event=>{const addingId=event.model.get("_id");if(!ids[addingId])return;event.force();if(addingId!==id)return;Adapt$1.off("view:addChild",forceUntilId)};Adapt$1.on("view:addChild",forceUntilId);await this.addChildren();await this.whenReady();if(!model.get("_isRendered")||!model.get("_isReady")){throw new Error(`Cannot renderTo "${id}".`)}}preRemove(){const type=this.constructor.type;Adapt$1.trigger(`${type}View:preRemove contentObjectView:preRemove view:preRemove`,this)}remove(){const type=this.constructor.type;this.preRemove();Adapt$1.trigger(`${type}View:remove contentObjectView:remove view:remove`,this);this._isRemoved=true;wait$1.for((end=>{if(this.isJSX){ReactDOM__default["default"].unmountComponentAtNode(this.el)}this.$el.off("onscreen.adaptView");this.findDescendantViews().reverse().forEach((view=>{view.remove()}));this.setChildViews(null);super.remove();_.defer((()=>{Adapt$1.trigger(`${type}View:postRemove contentObjectView:postRemove view:postRemove`,this);this.trigger("postRemove")}));end()}));return this}destroy(){this.remove();if(Adapt$1.parentView===this){Adapt$1.parentView=null}}});class PageView extends ContentObjectView{remove(){if(this.$pageLabel){this.$pageLabel.remove()}super.remove()}}Object.assign(PageView,{childContainer:".article__container",type:"page",template:"page"});components$1.register("page",{view:PageView});__AMD("core/js/views/pageView",PageView);class ArticleView extends AdaptView$1{className(){return["article",this.model.get("_id"),this.model.get("_classes"),this.setVisibility(),this.setHidden(),this.model.get("_isComplete")?"is-complete":"",this.model.get("_isOptional")?"is-optional":""].join(" ")}}Object.assign(ArticleView,{childContainer:".block__container",type:"article",template:"article"});components$1.register("article",{view:ArticleView});var ArticleView$1=__AMD("core/js/views/articleView",ArticleView);class BlockView extends AdaptView$1{className(){return["block",this.model.get("_id"),this.model.get("_classes"),this.setVisibility(),this.setHidden(),this.model.get("_isComplete")?"is-complete":"",this.model.get("_isOptional")?"is-optional":""].join(" ")}}Object.assign(BlockView,{childContainer:".component__container",type:"block",template:"block"});components$1.register("block",{view:BlockView});__AMD("core/js/views/blockView",BlockView);class MPABC extends Backbone.Controller{initialize(){this.listenTo(data$1,{loading:this.waitForDataLoaded,loaded:this.onDataLoaded});this.setupSubsetCollections()}waitForDataLoaded(){wait$1.begin()}onDataLoaded(){wait$1.end()}setupSubsetCollections(){Adapt$1.contentObjects=new AdaptSubsetCollection(null,{parent:data$1,model:ContentObjectModel});Adapt$1.articles=new AdaptSubsetCollection(null,{parent:data$1,model:ArticleModel$1});Adapt$1.blocks=new AdaptSubsetCollection(null,{parent:data$1,model:BlockModel$1});Adapt$1.components=new AdaptSubsetCollection(null,{parent:data$1,model:ComponentModel$1})}}const mpabc=new MPABC;var mpabc$1=__AMD("core/js/mpabc",mpabc);var NotifyPushView=__AMD("core/js/views/notifyPushView",class NotifyPushView extends Backbone.View{className(){const classes=["notify-push",this.model.get("_classes"),this.model.get("_type")==="a11y-push"&&"aria-label"].filter(Boolean).join(" ");return classes}attributes(){return{role:"dialog","aria-labelledby":"notify-push-heading","aria-modal":"false"}}initialize(){this.listenTo(Adapt$1,{"notify:pushShown notify:pushRemoved":this.updateIndexPosition,remove:this.remove});this.listenTo(this.model.collection,{remove:this.updateIndexPosition,"change:_index":this.updatePushPosition});this.preRender();this.render()}events(){return{"click .js-notify-push-close-btn":"closePush","click .js-notify-push-inner":"triggerEvent"}}preRender(){this.hasBeenRemoved=false}render(){const data=this.model.toJSON();const template=Handlebars.templates.notifyPush;this.$el.html(template(data)).appendTo(".notify__push-container");_.defer(this.postRender.bind(this));return this}postRender(){this.$el.addClass("is-active");_.delay(this.closePush.bind(this),this.model.get("_timeout"));Adapt$1.trigger("notify:pushShown")}closePush(event){if(event){event.preventDefault()}if(this.hasBeenRemoved===false){this.hasBeenRemoved=true;this.$el.removeClass("is-active");_.delay((()=>{this.model.collection.remove(this.model);Adapt$1.trigger("notify:pushRemoved",this);this.remove()}),600)}}triggerEvent(event){Adapt$1.trigger(this.model.get("_callbackEvent"));this.closePush()}updateIndexPosition(){if(this.hasBeenRemoved)return;const models=this.model.collection.models;models.forEach(((model,index)=>{if(!model.get("_isActive"))return;model.set("_index",index);this.updatePushPosition()}))}updatePushPosition(){if(this.hasBeenRemoved){return}if(typeof this.model.get("_index")!=="undefined"){const elementHeight=this.$el.height();const offset=20;const navigationHeight=$(".nav").height();const currentIndex=this.model.get("_index");let flippedIndex=currentIndex===0?1:0;if(this.model.collection.where({_isActive:true}).length===1){flippedIndex=0}const positionLowerPush=(elementHeight+offset)*flippedIndex+navigationHeight+offset;this.$el.css("top",positionLowerPush)}}});var NotifyModel=__AMD("core/js/models/notifyModel",class NotifyModel extends LockingModel{defaults(){return{_isActive:false,_showIcon:false,_timeout:3e3}}});var NotifyPushCollection=__AMD("core/js/collections/notifyPushCollection",class NotifyPushCollection extends Backbone.Collection{initialize(){this.model=NotifyModel;this.listenTo(this,"add",this.onPushAdded);this.listenTo(Adapt$1,"notify:pushRemoved",this.onRemovePush)}onPushAdded(model){this.checkPushCanShow(model)}checkPushCanShow(model){if(!this.canShowPush())return;model.set("_isActive",true);this.showPush(model)}canShowPush(){const availablePushNotifications=this.where({_isActive:true});return availablePushNotifications.length<2}showPush(model){new NotifyPushView({model:model})}onRemovePush(view){const inactivePushNotifications=this.where({_isActive:false});if(inactivePushNotifications.length>0){this.checkPushCanShow(inactivePushNotifications[0])}}});var NotifyPopupView=__AMD("core/js/views/notifyPopupView",class NotifyPopupView extends Backbone__default["default"].View{className(){return`notify ${this.model.get("_classes")||""}`}attributes(){return Object.assign({role:"dialog","aria-labelledby":"notify-heading","aria-modal":"true"},this.model.get("_attributes"))}events(){return{"click .js-notify-btn-alert":"onAlertButtonClicked","click .js-notify-btn-prompt":"onPromptButtonClicked","click .js-notify-close-btn":"onCloseButtonClicked","click .js-notify-shadow-click":"onShadowClicked"}}initialize(_ref){let{notify:notify}=_ref;this.notify=notify;_.bindAll(this,"resetNotifySize","onKeyUp");this.disableAnimation=Adapt$1.config.get("_disableAnimation")||false;this.isOpen=false;this.hasOpened=false;this.setupEventListeners();this.render()}setupEventListeners(){this.listenTo(Adapt$1,{remove:this.closeNotify,"notify:resize":this.resetNotifySize,"notify:cancel":this.cancelNotify,"notify:close":this.closeNotify,"device:resize":this.resetNotifySize});this.setupEscapeKey()}setupEscapeKey(){$(window).on("keyup",this.onKeyUp)}onKeyUp(event){if(event.which!==27)return;event.preventDefault();this.cancelNotify()}render(){const data=this.model.toJSON();const template=Handlebars.templates.notifyPopup;this.$el.css("visibility","hidden");this.$el.html(template(data)).appendTo(".notify__popup-container");this.$(".notify__popup").css("visibility","hidden");this.$el.css("visibility","visible");this.showNotify();return this}onAlertButtonClicked(event){event.preventDefault();this.closeNotify();Adapt$1.trigger(this.model.get("_callbackEvent"),this)}onPromptButtonClicked(event){event.preventDefault();this.closeNotify();Adapt$1.trigger($(event.currentTarget).attr("data-event"),this)}onCloseButtonClicked(event){event.preventDefault();this.cancelNotify()}onShadowClicked(event){event.preventDefault();if(this.model.get("_closeOnShadowClick")===false)return;this.cancelNotify()}cancelNotify(){if(this.model.get("_isCancellable")===false)return;this.closeNotify();Adapt$1.trigger("notify:cancelled",this)}resetNotifySize(){if(!this.hasOpened)return;this.resizeNotify()}resizeNotify(){const windowHeight=$(window).height();const notifyHeight=this.$(".notify__popup-inner").outerHeight();const isFullWindow=notifyHeight>=windowHeight;this.$(".notify__popup").css({height:isFullWindow?"100%":"auto",top:isFullWindow?0:"","margin-top":isFullWindow?"":-(notifyHeight/2),"overflow-y":isFullWindow?"scroll":"","-webkit-overflow-scrolling":isFullWindow?"touch":""})}async showNotify(){this.isOpen=true;await this.addSubView();this.notify.stack.push(this);this.$previousActiveElement=$(document.activeElement);Adapt$1.trigger("notify:opened",this);this.$el.imageready(this.onLoaded.bind(this))}onLoaded(){if(this.disableAnimation){this.$(".notify__shadow").css("display","block")}else{this.$(".notify__shadow").velocity({opacity:0},{duration:0}).velocity({opacity:1},{duration:400,begin:()=>{this.$(".notify__shadow").css("display","block")}})}this.resizeNotify();if(this.disableAnimation){this.$(".notify__popup").css("visibility","visible");this.onOpened()}else{this.$(".notify__popup").velocity({opacity:0},{duration:0}).velocity({opacity:1},{duration:400,begin:()=>{this.$(".notify__popup").css("visibility","visible");this.onOpened()}})}}onOpened(){$.inview();this.hasOpened=true;a11y$1.popupOpened(this.$el);a11y$1.scrollDisable("body");$("html").addClass("notify");a11y$1.focusFirst(this.$(".notify__popup"),{defer:false})}async addSubView(){this.subView=this.model.get("_view");if(this.model.get("_shouldRenderId")&&this.model.get("_id")){const model=data$1.findById(this.model.get("_id"));const View=components$1.getViewClass(model);this.subView=new View({model:model})}if(!this.subView)return;this.subView.$el.on("resize",this.resetNotifySize);this.$(".notify__content-inner").append(this.subView.$el);if(!(this.subView instanceof AdaptView$1)||this.subView.model.get("_isReady"))return;return new Promise((resolve=>{const check=(model,value)=>{if(!value)return;this.subView.model.off("change:_isReady",check);resolve()};this.subView.model.on("change:_isReady",check)}))}closeNotify(){const stackItem=this.notify.stack[this.notify.stack.length-1];if(this!==stackItem)return;this.notify.stack.pop();if(!this.isOpen)return;this.isOpen=false;if(this.hasOpened){this.onCloseReady();return}this.listenToOnce(Adapt$1,"popup:opened",(()=>{_.defer(this.onCloseReady.bind(this))}))}onCloseReady(){if(this.disableAnimation){this.$(".notify__popup").css("visibility","hidden");this.$el.css("visibility","hidden");this.remove()}else{this.$(".notify__popup").velocity({opacity:0},{duration:400,complete:()=>{this.$(".notify__popup").css("visibility","hidden")}});this.$(".notify__shadow").velocity({opacity:0},{duration:400,complete:()=>{this.$el.css("visibility","hidden");this.remove()}})}a11y$1.scrollEnable("body");$("html").removeClass("notify");a11y$1.popupClosed(this.$previousActiveElement);Adapt$1.trigger("notify:closed",this)}remove(){this.removeSubView();$(window).off("keyup",this.onKeyUp);super.remove(...arguments)}removeSubView(){if(!this.subView)return;this.subView.$el.off("resize",this.resetNotifySize);if(this.subView instanceof AdaptView$1){const views=[...this.subView.findDescendantViews(),this.subView];views.forEach((view=>{view.model.set("_isReady",false);view.remove()}))}else{this.subView.remove()}this.subView=null}});var NotifyView=__AMD("core/js/views/notifyView",class NotifyView extends Backbone.View{className(){return"notify__container"}initialize(){this._stack=[];this.notifyPushes=new NotifyPushCollection;this.listenTo(Adapt$1,{"notify:popup":this._deprecated.bind(this,"popup"),"notify:alert":this._deprecated.bind(this,"alert"),"notify:prompt":this._deprecated.bind(this,"prompt"),"notify:push":this._deprecated.bind(this,"push")});this.render()}get stack(){return this._stack}get isOpen(){return this.stack.length>0}_deprecated(type,notifyObject){logging$1.deprecated(`NOTIFY DEPRECATED: Adapt.trigger('notify:${type}', notifyObject); is no longer supported, please use notify.${type}(notifyObject);`);return this.create(notifyObject,{_type:type})}render(){const notifyTemplate=Handlebars.templates.notify;this.$el.html(notifyTemplate());this.$el.appendTo("body")}create(notifyObject,defaults){notifyObject=_.defaults({},notifyObject,defaults,{_type:"popup",_shouldRenderId:false,_isCancellable:true,_showCloseButton:true,_closeOnShadowClick:true});if(notifyObject._type==="a11y-push")notifyObject._showCloseButton=false;switch(notifyObject._type){case"a11y-push":case"push":this.notifyPushes.push(notifyObject);return}return new NotifyPopupView({model:new NotifyModel(notifyObject),notify:this})}popup(notifyObject){return this.create(notifyObject,{_type:"popup"})}alert(notifyObject){return this.create(notifyObject,{_type:"alert"})}prompt(notifyObject){return this.create(notifyObject,{_type:"prompt"})}push(notifyObject){return this.create(notifyObject,{_type:"push"})}});const notify=new NotifyView;var notify$1=__AMD("core/js/notify",notify);var RouterModel=__AMD("core/js/models/routerModel",class RouterModel extends LockingModel{defaults(){return{_canNavigate:true,_shouldNavigateFocus:true}}lockedAttributes(){return{_canNavigate:false,_shouldNavigateFocus:false}}});class Router extends Backbone.Router{routes(){return{"":"handleRoute","id/:id":"handleRoute",":pluginName(/*location)(/*action)":"handleRoute"}}initialize(_ref){let{model:model}=_ref;this.navigateToElement=this.navigateToElement.bind(this);this._isBackward=false;this.model=model;this._navigationRoot=null;this._isCircularNavigationInProgress=false;this.showLoading();this.$wrapper=$("#wrapper");this.$html=$("html");this.listenToOnce(Adapt$1,"app:dataReady",this.setDocumentTitle);this.listenTo(Adapt$1,"router:navigateTo",this.navigateToArguments)}get rootModel(){return this._navigationRoot||Adapt$1.course}set rootModel(model){this._navigationRoot=model}showLoading(){$(".js-loading").show()}hideLoading(){$(".js-loading").hide()}setDocumentTitle(){const currentModel=location$1._currentModel;const hasSubTitle=currentModel&&currentModel!==router.rootModel&&currentModel.get("title");const title=[this.rootModel.get("title"),hasSubTitle&&currentModel.get("title")].filter(Boolean).join(" | ");this.listenToOnce(Adapt$1,"contentObjectView:preRender",(()=>{const escapedTitle=$(`<div>${title}</div>`).text();document.title=escapedTitle}))}navigateToArguments(args){args=args.filter((v=>v!==null));const options={trigger:false,replace:false};if(args.length===1&&data$1.findById(args[0])){this.navigate("#/id/"+args[0],options);return}if(args.length<=3){this.navigate("#/"+args.join("/"),options);return}logging$1.deprecated("Use Backbone.history.navigate or window.location.href instead of Adapt.trigger('router:navigateTo')");this.handleRoute(...args)}handleRoute(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}args=args.filter((v=>v!==null));if(this.model.get("_canNavigate")){this._isCircularNavigationInProgress=false}if(this._isCircularNavigationInProgress===false){Adapt$1.trigger("router:navigate",args)}if(this.model.get("_canNavigate")){this.model.set("_canNavigate",false,{pluginName:"adapt"});this._isBackward=false;if(args.length<=1){return this.handleId(...args)}return this.handlePluginRouter(...args)}if(this._isCircularNavigationInProgress){this._isCircularNavigationInProgress=false;return}this._isCircularNavigationInProgress=true;Adapt$1.trigger("router:navigationCancelled",args);Backbone.history.history[this._isBackward?"forward":"back"]();this._isBackward=false}async handlePluginRouter(pluginName,location,action){const pluginLocation=[pluginName,location&&`-${location}`,action&&`-${action}`].filter(Boolean).join("");await this.updateLocation(pluginLocation,null,null,null);Adapt$1.trigger("router:plugin:"+pluginName,pluginName,location,action);Adapt$1.trigger("router:plugin",pluginName,location,action);this.model.set("_canNavigate",true,{pluginName:"adapt"})}async handleId(id){const rootModel=router.rootModel;let model=!id?rootModel:data$1.findById(id);if(!model){this.model.set("_canNavigate",true,{pluginName:"adapt"});return}const isContentObject=model.isTypeGroup?.("contentobject");const navigateToId=model.get("_id");model=isContentObject?model:model.findAncestor("contentobject");id=model.get("_id");const isRoot=model===rootModel;if(isRoot&&Adapt$1.course.has("_start")){const startController=Adapt$1.course.get("_start");if(startController._isEnabled===true&&startController._isMenuDisabled===true){return}}if(model.get("_isLocked")&&Adapt$1.config.get("_forceRouteLocking")){logging$1.warn("Unable to navigate to locked id: "+id);this.model.set("_canNavigate",true,{pluginName:"adapt"});if(location$1._previousId===undefined){return this.navigate("#/",{trigger:true,replace:true})}return this.navigateBack()}this.showLoading();await Adapt$1.remove();const isCourse=model.isTypeGroup?.("course");const type=isCourse?"menu":model.get("_type");const newLocation=isCourse?"course":`${type}-${id}`;model.set("_isVisited",true);await this.updateLocation(newLocation,type,id,model);Adapt$1.once("contentObjectView:ready",(()=>{this.model.set("_canNavigate",true,{pluginName:"adapt"});this.handleNavigationFocus()}));Adapt$1.trigger(`router:${type} router:contentObject`,model);const ViewClass=components$1.getViewClass(model);const isMenu=model.isTypeGroup?.("menu");if(!ViewClass&&isMenu){logging$1.deprecated(`Using event based menu view instantiation for '${components$1.getViewName(model)}'`);return}if(!isMenu){_.invoke(model.getAllDescendantModels(),"checkIfResetOnRevisit");await Adapt$1.deferUntilCompletionChecked()}this.$wrapper.append(new ViewClass({model:model}).$el);if(!isContentObject&&!this.isScrolling){await this.navigateToElement("."+navigateToId,{replace:true,duration:400})}}async updateLocation(currentLocation,type,id,currentModel){location$1._previousModel=location$1._currentModel;location$1._previousId=location$1._currentId;location$1._previousContentType=location$1._contentType;location$1._currentModel=currentModel;location$1._currentId=id;location$1._contentType=type;location$1._currentLocation=currentLocation;if(type==="menu"){location$1._lastVisitedType="menu";location$1._lastVisitedMenu=id}else if(type==="page"){location$1._lastVisitedType="page";location$1._lastVisitedPage=id}this.setDocumentTitle();this.setGlobalClasses();Adapt$1.trigger("router:location",location$1);await wait$1.queue()}setGlobalClasses(){const currentModel=location$1._currentModel;const htmlClasses=currentModel?.get("_htmlClasses")||"";const classes=location$1._currentId?`location-${location$1._contentType} location-id-${location$1._currentId}`:`location-${location$1._currentLocation}`;const currentClasses=`${classes} ${htmlClasses}`;this.$html.removeClass(location$1._previousClasses).addClass(currentClasses).attr("data-location",location$1._currentLocation);this.$wrapper.removeClass().addClass(classes).attr("data-location",location$1._currentLocation);location$1._previousClasses=currentClasses}handleNavigationFocus(){if(!this.model.get("_shouldNavigateFocus"))return;a11y$1.focus("body")}navigateBack(){this._isBackward=true;Backbone.history.history.back()}navigateToCurrentRoute(force){if(!this.model.get("_canNavigate")&&!force){return}if(!location$1._currentId){return}const currentId=location$1._currentModel.get("_id");const isRoot=location$1._currentModel===this.rootModel;const route=isRoot?"#/":"#/id/"+currentId;this.navigate(route,{trigger:true,replace:true})}navigateToPreviousRoute(force){if(!this.model.get("_canNavigate")&&!force){return}const currentModel=location$1._currentModel;const previousModel=location$1._previousModel;if(!currentModel){return this.navigateBack()}if(location$1._currentModel?.isTypeGroup("menu")){return this.navigateToParent()}if(previousModel){return this.navigateBack()}this.navigateToParent()}navigateToParent(force){if(!this.model.get("_canNavigate")&&!force){return}const parentId=location$1._currentModel.get("_parentId");const parentModel=data$1.findById(parentId);const isRoot=parentModel===this.rootModel;const route=isRoot?"#/":"#/id/"+parentId;this.navigate(route,{trigger:true})}navigateToHomeRoute(force){if(!this.model.get("_canNavigate")&&!force){return}this.navigate("#/",{trigger:true})}async navigateToElement(selector){let settings=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};const currentModelId=typeof selector==="string"&&selector.replace(/\./g,"").split(" ")[0];const isSelectorAnId=data$1.hasId(currentModelId);if(isSelectorAnId){const currentModel=data$1.findById(currentModelId);const contentObject=currentModel.isTypeGroup?.("contentobject")?currentModel:currentModel.findAncestor("contentobject");const contentObjectId=contentObject.get("_id");const isNotInCurrentContentObject=contentObjectId!==location$1._currentId;if(currentModel&&(!currentModel.get("_isRendered")||!currentModel.get("_isReady")||isNotInCurrentContentObject)){const shouldReplace=settings.replace||false;if(isNotInCurrentContentObject){this.isScrolling=true;this.navigate(`#/id/${currentModelId}`,{trigger:true,replace:shouldReplace});this.model.set("_shouldNavigateFocus",false,{pluginName:"adapt"});await new Promise((resolve=>Adapt$1.once("contentObjectView:ready",_.debounce((()=>{this.model.set("_shouldNavigateFocus",true,{pluginName:"adapt"});resolve()}),1))));this.isScrolling=false}await Adapt$1.parentView.renderTo(currentModelId)}if(currentModel&&selector===currentModel.get("_id")){selector=`.${selector}`}}const isElementUnavailable=!$(selector).length;if(isElementUnavailable){logging$1.warn(`router.navigateToElement, selector not found in document: ${selector}`);return}const newLocation=location$1._contentType?location$1._contentType:location$1._currentLocation;Adapt$1.trigger(`${newLocation}:scrollTo`,selector);const disableScrollToAnimation=Adapt$1.config.has("_disableAnimation")?Adapt$1.config.get("_disableAnimation"):false;if(disableScrollToAnimation){settings.duration=0}else if(!settings.duration){settings.duration=$.scrollTo.defaults.duration}const $wrapper=$("#wrapper");let offsetTop=-parseInt($wrapper.css("padding-top"));if($(selector).hasClass("component")){offsetTop-=$(selector).find(".aria-label").height()||0}if(!settings.offset)settings.offset={top:offsetTop,left:0};if(settings.offset.top===undefined)settings.offset.top=offsetTop;if(settings.offset.left===undefined)settings.offset.left=0;if(settings.offset.left===0)settings.axis="y";if(Adapt$1.get("_canScroll")!==false){$.scrollTo(selector,settings)}await new Promise((resolve=>{_.delay((()=>{a11y$1.focusNext(selector);Adapt$1.trigger(`${location$1}:scrolledTo`,selector);resolve()}),settings.duration+300)}))}get(){logging$1.deprecated("router.get, please use router.model.get");return this.model.get(...arguments)}set(){logging$1.deprecated("router.set, please use router.model.set");return this.model.set(...arguments)}}const router=new Router({model:new RouterModel(null,{reset:true})});var router$1=__AMD("core/js/router",router);class Scrolling extends Backbone.Controller{initialize(){this.scrollTo=this.scrollTo.bind(this);this.$html=$("html");this.isLegacyScrolling=true;Adapt$1.once("configModel:dataLoaded",this._loadConfig.bind(this))}_loadConfig(){const config=Adapt$1.config.get("_scrollingContainer");if(!config?._isEnabled)return;const limitTo=config._limitToSelector;const isIncluded=!limitTo||this.$html.is(limitTo)||this.$html.hasClass(limitTo);if(!isIncluded)return;this.isLegacyScrolling=false;this._windowScrollFix();this._addStyling();this._updateScrollbarWidth();this.listenTo(Adapt$1,"device:resize",this._updateScrollbarWidth)}_addStyling(){this.$html.addClass("adapt-scrolling")}_updateScrollbarWidth(){const $tester=$('<div class="outer" style="overflow:scroll; visibility: hidden; position:fixed; top: 0; left: 0;"><div class="inner"> </div></div>"');$("body").append($tester);const scrollBarWidth=$tester.outerWidth()-$tester.find(".inner").outerWidth();$tester.remove();const documentStyle=document.documentElement.style;documentStyle.setProperty("--adapt-scrollbar-width",`${scrollBarWidth}px`)}_windowScrollFix(){const body=document.body;const html=Adapt$1.scrolling.$html[0];const scrollY={get:()=>body.scrollTop,set:value=>body.scrollTop=value};const scrollX={get:()=>body.scrollLeft,set:value=>body.scrollLeft=value};const scrollHeight={get:()=>body.scrollHeight,set:value=>body.scrollHeight=value};const scrollWidth={get:()=>body.scrollWidth,set:value=>body.scrollWidth=value};Object.defineProperties(window,{scrollY:scrollY,scrollX:scrollX,pageYOffset:scrollY,pageXOffset:scrollX});Object.defineProperties(html,{scrollHeight:scrollHeight,scrollWidth:scrollWidth});window.scrollTo=function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}const isObject=args.length===1&&typeof args[0]==="object"&&args[0]!==null;const left=(isObject?args[0].left:args[0])??null;const top=(isObject?args[0].top:args[1])??null;left!==null&&(body.scrollLeft=left);top!==null&&(body.scrollTop=top)};const MouseEvent=window.MouseEvent;Object.defineProperties(MouseEvent.prototype,{pageX:{get:function(){return this.clientX+scrollX.get()}},pageY:{get:function(){return this.clientY+scrollY.get()}}});const $window=$(window);$(document.body).on("scroll",(()=>$window.scroll()))}async scrollTo(selector){let settings=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};logging$1.deprecated("Adapt.scrollTo and Adapt.scrolling.scrollTo, use router.navigateToElement instead.");return router$1.navigateToElement(selector,settings)}}const scrolling=new Scrolling;var scrolling$1=__AMD("core/js/scrolling",scrolling);class StartController extends Backbone.Controller{initialize(){super.initialize(...arguments);this.model=null}loadCourseData(){this.model=new LockingModel(Adapt$1.course.get("_start"))}setStartLocation(){if(!this.isEnabled())return;window.history.replaceState("","",this.getStartHash())}returnToStartLocation(){const startIds=this.model.get("_startIds");if(startIds){startIds.forEach((startId=>startId._skipIfComplete=false))}window.location.hash=this.getStartHash(true)}getStartHash(alwaysForce){const startId=this.getStartId();const isRouteSpecified=window.location.href.indexOf("#")>-1;const shouldForceStartId=alwaysForce||this.model.get("_force");const shouldNavigateToStartId=startId&&(!isRouteSpecified||shouldForceStartId);if(shouldNavigateToStartId&&startId!==Adapt$1.course.get("_id")){return"#/id/"+startId}return window.location.hash||"#/"}isEnabled(){return Boolean(this.model?.get("_isEnabled"))}getStartId(){let startId=this.model.get("_id");const startIds=this.model.get("_startIds");if(!startIds?.length)return startId;const $html=$("html");for(let i=0,l=startIds.length;i<l;i++){const item=startIds[i];const className=item._className;const skipIfComplete=item._skipIfComplete;const model=data$1.findById(item._id);if(!model){console.log("startController: cannot find id",item._id);continue}if(skipIfComplete){if(model.get("_isComplete"))continue}if(!className||$html.is(className)||$html.hasClass(className)){startId=item._id;break}}return startId}}Adapt$1.once("adapt:start",(()=>{startController.loadCourseData();startController.setStartLocation()}));Adapt$1.on("navigation:returnToStart",(()=>{startController.returnToStartLocation()}));Adapt$1.on("app:languageChanged",(()=>{wait$1.for((done=>{startController.loadCourseData();const hash=startController.isEnabled()?startController.getStartHash(false):"#/";router$1.navigate(hash,{trigger:true,replace:true});done()}))}));const startController=new StartController;var startController$1=__AMD("core/js/startController",startController);const COMPLETION_STATE=ENUM(["INCOMPLETE","COMPLETED","PASSED","FAILED"]);var COMPLETION_STATE$1=__AMD("core/js/enums/completionStateEnum",COMPLETION_STATE);class Tracking extends Backbone.Controller{initialize(){this._config={_requireContentCompleted:true,_requireAssessmentCompleted:false,_submitOnEveryAssessmentAttempt:false,_shouldSubmitScore:false};this._assessmentState=null;Adapt$1.once("configModel:dataLoaded",this.loadConfig.bind(this));Adapt$1.on("app:dataReady",this.setupEventListeners.bind(this))}setupEventListeners(){this.listenTo(Adapt$1,{"assessment:complete":this.onAssessmentComplete,"assessment:restored":this.onAssessmentRestored,"scoring:complete":this.onScoringComplete,"scoring:restored":this.onScoringRestored});if(this._config._requireContentCompleted){this.listenTo(Adapt$1.course,"change:_isComplete",this.checkCompletion)}}submitScore(){if(!this._config._shouldSubmitScore)return;offlineStorage$1.set("score",this._assessmentState.score,this._assessmentState.minScore,this._assessmentState.maxScore,this._assessmentState.isPercentageBased)}checkCompletion(){const completionData=this.getCompletionData();if(completionData.status===COMPLETION_STATE$1.INCOMPLETE)return;const canRetry=completionData.assessment?.canRetry;if(!this._config._submitOnEveryAssessmentAttempt&&completionData.status===COMPLETION_STATE$1.FAILED&&canRetry)return;Adapt$1.trigger("tracking:complete",completionData);logging$1.debug("tracking:complete",completionData)}getCompletionData(){const completionData={status:COMPLETION_STATE$1.INCOMPLETE,assessment:null};if(this._config._requireContentCompleted&&!Adapt$1.course.get("_isComplete"))return completionData;if(this._config._requireAssessmentCompleted){if(!this._assessmentState)return completionData;const isPassed=this._assessmentState?.isPass??this._assessmentState?.isPassed;completionData.status=isPassed?COMPLETION_STATE$1.PASSED:COMPLETION_STATE$1.FAILED;completionData.assessment=this._assessmentState;return completionData}completionData.status=COMPLETION_STATE$1.COMPLETED;return completionData}loadConfig(){Object.assign(this._config,Adapt$1.config.get("_completionCriteria"));const newShouldSubmitScore=this._config._shouldSubmitScore;const legacyShouldSubmitScore=Adapt$1.config.get("_spoor")?._tracking?._shouldSubmitScore;if(legacyShouldSubmitScore!==undefined)logging$1.deprecated("config.json:_spoor._tracking._shouldSubmitScore, please use only config.json:_completionCriteria._shouldSubmitScore");this._config._shouldSubmitScore=legacyShouldSubmitScore??newShouldSubmitScore??true}onAssessmentComplete(assessmentState){this.stopListening(Adapt$1,"scoring:complete",this.onScoringComplete);this.onScoringComplete(assessmentState)}onScoringComplete(state){this._assessmentState=state;this.submitScore();if(this._config._requireAssessmentCompleted)this.checkCompletion()}onAssessmentRestored(assessmentState){this.onScoringRestored(assessmentState)}onScoringRestored(state){if(this._assessmentState)return;this._assessmentState=state}}const tracking=new Tracking;var tracking$1=__AMD("core/js/tracking",tracking);const beginWait=()=>{logging$1.deprecated("Use wait.begin() as Adapt.trigger('plugin:beginWait') will be removed in the future");wait$1.begin()};const endWait=()=>{logging$1.deprecated("Use wait.end() as Adapt.trigger('plugin:endWait') will be removed in the future");wait$1.end()};const ready=()=>{if(wait$1.isWaiting()){return}const isEventListening=Adapt$1._events["plugins:ready"];if(!isEventListening){return}logging$1.deprecated("Use wait.queue(callback) as Adapt.on('plugins:ready', callback) will be removed in the future");Adapt$1.trigger("plugins:ready")};Adapt$1.listenTo(wait$1,"ready",ready);Adapt$1.on({"plugin:beginWait":beginWait,"plugin:endWait":endWait});Adapt$1.on({"drawer:remove"(){logging$1.deprecated("Use drawer.remove, Adapt.trigger('drawer:remove') will be removed in the future");drawer.remove()},"drawer:closeDrawer"(){logging$1.deprecated("Use drawer.close, Adapt.trigger('drawer:closeDrawer') will be removed in the future");drawer.close()},"drawer:triggerCustomView"(){logging$1.deprecated("Use drawer.triggerCustomView(), Adapt.trigger('drawer:triggerCustomView') will be removed in the future");drawer.triggerCustomView()}});Object.defineProperties(drawer,{triggerCustomView:{get(){a11y$1.log.deprecated("drawer.triggerCustomView has moved to drawer.openCustomView");return drawer.openCustomView}}});Object.defineProperties(Adapt$1,{accessibility:{get(){a11y$1.log.deprecated("Adapt.accessibility has moved to a11y");return a11y$1}},a11y:{get(){logging$1.deprecated("Adapt.a11y, please use core/js/a11y directly");return a11y$1}},componentStore:{get(){logging$1.deprecated("Adapt.componentStore, please use core/js/components directly");return components$1._register}},data:{get(){logging$1.deprecated("Adapt.data, please use core/js/data directly");return data$1}},device:{get(){logging$1.deprecated("device, please use core/js/device directly");return device$1}},drawer:{get(){logging$1.deprecated("Adapt.drawer, please use core/js/drawer directly");return drawer}},findById:{get(){logging$1.deprecated("Adapt.findById, please use data.findById directly");return data$1.findById}},findViewByModelId:{get(){logging$1.deprecated("Adapt.findViewByModelId, please use data.findViewByModelId directly");return data$1.findViewByModelId}},findByTrackingPosition:{get(){logging$1.deprecated("Adapt.findByTrackingPosition, please use data.findByTrackingPosition directly");return data$1.findByTrackingPosition}},getViewName:{get(){logging$1.deprecated("Adapt.getViewName, please use components.getViewName instead");return components$1.getViewName}},getViewClass:{get(){logging$1.deprecated("Adapt.getViewClass, please use components.getViewClass instead");return components$1.getViewClass}},getModelName:{get(){logging$1.deprecated("Adapt.getModelName, please use components.getModelName instead");return components$1.getModelName}},getModelClass:{get(){logging$1.deprecated("Adapt.getModelClass, please use components.getModelClass instead");return components$1.getModelClass}},location:{get(){logging$1.deprecated("Adapt.location, please use core/js/location directly");return location$1}},log:{get(){logging$1.deprecated("Adapt.log, please use core/js/logging directly");return logging$1}},mpabc:{get(){logging$1.deprecated("Adapt.mpabc, please use core/js/mpabc directly");return mpabc$1}},notify:{get(){logging$1.deprecated("Adapt.notify, please use core/js/notify directly");return notify$1}},offlineStorage:{get(){logging$1.deprecated("offlineStorage, please use src/core/offlineStorage instead");return offlineStorage$1}},navigateToElement:{get(){logging$1.deprecated("Adapt.navigateToElement, please use router.navigateToElement");return router$1.navigateToElement}},register:{get(){logging$1.deprecated("Adapt.register, please use components.register instead");return components$1.register}},router:{get(){logging$1.deprecated("Adapt.router, please use core/js/router directly");return router$1}},scrolling:{get(){logging$1.deprecated("Adapt.scrolling, please use core/js/scrolling directly");return scrolling$1}},scrollTo:{get(){logging$1.deprecated("Adapt.scrollTo, please use router.navigateToElement");return scrolling$1.scrollTo}},startController:{get(){logging$1.deprecated("Adapt.startController, please use core/js/startController directly");return startController$1}},store:{get(){logging$1.deprecated("Adapt.store, please use core/js/components directly");return components$1._register}},tracking:{get(){logging$1.deprecated("Adapt.tracking, please use core/js/tracking directly");return tracking$1}},wait:{get(){logging$1.deprecated("Adapt.wait, please use src/core/wait instead");return wait$1}}});function onRender(cb){const intercept=(object,name,mode,cb)=>object[name]=cb.bind(object,object[name],name,mode);Object.keys(Handlebars.templates).forEach((name=>{intercept(Handlebars.templates,name,"template",cb)}));Object.keys(Handlebars.partials).forEach((name=>{intercept(Handlebars.partials,name,"partial",cb)}))}onRender((function(template,name,mode){for(var _len=arguments.length,args=new Array(_len>3?_len-3:0),_key=3;_key<_len;_key++){args[_key-3]=arguments[_key]}const preRenderEvent=new TemplateRenderEvent(`${mode}:preRender`,name,mode,null,args);Adapt$1.trigger(preRenderEvent.type,preRenderEvent);const value=template(...preRenderEvent.args);const postRenderEvent=new TemplateRenderEvent(`${mode}:postRender`,name,mode,value,preRenderEvent.args);Adapt$1.trigger(postRenderEvent.type,postRenderEvent);return postRenderEvent.value}));Adapt$1.on("app:dataReady",(()=>{const config=Adapt$1.config.get("_fixes");if(config?._imgLazyLoad===false)return;applyImgLoadingFix()}));function applyImgLoadingFix(){const findImgTag=/<img([^>]*)>/gi;const hasLoadingAttr=/ loading=/gi;Adapt$1.on("template:postRender partial:postRender",(event=>{const imgTagsFound=event.value.match(findImgTag);if(!imgTagsFound){return}event.value=imgTagsFound.reduce(((value,img)=>{if(hasLoadingAttr.test(img)){return value}return value.replace(img,img.replace(findImgTag,'<img loading="eager"$1>'))}),event.value)}));Adapt$1.on("reactElement:preRender",(event=>{if(event.name!=="img")return;const options=event.args[1]=event.args[1]||{};if(options&&options.hasOwnProperty("loading"))return;options.loading="eager"}))}Adapt$1.on("app:dataReady",(()=>{const config=Adapt$1.config.get("_fixes");if(config?._jsxReactHelpersHTML===false)return;applyReactHelpersHTML()}));function applyReactHelpersHTML(){Adapt$1.on("reactElement:preRender",(event=>{let[tagName,props,...children]=event.args;if(!children)return;if(!Array.isArray(children))children=[children];children=children.filter(Boolean);const hasSomeUnsafeConversions=children.some((c=>c?.__html));if(!hasSomeUnsafeConversions)return;const hasManyChildren=children.length>1;if(hasManyChildren){event.args=event.args.map((child=>{if(!child||!child.__html)return child;const attributes=Object.entries(props).map((_ref=>{let[name,value]=_ref;return`${name}="${value}"`})).join(" ");logging$1.warnOnce(`html() call should be the only child in its parent <${tagName} ${attributes}>`);return child.__html?HTMLReactParser__default["default"](child.__html):undefined}));return}props=event.args[1]=event.args[1]||{};props.dangerouslySetInnerHTML=children[0];event.args.length=2}))}Adapt$1.on("app:dataReady",(()=>{const config=Adapt$1.config.get("_fixes");if(config?._safariLabelClickBlur===false)return;applySafariLabelClickBlur()}));function onLabelClick(event){const input=document.querySelector(`[id="${event.currentTarget.getAttribute("for")}"]`);if(!input)return;event.preventDefault();input.click()}function applySafariLabelClickBlur(){Adapt$1.on("reactElement:preRender",(event=>{const[tagName,props]=event.args;if(tagName!=="label"||!Object.hasOwn(props,"htmlFor")||Object.hasOwn(props,"onClick"))return;props.onClick=onLabelClick}))}const helpers$1={lowercase(text){return text.toLowerCase()},capitalise(text){return text.charAt(0).toUpperCase()+text.slice(1)},inc(index){return index+1},dec(index){return index-1},odd(index){return(index+1)%2===0?"even":"odd"},equals(value,text,block){return helpers$1.compare.call(this,value,"==",text,block)},compare(value,operator,text,block){switch(operator){case"===":if(value===text)return block.fn?block.fn(this):true;break;case"=":case"==":if(value==text)return block.fn?block.fn(this):true;break;case">=":if(value>=text)return block.fn?block.fn(this):true;break;case"<=":if(value<=text)return block.fn?block.fn(this):true;break;case">":if(value>text)return block.fn?block.fn(this):true;break;case"<":if(value<text)return block.fn?block.fn(this):true;break}return block.inverse?block.inverse(this):false},math(lvalue,operator,rvalue,options){lvalue=parseFloat(lvalue);rvalue=parseFloat(rvalue);switch(operator){case"+":return lvalue+rvalue;case"-":return lvalue-rvalue;case"*":return lvalue*rvalue;case"/":return lvalue/rvalue;case"%":return lvalue%rvalue}},any(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}const specified=args.slice(0,-1);const block=args.slice(-1)[0];return specified.some(Boolean)?block.fn?block.fn(this):true:block.inverse?block.inverse(this):false},all(){for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++){args[_key2]=arguments[_key2]}const specified=args.slice(0,-1);const block=args.slice(-1)[0];return specified.every(Boolean)?block.fn?block.fn(this):true:block.inverse?block.inverse(this):false},none(){for(var _len3=arguments.length,args=new Array(_len3),_key3=0;_key3<_len3;_key3++){args[_key3]=arguments[_key3]}const specified=args.slice(0,-1);const block=args.slice(-1)[0];return!specified.some(Boolean)?block.fn?block.fn(this):true:block.inverse?block.inverse(this):false},compile(template,context){if(!template)return"";if(template instanceof Object)template=template.toString();const data=context?.data?.root?this:context;return Handlebars.compile(template)(data)},compile_a11y_text(template,context){logging$1.deprecated("a11y_text is no longer required. https://tink.uk/understanding-screen-reader-interaction-modes/");return helpers$1.compile.call(this,template,context)},compile_a11y_normalize(template,context){if(!template){return""}if(template instanceof Object)template=template.toString();return Handlebars.helpers.a11y_normalize.call(this,helpers$1.compile.call(this,template,context))},compile_a11y_remove_breaks(template,context){if(!template){return""}return Handlebars.helpers.a11y_remove_breaks.call(this,helpers$1.compile.call(this,template,context))},import_globals(context){if(context.data.root._globals){return""}context.data.root._globals=Adapt$1.course.get("_globals");return""},import_adapt(context){if(context.data.root.Adapt){return}const adapt=context.data.root.Adapt={};let i,l,name;const directImport=["config","course"];for(i=0,l=directImport.length;i<l;i++){name=directImport[i];adapt[name]=Adapt$1[name].toJSON()}const indexedImport=["contentObjects","articles","blocks","components"];for(i=0,l=indexedImport.length;i<l;i++){name=indexedImport[i];const importArray=Adapt$1[name].toJSON();const importIndex={};for(let i1=0,l1=importArray.length;i1<l1;i1++){const item=importArray[i1];importIndex[item._id]=item}adapt[name]=importIndex}return""},component_description(override,context){if(!this._isA11yComponentDescriptionEnabled){return}const isNotDefined=!this._globals._components?.["_"+this._component];if(isNotDefined){return}const hasOverride=arguments.length>1;let description;if(hasOverride){description=override;description=helpers$1.compile(description,context)}else{description=this._globals._components["_"+this._component].ariaRegion;description=helpers$1.compile(description,override)}if(!description){return}return new Handlebars.SafeString('<div class="aria-label">'+description+"</div>")},a11y_text(text){logging$1.deprecated("a11y_text is no longer required. https://tink.uk/understanding-screen-reader-interaction-modes/");return text},a11y_normalize(htmls){return a11y$1.normalize.apply(a11y$1,arguments)},a11y_remove_breaks(htmls){return a11y$1.removeBreaks.apply(a11y$1,arguments)},a11y_aria_label(htmls){let values=Array.prototype.slice.call(arguments,0,-1);values=values.filter(Boolean);return new Handlebars.SafeString('<div class="aria-label">'+values.join(" ")+"</div>")},a11y_aria_label_relative(htmls){let values=Array.prototype.slice.call(arguments,0,-1);values=values.filter(Boolean);return new Handlebars.SafeString('<div class="aria-label relative">'+values.join(" ")+"</div>")},a11y_aria_image(texts){let values=Array.prototype.slice.call(arguments,0,-1);values=values.filter(Boolean);return new Handlebars.SafeString('<div class="aria-label" role="img" aria-label="'+values.join(" ")+'"></div>')},a11y_wrap_focus(){const cfg=Adapt$1.config.get("_accessibility");if(cfg._isPopupWrapFocusEnabled===false)return"";return new Handlebars.SafeString('<a class="a11y-focusguard a11y-ignore a11y-ignore-focus" tabindex="0" role="presentation">&nbsp;</a>')},a11y_attrs_heading(level){logging$1.deprecated("a11y_attrs_heading, please use a11y_aria_level or a11y.ariaLevel");const resolvedLevel=a11y$1.ariaLevel({id:this._id??Array.from(arguments).lastItem?.data?.root?._id,level:level,override:this._ariaLevel});return new Handlebars.SafeString(` role="heading" aria-level="${resolvedLevel}" `)},a11y_aria_level(id,level){let override=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;const resolvedLevel=a11y$1.ariaLevel({id:id,level:level,override:override});return resolvedLevel},a11y_attrs_tabbable(){logging$1.deprecated("a11y_attrs_tabbable should not be used. tabbable elements should be natively tabbable.");return new Handlebars.SafeString(' role="region" tabindex="0" ')},a11y_alt_text(visible,alternatives){let values=Array.prototype.slice.call(arguments,1,-1);values=values.filter(Boolean);return new Handlebars.SafeString('<span aria-hidden="true">'+visible+'</span><span class="aria-label">'+values.join(" ")+"</span>")}};Object.assign(helpers$1,{if_value_equals(){logging$1.deprecated("if_value_equals, use equals instead.");return helpers$1.equals.apply(this,arguments)},numbers(){logging$1.deprecated("numbers, use inc instead.");return helpers$1.inc.apply(this,arguments)},lowerCase(){logging$1.deprecated("lowerCase, use lowercase instead.");return helpers$1.lowercase.apply(this,arguments)}});for(const name in helpers$1){Handlebars.registerHelper(name,helpers$1[name])}__AMD("core/js/helpers",helpers$1);class HeadingView extends Backbone.View{initialize(){this.listenTo(Adapt$1.parentView,"postRemove",this.remove);this.listenTo(this.model,"change:_isComplete",this.updateAria);this.render()}render(){const template=Handlebars.templates[this.constructor.template];const data=this.model.toJSON();const customHeadingType=this.$el.attr("data-a11y-heading-type");const isBackwardCompatible=[...this.$el[0].classList].every((name=>!name.includes("-inner")));data._isBackwardCompatible=isBackwardCompatible;if(customHeadingType)data._type=customHeadingType;if(data._type==="course")data._type="menu";this.$el.html(template(data));this.checkCompletion()}updateAria(){const template=Handlebars.templates[this.constructor.template];const data=this.model.toJSON();const $rendered=$(`<div>${template(data)}</div>`);this.$(".aria-label").html($rendered.find(".aria-label").html());this.checkCompletion()}checkCompletion(){const isComplete=this.model.get("_isComplete");if(isComplete===undefined)return;this.$el.toggleClass("is-complete",isComplete).toggleClass("is-incomplete",!isComplete)}}HeadingView.template="heading";var HeadingView$1=__AMD("core/js/views/headingView",HeadingView);class Headings extends Backbone.Controller{initialize(){this.listenTo(Adapt$1,"view:render",this.onViewRender)}onViewRender(view){const $headingSeats=view.$(".js-heading");$headingSeats.each(((index,el)=>new HeadingView$1({el:el,model:view.model})))}}__AMD("core/js/headings",new Headings);var NavigationButtonView=__AMD("core/js/views/NavigationButtonView",class NavigationButtonView extends Backbone.View{tagName(){return"button"}events(){return{click:"triggerEvent"}}className(){if(this.isInjectedButton){return[this.model.get("_showLabel")===false&&"hide-label"].filter(Boolean).join(" ")}return["btn-icon nav__btn",this.model.get("_classes"),this.model.get("_showLabel")===false&&"hide-label"].filter(Boolean).join(" ")}attributes(){const attributes=this.model.toJSON();if(this.isInjectedButton){return{name:attributes._id,"data-order":attributes._order,"data-event":attributes._event}}return{name:attributes._id,role:attributes._role==="button"?undefined:attributes._role,"aria-label":attributes.ariaLabel,"data-order":attributes._order,"data-event":attributes._event}}initialize(_ref){let{el:el}=_ref;if(el){this.isInjectedButton=true}else{this.isJSX=(this.constructor.template||"").includes(".jsx")}this._classSet=new Set(_.result(this,"className").trim().split(/\s+/));this._attributes=_.result(this,"attributes");this.listenTo(this.model,"change",this.changed);this.render()}static get template(){return"navButton.jsx"}render(){if(this.isInjectedButton){this.changed()}else if(this.isJSX){this.changed()}else{const data=this.model.toJSON();data.view=this;const template=Handlebars.templates[this.constructor.template];this.$el.html(template(data))}return this}updateViewProperties(){const classesToAdd=_.result(this,"className").trim().split(/\s+/);classesToAdd.forEach((i=>this._classSet.add(i)));const classesToRemove=[...this._classSet].filter((i=>!classesToAdd.includes(i)));classesToRemove.forEach((i=>this._classSet.delete(i)));Object.keys(this._attributes).forEach((name=>this.$el.removeAttr(name)));Object.entries(_.result(this,"attributes")).forEach((_ref2=>{let[name,value]=_ref2;return this.$el.attr(name,value)}));this.$el.removeClass(classesToRemove).addClass(classesToAdd)}injectLabel(){const textLabel=this.$el.find("> .nav__btn-label");const ariaLabel=this.$el.attr("aria-label")??this.$el.find(".aria-label").text();const text=this.model.get("text");const output=compile(text??"",{ariaLabel:ariaLabel});if(!textLabel.length){this.$el.append(`<span class="nav__btn-label" aria-hidden="true">${output}</span>`);return}textLabel.html(output)}changed(){let eventName=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;if(typeof eventName==="string"&&eventName.startsWith("bubble")){return}if(this.isInjectedButton){this.updateViewProperties();this.injectLabel();return}if(!this.isJSX){this.updateViewProperties();return}const props={...this,...this.model.toJSON(),_globals:Adapt$1.course?.get("_globals")};const Template=templates[this.constructor.template.replace(".jsx","")];this.updateViewProperties();ReactDOM__default["default"].render(React__default["default"].createElement(Template,props),this.el)}triggerEvent(event){event.preventDefault();const currentEvent=$(event.currentTarget).attr("data-event");if(!currentEvent)return;Adapt$1.trigger("navigation:"+currentEvent);switch(currentEvent){case"backButton":router$1.navigateToPreviousRoute();break;case"homeButton":router$1.navigateToHomeRoute();break;case"parentButton":router$1.navigateToParent();break;case"skipNavigation":a11y$1.focusFirst("."+location$1._contentType);break;case"returnToStart":startController$1.returnToStartLocation();break}}remove(){this._isRemoved=true;this.stopListening();wait$1.for((end=>{if(this.isJSX){ReactDOM__default["default"].unmountComponentAtNode(this.el)}super.remove();end()}));return this}});var NavigationButtonModel=__AMD("core/js/models/NavigationButtonModel",class NavigationButtonModel extends LockingModel{defaults(){return{_id:"",_classes:"",_iconClasses:"",_order:0,_event:"",_showLabel:null,_role:"button",ariaLabel:"",text:"{{ariaLabel}}"}}});class NavigationView$1 extends Backbone.View{className(){return["nav",this.model?.get("_showLabel")===true?"show-label":"hide-label",`show-label-${this.model?.get("_showLabelAtWidth")||"medium"}`,`has-label-${this.model?.get("_labelPosition")||"auto"}`].filter(Boolean).join(" ")}attributes(){return{role:"navigation"}}get buttons(){return this._buttons=this._buttons||[]}set buttons(value){this._buttons=value}initialize(){___default["default"].bindAll(this,"sortNavigationButtons");this._classSet=new Set(___default["default"].result(this,"className").trim().split(/\s+/))}start(model){tooltips$1.register({_id:"back",...Adapt$1.course.get("_globals")?._extensions?._navigation?._backNavTooltip||{}});this.model=model;this.listenTo(model,"change",this.update);this.listenToOnce(Adapt$1,"courseModel:dataLoading",this.remove);this.listenTo(Adapt$1,{"router:contentObject":this.hideNavigationButton,"adapt:preInitialize device:resize":this.onDeviceResize});this.update();this.preRender()}update(){this.updateViewProperties();this.onDeviceResize()}onDeviceResize(){let{_navigationAlignment:_navigationAlignment="top",_isBottomOnTouchDevices:_isBottomOnTouchDevices=false}=this.model.toJSON();const $html=$("html");const isBottomOnTouchDevices=device$1.touch&&_isBottomOnTouchDevices;if(isBottomOnTouchDevices)_navigationAlignment="bottom";$html.removeClass("is-nav-top is-nav-bottom").addClass("is-nav-"+_navigationAlignment)}preRender(){Adapt$1.trigger("navigationView:preRender",this);this.render()}render(){const template=Handlebars.templates[this.constructor.template];this.$el.html(template({_config:Adapt$1.config.toJSON(),_globals:Adapt$1.course.get("_globals"),_accessibility:Adapt$1.config.get("_accessibility")})).insertBefore("#app");this.sortNavigationButtons();___default["default"].defer((()=>{Adapt$1.trigger("navigationView:postRender navigation:ready",this)}));return this}updateViewProperties(){const classesToAdd=___default["default"].result(this,"className").trim().split(/\s+/);classesToAdd.forEach((i=>this._classSet.add(i)));const classesToRemove=[...this._classSet].filter((i=>!classesToAdd.includes(i)));classesToRemove.forEach((i=>this._classSet.delete(i)));this._setAttributes({...___default["default"].result(this,"attributes"),id:___default["default"].result(this,"id")});this.$el.removeClass(classesToRemove).addClass(classesToAdd)}listenForInjectedButtons(){this.observer=this.observer||new MutationObserver(this.sortNavigationButtons);this.observer.observe(this.$(".nav__inner")[0],{childList:true,attributes:true,subtree:true})}sortNavigationButtons(changed){if(Array.isArray(changed)){const changes=Object.entries(changed.reduce(((changes,change)=>{const changeTypeName=`${change.type}.${change.attributeName}`;changes[changeTypeName]=changes[changeTypeName]||0;changes[changeTypeName]++;return changes}),{}));const shouldIgnore=changes.every((_ref=>{let[key]=_ref;return["attributes.data-a11y-force-focus","attributes.tabindex","attributes.aria-hidden","attributes.aria-expanded"].includes(key)}));if(shouldIgnore)return}this.observer?.disconnect();const $container=this.$(".nav__inner");const items=[...$container[0].children];const identifiers={".js-nav-drawer-btn":"drawer",".js-nav-back-btn":"back",".js-nav-home-btn":"home","*":null};items.forEach((el=>{const $el=$(el);if($el.is(".nav__spacer"))return;const foundId=($el.attr("name")??Object.entries(identifiers).find((_ref2=>{let[classes]=_ref2;return $el.is(classes)}))?.[1])||$el.attr("class");const attributes={_id:foundId,_order:parseFloat($el.attr("data-order")||0),_event:$el.attr("data-event")};const existingButton=this.getButton(attributes._id);if(existingButton){if(!existingButton.isInjectedButton)return;if(existingButton.el!==el){existingButton.undelegateEvents();existingButton.el=el;existingButton.$el=$(el);existingButton.delegateEvents()}existingButton.model.set(attributes);existingButton.changed();return}const navigationButtonModel=new NavigationButtonModel(attributes);this.addButton(new NavigationButtonView({el:el,model:navigationButtonModel}))}));const focusElement=document.activeElement;items.sort(((a,b)=>parseFloat($(a).attr("data-order")||0)-parseFloat($(b).attr("data-order")||0)));let indexOfFocused=items.findIndex((el=>el===focusElement));if(indexOfFocused===-1)indexOfFocused=Infinity;const before=items.slice(0,indexOfFocused);const after=items.slice(indexOfFocused+1);before.reverse().forEach((el=>$container.prepend(el)));after.forEach((el=>$container.append(el)));this.observer?.takeRecords();this.listenForInjectedButtons()}hideNavigationButton(contentObjectModel){const shouldHide=contentObjectModel.get("_type")==="course";this.$(".nav__back-btn, .nav__home-btn").toggleClass("u-display-none",shouldHide)}showNavigationButton(){this.$(".nav__back-btn, .nav__home-btn").removeClass("u-display-none")}addButton(buttonView){this.buttons.push(buttonView);const container=this.$(".nav__inner");container.append(buttonView.$el);this.listenTo(buttonView.model,"change",this.sortNavigationButtons);if(buttonView.isInjectedButton)return;this.sortNavigationButtons()}getButton(id){return this.buttons.find((button=>button.model.get("_id")===id))}removeButton(buttonView){this.buttons=this.buttons.filter((view=>view!==buttonView));this.stopListening(buttonView.model,"change",this.sortNavigationButtons);if(buttonView.isInjectedButton){buttonView.$el.remove();return}buttonView.remove()}}NavigationView$1.template="nav";var NavigationView$2=__AMD("core/js/views/navigationView",NavigationView$1);var NavigationModel=__AMD("core/js/models/NavigationModel",class NavigationModel extends LockingModel{defaults(){return{_navigationAlignment:"top",_isBottomOnTouchDevices:false,_showLabel:false,_showLabelAtWidth:"medium",_labelPosition:"auto"}}});class NavigationController extends Backbone.Controller{initialize(){this.navigation=new NavigationView$2;this.listenTo(Adapt$1,"adapt:preInitialize",this.addNavigationBar)}addNavigationBar(){const adaptConfig=Adapt$1.course.get("_navigation");if(adaptConfig?._isDefaultNavigationDisabled){Adapt$1.trigger("navigation:initialize");return}this.navigation.start(new NavigationModel(adaptConfig))}}__AMD("core/js/navigation",Adapt$1.navigation=(new NavigationController).navigation);class ComponentView extends AdaptView$1{attributes(){if(!this.model.get("_isA11yRegionEnabled")){return AdaptView$1.resultExtend("attributes",{},this)}return AdaptView$1.resultExtend("attributes",{"aria-labelledby":this.model.get("_id")+"-heading",role:"region"},this)}className(){return["component",this.model.get("_component").toLowerCase(),this.model.get("_id"),this.model.get("_classes"),this.setVisibility(),this.setHidden(),"is-"+this.model.get("_layout"),this.model.get("_isComplete")?"is-complete":"",this.model.get("_isOptional")?"is-optional":""].join(" ")}renderState(){logging$1.removed("renderState is removed and moved to item title")}setupInviewCompletion(){let inviewElementSelector=arguments.length>0&&arguments[0]!==undefined?arguments[0]:".component__inner";let callback=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.setCompletionStatus;this.$inviewElement=this.$(inviewElementSelector);this.inviewCallback=callback;this.$inviewElement.on("inview.componentView",this.onInview.bind(this))}removeInviewListener(){if(!this.$inviewElement)return;this.$inviewElement.off("inview.componentView");this.$inviewElement=null}onInview(event,visible,visiblePartX,visiblePartY){if(!visible)return;switch(visiblePartY){case"top":this.hasSeenTop=true;break;case"bottom":this.hasSeenBottom=true;break;case"both":this.hasSeenTop=this.hasSeenBottom=true}if(!this.hasSeenTop||!this.hasSeenBottom)return;this.inviewCallback();if(this.model.get("_isComplete")){this.removeInviewListener()}}postRender(){}remove(){this.removeInviewListener();super.remove()}}ComponentView.type="component";var ComponentView$1=__AMD("core/js/views/componentView",ComponentView);var Chat=ComponentView$1.extend({events:{"click .chat-next":"nextItem"},preRender:function(){this.model.set("_stage",-1);this.setupButton()},postRender:function(){if(!this.model.get("_isComplete")||this.model.get("_isResetOnRevisit"))this.setupListItems();this.setReadyStatus()},setupButton:function(){var _button=this.model.get("_button")||{};if(!_button.startText)_button.startText="Click here to begin";if(!_button.continueText)_button.continueText="Next";this.model.set("_button",_button)},setupListItems:function(){this.$(".chat-lines");var $items=this.$(".chat-line");var wWin=$(window).width();var context=this;$items.each((function(i){var $el=$items.eq(i);var animateLeft;if(context.model.get("_singleParticipant")){animateLeft=true}else{animateLeft=context.model.get("_items")[i]._participant!=0}var offset=$el.offset();offset.left=animateLeft?-($el.outerWidth()+10):wWin+10;$el.offset(offset).hide()}));this.$(".chat-button").show();_.each(this.model.get("_items"),(function(item,index){context.setImage(index,item)}))},setImage:function(index,item){var $icon=this.$(".chat-icon-inner").get(index);$($icon).attr("src",this.model.get("_participants")[item._participant]._icon);var $name=this.$(".chat-icon-name").get(index);$($name).html(this.model.get("_participants")[item._participant].name)},nextItem:function(){var stage=this.model.get("_stage")+1;this.setStage(stage)},setStage:function(stage){this.model.set("_stage",stage);this.$(".chat-next").hide();var context=this;Adapt$1.log.debug(context.model.get("_items")[stage]._timeToShow);setTimeout((function(){if(context.model.get("_items")[stage]._button._isEnabled||stage===0){var continueText=context.model.get("_items")[stage]._button.buttonText||"Start";context.$(".chat-next").html(continueText)}context.showNextStage(stage)}),context.model.get("_items")[stage]._timeToShow*1e3)},showNextStage:function(stage){var $item=this.$(".chat-line").eq(stage);$item.show();var h=$item.outerHeight(true);this.$(".chat-button").css({top:"+="+h});setTimeout((function(){$item.css({left:0})}),250);if(this.model.get("_items").length-1===stage){this.onComplete();this.$(".chat-icon-name").show().a11y_focus()}else if(this.checkNextButton(stage+1)){this.$(".chat-next").show()}else{this.nextItem()}},checkNextButton:function(nextStage){return this.model.get("_items")[nextStage]._button._isEnabled},onComplete:function(){var $button=this.$(".chat-button");$button.css({top:$(window).height()});setTimeout((function(){$button.remove()}),500);this.setCompletionStatus()}});Adapt$1.register("chat",Chat);__AMD("components/adapt-chat/js/adapt-chat",Chat);var Tidbits=ComponentView$1.extend({events:{"click .tidbit-trigger":"onClickTriggerTidbit"},preRender:function(){this.checkIfResetOnRevisit()},postRender:function(){this.setReadyStatus();this.setupInview();this.removeBitColor()},removeBitColor:function(){var links=this.$(".tidbit-trigger");var bits=this.model.get("_tidbits");_.each(bits,(function(bit,index){if(bit._isVisited){$(links[index]).removeClass("tidbit-color")}}))},onClickTriggerTidbit:function(event){if(event&&event.preventDefault)event.preventDefault();var bitnum=Number($(event.currentTarget).data("bitnum"));var bit=this.model.get("_tidbits")[bitnum];var popupObject={title:bit.theTitle,body:bit.theBody};Adapt$1.trigger("notify:popup",popupObject);Adapt$1.trigger("popup:opened");this.visitedBit(bitnum);$(event.currentTarget).removeClass("tidbit-color")},visitedBit:function(n){var bit=this.model.get("_tidbits")[n];bit._isVisited=true;this.checkDone()},getRequiredBits:function(){return _.filter(this.model.get("_tidbits"),(function(bit){return bit._isRequired}))},checkDone:function(){var rBits=this.getRequiredBits();var vBits=_.filter(rBits,(function(bit){return bit._isVisited}));if(rBits.length===vBits.length){this.setCompletionStatus()}},setupInview:function(){var selector=this.getInviewElementSelector();if(!selector);else{this.model.set("inviewElementSelector",selector);this.$(selector).on("inview",_.bind(this.inview,this))}},getInviewElementSelector:function(){if(this.model.get("body"))return".component-body";if(this.model.get("instruction"))return".component-instruction";if(this.model.get("displayTitle"))return".component-title";return null},checkIfResetOnRevisit:function(){var isResetOnRevisit=this.model.get("_isResetOnRevisit");if(isResetOnRevisit){this.model.reset(isResetOnRevisit)}},inview:function(event,visible,visiblePartX,visiblePartY){if(visible){if(visiblePartY==="top"){this._isVisibleTop=true}else if(visiblePartY==="bottom"){this._isVisibleBottom=true}else{this._isVisibleTop=true;this._isVisibleBottom=true}if(this._isVisibleTop&&this._isVisibleBottom){this.$(this.model.get("inviewElementSelector")).off("inview");var rBits=this.getRequiredBits();if(rBits.length===0){this.setCompletionStatus()}}}},remove:function(){if(this.model.has("inviewElementSelector")){this.$(this.model.get("inviewElementSelector")).off("inview")}ComponentView$1.prototype.remove.call(this)}},{template:"tidbits"});Adapt$1.register("tidbits",Tidbits);__AMD("components/adapt-component-tidbits/js/adapt-component-tidbits",Tidbits);var ItemModel=__AMD("core/js/models/itemModel",class ItemModel extends LockingModel{defaults(){return{_isActive:false,_isVisited:false,_score:0}}reset(){this.set({_isActive:false,_isVisited:false})}toggleActive(){let isActive=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!this.get("_isActive");this.set("_isActive",isActive)}toggleVisited(){let isVisited=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!this.get("_isVisited");this.set("_isVisited",isVisited)}});var ItemsComponentModel=__AMD("core/js/models/itemsComponentModel",class ItemsComponentModel extends ComponentModel$1{toJSON(){const json=super.toJSON();json._items=this.getChildren().toJSON();return json}init(){this.setUpItems();this.listenTo(this.getChildren(),{all:this.onAll,"change:_isActive":this.setVisitedStatus,"change:_isVisited":this.checkCompletionStatus});super.init()}restoreUserAnswers(){const booleanArray=this.get("_userAnswer");if(!booleanArray)return;this.getChildren().forEach(((child,index)=>child.set("_isVisited",booleanArray[index])))}storeUserAnswer(){const booleanArray=this.getChildren().map((child=>child.get("_isVisited")));this.set("_userAnswer",booleanArray)}setUpItems(){const items=this.get("_items")||[];items.forEach(((item,index)=>item._index=index));this.setChildren(new Backbone.Collection(items,{model:ItemModel}))}getItem(index){return this.getChildren().findWhere({_index:index})}getVisitedItems(){return this.getChildren().where({_isVisited:true})}getActiveItems(){return this.getChildren().where({_isActive:true})}getActiveItem(){return this.getChildren().findWhere({_isActive:true})}areAllItemsCompleted(){return this.getVisitedItems().length===this.getChildren().length}checkCompletionStatus(){this.setVisitedStatus();this.storeUserAnswer();if(!this.areAllItemsCompleted())return;this.setCompletionStatus()}reset(){let type=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"hard";let canReset=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.get("_canReset");const wasReset=super.reset(type,canReset);if(!wasReset)return false;this.getChildren().each((item=>item.reset()));return true}resetActiveItems(){this.getChildren().each((item=>item.toggleActive(false)))}setActiveItem(index){const item=this.getItem(index);if(!item)return;const activeItem=this.getActiveItem();if(activeItem)activeItem.toggleActive(false);item.toggleActive(true)}});var AccordionModel=__AMD("components/adapt-contrib-accordion/js/AccordionModel",class AccordionModel extends ItemsComponentModel{defaults(){return ItemsComponentModel.resultExtend("defaults",{_shouldCollapseItems:true,_shouldExpandFirstItem:false,_toggleSpeed:200})}checkIfResetOnRevisit(){this.resetActiveItems();super.checkIfResetOnRevisit();this.checkExpandFirstItem()}toggleItemsState(index){const item=this.getItem(index);const previousActiveItem=this.getActiveItem();item.toggleActive();item.toggleVisited(true);if(!previousActiveItem||!this.get("_shouldCollapseItems"))return;previousActiveItem.toggleActive(false)}checkExpandFirstItem(){if(!this.get("_shouldExpandFirstItem"))return;this.toggleItemsState(0)}});class AccordionView extends ComponentView$1{preRender(){this.onClick=this.onClick.bind(this);this.listenTo(this.model.getChildren(),"change:_isActive",this.onItemsActiveChange)}postRender(){this.getItemElement(this.model.getActiveItem())?.find(".js-accordion-item-content")?.css("display","block");this.setReadyStatus();if(this.model.get("_setCompletionOn")!=="inview")return;this.setupInviewCompletion()}onClick(event){this.model.toggleItemsState($(event.currentTarget).parents(".js-accordion-item").data("index"))}onItemsActiveChange(item,isActive){this.toggleItem(item,isActive)}toggleItem(item,shouldExpand){const $item=this.getItemElement(item);const $body=$item.children(".js-accordion-item-content").stop(true,true);if(!shouldExpand){$body.slideUp(this.model.get("_toggleSpeed"));return}$body.slideDown(this.model.get("_toggleSpeed"))}getItemElement(item){if(!item)return;const index=item.get("_index");return this.$(".js-accordion-item").filter(`[data-index="${index}"]`)}}AccordionView.template="accordion.jsx";var AccordionView$1=__AMD("components/adapt-contrib-accordion/js/AccordionView",AccordionView);__AMD("components/adapt-contrib-accordion/js/adapt-contrib-accordion",components$1.register("accordion",{model:AccordionModel,view:AccordionView$1}));var AssessmentResultsModel=__AMD("components/adapt-contrib-assessmentResults/js/assessmentResultsModel",class AssessmentResultsModel extends ComponentModel$1{init(){this.set("originalBody",this.get("body"));this.listenTo(Adapt$1,{"assessments:complete":this.onAssessmentComplete,"assessments:reset":this.onAssessmentReset});super.init(...arguments)}checkIfAssessmentComplete(){if(!Adapt$1.assessment||this.get("_assessmentId")===undefined){return}const assessmentModel=Adapt$1.assessment.get(this.get("_assessmentId"));if(!assessmentModel||assessmentModel.length===0)return;const state=assessmentModel.getState();const isResetOnRevisit=assessmentModel.get("_assessment")._isResetOnRevisit;if(state.isComplete&&(!state.allowResetIfPassed||!isResetOnRevisit)){this.onAssessmentComplete(state);return}this.setVisibility()}onAssessmentComplete(state){if(this.get("_assessmentId")===undefined||this.get("_assessmentId")!==state.id)return;this._state=state;this.set({attempts:state.attempts,attemptsSpent:state.attemptsSpent,attemptsLeft:state.attemptsLeft,score:state.score,scoreAsPercent:state.scoreAsPercent,maxScore:state.maxScore,isPass:state.isPass});this.setFeedbackBand(state);this.checkRetryEnabled(state);this.setFeedbackText();this.toggleVisibility(true)}setFeedbackBand(state){const scoreProp=state.isPercentageBased?"scoreAsPercent":"score";const bands=_.sortBy(this.get("_bands"),"_score");for(let i=bands.length-1;i>=0;i--){const isScoreInBandRange=state[scoreProp]>=bands[i]._score;if(!isScoreInBandRange)continue;this.set("_feedbackBand",bands[i]);break}}checkRetryEnabled(state){const assessmentModel=Adapt$1.assessment.get(state.id);if(!assessmentModel.canResetInPage())return false;const feedbackBand=this.get("_feedbackBand");const isRetryEnabled=(feedbackBand&&feedbackBand._allowRetry)!==false;const isAttemptsLeft=state.attemptsLeft>0||state.attemptsLeft==="infinite";const showRetry=isRetryEnabled&&isAttemptsLeft&&(!state.isPass||state.allowResetIfPassed);this.set({_isRetryEnabled:showRetry,retryFeedback:showRetry?this.get("_retry").feedback:""})}setFeedbackText(){const feedbackBand=this.get("_feedbackBand");const feedback=feedbackBand?Handlebars.compile(feedbackBand.feedback)(this.toJSON()):"";this.set({feedback:feedback,body:this.get("_completionBody")})}setVisibility(){if(!Adapt$1.assessment)return;const assessmentModel=Adapt$1.assessment.get(this.get("_assessmentId"));if(!assessmentModel||assessmentModel.length===0)return;const state=assessmentModel.getState();const isAttemptInProgress=state.attemptInProgress;const isComplete=!isAttemptInProgress&&state.isComplete;const isVisibleBeforeCompletion=this.get("_isVisibleBeforeCompletion")||false;const isVisible=isVisibleBeforeCompletion||isComplete;this.toggleVisibility(isVisible)}toggleVisibility(isVisible){if(isVisible===undefined){isVisible=!this.get("_isVisible")}this.set("_isVisible",isVisible,{pluginName:"assessmentResults"})}checkCompletion(){if(this.get("_setCompletionOn")==="pass"&&!this.get("isPass")){return}this.setCompletionStatus()}onAssessmentReset(state){if(this.get("_assessmentId")===undefined||this.get("_assessmentId")!==state.id)return;let resetType=this.get("_resetType");if(!resetType||resetType==="inherit"){resetType=state.resetType||"hard"}this.reset(resetType,true)}reset(){this.set({body:this.get("originalBody"),state:null,feedback:"",_feedbackBand:null,retryFeedback:"",_isRetryEnabled:false});super.reset(...arguments)}});class AssessmentResultsView extends ComponentView$1{events(){return{"click .js-assessment-retry-btn":"onRetryClicked"}}preRender(){this.model.setLocking("_isVisible",false);this.listenTo(Adapt$1.parentView,"preRemove",(()=>{this.model.unsetLocking("_isVisible")}));this.listenTo(this.model,{"change:_feedbackBand":this.addClassesToArticle,"change:body":this.render})}postRender(){this.model.checkIfAssessmentComplete();this.setReadyStatus();this.setupInviewCompletion(".component__inner",this.model.checkCompletion.bind(this.model))}onRetryClicked(){const state=this.model._state;Adapt$1.assessment.get(state.id).reset(null,(wasReset=>{if(!wasReset)return;if(this.model.get("_retry")._routeToAssessment!==true)return;router$1.navigateToElement(`.${state.articleId}`)}))}addClassesToArticle(model,value){if(!value?._classes)return;this.$el.parents(".article").addClass(value._classes)}}AssessmentResultsView.template="assessmentResults.jsx";var AssessmentResultsView$1=__AMD("components/adapt-contrib-assessmentResults/js/assessmentResultsView",AssessmentResultsView);__AMD("components/adapt-contrib-assessmentResults/js/adapt-contrib-assessmentResults",components$1.register("assessmentResults",{model:AssessmentResultsModel,view:AssessmentResultsView$1}));class BlankView extends ComponentView$1{postRender(){this.setReadyStatus();this.setupInviewCompletion()}}BlankView.template="blank.jsx";var BlankView$1=__AMD("components/adapt-contrib-blank/js/blankView",BlankView);__AMD("components/adapt-contrib-blank/js/adapt-contrib-blank",components$1.register("blank",{model:ComponentModel$1.extend({}),view:BlankView$1}));var ClickAndLearn=ComponentView$1.extend({events:{"click .clickAndLearn-indicator":"onClickDisplayItem","click .clickAndLearn-popup-close":"onClickCloseItem"},preRender:function(){this.listenTo(Adapt$1,"device:resize",this.resizeControl,this)},resizeControl:function(){this.setDeviceSize();var tabViewContainer=this.$(".clickAndLearn-tabViewContainer");if(!this.model.get("_isDesktop")){tabViewContainer.hide()}else if(this.getVisitedItems().length>0){tabViewContainer.show()}},setDeviceSize:function(){if(Adapt$1.device.screenSize==="large"){this.$el.addClass("desktop").removeClass("mobile");this.model.set("_isDesktop",true)}else{this.$el.addClass("mobile").removeClass("desktop");this.model.set("_isDesktop",true)}},postRender:function(){this.setDeviceSize();var flag=this.model.get("_flag");if(flag=="horizontal"){this.$(".clickAndLearn-container").addClass("clickAndLearn-horizontal")}else if(flag=="vertical"){this.$(".clickAndLearn-container").addClass("clickAndLearn-vertical")}this.$(".clickAndLearn-tabViewContainer").show();this.$(".clickAndLearn-widget").imageready(_.bind((function(){this.setReadyStatus()}),this))},checkIfResetOnRevisit:function(){var isResetOnRevisit=this.model.get("_isResetOnRevisit");if(isResetOnRevisit){this.model.reset(isResetOnRevisit)}_.each(this.model.get("_items"),(function(item){item._isVisited=false}))},onClickDisplayItem:function(event){if(event&&event.preventDefault)event.preventDefault();var $selectedElement=$(event.currentTarget);var indicatorIndex=this.$(".clickAndLearn-indicator").index($selectedElement);this.setDeviceSize();var $tabViewContainer=this.$(".clickAndLearn-tabViewContainer");if(!this.model.get("_isDesktop")){$tabViewContainer.hide()}else if(this.getVisitedItems().length>0){$tabViewContainer.show()}_.delay(function(){Adapt$1.trigger("audio:itemControl",$tabViewContainer.find(".item-audio-container").data("audio-id"))}.bind(this),1e3);this.$(".clickAndLearn-navContainer .clickAndLearn-indicator").removeClass("clickAndLearn-indicatorActive");if($selectedElement.hasClass("clickAndLearn-indicator-img")){$selectedElement.closest(".clickAndLearn-indicator").addClass("clickAndLearn-indicatorActive")}else{$selectedElement.addClass("clickAndLearn-indicatorActive")}this.$(".clickAndLearn-tabViewContainer .clickAndLearn-tabItem").hide();this.$(".clickAndLearn-tabViewContainer .clickAndLearn-tabItem:eq("+indicatorIndex+")").show();if(!this.model.get("_isDesktop")){var $popup=this.$(".clickAndLearn-popup");$popup.removeClass("display-none");$popup.find(".clickAndLearn-popup-toolbar-title").hide();$popup.find(".clickAndLearn-popup-body").hide();$popup.find(".clickAndLearn-popup-toolbar-title:eq("+indicatorIndex+")").show();$popup.find(".clickAndLearn-popup-body:eq("+indicatorIndex+")").show()}this.setVisited(indicatorIndex)},onClickCloseItem:function(event){if(event&&event.preventDefault)event.preventDefault();this.$(".clickAndLearn-popup-close").blur();this.$(".clickAndLearn-popup").addClass("display-none")},setVisited:function(index){var item=this.model.get("_items")[index];item._isVisited=true;this.checkCompletionStatus()},getVisitedItems:function(){return _.filter(this.model.get("_items"),(function(item){return item._isVisited}))},checkCompletionStatus:function(){if(this.getVisitedItems().length===this.model.get("_items").length){this.setCompletionStatus()}}});Adapt$1.register("clickAndLearn",ClickAndLearn);__AMD("components/adapt-contrib-clickAndLearn/js/adapt-contrib-clickAndLearn",ClickAndLearn);const BUTTON_STATE=ENUM(["SUBMIT","CORRECT","INCORRECT","SHOW_CORRECT_ANSWER","HIDE_CORRECT_ANSWER","SHOW_FEEDBACK","RESET"]);var BUTTON_STATE$1=__AMD("core/js/enums/buttonStateEnum",BUTTON_STATE);const textPropertyName={SUBMIT:"submit",CORRECT:"correct",INCORRECT:"incorrect",SHOW_CORRECT_ANSWER:"showCorrectAnswer",HIDE_CORRECT_ANSWER:"hideCorrectAnswer",SHOW_FEEDBACK:"showFeedback",RESET:"reset"};var ButtonsView=__AMD("core/js/views/buttonsView",class ButtonsView extends Backbone.View{initialize(options){this.parent=options.parent;this.listenTo(Adapt$1.parentView,"postRemove",this.remove);this.listenTo(this.model,{"change:_buttonState":this.onButtonStateChanged,"change:feedbackMessage":this.onFeedbackMessageChanged,"change:feedbackTitle":this.onFeedbackMessageChanged,"change:_attemptsLeft":this.onAttemptsChanged,"change:_canSubmit":this.onCanSubmitChange});this.render()}events(){return{"click .js-btn-action":"onActionClicked","click .js-btn-feedback":"onFeedbackClicked"}}render(){const data=this.model.toJSON();const template=Handlebars.templates.buttons;_.defer((()=>{this.postRender();Adapt$1.trigger("buttonsView:postRender",this)}));this.$el.html(template(data))}postRender(){this.refresh()}checkResetSubmittedState(){const isSubmitted=this.model.get("_isSubmitted");if(isSubmitted){this.$el.addClass("is-submitted");return}this.$(".js-btn-marking, .js-btn-marking-label").removeClass("is-incorrect is-correct").addClass("u-display-none");this.$el.removeClass("is-submitted");this.model.set("feedbackMessage",undefined);this.disableFeedbackButton()}onActionClicked(){const buttonState=BUTTON_STATE$1(this.model.get("_buttonState"));this.trigger("buttons:stateUpdate",buttonState);this.checkResetSubmittedState();if(buttonState===BUTTON_STATE$1.SHOW_CORRECT_ANSWER){const correctAnswer=this.model.getCorrectAnswerAsText?.();this.updateAnswerLiveRegion(correctAnswer)}if(buttonState===BUTTON_STATE$1.HIDE_CORRECT_ANSWER){const userAnswer=this.model.getUserAnswerAsText?.();this.updateAnswerLiveRegion(userAnswer)}}onFeedbackClicked(){this.trigger("buttons:stateUpdate",BUTTON_STATE$1.SHOW_FEEDBACK)}onFeedbackMessageChanged(model,changedAttribute){if(!changedAttribute)return;this.enableFeedbackButton()}enableFeedbackButton(){if(!this.model.get("_canShowFeedback"))return;a11y$1.toggleEnabled(this.$(".js-btn-feedback"),true)}disableFeedbackButton(){a11y$1.toggleEnabled(this.$(".js-btn-feedback"),false)}onCanSubmitChange(){this.onButtonStateChanged(this.model,this.model.get("_buttonState"))}onButtonStateChanged(model,changedAttribute){this.updateAttemptsCount();const $buttonsAction=this.$(".js-btn-action");const buttonState=BUTTON_STATE$1(changedAttribute);if(!buttonState){return logging$1.error(`No button state found for '${changedAttribute}'`)}if(changedAttribute===BUTTON_STATE$1.CORRECT||changedAttribute===BUTTON_STATE$1.INCORRECT){a11y$1.toggleEnabled($buttonsAction,false);return}const propertyName=textPropertyName[buttonState.asString];const ariaLabel=this.model.get("_buttons")["_"+propertyName].ariaLabel;const buttonText=this.model.get("_buttons")["_"+propertyName].buttonText;a11y$1.toggleEnabled($buttonsAction,this.model.get("_canSubmit"));$buttonsAction.html(buttonText).attr("aria-label",ariaLabel)}checkFeedbackState(){const canShowFeedback=this.model.get("_canShowFeedback");const canShowMarking=this.model.get("_canShowMarking");this.$(".js-btn-action").toggleClass("is-full-width",!canShowFeedback);this.$(".js-btn-feedback").toggleClass("u-display-none",!canShowFeedback);this.$(".js-btn-marking, .js-btn-marking-label").toggleClass("is-full-width u-display-none",!canShowMarking)}updateAttemptsCount(){const isInteractionComplete=this.model.get("_isInteractionComplete");const attemptsLeft=this.model.get("_attemptsLeft")?this.model.get("_attemptsLeft"):this.model.get("_attempts");const shouldDisplayAttempts=this.model.get("_shouldDisplayAttempts");let attemptsString;this.checkResetSubmittedState();if(!isInteractionComplete&&attemptsLeft>=0){attemptsString=attemptsLeft+" ";attemptsString+=attemptsLeft===1?this.model.get("_buttons").remainingAttemptText:this.model.get("_buttons").remainingAttemptsText}else{this.$(".js-display-attempts").addClass("u-visibility-hidden");this.showMarking()}if(shouldDisplayAttempts){this.$(".js-insert-attempts-string").html(attemptsString)}}updateAnswerLiveRegion(answer){if(!answer)return;this.$(".js-answer-live-region").html(answer)}showMarking(){if(!this.model.shouldShowMarking)return;const isCorrect=this.model.get("_isCorrect");const ariaLabels=Adapt$1.course.get("_globals")._accessibility._ariaLabels;const $marking=this.$(".js-btn-marking, .js-btn-marking-label").removeClass("u-display-none").addClass(isCorrect?"is-correct":"is-incorrect");const $ariaLabel=this.$(".js-btn-marking-label");const hasSpanAriaLabel=Boolean($ariaLabel.length);if(!hasSpanAriaLabel){$marking.attr("aria-label",isCorrect?ariaLabels.answeredCorrectly:ariaLabels.answeredIncorrectly);return}$ariaLabel.html(isCorrect?ariaLabels.answeredCorrectly:ariaLabels.answeredIncorrectly)}refresh(){this.updateAttemptsCount();this.checkResetSubmittedState();this.checkFeedbackState();this.onButtonStateChanged(null,this.model.get("_buttonState"));this.onFeedbackMessageChanged(null,this.model.get("_isSubmitted"))}});class QuestionModel extends ComponentModel$1{defaults(){return ComponentModel$1.resultExtend("defaults",{_isQuestionType:true,_shouldDisplayAttempts:false,_shouldShowMarking:false,_canShowModelAnswer:true,_canShowFeedback:true,_canShowMarking:true,_canSubmit:true,_isSubmitted:false,_isCorrectAnswerShown:false,_questionWeight:Adapt$1.config.get("_questionWeight"),_hasItemScoring:false,_items:[]})}trackable(){return ComponentModel$1.resultExtend("trackable",["_isSubmitted","_score","_isCorrect","_attemptsLeft"])}trackableType(){return ComponentModel$1.resultExtend("trackableType",[Boolean,Number,Boolean,Number])}getTypeGroup(){return"question"}init(){this.setupDefaultSettings();this.setLocking("_canSubmit",true);this.updateRawScore();super.init()}setupDefaultSettings(){this.setupWeightSettings();this.setupButtonSettings()}setupButtonSettings(){const globalButtons=Adapt$1.course.get("_buttons");if(!this.has("_buttons")){this.set("_buttons",globalButtons)}else{const componentButtons=this.get("_buttons");for(const key in componentButtons){if(typeof componentButtons[key]==="object"){if(!componentButtons[key].buttonText&&globalButtons[key].buttonText){componentButtons[key].buttonText=globalButtons[key].buttonText}if(!componentButtons[key].ariaLabel&&globalButtons[key].ariaLabel){componentButtons[key].ariaLabel=globalButtons[key].ariaLabel}}if(!componentButtons[key]&&globalButtons[key]){componentButtons[key]=globalButtons[key]}}}}setupWeightSettings(){}canSubmit(){}checkCanSubmit(){this.set("_canSubmit",this.canSubmit(),{pluginName:"adapt"})}updateAttempts(){const attemptsLeft=this.get("_attemptsLeft")||this.get("_attempts");this.set("_attemptsLeft",attemptsLeft-1)}setQuestionAsSubmitted(){this.set({_isEnabled:false,_isSubmitted:true,_shouldShowMarking:this.shouldShowMarking})}markQuestion(){this.set({_isCorrect:this.isCorrect(),_isPartlyCorrect:this.isPartlyCorrect()});this.updateRawScore()}isCorrect(){}isPartlyCorrect(){}setScore(){const questionWeight=this.get("_questionWeight");const answeredCorrectly=this.get("_isCorrect");const score=answeredCorrectly?questionWeight:0;this.set("_score",score)}updateRawScore(){this.set({_rawScore:this.score,_maxScore:this.maxScore,_minScore:this.minScore})}get score(){return this.get("_isCorrect")?this.maxScore:0}get maxScore(){return this.get("_questionWeight")}get minScore(){return 0}checkQuestionCompletion(){const isComplete=this.get("_isCorrect")||this.get("_attemptsLeft")===0;if(isComplete){this.setCompletionStatus()}return isComplete}updateButtons(){const isInteractionComplete=this.get("_isInteractionComplete");const isCorrect=this.get("_isCorrect");const isEnabled=this.get("_isEnabled");const buttonState=this.get("_buttonState");const canShowModelAnswer=this.get("_canShowModelAnswer");if(isInteractionComplete){if(isCorrect||!canShowModelAnswer){this.set("_buttonState",BUTTON_STATE$1.CORRECT)}else{switch(buttonState){case BUTTON_STATE$1.SUBMIT:case BUTTON_STATE$1.HIDE_CORRECT_ANSWER:this.set("_buttonState",BUTTON_STATE$1.SHOW_CORRECT_ANSWER);break;default:this.set("_buttonState",BUTTON_STATE$1.HIDE_CORRECT_ANSWER)}}}else{if(isEnabled){this.set("_buttonState",BUTTON_STATE$1.SUBMIT)}else{this.set("_buttonState",BUTTON_STATE$1.RESET)}}}getFeedback(){let _feedback=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.get("_feedback");if(!_feedback)return{};const isFinal=this.get("_attemptsLeft")===0;const correctness=this.get("_isCorrect")?"correct":this.isPartlyCorrect()?"partlyCorrect":"incorrect";let{altTitle:altTitle,title:title,_classes:_classes}=_feedback;altTitle=altTitle||Adapt$1.course.get("_globals")._accessibility.altFeedbackTitle||"";title=title||this.get("displayTitle")||this.get("title")||"";switch(correctness){case"correct":{if(typeof _feedback.correct==="string"){return{altTitle:altTitle,title:title,_classes:_classes,body:_feedback.correct}}const feedbackCorrect=_feedback._correct;const feedbackConfig={...feedbackCorrect||{},altTitle:feedbackCorrect?.altTitle||altTitle,title:feedbackCorrect?.title||title,_classes:feedbackCorrect?._classes||_classes};if(feedbackConfig?._graphic?._src&&!feedbackConfig?._imageAlignment){feedbackConfig._imageAlignment="right"}return feedbackConfig}case"partlyCorrect":{if(typeof _feedback._partlyCorrect==="object"){return{altTitle:altTitle,title:title,_classes:_classes,body:!isFinal?_feedback._partlyCorrect?.notFinal||_feedback._incorrect?.notFinal||"":_feedback._partlyCorrect?.final||_feedback._incorrect?.final||""}}const feedbackPartlyCorrect=!isFinal?_feedback._partlyCorrectNotFinal||_feedback._incorrectNotFinal:_feedback._partlyCorrectFinal||_feedback._incorrectFinal;const feedbackConfig={...feedbackPartlyCorrect||{},altTitle:feedbackPartlyCorrect?.altTitle||altTitle,title:feedbackPartlyCorrect?.title||title,_classes:feedbackPartlyCorrect?._classes||_classes};if(feedbackConfig?._graphic?._src&&!feedbackConfig?._imageAlignment){feedbackConfig._imageAlignment="right"}return feedbackConfig}case"incorrect":{if(typeof _feedback._incorrect==="object"){return{altTitle:altTitle,title:title,_classes:_classes,body:!isFinal?_feedback._incorrect.notFinal||_feedback._incorrect.final:_feedback._incorrect.final}}const feedbackIncorrect=!isFinal?_feedback._incorrectNotFinal||_feedback._incorrectFinal:_feedback._incorrectFinal;const feedbackConfig={...feedbackIncorrect||{},altTitle:feedbackIncorrect?.altTitle||altTitle,title:feedbackIncorrect?.title||title,_classes:feedbackIncorrect?._classes||_classes};if(feedbackConfig?._graphic?._src&&!feedbackConfig?._imageAlignment){feedbackConfig._imageAlignment="right"}return feedbackConfig}}return{}}setupFeedback(){if(!this.has("_feedback"))return;const{altTitle:altTitle="",title:title="",body:body=""}=this.getFeedback();this.set({altFeedbackTitle:Handlebars.compile(altTitle)(this.toJSON()),feedbackTitle:Handlebars.compile(title)(this.toJSON()),feedbackMessage:Handlebars.compile(body)(this.toJSON())})}isInteractive(){return!this.get("_isComplete")||this.get("_isEnabled")&&!this.get("_isSubmitted")}checkIfResetOnRevisit(){super.checkIfResetOnRevisit();this.set("_buttonState",this.get("_isInteractionComplete")?BUTTON_STATE$1.HIDE_CORRECT_ANSWER:BUTTON_STATE$1.SUBMIT)}reset(){let type=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"hard";let canReset=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.get("_canReset");const wasReset=super.reset(type,canReset);if(!wasReset)return false;const attempts=this.get("_attempts");this.set({_attemptsLeft:attempts,_isCorrect:undefined,_isPartlyCorrect:undefined,_isCorrectAnswerShown:false,_isSubmitted:false,_buttonState:BUTTON_STATE$1.SUBMIT,_shouldShowMarking:this.shouldShowMarking});return true}setQuestionAsReset(){this.set({_isEnabled:true,_isSubmitted:false,_shouldShowMarking:this.shouldShowMarking});this.resetQuestion()}resetQuestion(){}refresh(){this.trigger("question:refresh")}getButtonState(){if(this.get("_isCorrect")){return BUTTON_STATE$1.CORRECT}if(this.get("_attemptsLeft")===0){return this.get("_canShowModelAnswer")?BUTTON_STATE$1.SHOW_CORRECT_ANSWER:BUTTON_STATE$1.INCORRECT}return this.get("_isSubmitted")?BUTTON_STATE$1.RESET:BUTTON_STATE$1.SUBMIT}getInteractionObject(){return{}}getResponse(){}getResponseType(){}onSubmitted(){if(this.get("_shouldStoreAttempts"))this.addAttemptObject();this.set("_shouldShowMarking",this.shouldShowMarking)}get shouldShowMarking(){return!this.isInteractive()&&this.get("_canShowMarking")&&this.get("_isInteractionComplete")}}components$1.register("question",{model:QuestionModel});var QuestionModel$1=__AMD("core/js/models/questionModel",QuestionModel);class QuestionView extends ComponentView$1{className(){return["component","is-question",this.model.get("_component").toLowerCase(),this.model.get("_id"),this.model.get("_classes"),this.setVisibility(),"is-"+this.model.get("_layout"),this.model.get("_isComplete")?"is-complete":"",this.model.get("_isOptional")?"is-optional":"",this.model.get("_canShowModelAnswer")?"can-show-model-answer":"",this.model.get("_canShowFeedback")?"can-show-feedback":"",this.model.get("_canShowMarking")?"can-show-marking":""].join(" ")}initialize(){this.isInteractive=this.isInteractive.bind(this);super.initialize(...arguments)}isInteractive(){logging$1.deprecated("questionView.isInteractive please use this.model.isInteractive, this.model.get('_shouldShowMarking') or this.model.shouldShowMarking");return this.model.isInteractive()}preRender(){this.listenTo(this.model,"change:_isEnabled",this.onEnabledChanged);this.listenTo(this.model,"question:refresh",this.refresh);if(this.checkIfResetOnRevisit!==QuestionView.prototype.checkIfResetOnRevisit){logging$1.deprecated("QuestionView.checkIfResetOnRevisit, please use QuestionModel.checkIfResetOnRevisit")}this.checkIfResetOnRevisit();_.defer((()=>this.ensureLegacyLifecycleState()));this._runModelCompatibleFunction("setupDefaultSettings");this.setupQuestion()}onEnabledChanged(model,changedAttribute){if(!changedAttribute){this.$(".component__widget").addClass("is-disabled");this.disableQuestion()}else{this.$(".component__widget").removeClass("is-disabled");this.enableQuestion()}}disableQuestion(){}enableQuestion(){}checkIfResetOnRevisit(){const canReset=this.model.get("_canReset")!==false;const isResetOnRevisit=this.model.get("_isResetOnRevisit");if(!canReset||!isResetOnRevisit)return;if(this.resetQuestionOnRevisit===QuestionView.prototype.resetQuestionOnRevisit)return;logging$1.deprecated("QuestionView.resetQuestionOnRevisit, please QuestionModel.reset");_.defer((()=>{this.resetQuestionOnRevisit(isResetOnRevisit)}))}ensureLegacyLifecycleState(){if(this.model.get("_isSubmitted")){this.onHideCorrectAnswerClicked();return}this.onResetClicked()}resetQuestionOnRevisit(type){}setupQuestion(){}postRender(){this.addButtonsView();this.onQuestionRendered()}addButtonsView(){this.buttonsView=new ButtonsView({model:this.model,el:this.$(".btn__container")});this.listenTo(this.buttonsView,"buttons:stateUpdate",this.onButtonStateUpdate)}onButtonStateUpdate(buttonState){switch(buttonState){case BUTTON_STATE$1.SUBMIT:this.onSubmitClicked();break;case BUTTON_STATE$1.RESET:this.onResetClicked();break;case BUTTON_STATE$1.SHOW_CORRECT_ANSWER:this.onShowCorrectAnswerClicked();break;case BUTTON_STATE$1.HIDE_CORRECT_ANSWER:this.onHideCorrectAnswerClicked();break;case BUTTON_STATE$1.SHOW_FEEDBACK:this.showFeedback();break}}onQuestionRendered(){}onSubmitClicked(){const canSubmit=this._runModelCompatibleFunction("canSubmit");if(!canSubmit){this.showInstructionError();this.onCannotSubmit();return}this.stopRendering();this._runModelCompatibleFunction("updateAttempts");this._runModelCompatibleFunction("setQuestionAsSubmitted");this._runModelCompatibleFunction("storeUserAnswer");this._runModelCompatibleFunction("markQuestion","isCorrect");this._runModelCompatibleFunction("setScore");this._runModelCompatibleFunction("checkQuestionCompletion");if(this.model.shouldShowMarking){this.showMarking()}this.recordInteraction();this._runModelCompatibleFunction("setupFeedback");this.showFeedback();$(window).resize();this._runModelCompatibleFunction("updateButtons");this.startRendering();this.changed();this.model.onSubmitted();this.onSubmitted();Adapt$1.trigger("questionView:submitted",this)}showInstructionError(){Adapt$1.trigger("questionView:showInstructionError",this)}onCannotSubmit(){}onSubmitted(){}setQuestionAsSubmitted(){this.model.setQuestionAsSubmitted();this.$(".component__widget").addClass("is-submitted")}showMarking(){}checkQuestionCompletion(){const isComplete=this.model.checkQuestionCompletion();if(isComplete){this.$(".component__widget").addClass("is-complete show-user-answer")}}recordInteraction(){if(this.model.get("_recordInteraction")===true||!this.model.has("_recordInteraction")){Adapt$1.trigger("questionView:recordInteraction",this)}}showFeedback(){if(this.model.get("_canShowFeedback")){Adapt$1.trigger("questionView:showFeedback",this)}else{Adapt$1.trigger("questionView:disabledFeedback",this)}}onResetClicked(){this.setQuestionAsReset();this._runModelCompatibleFunction("resetUserAnswer");this.model.checkCanSubmit();this._runModelCompatibleFunction("updateButtons");if(!this.model.get("_isReady"))return;const currentModel=data$1.findById(location$1._currentId);if(!currentModel?.get("_isReady"))return;a11y$1.focusNext(this.$el,{preventScroll:true})}setQuestionAsReset(){this.model.setQuestionAsReset();this.resetQuestion();this.$(".component__widget").removeClass("is-submitted")}resetQuestion(){}refresh(){this.model.set("_buttonState",this.model.getButtonState());if(this.model.shouldShowMarking){this.showMarking()}if(this.buttonsView){_.defer(this.buttonsView.refresh.bind(this.buttonsView))}}onShowCorrectAnswerClicked(){this.setQuestionAsShowCorrect();this._runModelCompatibleFunction("updateButtons");this.showCorrectAnswer()}setQuestionAsShowCorrect(){this.$(".component__widget").addClass("is-submitted show-correct-answer").removeClass("show-user-answer")}showCorrectAnswer(){this.model.set("_isCorrectAnswerShown",true)}onHideCorrectAnswerClicked(){this.setQuestionAsHideCorrect();this._runModelCompatibleFunction("updateButtons");this.hideCorrectAnswer()}setQuestionAsHideCorrect(){this.$(".component__widget").addClass("is-submitted show-user-answer").removeClass("show-correct-answer")}hideCorrectAnswer(){this.model.set("_isCorrectAnswerShown",false)}getLatency(){return null}_runModelCompatibleFunction(name,lookForViewOnlyFunction){return this.model[name]()}}QuestionView._isQuestionType=true;class ViewOnlyQuestionViewCompatibilityLayer extends QuestionView{getInteractionObject(){logging$1.deprecated("QuestionView.getInteractionObject, please use QuestionModel.getInteractionObject");return this.model.getInteractionObject()}getResponse(){logging$1.deprecated("QuestionView.getInteractionObject, please use QuestionModel.getInteractionObject");return this.model.getResponse()}getResponseType(){logging$1.deprecated("QuestionView.getResponseType, please use QuestionModel.getResponseType");return this.model.getResponseType()}setupDefaultSettings(){logging$1.deprecated("QuestionView.setupDefaultSettings, please use QuestionModel.setupDefaultSettings");return this.model.setupDefaultSettings()}setupButtonSettings(){logging$1.deprecated("QuestionView.setupButtonSettings, please use QuestionModel.setupButtonSettings");return this.model.setupButtonSettings()}setupWeightSettings(){logging$1.deprecated("QuestionView.setupWeightSettings, please use QuestionModel.setupWeightSettings");return this.model.setupWeightSettings()}canSubmit(){logging$1.deprecated("QuestionView.canSubmit, please use QuestionModel.canSubmit");return this.model.canSubmit()}updateAttempts(){logging$1.deprecated("QuestionView.updateAttempts, please use QuestionModel.updateAttempts");return this.model.updateAttempts()}storeUserAnswer(){logging$1.deprecated("QuestionView.storeUserAnswer, please use QuestionModel.storeUserAnswer");return this.model.storeUserAnswer()}resetUserAnswer(){logging$1.deprecated("QuestionView.resetUserAnswer, please use QuestionModel.resetUserAnswer");return this.model.resetUserAnswer()}markQuestion(){if(this._isInViewOnlyCompatibleMode("isCorrect")){if(this.isCorrect()){this.model.set("_isCorrect",true)}else{this.model.set("_isCorrect",false)}this.model.set({_rawScore:this.model.get("_isCorrect")?this.model.get("_questionWeight"):0,_maxScore:this.model.get("_questionWeight"),_minScore:0})}else{return this.model.markQuestion()}}isCorrect(){logging$1.deprecated("QuestionView.isCorrect, please use QuestionModel.isCorrect");return this.model.isCorrect()}setScore(){logging$1.deprecated("QuestionView.setScore, please use QuestionModel.setScore");return this.model.setScore()}updateButtons(){logging$1.deprecated("QuestionView.updateButtons, please use QuestionModel.updateButtons");return this.model.updateButtons()}setupFeedback(){if(this._isInViewOnlyCompatibleMode("isPartlyCorrect")){if(this.model.get("_isCorrect")){this._runModelCompatibleFunction("setupCorrectFeedback")}else if(this.isPartlyCorrect()){this._runModelCompatibleFunction("setupPartlyCorrectFeedback")}else{this._runModelCompatibleFunction("setupIncorrectFeedback")}}else{this.model.setupFeedback()}}isPartlyCorrect(){logging$1.deprecated("QuestionView.isPartlyCorrect, please use QuestionModel.isPartlyCorrect");return this.model.isPartlyCorrect()}setupCorrectFeedback(){logging$1.deprecated("QuestionView.setupCorrectFeedback, please use QuestionModel.setupCorrectFeedback");return this.model.setupCorrectFeedback()}setupPartlyCorrectFeedback(){logging$1.deprecated("QuestionView.setupPartlyCorrectFeedback, please use QuestionModel.setupPartlyCorrectFeedback");return this.model.setupPartlyCorrectFeedback()}setupIncorrectFeedback(){logging$1.deprecated("QuestionView.setupIncorrectFeedback, please use QuestionModel.setupIncorrectFeedback");return this.model.setupIncorrectFeedback()}_runModelCompatibleFunction(name,lookForViewOnlyFunction){if(this._isInViewOnlyCompatibleMode(name,lookForViewOnlyFunction)){return this[name]()}else{return this.model[name]()}}_isInViewOnlyCompatibleMode(name,lookForViewOnlyFunction){const checkForFunction=lookForViewOnlyFunction||name;if(!this.constructor.prototype[checkForFunction])return false;const hasCompatibleVersion=Object.prototype.hasOwnProperty.call(ViewOnlyQuestionViewCompatibilityLayer.prototype,checkForFunction);const usingCompatibleVersion=this.constructor.prototype[checkForFunction]===ViewOnlyQuestionViewCompatibilityLayer.prototype[checkForFunction];if(hasCompatibleVersion&&usingCompatibleVersion){switch(checkForFunction){case"setupFeedback":case"markQuestion":return true}return false}return true}}var QuestionView$1=__AMD("core/js/views/questionView",ViewOnlyQuestionViewCompatibilityLayer);class McqView extends QuestionView$1{initialize(){this.onKeyPress=this.onKeyPress.bind(this);this.onItemSelect=this.onItemSelect.bind(this);this.onItemFocus=this.onItemFocus.bind(this);this.onItemBlur=this.onItemBlur.bind(this);super.initialize(...arguments)}setupQuestion(){this.model.setupRandomisation()}onQuestionRendered(){this.setReadyStatus()}onKeyPress(event){if(event.which!==13)return;this.onItemSelect(event)}onItemFocus(event){if(!this.model.isInteractive())return;if(this.model.get("_isRadio")){this.onItemSelect(event);return}const index=parseInt($(event.currentTarget).data("adapt-index"));const item=this.model.getChildren().findWhere({_index:index});item.set("_isHighlighted",true)}onItemBlur(event){const index=$(event.currentTarget).data("adapt-index");const item=this.model.getChildren().findWhere({_index:index});item.set("_isHighlighted",false)}onItemSelect(event){if(!this.model.isInteractive())return;const index=$(event.currentTarget).data("adapt-index");const itemModel=this.model.getItem(index);let shouldSelect=!itemModel.get("_isActive");if(this.model.isSingleSelect()){shouldSelect=true;this.model.resetActiveItems()}else if(shouldSelect&&this.model.isAtActiveLimit()){this.model.getLastActiveItem().toggleActive(false)}itemModel.toggleActive(shouldSelect)}resetQuestion(){this.model.resetItems()}}McqView.template="mcq.jsx";var McqView$1=__AMD("components/adapt-contrib-mcq/js/McqView",McqView);class GmcqView extends McqView$1{onQuestionRendered(){this.$(".js-item-label").imageready((()=>this.setReadyStatus()))}}GmcqView.template="gmcq.jsx";var GmcqView$1=__AMD("components/adapt-contrib-gmcq/js/GmcqView",GmcqView);class BlendedItemsComponentQuestionModel extends QuestionModel$1{init(){ItemsComponentModel.prototype.init.call(this);super.init()}reset(){let type=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"hard";let canReset=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.get("_canReset");ItemsComponentModel.prototype.reset.call(this,type,canReset);return super.reset(type,canReset)}}Object.getOwnPropertyNames(ItemsComponentModel.prototype).forEach((name=>{if(name==="constructor"||name==="init"||name==="reset")return;Object.defineProperty(BlendedItemsComponentQuestionModel.prototype,name,{value:ItemsComponentModel.prototype[name]})}));var ItemsQuestionModel=__AMD("core/js/models/itemsQuestionModel",class ItemsQuestionModel extends BlendedItemsComponentQuestionModel{init(){super.init();this.set("_isRadio",this.isSingleSelect());this.listenTo(this.getChildren(),"change:_isActive",this.checkCanSubmit);this.checkCanSubmit()}restoreUserAnswers(){if(!this.get("_isSubmitted"))return;const itemModels=this.getChildren();const userAnswer=this.get("_userAnswer");itemModels.each((item=>{item.toggleActive(userAnswer[item.get("_index")])}));this.setQuestionAsSubmitted();this.markQuestion();this.setScore();this.setupFeedback()}setupRandomisation(){if(!this.get("_isRandom")||!this.get("_isEnabled"))return;const children=this.getChildren();children.set(children.shuffle())}canSubmit(){const activeItems=this.getActiveItems();return activeItems.length>0}storeUserAnswer(){const items=this.getChildren().slice(0);items.sort(((a,b)=>a.get("_index")-b.get("_index")));const userAnswer=items.map((itemModel=>itemModel.get("_isActive")));this.set("_userAnswer",userAnswer)}isCorrect(){const allChildren=this.getChildren();const activeChildren=allChildren.filter((itemModel=>itemModel.get("_isActive")));const isItemCorrect=itemModel=>itemModel.get("_shouldBeSelected")&&!itemModel.get("_isPartlyCorrect");const isItemPartlyCorrect=itemModel=>itemModel.get("_isPartlyCorrect");const isItemIncorrect=itemModel=>!itemModel.get("_shouldBeSelected")&&!itemModel.get("_isPartlyCorrect");const sum=(list,predicate)=>list.reduce(((sum,item)=>sum+(predicate(item)?1:0)),0);const props={_numberOfRequiredAnswers:sum(allChildren,isItemCorrect),_numberOfCorrectAnswers:sum(activeChildren,isItemCorrect),_numberOfPartlyCorrectAnswers:sum(activeChildren,isItemPartlyCorrect),_numberOfIncorrectAnswers:sum(activeChildren,isItemIncorrect)};activeChildren.forEach((itemModel=>itemModel.set("_isCorrect",itemModel.get("_shouldBeSelected"))));props._isAtLeastOneCorrectSelection=props._numberOfCorrectAnswers||props._numberOfPartlyCorrectAnswers;const numberOfSelectableAnswers=this.get("_selectable");const hasSelectableCorrectAnswers=props._numberOfCorrectAnswers===numberOfSelectableAnswers;const hasAllCorrectAnswers=props._numberOfCorrectAnswers===props._numberOfRequiredAnswers;const hasCorrectAnswers=hasSelectableCorrectAnswers||hasAllCorrectAnswers;const hasIncorrectAnswers=props._numberOfIncorrectAnswers;const hasPartlyCorrectAnswers=props._numberOfPartlyCorrectAnswers;this.set(props);return hasCorrectAnswers&&!hasIncorrectAnswers&&!hasPartlyCorrectAnswers}setScore(){const questionWeight=this.get("_questionWeight");const answeredCorrectly=this.get("_isCorrect");const score=answeredCorrectly?questionWeight:0;this.set("_score",score)}get score(){if(!this.get("_hasItemScoring"))return super.score;const children=this.getChildren()?.toArray()||[];return children.reduce(((score,child)=>score+=child.get("_isActive")?child.get("_score")||0:0),0)}get maxScore(){if(!this.get("_hasItemScoring"))return super.maxScore;const children=this.getChildren()?.toArray()||[];const scores=children.map((child=>child.get("_score")||0));scores.sort(((a,b)=>a-b));return scores.reverse().slice(0,this.get("_selectable")).filter((score=>score>0)).reduce(((maxScore,score)=>maxScore+=score),0)}get minScore(){if(!this.get("_hasItemScoring"))return super.minScore;const children=this.getChildren()?.toArray()||[];const scores=children.map((child=>child.get("_score")||0));scores.sort(((a,b)=>a-b));return scores.slice(0,this.get("_selectable")).filter((score=>score<0)).reduce(((minScore,score)=>minScore+=score),0)}getFeedback(){let _feedback=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.get("_feedback");if(!_feedback)return{};const activeItem=this.getActiveItem();const activeItemFeedback=activeItem.get("feedback");const isIndividualFeedback=!this.isCorrect()&&!this.isPartlyCorrect()&&this.isSingleSelect()&&activeItemFeedback;const feedback=super.getFeedback(_feedback);if(!isIndividualFeedback)return feedback;if(typeof activeItemFeedback==="string"){return{...feedback,body:activeItemFeedback||""}}const feedbackConfig={...feedback,...activeItemFeedback};if(feedbackConfig?._graphic?._src&&!feedbackConfig?._imageAlignment){feedbackConfig._imageAlignment="right"}return feedbackConfig}isPartlyCorrect(){return this.get("_isAtLeastOneCorrectSelection")}resetUserAnswer(){this.set("_userAnswer",[])}isAtActiveLimit(){const selectedItems=this.getActiveItems();return selectedItems.length===this.get("_selectable")}isSingleSelect(){return this.get("_selectable")===1}getLastActiveItem(){const selectedItems=this.getActiveItems();return selectedItems[selectedItems.length-1]}resetQuestion(){this.resetItems()}resetItems(){if(this.get("_shouldResetAllAnswers")===false){this.resetIncorrectItems();return}this.resetActiveItems();this.set("_isAtLeastOneCorrectSelection",false)}resetIncorrectItems(){this.getChildren().each((item=>{const isCorrect=item.get("_shouldBeSelected")||item.get("_isCorrect");if(isCorrect)return;item.toggleActive(false)}));this.set("_isAtLeastOneCorrectSelection",Boolean(this.getLastActiveItem()))}getInteractionObject(){const interactions={correctResponsesPattern:[],choices:[]};interactions.choices=this.getChildren().map((itemModel=>({id:(itemModel.get("_index")+1).toString(),description:itemModel.get("text")})));const correctItems=this.getChildren().filter((itemModel=>itemModel.get("_shouldBeSelected")));interactions.correctResponsesPattern=[correctItems.map((itemModel=>String(itemModel.get("_index")+1))).join("[,]")];return interactions}getResponse(){const activeItems=this.getActiveItems();const activeIndexes=activeItems.map((itemModel=>itemModel.get("_index")+1));return activeIndexes.join(",")}getResponseType(){return"choice"}getCorrectAnswerAsText(){const globals=Adapt$1.course.get("_globals")._components["_"+this.get("_component")];const isSingleSelect=this.isSingleSelect();const ariaAnswer=isSingleSelect?globals?.ariaCorrectAnswer:globals?.ariaCorrectAnswers;if(!ariaAnswer)return;const correctOptions=this.getChildren().where({_shouldBeSelected:true});const correctAnswer=isSingleSelect?correctOptions[0]?.get("text"):correctOptions.map((correctOption=>correctOption.get("text"))).join("<br>");return Handlebars.compile(ariaAnswer)({correctAnswer:correctAnswer})}getUserAnswerAsText(){const globals=Adapt$1.course.get("_globals")._components["_"+this.get("_component")];const isSingleSelect=this.isSingleSelect();const ariaAnswer=isSingleSelect?globals?.ariaUserAnswer:globals?.ariaUserAnswers;if(!ariaAnswer)return;const selectedItems=this.getActiveItems();const userAnswer=isSingleSelect?selectedItems[0].get("text"):selectedItems.map((selectedItem=>selectedItem.get("text"))).join("<br>");return Handlebars.compile(ariaAnswer)({userAnswer:userAnswer})}});var McqModel=__AMD("components/adapt-contrib-mcq/js/McqModel",class McqModel extends ItemsQuestionModel{});var GmcqModel=__AMD("components/adapt-contrib-gmcq/js/GmcqModel",class GmcqModel extends McqModel{});__AMD("components/adapt-contrib-gmcq/js/adapt-contrib-gmcq",components$1.register("gmcq",{model:GmcqModel,view:GmcqView$1}));class GraphicView extends ComponentView$1{className(){return[super.className(),this.model.get("_isScrollable")&&"is-scrollable"].filter(Boolean).join(" ")}events(){return{"click .js-graphic-link":"onClick","keydown .js-graphic-scrollbar":"onKeyDown"}}postRender(){this.$(".graphic__widget").imageready((()=>{this.setReadyStatus();this.setupInviewCompletion(".graphic__widget");this.setupScrollable()}))}setupScrollable(){if(!this.model.get("_isScrollable"))return;this.onScroll=_.debounce(this.onScroll.bind(this),17);const $scrollbar=this.$(".js-graphic-scrollbar");const $scrollContainer=this.$(`#${$scrollbar.attr("aria-controls")}`);$scrollContainer.on("scroll",this.onScroll);this.onKeyDown()}onScroll(event){if(!this.model.get("_isScrollable"))return;const $scrollbar=this.$(".js-graphic-scrollbar");const $scrollContainer=this.$(`#${$scrollbar.attr("aria-controls")}`);const{clientWidth:clientWidth,scrollWidth:scrollWidth}=$scrollContainer[0];const scrollableWidth=scrollWidth-clientWidth;const left=$scrollContainer.scrollLeft();const calculatedScrollPercent=parseInt(left/scrollableWidth*100);this.model.set("_scrollPercent",calculatedScrollPercent)}onKeyDown(event){if(!this.model.get("_isScrollable"))return;const $scrollbar=this.$(".js-graphic-scrollbar");const $scrollContainer=this.$(`#${$scrollbar.attr("aria-controls")}`);const{clientWidth:clientWidth,scrollWidth:scrollWidth}=$scrollContainer[0];const scrollableWidth=scrollWidth-clientWidth;const step=clientWidth*.1;let left=$scrollContainer.scrollLeft();const calculatedScrollPercent=parseInt(left/scrollableWidth*100);const definedScrollPercent=this.model.get("_scrollPercent")??0;if(definedScrollPercent!==calculatedScrollPercent){left=definedScrollPercent/100*scrollableWidth}switch(event?.which){case 37:left-=step;break;case 39:left+=step;break}left=_.max([0,_.min([scrollableWidth,left])]);$scrollContainer.scrollLeft(left)}onClick(event){if(event)event.preventDefault();const item=this.model.get("_graphic");const{_url:url,_target:target="_blank"}=item;const isNewWindow=target!=="_self";if(isNewWindow)return window.open(url,target);const isRouterNavigation=url.substr(0,1)==="#";if(isRouterNavigation)return Backbone.history.navigate(url,{trigger:true});window.location.href=url}preRemove(){if(!this.model.get("_isScrollable"))return;const $scrollbar=this.$(".js-graphic-scrollbar");const $scrollContainer=this.$(`#${$scrollbar.attr("aria-controls")}`);$scrollContainer.off("scroll",this.onScroll)}}GraphicView.template="graphic.jsx";var GraphicView$1=__AMD("components/adapt-contrib-graphic/js/GraphicView",GraphicView);var GraphicModel=__AMD("components/adapt-contrib-graphic/js/GraphicModel",class GraphicModel extends ComponentModel$1{init(){this.set("_scrollPercent",this.get("_defaultScrollPercent"))}});__AMD("components/adapt-contrib-graphic/js/adapt-contrib-graphic",components$1.register("graphic",{model:GraphicModel,view:GraphicView$1}));class HotgraphicPopupView extends Backbone.View{className(){return"hotgraphic-popup"}initialize(){this.setupEventListeners()}setupEventListeners(){this.listenToOnce(Adapt$1,"notify:opened",this.onNotifyOpened);this.listenTo(this.model.getChildren(),{"change:_isActive":this.onItemsActiveChange});this.model.set("onCloseClick",this.onCloseClick.bind(this));this.model.set("onControlClick",this.onControlClick.bind(this))}onNotifyOpened(){this.setupNavigation();this.render()}setupNavigation(){this.manageBackNextStates();this.updatePageCount();this.setupBackNextLabels()}manageBackNextStates(){let index=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.model.getActiveItem().get("_index");const totalItems=this.model.getChildren().length;const canCycleThroughPagination=this.model.get("_canCycleThroughPagination");const shouldEnableBack=index>0||canCycleThroughPagination;const shouldEnableNext=index<totalItems-1||canCycleThroughPagination;this.model.set("shouldEnableBack",shouldEnableBack);this.model.set("shouldEnableNext",shouldEnableNext)}setupBackNextLabels(){let index=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.model.getActiveItem().get("_index");const totalItems=this.model.getChildren().length;const canCycleThroughPagination=this.model.get("_canCycleThroughPagination");const isAtStart=index===0;const isAtEnd=index===totalItems-1;const globals=Adapt$1.course.get("_globals");const hotgraphicGlobals=globals._components._hotgraphic;let prevTitle=isAtStart?"":this.model.getItem(index-1).get("title");let nextTitle=isAtEnd?"":this.model.getItem(index+1).get("title");let backItem=isAtStart?null:index;let nextItem=isAtEnd?null:index+2;if(canCycleThroughPagination){if(isAtStart){prevTitle=this.model.getItem(totalItems-1).get("title");backItem=totalItems}if(isAtEnd){nextTitle=this.model.getItem(0).get("title");nextItem=1}}const backLabel=compile(hotgraphicGlobals.previous,{_globals:globals,title:prevTitle,itemNumber:backItem,totalItems:totalItems});const nextLabel=compile(hotgraphicGlobals.next,{_globals:globals,title:nextTitle,itemNumber:nextItem,totalItems:totalItems});this.model.set("backLabel",backLabel);this.model.set("nextLabel",nextLabel)}updatePageCount(){const globals=Adapt$1.course.get("_globals");const pagingTemplate=globals._components._hotgraphic.popupPagination;const template=pagingTemplate||"{{itemNumber}} / {{totalItems}}";const itemNumber=this.model.getActiveItem().get("_index")+1;const totalItems=this.model.getChildren().length;const popupCount=compile(template,{itemNumber:itemNumber,totalItems:totalItems});this.model.set("popupCount",popupCount)}onItemsActiveChange(item,_isActive){if(!_isActive)return;const index=item.get("_index");this.manageBackNextStates(index);this.updatePageCount();this.render()}onCloseClick(){Adapt$1.trigger("notify:close")}onControlClick(e){const direction=$(e.currentTarget).data("direction");const index=this.getNextIndex(direction);if(index!==-1){this.setItemState(index)}}getNextIndex(direction){let index=this.model.getActiveItem().get("_index");const lastIndex=this.model.getChildren().length-1;switch(direction){case"back":if(index>0)return--index;if(this.model.get("_canCycleThroughPagination"))return lastIndex;break;case"next":if(index<lastIndex)return++index;if(this.model.get("_canCycleThroughPagination"))return 0}return-1}setItemState(index){this.model.getActiveItem().toggleActive();const nextItem=this.model.getItem(index);this.setupBackNextLabels(index);nextItem.toggleActive();nextItem.toggleVisited(true)}render(){ReactDOM__default["default"].render(React__default["default"].createElement(templates.hotgraphicPopup,this.model.toJSON()),this.el)}}var HotgraphicPopupView$1=__AMD("components/adapt-contrib-hotgraphic/js/hotgraphicPopupView",HotgraphicPopupView);class HotGraphicView extends ComponentView$1{initialize(){super.initialize(...arguments);this.onPinClicked=this.onPinClicked.bind(this);this.setUpViewData();this.setUpEventListeners()}setUpViewData(){this.popupView=null;this._isPopupOpen=false}setUpEventListeners(){this.listenTo(Adapt$1,"device:changed",this.reRender)}reRender(){if(device$1.isScreenSizeMin("medium")||this.model.get("_isNarrativeOnMobile")===false)return;this.replaceWithNarrative()}replaceWithNarrative(){const NarrativeView=components$1.getViewClass("narrative");if(!NarrativeView)return;const model=this.model.prepareNarrativeModel();const newNarrative=new NarrativeView({model:model});const parentView=data$1.findViewByModelId(model.get("_parentId"));const $container=parentView.$el.find(".component__container");$container.append(newNarrative.$el);const parentChildViews=parentView.getChildViews();const currentIndex=parentChildViews.findIndex((view=>view===this));parentChildViews[currentIndex]=newNarrative;parentView.setChildViews(parentChildViews);this.remove();_.defer((()=>{Adapt$1.trigger("device:resize")}))}onItemsActiveChange(model,_isActive){this.getItemElement(model).toggleClass("is-active",_isActive)}getItemElement(model){const index=model.get("_index");return this.$(".js-hotgraphic-item-click").filter(`[data-index="${index}"]`)}onItemsVisitedChange(model,_isVisited){if(!_isVisited)return;const $pin=this.getItemElement(model);const visitedLabel=` ${this.model.get("_globals")._accessibility._ariaLabels.visited}. `;$pin.find(".aria-label").each(((index,el)=>{el.innerHTML=visitedLabel+el.innerHTML}))}preRender(){this.reRender()}postRender(){this.$(".hotgraphic__widget").imageready(this.setReadyStatus.bind(this));if(this.model.get("_setCompletionOn")!=="inview")return;this.setupInviewCompletion(".hotgraphic__widget")}onPinClicked(e){const item=this.model.getItem($(e.currentTarget).data("index"));item.toggleActive(true);item.toggleVisited(true);this.openPopup()}openPopup(){if(this._isPopupOpen)return;this._isPopupOpen=true;this.popupView=new HotgraphicPopupView$1({model:this.model});notify$1.popup({_attributes:{"data-adapt-id":this.model.get("_id")},_view:this.popupView,_isCancellable:true,_showCloseButton:false,_classes:"hotgraphic is-component is-hotgraphic "+this.model.get("_classes")});this.listenToOnce(Adapt$1,{"popup:closed":this.onPopupClosed})}onPopupClosed(){this.model.getActiveItem().toggleActive();this._isPopupOpen=false}}HotGraphicView.template="hotgraphic.jsx";var HotgraphicView=__AMD("components/adapt-contrib-hotgraphic/js/hotgraphicView",HotGraphicView);var HotgraphicModel=__AMD("components/adapt-contrib-hotgraphic/js/hotgraphicModel",class HotgraphicModel extends ItemsComponentModel{defaults(){return ItemsComponentModel.resultExtend("defaults",{_canCycleThroughPagination:false})}setUpItems(){super.setUpItems();const id=this.get("_id");this.getChildren().forEach(((child,index)=>{if(!child.get("_pin"))child.set("_pin",false);const tooltip=child.get("_tooltip");if(!tooltip?._isEnabled)return;tooltip._id=`hotgraphic-pin-${id}-${index}`;const tooltipConfig={...child.toJSON(),_classes:["hotgraphic__pin-tooltip"],...tooltip};tooltipConfig._position=tooltipConfig._position||"outside bottom middle middle";tooltips$1.register(tooltipConfig)}))}prepareNarrativeModel(){this.set({_component:"narrative",_wasHotgraphic:true,originalBody:this.get("body"),originalInstruction:this.get("instruction")});const activeItem=this.getActiveItem();if(!activeItem){this.getItem(0).toggleActive(true)}if(this.get("mobileBody")){this.set("body",this.get("mobileBody"))}if(this.get("mobileInstruction")&&this.get("_isNarrativeOnMobile")&&!this.get("_isMobileTextBelowImage")){this.set("instruction",this.get("mobileInstruction"))}return this}});__AMD("components/adapt-contrib-hotgraphic/js/adapt-contrib-hotgraphic",components$1.register("hotgraphic",{model:HotgraphicModel,view:HotgraphicView}));class MatchingView extends QuestionView$1{preinitialize(){var _this=this;this.setActiveOption=function(){return _this.model.setActiveOption(...arguments)};this.setHighlightedOption=function(){return _this.model.setHighlightedOption(...arguments)}}setupQuestion(){this.model.setupRandomisation();this.model.setupInitialHighlighted()}onQuestionRendered(){this.setReadyStatus()}}MatchingView.template="matching.jsx";var MatchingView$1=__AMD("components/adapt-contrib-matching/js/MatchingView",MatchingView);var MatchingItemModel=__AMD("components/adapt-contrib-matching/js/MatchingItemModel",class MatchingItemModel extends ItemModel{defaults(){return ItemModel.resultExtend("defaults",{_isHighlighted:false})}toggleHighlighted(){let isHighlighted=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!this.get("_isHighlighted");this.set("_isHighlighted",isHighlighted)}});var MatchingModel=__AMD("components/adapt-contrib-matching/js/MatchingModel",class MatchingModel extends ItemsQuestionModel{toJSON(){const json=super.toJSON();json._items=this.get("_items");json._options=this.getChildren().toJSON();return json}setUpItems(){let index=0;const items=this.get("_items")||[];const options=items.reduce(((options,item,itemIndex)=>{item._index=itemIndex;const itemOptions=item._options||[];itemOptions.forEach(((option,optionIndex)=>{option._index=index++;option._optionIndex=optionIndex;option._itemIndex=item._index;option._shouldBeSelected=Boolean(option._isCorrect)}));options.push(...itemOptions);return options}),[]);this.set({_items:items,_selectable:items.length});this.setChildren(new Backbone.Collection(options,{model:MatchingItemModel}))}setupRandomisation(){if(!this.get("_isEnabled"))return;if(this.get("_isRandomQuestionOrder")){this.set("_items",_.shuffle(this.get("_items")))}if(!this.get("_isRandom"))return;const children=this.getChildren();children.set(children.shuffle())}setupInitialHighlighted(){this.get("_items")?.forEach((_ref=>{let{_index:_index}=_ref;const selectOption=this.getActiveItemOption(_index)||this.getFirstItemOption(_index);selectOption?.toggleHighlighted(true)}))}resetItems(){super.resetItems();this.resetHighlightedItems();this.setupInitialHighlighted()}resetHighlightedItems(){this.getChildren().forEach((option=>option.toggleHighlighted(false)))}canSubmit(){const options=this.getChildren().models;const activeCount=options.reduce(((count,option)=>count+(option.get("_isActive")?1:0)),0);const canSubmit=activeCount===this.get("_selectable");return canSubmit}getItemOptions(itemIndex){return this.getChildren().filter((option=>option.get("_itemIndex")===itemIndex))}getActiveItemOption(itemIndex){return this.getItemOptions(itemIndex).find((option=>option.get("_isActive")))}getFirstItemOption(itemIndex){return this.getItemOptions(itemIndex)[0]}getCorrectItemOption(itemIndex){const activeOption=this.getActiveItemOption(itemIndex);return activeOption.get("_shouldBeSelected")?activeOption:this.getItemOptions(itemIndex).find((option=>option.get("_shouldBeSelected")))}setHighlightedOption(optionIndex){const itemIndex=this.getItem(optionIndex).get("_itemIndex");const itemOptions=this.getItemOptions(itemIndex);itemOptions.forEach((option=>{const isHighlighted=option.get("_index")===optionIndex;option.toggleHighlighted(isHighlighted)}))}setActiveOption(optionIndex){const itemIndex=this.getItem(optionIndex).get("_itemIndex");const itemOptions=this.getItemOptions(itemIndex);itemOptions.forEach((option=>{const isActive=option.get("_index")===optionIndex;option.toggleHighlighted(isActive);option.toggleActive(isActive)}));this.unsetDuplicateOptions(optionIndex)}unsetDuplicateOptions(optionIndex){const allowOnlyUniqueAnswers=this.get("_allowOnlyUniqueAnswers");if(!allowOnlyUniqueAnswers)return;const itemIndex=this.getItem(optionIndex).get("_itemIndex");const activeItemOption=this.getActiveItemOption(itemIndex);const activeItemOptionText=activeItemOption.get("text");const otherActiveOptions=this.getChildren().filter((option=>option!==activeItemOption&&option.get("_isActive")));otherActiveOptions.forEach((option=>{const optionText=option.get("text");const hasMatchingText=activeItemOptionText===optionText;if(!hasMatchingText)return;option.toggleHighlighted(false);option.toggleActive(false)}))}get maxScore(){if(!this.get("_hasItemScoring"))return super.maxScore;const items=this.get("_items")||[];const maxItemScores=items.map((_ref2=>{let{_index:_index}=_ref2;const itemOptions=this.getItemOptions(_index);const optionScores=itemOptions.map((child=>child.get("_score")||0));optionScores.sort(((a,b)=>a-b));return optionScores[optionScores.length-1]||0}));maxItemScores.sort(((a,b)=>a-b));return maxItemScores.reverse().filter((score=>score>0)).reduce(((maxScore,score)=>maxScore+=score),0)}get minScore(){if(!this.get("_hasItemScoring"))return super.minScore;const items=this.get("_items")||[];const minItemScores=items.map((_ref3=>{let{_index:_index}=_ref3;const itemOptions=this.getItemOptions(_index);const optionScores=itemOptions.map((child=>child.get("_score")||0));optionScores.sort(((a,b)=>a-b));return optionScores[0]||0}));minItemScores.sort(((a,b)=>a-b));return minItemScores.filter((score=>score<0)).reduce(((minScore,score)=>minScore+=score),0)}getInteractionObject(){const items=this.get("_items");const interactions={correctResponsesPattern:null,source:null,target:null};interactions.correctResponsesPattern=[items.map((item=>{const itemPosition=item._index+1;const itemOptions=this.getItemOptions(item._index).sort(((a,b)=>a.get("_index")-b.get("_index")));return[itemPosition,itemOptions.filter((option=>option.get("_shouldBeSelected"))).map((option=>{const optionPosition=option.get("_optionIndex")+1;return`${itemPosition}_${optionPosition}`}))].join("[.]")})).join("[,]")];interactions.source=items.map((item=>{const itemPosition=item._index+1;return{id:`${itemPosition}`,description:item.text}})).flat(Infinity);interactions.target=items.map((item=>{const itemPosition=item._index+1;const itemOptions=this.getItemOptions(item._index).sort(((a,b)=>a.get("_index")-b.get("_index")));return itemOptions.map((option=>{const optionPosition=option.get("_optionIndex")+1;return{id:`${itemPosition}_${optionPosition}`,description:option.get("text")}}))})).flat(Infinity);return interactions}getResponse(){const items=this.get("_items");const responses=items.map((_ref4=>{let{_index:_index}=_ref4;const activeOption=this.getActiveItemOption(_index);const itemIndex=_index+1;const optionIndex=activeOption.get("_optionIndex")+1;return`${itemIndex}.${optionIndex}`}));return responses.join("#")}getResponseType(){return"matching"}getCorrectAnswerAsText(){const correctAnswerTemplate=Adapt$1.course.get("_globals")._components._matching.ariaCorrectAnswer;const ariaAnswer=this.get("_items").map((item=>{const correctOption=this.getCorrectItemOption(item._index);return Handlebars.compile(correctAnswerTemplate)({itemText:item.text,correctAnswer:correctOption.get("text")})})).join("<br>");return ariaAnswer}getUserAnswerAsText(){const userAnswerTemplate=Adapt$1.course.get("_globals")._components._matching.ariaUserAnswer;const items=this.get("_items");const ariaAnswer=items.map((item=>{const activeOption=this.getActiveItemOption(item._index);return Handlebars.compile(userAnswerTemplate)({itemText:item.text,userAnswer:activeOption.get("text")})})).join("<br>");return ariaAnswer}});__AMD("components/adapt-contrib-matching/js/adapt-contrib-matching",components$1.register("matching",{view:MatchingView$1,model:MatchingModel}));__AMD("components/adapt-contrib-mcq/js/adapt-contrib-mcq",components$1.register("mcq",{model:McqModel,view:McqView$1}));var mepPrototype=$.extend({},window.mejs.MediaElementPlayer.prototype);$.extend(window.mejs.MediaElementPlayer.prototype,{detectFullscreenMode:function(){var vendorPrefix=this.getVendorPrefix();var fsEventName="on"+vendorPrefix+"fullscreenchange";if(document[fsEventName]===null){document[fsEventName]=function fullScreenEventHandler(){var elementName=vendorPrefix===""?"fullscreenElement":vendorPrefix+"FullscreenElement";if(document[elementName]!==null){$.inview.lock("mediaelement");Adapt$1.trigger("media:fullscreen:enter")}else{$.inview.unlock("mediaelement");Adapt$1.trigger("media:fullscreen:exit")}}}return mepPrototype.detectFullscreenMode.apply(this,arguments)},getVendorPrefix:function(){var browser=device$1.browser;if(browser==="internet explorer"){return"ms"}if(browser==="microsoft edge"||browser==="safari"){return"webkit"}return""}});Object.assign(window.mejs.MepDefaults,{keyActions:[],defaultSeekForwardInterval:duration=>{if(typeof duration==="object")return duration.duration*.05;return duration*.05},defaultSeekBackwardInterval:duration=>{if(typeof duration==="object")return duration.duration*.05;return duration*.05}});const purge=function(d){let a=d.attributes;if(a){for(let i=a.length-1;i>=0;i-=1){const n=a[i].name;if(typeof d[n]==="function"){d[n]=null}}}a=d.childNodes;if(a){for(let i=0,count=a.length;i<count;i+=1){purge(d.childNodes[i])}}};window.mejs.MediaElementPlayer.prototype.setTrack=function(lang){const t=this;let i;if(lang==="none"){t.selectedTrack=null;t.captionsButton.removeClass("mejs-captions-enabled");t.captionsButton[0].firstChild.setAttribute("aria-pressed",false)}else{for(i=0;i<t.tracks.length;i++){if(t.tracks[i].srclang===lang){if(t.selectedTrack===null){t.captionsButton.addClass("mejs-captions-enabled");t.captionsButton[0].firstChild.setAttribute("aria-pressed",true)}t.selectedTrack=t.tracks[i];t.captions.attr("lang",t.selectedTrack.srclang);t.displayCaptions();break}}}};window.mejs.MediaElementPlayer.prototype.enterFullScreen=function(){const t=this;if(window.mejs.MediaFeatures.hasiOSFullScreen){t.media.webkitEnterFullscreen();return}$(document.documentElement).addClass("mejs-fullscreen");t.normalHeight=t.container.height();t.normalWidth=t.container.width();if(t.fullscreenMode==="native-native"||t.fullscreenMode==="plugin-native"){window.mejs.MediaFeatures.requestFullScreen(t.container[0])}t.container.addClass("mejs-container-fullscreen").width("100%").height("100%");t.containerSizeTimeout=setTimeout((function(){t.container.css({width:"100%",height:"100%"});t.setControlsSize()}),500);if(t.media.pluginType==="native"){t.$media.width("100%").height("100%")}else{t.container.find(".mejs-shim").width("100%").height("100%");setTimeout((function(){const win=$(window);const winW=win.width();const winH=win.height();t.media.setVideoSize(winW,winH)}),500)}t.layers.children("div").width("100%").height("100%");if(t.fullscreenBtn){t.fullscreenBtn.removeClass("mejs-fullscreen").addClass("mejs-unfullscreen")}t.setControlsSize();t.isFullScreen=true;t.container.find(".mejs-captions-text").css("font-size",screen.width/t.width*1*100+"%");t.container.find(".mejs-captions-position").css("bottom","45px");t.container.trigger("enteredfullscreen")};window.mejs.i18n.locale.language="en-US";window.mejs.i18n.locale.strings["en-US"]={};const ariaLabelMappings={playText:"Play",pauseText:"Pause",stopText:"Stop",audioPlayerText:"Audio Player",videoPlayerText:"Video Player",tracksText:"Captions/Subtitles",timeSliderText:"Time Slider",muteText:"Mute Toggle",unmuteStatusText:"Unmute",muteStatusText:"Mute",volumeSliderText:"Volume Slider",fullscreenText:"Fullscreen",goFullscreenText:"Go Fullscreen",turnOffFullscreenText:"Turn off Fullscreen",noneText:"None",skipBackText:"Skip back %1 seconds",allyVolumeControlText:"Use Up/Down Arrow keys to increase or decrease volume.",progessHelpText:"Use Left/Right Arrow keys to advance one second, Up/Down arrows to advance ten seconds."};Adapt$1.on("app:dataReady",(()=>{const dynamicLabels=window.mejs.i18n.locale.strings["en-US"];const fixedDefaults=window.mejs.MepDefaults;const globals=Adapt$1.course.get("_globals")?._components?._media;for(const k in ariaLabelMappings){dynamicLabels[ariaLabelMappings[k]]=globals[k]??ariaLabelMappings[k];fixedDefaults[k]=dynamicLabels[ariaLabelMappings[k]]}}));class MediaView extends ComponentView$1{events(){return{"click .js-media-inline-transcript-toggle":"onToggleInlineTranscript","click .js-media-external-transcript-click":"onExternalTranscriptClicked","click .js-skip-to-transcript":"onSkipToTranscript"}}className(){let classes=super.className();const playerOptions=this.model.get("_playerOptions");if(playerOptions?.toggleCaptionsButtonWhenOnlyOne){classes+=" toggle-captions"}return classes}preRender(){this.listenTo(Adapt$1,{"device:resize":this.onScreenSizeChanged,"device:changed":this.onDeviceChanged,"media:stop":this.onMediaStop});_.bindAll(this,"onMediaElementPlay","onMediaElementPause","onMediaElementEnded","onMediaElementTimeUpdate","onMediaElementSeeking","onOverlayClick","onMediaElementClick","onWidgetInview");this.model.set({_isMediaEnded:false,_isMediaPlaying:false});if(!this.model.get("_media").source)return;const media=this.model.get("_media");if(window.location.protocol==="https:"&&media.source.indexOf("http:")===0){media.source=media.source.replace(/^http:/,"https:")}this.model.set("_media",media)}postRender(){this.setupPlayer();this.addMejsButtonClass()}addMejsButtonClass(){this.$(".mejs-overlay-button").addClass("icon")}setupPlayer(){if(!this.model.get("_playerOptions"))this.model.set("_playerOptions",{});const modelOptions=this.model.get("_playerOptions");if(modelOptions.pluginPath===undefined){_.extend(modelOptions,{pluginPath:"https://cdnjs.cloudflare.com/ajax/libs/mediaelement/2.21.2/",flashName:"flashmediaelement-cdn.swf",flashScriptAccess:"always"})}if(modelOptions.features===undefined){modelOptions.features=["playpause","progress","current","duration"];if(this.model.get("_useClosedCaptions")){modelOptions.features.unshift("tracks")}if(this.model.get("_allowFullScreen")){modelOptions.features.push("fullscreen")}if(this.model.get("_showVolumeControl")){modelOptions.features.push("volume")}}modelOptions.success=_.debounce(this.onPlayerReady.bind(this),100);if(this.model.get("_useClosedCaptions")){const startLanguage=this.model.get("_startLanguage")||"en";if(!offlineStorage$1.get("captions")){offlineStorage$1.set("captions",startLanguage)}modelOptions.startLanguage=this.checkForSupportedCCLanguage(offlineStorage$1.get("captions"))}if(modelOptions.alwaysShowControls===undefined){modelOptions.alwaysShowControls=false}if(modelOptions.hideVideoControlsOnLoad===undefined){modelOptions.hideVideoControlsOnLoad=true}this.addMediaTypeClass();this.addThirdPartyFixes(modelOptions,(()=>{this.$("audio, video").mediaelementplayer(modelOptions);this.cleanUpPlayer();const _media=this.model.get("_media");if(!_media.mp3&&!_media.mp4&&!_media.ogv&&!_media.webm&&!_media.source){logging$1.warn("ERROR! No media is selected in components.json for component "+this.model.get("_id"));this.setReadyStatus();return}if(!_media.source)return;this.$(".media__widget").addClass("external-source")}))}addMediaTypeClass(){const media=this.model.get("_media");if(!media?.type)return;const typeClass=media.type.replace(/\//,"-");this.$(".media__widget").addClass(typeClass)}addThirdPartyFixes(modelOptions,callback){const media=this.model.get("_media");if(!media)return callback();if(media.mp3||media.ogg){modelOptions.alwaysShowControls=true}switch(media.type){case"video/vimeo":modelOptions.alwaysShowControls=false;modelOptions.hideVideoControlsOnLoad=true;modelOptions.features=[];if(MediaView.froogaloopAdded)return callback();$.getScript("assets/froogaloop.js").done((()=>{MediaView.froogaloopAdded=true;callback()})).fail((()=>{MediaView.froogaloopAdded=false;logging$1.error("Could not load froogaloop.js")}));break;default:callback()}}cleanUpPlayer(){const containerLabel=this.model.get("displayTitle")||this.model.get("title");this.$(".media__widget").children(".mejs-offscreen").remove();this.$("[role=application]").removeAttr("role tabindex");this.$(".mejs-container").attr({role:"region","aria-label":containerLabel});this.$("[aria-controls]").removeAttr("aria-controls");this.$(".mejs-overlay-play").attr("aria-hidden","true")}setupEventListeners(){this.completionEvent=this.model.get("_setCompletionOn")||"play";if(this.completionEvent==="inview"){this.setupInviewCompletion(".component__widget")}if(this.model.get("_preventForwardScrubbing")&&!this.model.get("_isComplete")){$(this.mediaElement).on({seeking:this.onMediaElementSeeking,timeupdate:this.onMediaElementTimeUpdate})}$(this.mediaElement).on({play:this.onMediaElementPlay,pause:this.onMediaElementPause,ended:this.onMediaElementEnded});_.delay(this.listenForCaptionsChange.bind(this),250)}listenForCaptionsChange(){if(!this.model.get("_useClosedCaptions"))return;const selector=this.model.get("_playerOptions").toggleCaptionsButtonWhenOnlyOne?".mejs-captions-button button":".mejs-captions-selector";this.$(selector).on("click.mediaCaptionsChange",_.debounce((()=>{const srclang=this.mediaElement.player.selectedTrack?this.mediaElement.player.selectedTrack.srclang:"none";offlineStorage$1.set("captions",srclang);Adapt$1.trigger("media:captionsChange",this,srclang)}),250));this.listenTo(Adapt$1,"media:captionsChange",this.onCaptionsChanged)}onCaptionsChanged(view,lang){if(view?.cid===this.cid)return;lang=this.checkForSupportedCCLanguage(lang);this.mediaElement.player.setTrack(lang);const $inputs=this.$(".mejs-captions-selector input");$inputs.filter(":checked").prop("checked",false);$inputs.filter(`[value="${lang}"]`).prop("checked",true)}checkForSupportedCCLanguage(lang){if(!lang||lang==="none")return"none";if(_.findWhere(this.model.get("_media").cc,{srclang:lang}))return lang;return this.model.get("_startLanguage")||"none"}onMediaElementPlay(event){this.queueGlobalEvent("play");Adapt$1.trigger("media:stop",this);if(this.model.get("_pauseWhenOffScreen")){this.$(".mejs-container").on("inview",this.onWidgetInview)}this.model.set({_isMediaPlaying:true,_isMediaEnded:false});if(this.completionEvent!=="play")return;this.setCompletionStatus()}onMediaElementPause(event){this.queueGlobalEvent("pause");this.$(".mejs-container").off("inview",this.onWidgetInview);this.model.set("_isMediaPlaying",false)}onMediaElementEnded(event){this.queueGlobalEvent("ended");this.model.set("_isMediaEnded",true);if(this.completionEvent==="ended"){this.setCompletionStatus()}}onWidgetInview(event,isInView){if(!isInView&&!this.mediaElement.paused)this.mediaElement.player.pause()}onMediaElementSeeking(event){let maxViewed=this.model.get("_maxViewed");if(!maxViewed){maxViewed=0}if(event.target.currentTime<=maxViewed)return;event.target.currentTime=maxViewed}onMediaElementTimeUpdate(event){let maxViewed=this.model.get("_maxViewed");if(!maxViewed){maxViewed=0}if(event.target.currentTime<=maxViewed)return;this.model.set("_maxViewed",event.target.currentTime)}setupPlayPauseToggle(){const player=this.mediaElement.player;if(!player){logging$1.warn("MediaView.setupPlayPauseToggle: OOPS! there is no player reference.");return}player.options.clickToPlayPause=false;this.$(".mejs-overlay-button").on("click",this.onOverlayClick);this.$(".mejs-mediaelement").on("click",this.onMediaElementClick)}onMediaStop(view){if(view?.cid===this.cid)return;if(!this.mediaElement||!this.mediaElement.player)return;this.mediaElement.player.pause()}onOverlayClick(){const player=this.mediaElement.player;if(!player)return;player.play()}onMediaElementClick(event){const player=this.mediaElement.player;if(!player)return;const isPaused=player.media.paused;if(!isPaused)player.pause()}remove(){this.$(".mejs-overlay-button").off("click",this.onOverlayClick);this.$(".mejs-mediaelement").off("click",this.onMediaElementClick);this.$(".mejs-container").off("inview",this.onWidgetInview);if(this.model.get("_useClosedCaptions")){const selector=this.model.get("_playerOptions").toggleCaptionsButtonWhenOnlyOne?".mejs-captions-button button":".mejs-captions-selector";this.$(selector).off("click.mediaCaptionsChange")}const modelOptions=this.model.get("_playerOptions");delete modelOptions.success;const media=this.model.get("_media");if(media){switch(media.type){case"video/vimeo":this.$("iframe")[0].isRemoved=true}}if(this.mediaElement&&this.mediaElement.player){const playerId=this.mediaElement.player.id;purge(this.$el[0]);this.mediaElement.player.remove();if(window.mejs.players[playerId]){delete window.mejs.players[playerId]}}if(this.mediaElement){$(this.mediaElement).off({play:this.onMediaElementPlay,pause:this.onMediaElementPause,ended:this.onMediaElementEnded,seeking:this.onMediaElementSeeking,timeupdate:this.onMediaElementTimeUpdate});this.mediaElement.src="";$(this.mediaElement.pluginElement).remove();delete this.mediaElement}super.remove()}onDeviceChanged(){if(!this.model.get("_media").source)return;this.$(".mejs-container").width(this.$(".component__widget").width())}onPlayerReady(mediaElement,domObject){this.mediaElement=mediaElement;let player=this.mediaElement.player;if(!player)player=window.mejs.players[this.$(".mejs-container").attr("id")];const hasTouch=window.mejs.MediaFeatures.hasTouch;if(hasTouch){this.setupPlayPauseToggle()}this.addThirdPartyAfterFixes();this.cleanUpPlayerAfter();if(player&&this.model.has("_startVolume")){player.setVolume(parseInt(this.model.get("_startVolume"))/100)}this.setReadyStatus();this.setupEventListeners()}addThirdPartyAfterFixes(){const media=this.model.get("_media");switch(media.type){case"video/vimeo":this.$(".mejs-container").attr("tabindex",0)}}cleanUpPlayerAfter(){this.$("[aria-valuemax='NaN']").attr("aria-valuemax",0)}onScreenSizeChanged(){this.$("audio, video").width(this.$(".component__widget").width())}onSkipToTranscript(){_.delay((()=>{a11y$1.focus(this.$(".media__transcript-btn"))}),250)}onToggleInlineTranscript(event){if(event)event.preventDefault();const $transcriptBodyContainer=this.$(".media__transcript-body-inline");const $button=this.$(".media__transcript-btn-inline");const $buttonText=this.$(".media__transcript-btn-inline .media__transcript-btn-text");if($transcriptBodyContainer.hasClass("inline-transcript-open")){$transcriptBodyContainer.stop(true,true).slideUp((()=>{$(window).resize()})).removeClass("inline-transcript-open");$button.attr("aria-expanded",false);$buttonText.html(this.model.get("_transcript").inlineTranscriptButton);return}$transcriptBodyContainer.stop(true,true).slideDown((()=>{$(window).resize()})).addClass("inline-transcript-open");$button.attr("aria-expanded",true);$buttonText.html(this.model.get("_transcript").inlineTranscriptCloseButton);if(this.model.get("_transcript")._setCompletionOnView!==false){Adapt$1.trigger("media:transcriptComplete",this);this.setCompletionStatus()}}onExternalTranscriptClicked(event){if(this.model.get("_transcript")._setCompletionOnView===false)return;Adapt$1.trigger("media:transcriptComplete",this);this.setCompletionStatus()}queueGlobalEvent(eventType){const time=Date.now();const lastEvent=this.lastEvent||{time:0};const timeSinceLastEvent=time-lastEvent.time;const debounceTime=500;this.lastEvent={time:time,type:eventType};clearTimeout(this.eventTimeout);if(eventType==="ended"){return this.triggerGlobalEvent(eventType)}if(timeSinceLastEvent<=debounceTime)return;this.eventTimeout=setTimeout(this.triggerGlobalEvent.bind(this,eventType),debounceTime)}triggerGlobalEvent(eventType){const player=this.mediaElement.player;const eventObj={type:eventType,src:this.mediaElement.src,platform:this.mediaElement.pluginType};if(player)eventObj.isVideo=player.isVideo;Adapt$1.trigger("media",eventObj)}}MediaView.froogaloopAdded=false;var MediaView$1=__AMD("components/adapt-contrib-media/js/mediaView",MediaView);__AMD("components/adapt-contrib-media/js/adapt-contrib-media",components$1.register("media",{model:ComponentModel$1.extend({}),view:MediaView$1}));var NarrativeModel=__AMD("components/adapt-contrib-narrative/js/NarrativeModel",class NarrativeModel extends ItemsComponentModel{});var MODE=__AMD("components/adapt-contrib-narrative/js/modeEnum",new ENUM(["SMALL","LARGE"]));class NarrativeView extends ComponentView$1{events(){return{"swipeleft .js-narrative-swipe":"onSwipeLeft","swiperight .js-narrative-swipe":"onSwipeRight"}}initialize(){super.initialize(...arguments);this.model.set("_isInitial",true);this.model.set("_activeItemIndex",0);this.onNavigationClicked=this.onNavigationClicked.bind(this);this.openPopup=this.openPopup.bind(this)}preRender(){this.listenTo(Adapt$1,{"device:changed device:resize":this.reRender,"notify:closed":this.closeNotify});this.renderMode();this.listenTo(this.model.getChildren(),"change:_isActive",this.onItemsActiveChange);this.calculateWidths()}setFocus(itemIndex){const $animatedElement=this.isLargeMode()?this.$(".narrative__slider"):this.$(".narrative__strapline-header-inner");const hasAnimation=$animatedElement.css("transitionDuration")!=="0s";if(hasAnimation){$animatedElement.one("transitionend",(()=>this.focusOnNarrativeElement(itemIndex)));return}requestAnimationFrame((()=>{this.focusOnNarrativeElement(itemIndex)}))}focusOnNarrativeElement(itemIndex){const dataIndexAttr=`[data-index='${itemIndex}']`;const $elementToFocus=this.isLargeMode()?this.$(`.narrative__content-item${dataIndexAttr}`):this.$(`.narrative__strapline-btn${dataIndexAttr}`);a11y$1.focusFirst($elementToFocus);this.setupBackNextLabels();this.manageBackNextStates()}onItemsActiveChange(item,_isActive){if(!_isActive)return;if(this.isTextBelowImage()){item.toggleVisited(true)}const index=item.get("_index");this.model.set("_activeItemIndex",index);this.setStage(item);if(this.model.get("_isInitial")){this.setupBackNextLabels();this.manageBackNextStates();return}this.setFocus(index)}calculateMode(){const mode=device$1.isScreenSizeMin("medium")?MODE.LARGE:MODE.SMALL;this.model.set("_mode",mode);this.model.set("_isLargeMode",mode===MODE.LARGE)}renderMode(){this.calculateMode();const isTextBelowImage=this.isTextBelowImage();this.model.set("_isTextBelowImageResolved",isTextBelowImage)}isLargeMode(){return this.model.get("_mode")===MODE.LARGE}isTextBelowImage(){const isTextBelowImage=device$1.isScreenSizeMin("medium")?this.model.get("_isTextBelowImage"):this.model.get("_isMobileTextBelowImage");return Boolean(isTextBelowImage)}postRender(){this.renderMode();this.setupNarrative();this.$(".narrative__slider").imageready(this.setReadyStatus.bind(this));this.$(".narrative__slide-container")[0]?.addEventListener("scroll",this.onScroll,true)}setupNarrative(){const items=this.model.getChildren();if(!items||!items.length)return;let activeItem=this.model.getActiveItem();if(!activeItem){activeItem=this.model.getItem(0);activeItem.toggleActive(true)}else{items.trigger("change:_isActive",activeItem,true)}this.calculateWidths();if(!this.isLargeMode()&&!this.model.get("_wasHotgraphic")){this.replaceInstructions()}this.setupEventListeners();this.model.set("_isInitial",false)}calculateWidths(){const itemCount=this.model.getChildren().length;this.model.set({_totalWidth:100*itemCount,_itemWidth:100/itemCount})}resizeControl(){const previousMode=this.model.get("_mode");this.renderMode();if(previousMode!==this.model.get("_mode"))this.replaceInstructions();this.setupBackNextLabels();const activeItem=this.model.getActiveItem();if(activeItem)this.setStage(activeItem)}reRender(){if(this.model.get("_wasHotgraphic")&&this.isLargeMode()){this.replaceWithHotgraphic();return}this.resizeControl()}closeNotify(){this.evaluateCompletion()}replaceInstructions(){if(this.isLargeMode()||this.isTextBelowImage()){this.$(".narrative__instruction-inner").html(this.model.get("instruction"));return}if(this.model.get("mobileInstruction")&&!this.model.get("_wasHotgraphic")){this.$(".narrative__instruction-inner").html(this.model.get("mobileInstruction"))}}replaceWithHotgraphic(){const HotgraphicView=components$1.getViewClass("hotgraphic");if(!HotgraphicView)return;const model=this.prepareHotgraphicModel();const newHotgraphic=new HotgraphicView({model:model});const parentView=data$1.findViewByModelId(model.get("_parentId"));const $container=parentView.$el.find(".component__container");$container.append(newHotgraphic.$el);const parentChildViews=parentView.getChildViews();const currentIndex=parentChildViews.findIndex((view=>view===this));parentChildViews[currentIndex]=newHotgraphic;parentView.setChildViews(parentChildViews);this.remove();_.defer((()=>{Adapt$1.trigger("device:resize")}))}prepareHotgraphicModel(){const model=this.model;model.resetActiveItems();model.set({_isPopupOpen:false,_component:"hotgraphic",body:model.get("originalBody"),instruction:model.get("originalInstruction")});return model}moveSliderToIndex(itemIndex){let offset=this.model.get("_itemWidth")*itemIndex;if(Adapt$1.config.get("_defaultDirection")==="ltr"){offset*=-1}this.model.set("_translateXOffset",offset)}setStage(item){const index=item.get("_index");if(this.isLargeMode()){item.toggleVisited(true)}this.evaluateCompletion();this.shouldShowInstructionError();this.moveSliderToIndex(index)}manageBackNextStates(){let index=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.model.getActiveItem().get("_index");const totalItems=this.model.getChildren().length;const canCycleThroughPagination=this.model.get("_canCycleThroughPagination");const shouldEnableBack=index>0||canCycleThroughPagination;const shouldEnableNext=index<totalItems-1||canCycleThroughPagination;this.model.set("shouldEnableBack",shouldEnableBack);this.model.set("shouldEnableNext",shouldEnableNext)}setupBackNextLabels(){let index=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.model.getActiveItem().get("_index");const totalItems=this.model.getChildren().length;const canCycleThroughPagination=this.model.get("_canCycleThroughPagination");const isAtStart=index===0;const isAtEnd=index===totalItems-1;const globals=Adapt$1.course.get("_globals");const narrativeGlobals=globals._components._narrative;let prevTitle=isAtStart?"":this.model.getItem(index-1).get("title");let nextTitle=isAtEnd?"":this.model.getItem(index+1).get("title");let backItem=isAtStart?null:index;let nextItem=isAtEnd?null:index+2;if(canCycleThroughPagination){if(isAtStart){prevTitle=this.model.getItem(totalItems-1).get("title");backItem=totalItems}if(isAtEnd){nextTitle=this.model.getItem(0).get("title");nextItem=1}}const backLabel=compile(narrativeGlobals.previous,{_globals:globals,title:prevTitle,itemNumber:backItem,totalItems:totalItems});const nextLabel=compile(narrativeGlobals.next,{_globals:globals,title:nextTitle,itemNumber:nextItem,totalItems:totalItems});this.model.set("backLabel",backLabel);this.model.set("nextLabel",nextLabel)}evaluateCompletion(){if(this.model.areAllItemsCompleted()){this.trigger("allItems");this.$(".narrative__instruction").removeClass("has-error")}}openPopup(){const currentItem=this.model.getActiveItem();notify$1.popup({title:currentItem.get("title"),body:currentItem.get("body")});Adapt$1.on("popup:opened",(function(){currentItem.toggleVisited(true)}))}onNavigationClicked(e){const $btn=$(e.currentTarget);let index=this.model.getActiveItem().get("_index");$btn.data("direction")==="right"?index++:index--;this.model.setActiveItem(index)}onSwipeLeft(){let index=this.model.getActiveItem().get("_index");this.model.setActiveItem(++index)}onSwipeRight(){let index=this.model.getActiveItem().get("_index");this.model.setActiveItem(--index)}onScroll(event){event.preventDefault();event.target.scrollTo(0,0)}shouldShowInstructionError(){const prevItemIndex=this.model.getActiveItem().get("_index")-1;if(prevItemIndex<0||this.model.getItem(prevItemIndex).get("_isVisited"))return;this.$(".narrative__instruction").addClass("has-error")}setupEventListeners(){if(this.model.get("_setCompletionOn")!=="inview")return;this.setupInviewCompletion(".component__widget")}preRemove(){this.$(".narrative__slide-container")[0]?.removeEventListener("scroll",this.onScroll,true)}}NarrativeView.template="narrative.jsx";var NarrativeView$1=__AMD("components/adapt-contrib-narrative/js/NarrativeView",NarrativeView);__AMD("components/adapt-contrib-narrative/js/adapt-contrib-narrative",components$1.register("narrative",{model:NarrativeModel,view:NarrativeView$1}));class OpenTextInputModel extends QuestionModel$1{formatPlaceholder(){let placeholder=this.get("placeholder")||"";placeholder=placeholder.replace(/"/g,"'");this.set("placeholder",placeholder)}setupQuestion(localUserAnswer){this.set("_canShowFeedback",false);this.set("_feedback",null);this.formatPlaceholder();if(localUserAnswer){this.setUserAnswer(localUserAnswer)}else{const answer=this.getUserAnswer();this.set("userAnswerString",answer)}let modelAnswer=this.get("modelAnswer");modelAnswer=modelAnswer?modelAnswer.replace(/\\n|&#10;/g,"\n"):"";this.set("modelAnswer",modelAnswer);let _buttonState=BUTTON_STATE$1.SUBMIT;if(this.get("_isComplete")){_buttonState=BUTTON_STATE$1.CORRECT;if(this.get("_canShowModelAnswer")){_buttonState=BUTTON_STATE$1.SHOW_CORRECT_ANSWER}}this.set("_buttonState",_buttonState);const buttons=this.get("_buttons");if(buttons["_hideCorrectAnswer"]===undefined){buttons._hideCorrectAnswer=buttons._showUserAnswer||"Show User Answer"}if(buttons["_showCorrectAnswer"]===undefined){buttons._showCorrectAnswer=buttons._showModelAnswer||"Show Model Answer"}this.set("_buttons",buttons)}getUserAnswer(){const answerArray=this.get("_userAnswer")||this.get("userAnswer")||[];return String.fromCharCode(...answerArray)}setUserAnswer(answer){const _userAnswer=[...answer].map(((char,index)=>answer.codePointAt(index)));this.set("userAnswerString",answer);this.set("_userAnswer",_userAnswer)}canSubmit(){return this.get("charactersLeft")>=0}isCorrect(){return this.canSubmit()}getResponse(){return this.getUserAnswer()}getResponseType(){return"fill-in"}getInteractionObject(){return{correctResponsesPattern:[this.get("modelAnswer")]}}}var OpenTextInputModel$1=__AMD("components/adapt-contrib-openTextInput/js/openTextInputModel",OpenTextInputModel);const HIDE_MODEL_ANSWER_CLASS="opentextinput__hide-modelanswer";const SHOW_MODEL_ANSWER_CLASS="opentextinput__show-modelanswer";class OpenTextInputView extends QuestionView$1{events(){return{"keyup .opentextinput__item-textbox":"onKeyUpTextarea"}}setupQuestion(){this.listenTo(this.model,"change:_isComplete",this.onCompleteChanged);const localUserAnswer=this.loadLocalAnswer();this.model.setupQuestion(localUserAnswer)}onCompleteChanged(isComplete,buttonState){this.$textbox.prop("disabled",isComplete);if(this.$textbox.html()===""){this.$textbox.html(this.model.getUserAnswer().replace(/\n/g,"<br>"))}if(!isComplete)return;if(!this.model.get("_canShowModelAnswer"))return;Adapt$1.a11y.toggleAccessibleEnabled(this.$(".btn__action"),true);Adapt$1.a11y.toggleAccessible(this.$(".opentextinput__count-amount"),false);if(_.isEmpty(buttonState))return;let _buttonState=BUTTON_STATE$1.HIDE_CORRECT_ANSWER;if(buttonState===BUTTON_STATE$1.CORRECT||buttonState===BUTTON_STATE$1.HIDE_CORRECT_ANSWER||buttonState===BUTTON_STATE$1.SUBMIT){_buttonState=BUTTON_STATE$1.SHOW_CORRECT_ANSWER}this.model.set("_buttonState",_buttonState)}isCorrect(){return this.model.isCorrect()}onQuestionRendered(){this.listenTo(this.buttonsView,"buttons:stateUpdate",this.onActionClicked);this.$textbox=this.$("textarea.opentextinput__item-textbox");this.$modelAnswer=this.$(".opentextinput__item-modelanswer");this.$countChars=this.$(".opentextinput__count-characters-container");Adapt$1.a11y.toggleAccessibleEnabled(this.$countChars,false);this.countCharacters();this.setReadyStatus();if(this.model.get("_isComplete")&&!this.model.get("_canShowModelAnswer")){this.model.set("_buttonState",BUTTON_STATE$1.CORRECT)}if(!this.model.get("_isInteractionComplete"))return;this.$textbox.prop("disabled",true)}loadLocalAnswer(){const identifier=this.model.get("_id")+"-OpenTextInput-UserAnswer";let userAnswer=false;if(this.supportsHtml5Storage()&&!this.model.get("_isResetOnRevisit")){userAnswer=localStorage.getItem(identifier)}return userAnswer}supportsHtml5Storage(){try{return"localStorage"in window&&typeof window["localStorage"]!=="undefined"}catch(e){return false}}showCountAmount(){this.$(".opentextinput__count-amount").html(`${this.model.get("charactersLeft")} ${this.model.get("remainingCharactersText")}`)}countCharacters(){const charLengthOfTextarea=this.$textbox.val().length;const allowedCharacters=this.model.get("_allowedCharacters");let charactersLeft=charLengthOfTextarea;if(allowedCharacters!==null){charactersLeft=allowedCharacters-charLengthOfTextarea}this.model.set("charactersLeft",charactersLeft);this.showCountAmount()}onKeyUpTextarea(){const countandLimitCharacters=_.throttle((()=>{this.limitCharacters();this.countCharacters();this.model.setUserAnswer(this.$textbox.val())}),300);countandLimitCharacters();this.model.checkCanSubmit()}limitCharacters(){const allowedCharacters=this.model.get("_allowedCharacters");if(allowedCharacters!==null&&this.$textbox.val().length>allowedCharacters){const substringValue=this.$textbox.val().substring(0,allowedCharacters);this.$textbox.val(substringValue)}}onSubmitted(){const userAnswer=this.$textbox.val();this.model.setUserAnswer(userAnswer);this.storeUserAnswer()}storeUserAnswer(){const identifier=this.model.get("_id")+"-OpenTextInput-UserAnswer";if(this.supportsHtml5Storage()&&!this.model.get("_isResetOnRevisit")){try{localStorage.setItem(identifier,this.$textbox.val())}catch(e){console.log("ERROR: HTML5 localStorage.setItem() failed! Unable to save user answer.")}}this.model.set("_isSaved",true)}onActionClicked(buttonState){if(!this.model.get("_isComplete"))return;this.onCompleteChanged(true,buttonState)}postRender(){QuestionView$1.prototype.postRender.call(this);if(this.$modelAnswer.height()<=0){this.$textbox.css("height","auto");this.$countChars.css("height","auto")}else{this.$textbox.height(this.$modelAnswer.height())}this.$modelAnswer.addClass(HIDE_MODEL_ANSWER_CLASS)}showCorrectAnswer(){this.model.set("_buttonState",BUTTON_STATE$1.HIDE_CORRECT_ANSWER);this.$textbox.hide();this.$countChars.hide();this.$modelAnswer.addClass(SHOW_MODEL_ANSWER_CLASS).removeClass(HIDE_MODEL_ANSWER_CLASS);Adapt$1.a11y.focusFirst(this.$(".opentextinput__item-modelanswer"))}hideCorrectAnswer(){this.model.set("_buttonState",BUTTON_STATE$1.SHOW_CORRECT_ANSWER);this.$("textarea.opentextinput__item-textbox").show();this.$(".opentextinput__count-characters-container").show();this.$(".opentextinput__item-modelanswer").addClass(HIDE_MODEL_ANSWER_CLASS).removeClass(SHOW_MODEL_ANSWER_CLASS)}getResponse(){return this.model.getResponse()}getResponseType(){return this.model.getResponseType()}getInteractionObject(){return this.model.getInteractionObject()}resetQuestionOnRevisit(){this.resetQuestion()}resetQuestion(){this.model.setUserAnswer("")}}var OpenTextInputView$1=__AMD("components/adapt-contrib-openTextInput/js/openTextInputView",OpenTextInputView);Adapt$1.once("adapt:start",restoreQuestionStatusPolyfill);__AMD("components/adapt-contrib-openTextInput/js/adapt-contrib-openTextInput",Adapt$1.register("openTextInput",{view:OpenTextInputView$1,model:OpenTextInputModel$1}));function restoreQuestionStatusPolyfill(){Adapt$1.components.each((function(component){if(component.get("_component")!=="openTextInput")return;if(!component.get("_isComplete"))return;component.set({_isCorrect:true,_isInteractionComplete:true});component.trigger("change:_isComplete",component,true)}))}class SliderView extends QuestionView$1{initialize(){this.getIndexFromValue=this.getIndexFromValue.bind(this);this.onNumberSelected=this.onNumberSelected.bind(this);this.getCorrectAnswers=this.model.getCorrectAnswers.bind(this.model);super.initialize(...arguments)}setupQuestion(){if(this.model.get("_isSubmitted"))return;this.selectItem(this.getIndexFromValue(this.model.get("_selectedItem").value))}onQuestionRendered(){this.setReadyStatus()}getIndexFromValue(value){value=parseInt(value);const step=this.model.get("_scaleStep")??1;return this.model.get("_items").reduce(((found,item)=>{if(found)return found;if(item.value===value)return item;const rangeStart=item.value-step/2;const rangeEnd=item.value+step/2;const inRange=value>=rangeStart&&value<rangeEnd;if(inRange)return item;return found}),null).index}onNumberSelected(value){if(this.model.get("_isInteractionComplete")){return}const index=this.getIndexFromValue(value);this.selectItem(index)}onCannotSubmit(){}selectItem(itemIndex){this.model.deselectAllItems();const item=this.model.get("_items")[itemIndex];if(!item)return;item.selected=true;this.model.set("_selectedItem",item)}}SliderView.template="slider.jsx";var SliderView$1=__AMD("components/adapt-contrib-slider/js/SliderView",SliderView);var SliderModel=__AMD("components/adapt-contrib-slider/js/SliderModel",class SliderModel extends QuestionModel$1{defaults(){return QuestionModel$1.resultExtend("defaults",{_showScale:true,_showScaleNumbers:true,_showScaleIndicator:true,_showNumber:true})}init(){QuestionModel$1.prototype.init.call(this);this.setupModelItems();this.selectDefaultItem()}reset(){let type=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"hard";let canReset=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.get("_canReset");const wasReset=super.reset(type,canReset);if(!wasReset)return false;this.deselectAllItems();this.selectDefaultItem();return true}selectDefaultItem(){this.set("_selectedItem",this.get("_items")[0])}getDecimalPlaces(num){return(num.toString().split(".")[1]||[]).length}setupModelItems(){const items=[];const answer=this.get("_correctAnswer");const range=this.get("_correctRange");const start=this.get("_scaleStart");const end=this.get("_scaleEnd");const step=this.get("_scaleStep")||1;const dp=this.getDecimalPlaces(step);for(let i=start;i<=end;i+=step){if(dp!==0){i=parseFloat(i.toFixed(dp))}items.push({value:i,selected:false,correct:answer?i===Number(answer):i>=range._bottom&&i<=range._top});const index=items.length-1;items[index].index=index}this.set({_items:items,_marginDir:Adapt$1.config.get("_defaultDirection")==="rtl"?"right":"left"})}canSubmit(){return true}restoreUserAnswers(){if(!this.get("_isSubmitted")){this.set({_userAnswer:undefined});this.selectDefaultItem();return}const items=this.get("_items");const userAnswer=this.get("_userAnswer");const selectedItem=items.find((_ref=>{let{value:value}=_ref;return value===userAnswer}));if(selectedItem){selectedItem.selected=true;this.set("_selectedItem",selectedItem)}this.setQuestionAsSubmitted();this.markQuestion();this.setScore();this.setupFeedback()}storeUserAnswer(){this.set("_userAnswer",this.get("_selectedItem").value)}resetUserAnswer(){this.set({_isAtLeastOneCorrectSelection:false,_userAnswer:undefined});this.selectDefaultItem()}deselectAllItems(){this.get("_items").forEach((item=>item.selected=false))}isCorrect(){const numberOfCorrectAnswers=this.get("_items").filter((_ref2=>{let{selected:selected,correct:correct}=_ref2;return selected&&correct})).length;this.set("_isAtLeastOneCorrectSelection",numberOfCorrectAnswers>0);this.set("_numberOfCorrectAnswers",numberOfCorrectAnswers);return this.get("_isAtLeastOneCorrectSelection")}isPartlyCorrect(){return this.get("_isAtLeastOneCorrectSelection")}setScore(){const numberOfCorrectAnswers=this.get("_numberOfCorrectAnswers");const questionWeight=this.get("_questionWeight");const score=questionWeight*numberOfCorrectAnswers;this.set("_score",score)}getResponse(){return this.get("_userAnswer").toString()}getResponseType(){return"numeric"}getCorrectAnswers(){const answerSingle=this.get("_correctAnswer");const answers=[];if(answerSingle){return[answerSingle]}const answerMultiple=this.get("_correctRange");if(!answerMultiple){return answers}const bottom=answerMultiple._bottom;const top=answerMultiple._top;if(bottom===undefined||top===undefined){return answers}let answer=bottom;const step=this.get("_scaleStep")||1;while(answer<=top){answers.push(answer);answer+=step}return answers}getCorrectAnswerAsText(){const globals=Adapt$1.course.get("_globals")._components._slider;const answers=this.getCorrectAnswers();if(answers.length>1){return Handlebars.compile(globals.ariaCorrectAnswerRange)({bottom:answers.shift(),top:answers.pop()})}return Handlebars.compile(globals.ariaCorrectAnswer)({correctAnswer:answers[0]})}getUserAnswerAsText(){const answerTemplate=Adapt$1.course.get("_globals")._components._slider.ariaUserAnswer;return Handlebars.compile(answerTemplate)({userAnswer:this.get("_userAnswer")})}});__AMD("components/adapt-contrib-slider/js/adapt-contrib-slider",components$1.register("slider",{view:SliderView$1,model:SliderModel}));class TextView extends ComponentView$1{postRender(){this.setReadyStatus();this.setupInview()}setupInview(){const selector=this.getInviewElementSelector();if(!selector)return this.setCompletionStatus();this.setupInviewCompletion(selector)}getInviewElementSelector(){if(this.model.get("body"))return".component__body";if(this.model.get("instruction"))return".component__instruction";if(this.model.get("displayTitle"))return".component__title";return null}}TextView.template="text.jsx";var TextView$1=__AMD("components/adapt-contrib-text/js/TextView",TextView);var TextModel=__AMD("components/adapt-contrib-text/js/TextModel",class TextModel extends ComponentModel$1{});__AMD("components/adapt-contrib-text/js/adapt-contrib-text",components$1.register("text",{model:TextModel,view:TextView$1}));class TextInputView extends QuestionView$1{events(){return{"focus .js-textinput-textbox":"clearValidationError","change .js-textinput-textbox":"onInputChanged","keyup .js-textinput-textbox":"onInputChanged"}}setupQuestion(){this.model.setupRandomisation()}disableQuestion(){this.setAllItemsEnabled(false)}enableQuestion(){this.setAllItemsEnabled(true)}setAllItemsEnabled(isEnabled){this.model.get("_items").forEach(((item,index)=>{const $itemInput=this.$(".js-textinput-textbox").eq(index);$itemInput.prop("disabled",!isEnabled)}))}onQuestionRendered(){this.setReadyStatus()}clearValidationError(){this.$(".js-textinput-textbox").removeClass("has-error")}onCannotSubmit(){this.showValidationError()}showValidationError(){this.$(".js-textinput-textbox").addClass("has-error")}showMarking(){if(!this.model.get("_canShowMarking"))return;this.model.get("_items").forEach(((item,i)=>{const $item=this.$(".js-textinput-item").eq(i);$item.removeClass("is-correct is-incorrect").addClass(item._isCorrect?"is-correct":"is-incorrect")}))}resetQuestion(){this.$(".js-textinput-textbox").prop("disabled",!this.model.get("_isEnabled")).val("");this.model.set({_isAtLeastOneCorrectSelection:false,_isCorrect:undefined})}showCorrectAnswer(){const correctAnswers=this.model.get("_answers");this.model.get("_items").forEach(((item,index)=>{const correctAnswer=correctAnswers?correctAnswers[index][0]:item._answers[0];this.$(".js-textinput-textbox").eq(index).val(correctAnswer)}))}hideCorrectAnswer(){this.model.get("_items").forEach(((item,index)=>{this.$(".js-textinput-textbox").eq(index).val(item.userAnswer)}))}onInputChanged(e){const $input=$(e.target);this.model.setItemUserAnswer($input.parents(".js-textinput-item").index(),$input.val())}}TextInputView.template="textinput.jsx";var TextInputView$1=__AMD("components/adapt-contrib-textInput/js/textInputView",TextInputView);class TextInputModel extends QuestionModel$1{init(){super.init();this.set("_genericAnswerIndexOffset",TextInputModel.genericAnswerIndexOffset);this.setupQuestionItemIndexes();this.checkCanSubmit()}reset(){let type=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"hard";let canReset=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.get("_canReset");const wasReset=super.reset(type,canReset);if(!wasReset)return false;this.set({_isAtLeastOneCorrectSelection:false,_isCorrect:null});return true}setupQuestionItemIndexes(){this.get("_items").forEach(((item,index)=>{if(item._index===undefined)item._index=index;if(item._answerIndex===undefined)item._answerIndex=-1}))}restoreUserAnswers(){if(!this.get("_isSubmitted"))return;const userAnswer=this.get("_userAnswer");const genericAnswers=this.get("_answers");this.get("_items").forEach((item=>{const answerIndex=userAnswer[item._index];if(answerIndex>=TextInputModel.genericAnswerIndexOffset){item.userAnswer=genericAnswers[answerIndex-TextInputModel.genericAnswerIndexOffset];item._answerIndex=answerIndex}else if(answerIndex>-1){item.userAnswer=item._answers[answerIndex];item._answerIndex=answerIndex}else{if(item.userAnswer===undefined)item.userAnswer="******";item._answerIndex=-1}if(item.userAnswer instanceof Array)item.userAnswer=item.userAnswer[0]}));this.setQuestionAsSubmitted();this.markQuestion();this.setScore();this.setupFeedback()}setupRandomisation(){if(!this.get("_isRandom")||!this.get("_isEnabled"))return;this.set("_items",_.shuffle(this.get("_items")))}canSubmit(){return this.get("_items").every((_ref=>{let{userAnswer:userAnswer}=_ref;return userAnswer}))}setItemUserAnswer(itemIndex,userAnswer){const item=this.get("_items")[itemIndex];item.userAnswer=userAnswer;this.checkCanSubmit()}storeUserAnswer(){const items=this.get("_items");this.isCorrect();const userAnswer=new Array(items.length);items.forEach((_ref2=>{let{_index:_index,_answerIndex:_answerIndex}=_ref2;return userAnswer[_index]=_answerIndex}));this.set("_userAnswer",userAnswer)}isCorrect(){if(this.get("_answers")){this.markGenericAnswers()}else{this.markSpecificAnswers()}return this.get("_items").every((_ref3=>{let{_isCorrect:_isCorrect}=_ref3;return _isCorrect}))}isPartlyCorrect(){return this.get("_isAtLeastOneCorrectSelection")}markGenericAnswers(){let numberOfCorrectAnswers=0;const correctAnswers=this.get("_answers").slice();const usedAnswerIndexes=[];this.get("_items").forEach((item=>{correctAnswers.forEach(((answerGroup,answerIndex)=>{if(usedAnswerIndexes.includes(answerIndex))return;if(this.checkAnswerIsCorrect(answerGroup,item.userAnswer)===false)return;usedAnswerIndexes.push(answerIndex);item._isCorrect=true;item._answerIndex=answerIndex+TextInputModel.genericAnswerIndexOffset;this.set({_numberOfCorrectAnswers:++numberOfCorrectAnswers,_isAtLeastOneCorrectSelection:true})}));if(!item._isCorrect)item._isCorrect=false}))}markSpecificAnswers(){let numberOfCorrectAnswers=0;this.get("_items").forEach((item=>{const answers=item._answers;if(!answers)return;const userAnswer=item.userAnswer||"";const isCorrect=this.checkAnswerIsCorrect(answers,userAnswer);item._isCorrect=isCorrect;item._answerIndex=answers.indexOf(this.cleanupUserAnswer(userAnswer));if(!isCorrect)return;this.set({_numberOfCorrectAnswers:++numberOfCorrectAnswers,_isAtLeastOneCorrectSelection:true})}))}checkAnswerIsCorrect(possibleAnswers,userAnswer){const uAnswer=this.cleanupUserAnswer(userAnswer);const answerIsCorrect=possibleAnswers.some((cAnswer=>this.cleanupUserAnswer(cAnswer)===uAnswer));return answerIsCorrect}cleanupUserAnswer(userAnswer){if(this.get("_allowsAnyCase")){userAnswer=userAnswer.toLowerCase()}if(this.get("_allowsPunctuation")){userAnswer=userAnswer.replace(/[.,-/#!$£%^&*;:{}=\-_`~()]/g,"");userAnswer=userAnswer.replace(/(  +)+/g," ")}return userAnswer.trim()}setScore(){const numberOfCorrectAnswers=this.get("_numberOfCorrectAnswers");const questionWeight=this.get("_questionWeight");const itemLength=this.get("_items").length;const score=questionWeight*numberOfCorrectAnswers/itemLength;this.set("_score",score)}resetUserAnswer(){this.get("_items").forEach((item=>{item._isCorrect=false;item.userAnswer=""}))}getResponse(){return this.get("_items").map((_ref4=>{let{userAnswer:userAnswer}=_ref4;return userAnswer})).join("[,]")}getResponseType(){return"fill-in"}}TextInputModel.genericAnswerIndexOffset=65536;var TextInputModel$1=__AMD("components/adapt-contrib-textInput/js/textInputModel",TextInputModel);__AMD("components/adapt-contrib-textInput/js/adapt-contrib-textInput",components$1.register("textinput",{view:TextInputView$1,model:TextInputModel$1}));window.Arrow=function(window,document,undefined$1){function _increaseOpacity(milliseconds){var arrow=document.getElementById("arrow-"+browser);arrow.style.display="block";var i=0,ieI=0,x=setInterval((function(){i+=.1,ieI+=10,"msie"===browser&&8>=browserVersion?arrow.filters&&(arrow.filters.item("DXImageTransform.Microsoft.Alpha").opacity=ieI):arrow.style.opacity=i}),50);setTimeout((function(){clearInterval(x)}),600),setTimeout((function(){_hide()}),milliseconds||6e3)}function _decreaseOpacity(){var arrow=document.getElementById("arrow-"+browser),i=1,ieI=100,x=setInterval((function(){i-=.1,ieI-=10,"msie"===browser&&8>=browserVersion?arrow.filters&&(arrow.filters.item("DXImageTransform.Microsoft.Alpha").opacity=ieI):arrow.style.opacity=i}),50);setTimeout((function(){clearInterval(x),arrow.style.display="none"}),600)}function _applyStyleModern(node){node.style.position="fixed",node.style.zIndex=999,node.style.display="none",node.style.height="309px",node.style.width="186px",node.style.opacity=0,node.style.backgroundImage="url(https://i.imgur.com/aMwoyfN.png)",node.style.backgroundRepeat="no-repeat",node.style.backgroundPositionX="0",node.style.backgroundPositionY="0"}function _applyStyleIE8(node){node.style.top="10px",node.style.left="20px";var opacity="progid:DXImageTransform.Microsoft.Alpha(opacity=0) ",imgSrc='progid:DXImageTransform.Microsoft.AlphaImageLoader(src="https://i.imgur.com/aMwoyfN.png", sizingMethod="scale") ',rotation='progid:DXImageTransform.Microsoft.Matrix(M11=1, M12=1.2246063538223773e-16, M21=-1.2246063538223773e-16, M22=-1, SizingMethod="auto expand") ';node.style.filter=opacity+imgSrc+rotation}function _applyStyleMs(node){node.style.bottom="50px",node.style.left="67%"}function _applyStyleMoz(node){node.style.top="0px",node.style.right="37px",node.style.transform="rotateX(180deg) rotateY(180deg)",node.style.MozTransform="rotateX(180deg) rotateY(180deg)"}function _applyStyleWebkit(node){node.style.bottom="50px",node.style.left="20px"}function _applyStyleSafari(node){node.style.top="0px",node.style.right="80px",node.style.transform="rotateX(180deg) rotateY(180deg)",node.style.webkitTransform="rotateX(180deg) rotateY(180deg)"}function _setStyleType(node){_applyStyleModern(node),"msie"===browser?8===browserVersion?_applyStyleIE8(node):(9===browserVersion||10===browserVersion)&&_applyStyleMs(node):"chrome"===browser||"opera"===browser?_applyStyleWebkit(node):"safari"===browser?_applyStyleSafari(node):"IE11"===browser||"edge"===browser?_applyStyleMs(node):"firefox"===browser&&browserVersion>=20&&_applyStyleMoz(node)}function _buildArrow(){var div=document.createElement("div");return div.setAttribute("id","arrow-"+browser),arrowNode=div,div}function _injectNode(node){document.body.appendChild(node)}function _isExist(){return!!document.getElementById("arrow-"+browser)}function _initArrow(){var arrow=_buildArrow();_setStyleType(arrow),_calculateArrowPosition(),_injectNode(arrow),_addWindowEvent("resize",_calculateArrowPosition),_addWindowEvent("scroll",_calculateArrowPosition)}function _addWindowEvent(event,functionReference){window.addEventListener?window.addEventListener(event,functionReference,!1):window.attachEvent&&window.attachEvent(event,functionReference)}function _calculateArrowPosition(){"number"==typeof window.innerWidth?(visibleWidth=window.innerWidth,window.innerHeight):document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)&&(visibleWidth=document.documentElement.clientWidth,document.documentElement.clientHeight),"msie"===browser&&9===browserVersion&&(1005>visibleWidth?arrowNode.style.bottom="85px":visibleWidth>1006&&(arrowNode.style.bottom="50px"))}function _hide(){if(!_isExist())throw"Invalid usage: There are no arrows on the page.";_decreaseOpacity()}function show(seconds){if(!_isExist())throw"Invalid usage: arrow does not exist";_increaseOpacity(seconds)}var arrowNode,version="0.1.9",Arrow={},browser="",browserVersion=0,visibleWidth=0;return function(){var tem,N=navigator.appName,ua=navigator.userAgent,M=ua.match(/(opera|chrome|safari|firefox|msie)\/?\s*(\.?\d+(\.\d+)*)/i);M&&null!=(tem=ua.match(/version\/([\.\d]+)/i))&&(M[2]=tem[1]),M=M?[M[1],M[2]]:[N,navigator.appVersion,"-?"],browser="netscape"==M[0].toLowerCase()?"IE11":-1!=ua.toLowerCase().indexOf("edge")?"edge":M[0].toLowerCase(),browserVersion=parseInt(M[1],10)}(),_initArrow(),Arrow._version=version,Arrow._browser=browser,Arrow._browserVersion=browserVersion,Arrow.show=show,Arrow}(window,window.document);var DownloadButtonView=ComponentView$1.extend({events:{"click .download-button":"downloadFile"},preRender:function(){this.checkIfResetOnRevisit()},postRender:function(){this.setReadyStatus();if(this.model.get("_setCompletionOn")==="inview"){this.setupInviewCompletion(".component-widget")}},checkIfResetOnRevisit:function(){var isResetOnRevisit=this.model.get("_isResetOnRevisit");if(isResetOnRevisit){this.model.reset(isResetOnRevisit)}},downloadFile:function(event){Arrow.show();this.setCompletionStatus()}});var DownloadButtonModel=ComponentModel$1.extend({});__AMD("components/adapt-download-button/js/adapt-download-button",Adapt$1.register("downloadButton",{model:DownloadButtonModel,view:DownloadButtonView}));function toHyphenCase(str){if(!str)return false;return str.replace(/([A-Z])/g,"-$1").toLowerCase()}var Expose=ComponentView$1.extend({events:{"click .expose-item-cover":"toggleItem","click .expose-item-content":"toggleItem","click .expose-item-button":"toggleItem"},onDeviceResize:function(){this.setupColumns();this.setEqualHeights()},preRender:function(){this.animationType=toHyphenCase(this.model.get("_animationType"))||"fade"},postRender:function(){this.$(".expose-item").children().addClass(this.animationType);this.setupColumns();this.setupEventListeners();this.$(".expose-item-img").imageready(_.bind(this.onImageReady,this))},onImageReady:function(){this.setEqualHeights();this.setReadyStatus()},setupColumns:function(){if(this.model.get("_columns")&&$(window).width()>760){var w=100/this.model.get("_columns")+"%";this.$(".expose-items").addClass("expose-columns");this.$(".expose-item").width(w).addClass("expose-column")}else{this.$(".expose-items").removeClass("expose-columns");this.$(".expose-item").width("auto").removeClass("expose-column")}},setEqualHeights:function(){if(this.model.get("_equalHeights")===false)return;var $contentElements=this.$(".expose-item-content");$contentElements.height("auto");var hMax=0;_.each($contentElements,(function(el){var h=$(el).outerHeight();if(h>hMax)hMax=h}));$contentElements.height(hMax)},setupEventListeners:function(){this.listenTo(Adapt$1,{"device:resize":this.onDeviceResize})},toggleItem:function(e){if(e.target.tagName==="A")return;var $parent=$(e.currentTarget).parent();var $cover=$parent.children(".expose-item-cover");var $coverButton=$parent.children(".expose-item-button");var $content=$parent.children(".expose-item-content");$cover.toggleClass(this.animationType);if($cover.hasClass(this.animationType)){$cover.attr("aria-hidden",true);$content.attr("aria-hidden",false);$content.a11y_focus();_.delay((function(){$coverButton.attr("aria-hidden",true).css("visibility","hidden")}),100);Adapt$1.trigger("audio:itemControl",$content.find(".item-audio-container").data("audio-id"))}else{$cover.attr("aria-hidden",false);$coverButton.attr("aria-hidden",false).css("visibility","visible");$content.attr("aria-hidden",true)}if(!$cover.is(".visited")){$cover.addClass("visited");var i=$cover.parents(".expose-item").index();this.model.get("_items")[i]._isVisited=true;this.evaluateCompletion()}},evaluateCompletion:function(){var incompleteItems=_.filter(this.model.get("_items"),(function(item){return!item._isVisited}));!incompleteItems.length&&this.onComplete()},onComplete:function(){this.setCompletionStatus()}});Adapt$1.register("expose",Expose);__AMD("components/adapt-expose/js/adapt-expose",Expose);var Flipper=ComponentView$1.extend({shouldPrevEnabled:true,events:{"click .flipper-item-next-button":"onNextBtnClick","click .flipper-item-previous-button":"onPreviousBtnClick","click .flipper-item-complete-button":"onCompleteBtnClick"},preRender:function(){this.listenTo(this.model,"change:_stage",this.playAudio);this.model.get("_items")[0]?._audio?this.model.get("_items")[0]._audio._autoplayWhenOnScreen=true:"";this.model.set("_stage",0);this.locked=false},playAudio:function(state){Adapt$1.trigger("audio:itemControl",`${this.model.get("_id")}-${this.model.get("_stage")}`)},postRender:function(){var $container=this.$(".flipper-container");var stage=this.model.get("_stage");if(stage===0&&!this.model.get("_isComplete")){this.$(".flipper-item-previous-button").attr("disabled",true)}if(this.model.get("width")){$container.width(this.model.get("width"))}$container.imageready(this.onImageReady.bind(this));this.$(".flipper.stage-0").on("inview.componentView",this.onFlipperWidgetInview.bind(this))},onFlipperWidgetInview:function(event,visible,visiblePartX,visiblePartY){if(!visible)return;switch(visiblePartY){case"top":this.hasSeenTop=true;break;case"bottom":this.hasSeenBottom=true;break;case"both":this.hasSeenTop=this.hasSeenBottom=true}if(!this.hasSeenTop||!this.hasSeenBottom)return;Adapt$1.trigger("audio:itemControl",`${this.model.get("_id")}-${this.model.get("_stage")}`);this.$(".flipper.stage-0").off("inview.componentView")},onImageReady:function(){this.setItemNextVisibility();this.setItemHeights();this.setReadyStatus()},setItemHeights:function(){if(this.model.get("_equalHeights")===false)return;var $items=this.$(".flipper-item");var hMax=_.reduce($items,(function(hMax,el){var h=$(el).outerHeight();return h>hMax?h:hMax}),0);$items.height(hMax);this.$(".flipper-container").height(hMax)},setItemNextVisibility:function(){var stage=this.model.get("_stage");var rx=/state-\d+/;_.each(this.$(".flipper-item"),(function(el,i){if(stage===i){el.className=el.className.replace(rx,"state-1");$(el).attr("aria-hidden","false")}else if(stage-1===i||stage===0&&i===this.model.get("_items").length-1){el.className=el.className.replace(rx,"state-2");$(el).attr("aria-hidden","true")}else{el.className=el.className.replace(rx,"state-0");$(el).attr("aria-hidden","true")}}),this)},setItemPreviousVisibility:function(){var stage=this.model.get("_stage");var rx=/state-\d+/;_.each(this.$(".flipper-item"),(function(el,i){if(stage===i){el.className=el.className.replace(rx,"state-1");$(el).attr("aria-hidden","false")}else if(stage+1===i||stage===0&&i===this.model.get("_items").length){el.className=el.className.replace(rx,"state-2");$(el).attr("aria-hidden","true")}else{el.className=el.className.replace(rx,"state-0");$(el).attr("aria-hidden","true")}}),this)},onNextBtnClick:function(){if(this.locked)return;this.setLock();var numItems=this.model.get("_items").length;var stage=this.model.get("_stage")+1;console.log("next btn stage"+stage);this.$(".flipper").removeClass("prev-direction");this.$(".flipper").addClass("next-direction");this.setStage(stage);if(!stage==0&&this.shouldPrevEnabled){this.$(".flipper-item-previous-button").removeAttr("disabled")}_.delay(function(){this.$(".state-1 > .flipper-item-title").attr("tabindex",0).focus()}.bind(this),1e3);if(numItems-1===stage){this.setCompletionStatus()}},onPreviousBtnClick:function(){if(this.locked)return;this.setLock();var firstStage=this.model.get("_stage");var stage=this.model.get("_stage")-1;var numItems=this.model.get("_items").length;if(firstStage===0){stage=numItems-1}if(stage==0&&this.shouldPrevEnabled){this.$(".flipper-item-previous-button").attr("disabled",true)}this.$(".flipper").removeClass("next-direction");this.$(".flipper").addClass("prev-direction");this.model.set("_stage",stage);var flipper=this.$(".flipper")[0];flipper.className=flipper.className.replace(/stage-\d+/,"stage-"+stage);this.setItemPreviousVisibility();_.delay(function(){this.$(".state-1 > .flipper-item-title").attr("tabindex",0).focus()}.bind(this),1e3)},onCompleteBtnClick:function(){if(this.locked)return;this.setLock();var stage=this.model.get("_stage")+1;var numItems=this.model.get("_items").length;if(stage===numItems){stage=0}this.setStage(stage);this.$(".flipper-item-previous-button").removeAttr("disabled");this.$(".state-1 > .flipper-item-title").attr("tabindex",0).addClass("flipperFocus");this.shouldPrevEnabled=false;this.setCompletionStatus()},setLock:function(){var $flipper=this.$(".flipper");$flipper.addClass("animating");this.locked=true;setTimeout(function(){$flipper.removeClass("animating");this.locked=false}.bind(this),600)},setStage:function(stage){this.model.set("_stage",stage);var flipper=this.$(".flipper")[0];flipper.className=flipper.className.replace(/stage-\d+/,"stage-"+stage);this.setItemNextVisibility()}});Adapt$1.register("flipper",Flipper);__AMD("components/adapt-flipper/js/adapt-flipper",Flipper);var HotgridModel=__AMD("components/adapt-hotgrid/js/HotgridModel",class HotgridModel extends ItemsComponentModel{init(){super.init();this.checkIfResetOnRevisit()}checkIfResetOnRevisit(){const isResetOnRevisit=this.get("_isResetOnRevisit");if(isResetOnRevisit)this.reset(isResetOnRevisit)}});class HotgridPopupView extends Backbone.View{className(){return"hotgrid-popup"}initialize(){this.setupEventListeners()}setupEventListeners(){this.listenToOnce(Adapt$1,"notify:opened",this.onNotifyOpened);this.listenTo(this.model.getChildren(),{"change:_isActive":this.onItemsActiveChange});this.model.set("onCloseClick",this.onCloseClick.bind(this));this.model.set("onControlClick",this.onControlClick.bind(this))}onNotifyOpened(){this.setupNavigation();this.render()}setupNavigation(){this.manageBackNextStates();this.updatePageCount();this.setupBackNextLabels()}manageBackNextStates(){let index=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.model.getActiveItem().get("_index");const totalItems=this.model.getChildren().length;const canCycleThroughPagination=this.model.get("_canCycleThroughPagination");const shouldEnableBack=index>0||canCycleThroughPagination;const shouldEnableNext=index<totalItems-1||canCycleThroughPagination;this.model.set("shouldEnableBack",shouldEnableBack);this.model.set("shouldEnableNext",shouldEnableNext)}setupBackNextLabels(){let index=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.model.getActiveItem().get("_index");const totalItems=this.model.getChildren().length;const canCycleThroughPagination=this.model.get("_canCycleThroughPagination");const isAtStart=index===0;const isAtEnd=index===totalItems-1;const globals=Adapt$1.course.get("_globals");const hotgridGlobals=globals._components._hotgrid;let prevTitle=isAtStart?"":this.model.getItem(index-1).get("title");let nextTitle=isAtEnd?"":this.model.getItem(index+1).get("title");let backItem=isAtStart?null:index;let nextItem=isAtEnd?null:index+2;if(canCycleThroughPagination){if(isAtStart){prevTitle=this.model.getItem(totalItems-1).get("title");backItem=totalItems}if(isAtEnd){nextTitle=this.model.getItem(0).get("title");nextItem=1}}const backLabel=compile(hotgridGlobals.previous,{_globals:globals,title:prevTitle,itemNumber:backItem,totalItems:totalItems});const nextLabel=compile(hotgridGlobals.next,{_globals:globals,title:nextTitle,itemNumber:nextItem,totalItems:totalItems});this.model.set("backLabel",backLabel);this.model.set("nextLabel",nextLabel)}updatePageCount(){const globals=Adapt$1.course.get("_globals");const pagingTemplate=globals._components._hotgrid.popupPagination;const template=pagingTemplate||"{{itemNumber}} / {{totalItems}}";const itemNumber=this.model.getActiveItem().get("_index")+1;const totalItems=this.model.getChildren().length;const itemCount=compile(template,{itemNumber:itemNumber,totalItems:totalItems});this.model.set("itemCount",itemCount)}onItemsActiveChange(item,_isActive){if(!_isActive)return;const index=item.get("_index");this.manageBackNextStates(index);this.updatePageCount();this.render()}onCloseClick(){Adapt$1.trigger("notify:close")}onControlClick(e){const direction=$(e.currentTarget).data("direction");const index=this.getNextIndex(direction);if(index!==-1){this.setItemState(index)}}getNextIndex(direction){let index=this.model.getActiveItem().get("_index");const lastIndex=this.model.getChildren().length-1;switch(direction){case"back":if(index>0)return--index;if(this.model.get("_canCycleThroughPagination"))return lastIndex;break;case"next":if(index<lastIndex)return++index;if(this.model.get("_canCycleThroughPagination"))return 0}return-1}setItemState(index){this.model.getActiveItem().toggleActive();const nextItem=this.model.getItem(index);this.setupBackNextLabels(index);nextItem.toggleActive();nextItem.toggleVisited(true)}render(){ReactDOM__default["default"].render(React__default["default"].createElement(templates.hotgridPopup,this.model.toJSON()),this.el)}}var HotgridPopupView$1=__AMD("components/adapt-hotgrid/js/HotgridPopupView",HotgridPopupView);class HotgridView extends ComponentView$1{initialize(){super.initialize(...arguments);this.onItemClicked=this.onItemClicked.bind(this);this.setUpViewData();this.setUpEventListeners()}setUpViewData(){this.popupView=null;this._isPopupOpen=false}setUpEventListeners(){this.listenTo(Adapt$1,"device:changed",this.resizeControl)}postRender(){this.setUpColumns();this.$(".hotgrid__widget").imageready(this.setReadyStatus.bind(this));if(this.model.get("_setCompletionOn")==="inview"){this.setupInviewCompletion(".hotgrid__widget")}}resizeControl(){this.setUpColumns();this.render()}setUpColumns(){const columns=this.model.get("_columns");const columnWidth=columns&&device$1.isScreenSizeMin("medium")?100/columns:100;this.model.set("_columnWidth",columnWidth)}onItemClicked(e){e.preventDefault();const item=this.model.getItem($(e.currentTarget).data("index"));item.toggleActive(true);item.toggleVisited(true);this.openPopup()}openPopup(){if(this._isPopupOpen)return;this._isPopupOpen=true;this.popupView=new HotgridPopupView$1({model:this.model});notify$1.popup({_view:this.popupView,_isCancellable:true,_showCloseButton:false,_classes:"hotgrid "+this.model.get("_classes")});this.listenToOnce(Adapt$1,{"popup:closed":this.onPopupClosed})}onPopupClosed(){this.model.getActiveItem().toggleActive();this._isPopupOpen=false}}HotgridView.template="hotgrid.jsx";var HotgridView$1=__AMD("components/adapt-hotgrid/js/HotgridView",HotgridView);__AMD("components/adapt-hotgrid/js/adapt-hotgrid",components$1.register("hotgrid",{model:HotgridModel,view:HotgridView$1}));var Imagegrid=ComponentView$1.extend({preRender:function(){this.listenTo(Adapt$1,"device:changed",this.resizeControl);this.setDeviceSize();this.checkIfResetOnRevisit()},setDeviceSize:function(){if(Adapt$1.device.screenSize==="large"){this.$el.addClass("desktop").removeClass("mobile");this.model.set("_isDesktop",true)}else{this.$el.addClass("mobile").removeClass("desktop");this.model.set("_isDesktop",false)}},checkIfResetOnRevisit:function(){var isResetOnRevisit=this.model.get("_isResetOnRevisit");if(isResetOnRevisit){this.model.reset(isResetOnRevisit)}},inview:function(event,visible,visiblePartX,visiblePartY){if(visible){if(visiblePartY==="top"){this._isVisibleTop=true}else if(visiblePartY==="bottom"){this._isVisibleBottom=true}else{this._isVisibleTop=true;this._isVisibleBottom=true}if(this._isVisibleTop&&this._isVisibleBottom){this.$(".component-widget").off("inview");this.setCompletionStatus()}}},remove:function(){this.$(".component-widget").off("inview");ComponentView$1.prototype.remove.apply(this,arguments)},postRender:function(){this.setUpColumns();this.$(".imagegrid-widget").imageready(_.bind((function(){this.setReadyStatus();this.$(".component-widget").on("inview",_.bind(this.inview,this))}),this))},resizeControl:function(){this.setDeviceSize();this.render()},setUpColumns:function(){var columns=this.model.get("_columns");if(columns&&Adapt$1.device.screenSize==="large"){this.$(".imagegrid-grid-item").css("width",100/columns+"%")}}},{template:"imagegrid"});__AMD("components/adapt-imagegrid/js/adapt-imagegrid",Adapt$1.register("imagegrid",Imagegrid));var ListModel=__AMD("components/adapt-list/js/ListModel",class ListModel extends ItemsComponentModel{defaults(){return ItemsComponentModel.resultExtend("defaults",{_animateList:false,_columns:0,_orderedList:false,_percentInviewVertical:70})}});class ListView extends ComponentView$1{className(){let classes=super.className();if(this.model.get("_animateList")&&!$("html").hasClass("a11y-no-animations")){classes+=" is-animated-list"}return classes}postRender(){this.setReadyStatus();this.setupInviewCompletion(".component__widget");this.contentAlignment();if(this.model.get("_animateList")&&!$("html").hasClass("a11y-no-animations")){this.$(".list__container").on("onscreen.animate",this.checkIfOnScreen.bind(this))}}contentAlignment(){const _horizontalAlignment=this.model.get("_itemHorizontalAlignment");const _bulletAlignment=this.model.get("_bulletAlignment");if(_horizontalAlignment)this.$el.addClass(`item-justify-${_horizontalAlignment}`);if(_bulletAlignment)this.$el.addClass(`bullet-align-${_bulletAlignment}`)}checkIfOnScreen(_ref,_ref2){let{currentTarget:currentTarget}=_ref;let{percentInviewVertical:percentInviewVertical}=_ref2;if(percentInviewVertical<this.model.get("_percentInviewVertical"))return;$(currentTarget).off("onscreen.animate");this.animateListItems()}animateListItems(){this.model.getChildren().forEach(((listItem,index)=>{setTimeout(listItem.toggleActive.bind(listItem,true),200*index)}))}remove(){this.$(".list__container").off("onscreen.animate");super.remove()}}ListView.template="list.jsx";var ListView$1=__AMD("components/adapt-list/js/ListView",ListView);__AMD("components/adapt-list/js/adapt-list",components$1.register("list",{model:ListModel,view:ListView$1}));var Model=ComponentModel$1.extend({getNavigationData:function(){var buttonTypeModels={_returnToPreviousLocation:this.getReturnToPreviousLocation(),_page:this.getCurrentPage(),_up:this.getCurrentMenu(),_root:Adapt$1.course,_next:this.getNextPage(),_previous:this.getPrevPage(),_sibling:this.getSiblingPages(),_close:new Backbone.Model({_id:"",_onClick:"top.window.close();"})};var data=[];var buttons=this.get("_buttons");if(!buttons){return data}var order=0;var item;var currentPageComplete=buttonTypeModels._page.get("_isComplete");for(var attrName in buttons){var buttonConfig=buttons[attrName];var buttonModel=buttonTypeModels[attrName];if(attrName==="_sibling"){if(buttonModel.length<=1)continue;_.each(buttonModel,(function(model,index){item=model.toJSON();_.extend(item,buttonConfig,{type:attrName,index:index,order:order++,locked:item._isLocked||buttonConfig._lockUntilPageComplete&&!currentPageComplete});data.push(item)}));continue}if(buttonConfig._customRouteId)buttonModel=Adapt$1.findById(buttonConfig._customRouteId);item=buttonModel?buttonModel.toJSON():{_isHidden:true};_.extend(item,buttonConfig,{type:attrName,index:0,order:order++,locked:item._isLocked||buttonConfig._lockUntilPageComplete&&!currentPageComplete});data.push(item)}var orderedData=_.sortBy(data,"_order");orderedData.forEach((function(item,index){item._index=index}));return orderedData},getReturnToPreviousLocation:function(){return Adapt$1.location._previousId?Adapt$1.findById(Adapt$1.location._previousId):null},getCurrentPage:function(){var parents=this.getAncestorModels?this.getAncestorModels():this.getParents().models;for(var i=0,l=parents.length;i<l;i++){var model=parents[i];switch(model.get("_type")){case"page":return model}}},getCurrentMenu:function(){var parents=this.getAncestorModels?this.getAncestorModels():this.getParents().models;for(var i=0,l=parents.length;i<l;i++){var model=parents[i];switch(model.get("_type")){case"menu":case"course":return model}}},getSiblingPages:function(){var currentMenu=this.getCurrentMenu();var siblingModels=currentMenu.getAllDescendantModels(true);siblingModels=_.filter(siblingModels,(function(model){return model.get("_type")==="page"&&model.get("_isAvailable")&&(!this.get("_shouldSkipOptionalPages")||!model.get("_isOptional"))}),this);return siblingModels},getPrevPage:function(){var currentPage=this.getCurrentPage();var currentPageId=currentPage.get("_id");var pages=this.getPages();var hasFoundCurrentPage=false;for(var i=pages.length-1;i>-1;i--){var page=pages[i];var isNotAvailable=!page.get("_isAvailable");if(isNotAvailable)continue;if(!hasFoundCurrentPage){hasFoundCurrentPage=page.get("_id")===currentPageId;continue}if(!this.get("_shouldSkipOptionalPages")||!page.get("_isOptional")){return page}}return},getNextPage:function(){var currentPage=this.getCurrentPage();var currentPageId=currentPage.get("_id");var pages=this.getPages();var hasFoundCurrentPage=false;for(var i=0,l=pages.length;i<l;i++){var page=pages[i];var isNotAvailable=!page.get("_isAvailable");if(isNotAvailable)continue;if(!hasFoundCurrentPage){hasFoundCurrentPage=page.get("_id")===currentPageId;continue}if(!this.get("_shouldSkipOptionalPages")||!page.get("_isOptional")){return page}}return},getPages:function(){var loopStyle=this.get("_loopStyle");if(!loopStyle)return[];var loop=false;var descendants;switch(loopStyle){case"allPages":loop=true;descendants=Adapt$1.course.getAllDescendantModels(true);break;case"siblings":loop=true;default:var currentMenu=this.getCurrentMenu();descendants=currentMenu.getAllDescendantModels(true)}if(loop){descendants=descendants.concat(descendants)}return _.filter(descendants,(function(model){return model.get("_type")==="page"}))}});var Model$1=__AMD("components/adapt-pageNav/js/model",Model);var Tooltip=Backbone.View.extend({className:"collab__tooltip",initialize:function(options){this.removeOtherTooltips();this.setupEventListeners();this.setupData(options);this.render()},removeOtherTooltips:function(){Adapt$1.trigger("tooltip:remove");Adapt$1.tooltip=this},setupEventListeners:function(){_.bindAll(this,"remove","postRender","show");this.show=_.debounce(this.show,17);$(document).on("mouseover",this.remove);this.listenTo(Adapt$1,{"device:resize":this.checkPosition,"tooltip:remove":this.remove,remove:this.remove})},setupData:function(options){this.$target=options.$target;this.id=this.$target.attr("data-id");this.type=this.$target.attr("data-type");this.index=this.$target.attr("data-index");this.model.set("tooltip",this.$target.attr("data-tooltip"))},render:function(){var template=Handlebars.templates["pageNav-tooltip"];this.$el.html(template(this.model.toJSON()));_.defer(this.postRender)},postRender:function(){if(this.isRemoved)return;this.checkPosition();this.show()},checkPosition:function(){if(this.isRemoved)return;var buttonPosition=this.$target.position();var buttonWidth=this.$target.outerWidth(true);var buttonHalfWidth=buttonWidth/2;var buttonCenterLeft=buttonPosition.left+buttonHalfWidth;var tooltipWidth=this.$el.outerWidth(true);var tooltipHalfWidth=tooltipWidth/2;var tooltipCenter={top:buttonPosition.top,left:buttonCenterLeft};var $offsetParent=this.$el.offsetParent();var parentWidth=$offsetParent.innerWidth();var overflowRight=parentWidth-(tooltipCenter.left+tooltipHalfWidth);var overflowLeft=tooltipCenter.left-tooltipHalfWidth;var isOverflowingRight=overflowRight<0;var isOverflowingLeft=overflowLeft<0;var leftOffset=isOverflowingRight?overflowRight:isOverflowingLeft?-overflowLeft:0;this.$el.css({top:tooltipCenter.top,left:tooltipCenter.left+leftOffset});this.$el.find(".pagenav__triangle").css({left:tooltipHalfWidth-leftOffset})},show:function(){if(this.isRemoved)return;this.$el.addClass("show")},remove:function(){this.isRemoved=true;delete this.$target;delete Adapt$1.tooltip;$(document).off("mouseover",this.onBodyMouseOver);Backbone.View.prototype.remove.call(this)}});var Tooltip$1=__AMD("components/adapt-pageNav/js/tooltip",Tooltip);function getAttributes($node){var attrs={};_.each($node[0].attributes,(function(attribute){attrs[attribute.name]=attribute.value}));return attrs}var View=ComponentView$1.extend({events:{"click .js-pagenav-btn":"onButtonClick","mouseover .js-pagenav-btn":"onButtonTooltip"},preRender:function(){this.model.set("_items",this.model.getNavigationData());this.$el.addClass("pagenav "+this.model.get("_id"));_.bindAll(this,"postRender","checkButtonStates");this.listenTo(Adapt$1,"remove",this.remove);this.listenTo(Adapt$1.contentObjects,{"change:_isComplete change:_isLocked":this.onContentObjectComplete})},postRender:function(){this.checkButtonStates();this.setReadyStatus();this.setupInview()},setupInview:function(){const selector=this.getInviewElementSelector();if(!selector)return this.setCompletionStatus();this.setupInviewCompletion(selector)},getInviewElementSelector:function(){if(this.model.get("body"))return".component__body";if(this.model.get("instruction"))return".component__instruction";if(this.model.get("displayTitle"))return".component__title";if(this.model.get("_buttons"))return".component__widget";return null},onContentObjectComplete:function(){_.defer(this.checkButtonStates)},checkButtonStates:function(){this.$("button").each(function(index,item){this.checkButtonState(item)}.bind(this))},checkButtonState:function(button){var $button=$(button);var id=$button.attr("data-id");var index=$button.attr("data-item-index");if(!id)return;var items=this.model.getNavigationData();var data=items[index];var $buttonRendered=$(Handlebars.partials["pageNav-item"](data));if($buttonRendered.length===0){$button.remove();return}var renderedAttrs=getAttributes($buttonRendered);var attrs=getAttributes($button);var renderedAttrNames=_.keys(renderedAttrs);var attrNames=_.keys(attrs);var removeAttrNames=_.difference(attrNames,renderedAttrNames);removeAttrNames.forEach((function(name){$button.removeAttr(name)}));$button.attr(renderedAttrs);$button.html($buttonRendered.html())},onButtonClick:function(event){var $target=$(event.currentTarget);var isLocked=$target.hasClass("is-locked");var isSelected=$target.hasClass("is-selected");if(isLocked||isSelected)return;var id=$target.attr("data-id");var index=$target.attr("data-item-index");switch(id){case"":var items=this.model.getNavigationData();try{var execute=new Function(items[index]._onClick||"");execute()}catch(err){Adapt$1.log.error(err)}break;default:this.navigateTo(id);break}},onButtonTooltip:function(event){var $target=$(event.currentTarget);var id=$target.attr("data-id")||this.model.getCurrentPage().get("_id");if(!id){return}if(!$target.attr("data-tooltip")){return}event.stopPropagation();if(Adapt$1.tooltip){var type=$target.attr("data-type");var index=$target.attr("data-index");var isCurrentTooltip=Adapt$1.tooltip.type===type&&Adapt$1.tooltip.index===index;if(isCurrentTooltip){return}}var tooltip=new Tooltip$1({$target:$target,model:Adapt$1.findById(id)});this.$(".pagenav__tooltip-container").append(tooltip.$el)},navigateTo:function(id){var isCourse=id===Adapt$1.course.get("_id");var hash="#"+(isCourse?"/":"/id/"+id);Backbone.history.navigate(hash,{trigger:true,replace:false})}});var View$1=__AMD("components/adapt-pageNav/js/view",View);__AMD("components/adapt-pageNav/js/adapt-pageNav",Adapt$1.register("pageNav",{model:Model$1,view:View$1}));class SimpleTable extends ComponentView$1{preRender(){this.checkIfResetOnRevisit()}postRender(){this.setReadyStatus();this.setupInview()}setupInview(){const selector=this.getInviewElementSelector();if(!selector){this.setCompletionStatus();return}this.setupInviewCompletion(selector)}getInviewElementSelector(){if(this.model.get("body"))return".component__body";if(this.model.get("instruction"))return".component__instruction";if(this.model.get("displayTitle"))return".component__title";return null}checkIfResetOnRevisit(){const isResetOnRevisit=this.model.get("_isResetOnRevisit");if(isResetOnRevisit){this.model.reset(isResetOnRevisit)}}}SimpleTable.template="simple-table";__AMD("components/adapt-simple-table/js/adapt-simple-table",Adapt$1.register("simple-table",{model:ComponentModel$1.extend({}),view:SimpleTable}));var StackList=ComponentView$1.extend({TRANSITION_TIME:250,events:{"click .stacklist__next":"nextItem"},preRender:function(){this.model.set("_globals",Adapt$1.course.get("_globals"));this.model.set("_stage",-1);this.setupButton()},postRender:function(){this.$items=this.$(".stacklist__item");this.$button=this.$(".stacklist__button");if(!this.model.get("_isComplete")||this.model.get("_isResetOnRevisit")){this.setupListItems();this.setupItemOffsets();this.listenTo(Adapt$1,"device:resize",this.setupItemOffsets)}this.setReadyStatus()},setupButton:function(){var _button=this.model.get("_button")||{};var btnAriaLabel=this.model.get("_globals")._components._stacklist.ariaButtonLabel||this.model.get("_globals")._accessibility._ariaLabels.next;this.model.set({buttonAriaLabel:btnAriaLabel});if(!_button.startText)_button.startText="Click here to begin";if(!_button.continueText)_button.continueText="Next";if(!_button.ariaLabel)_button.ariaLabel=btnAriaLabel;this.model.set("_button",_button)},setupListItems:function(){this.$items.addClass("display-none");this.$button.show()},setupItemOffsets:function(){var wWin=$(window).width();var offsetLeft=-this.$el.outerWidth();var offsetRight=wWin+10;var stage=this.model.get("_stage");var buttonOffset=0;this.$items.each((function(i){var $el=$(this);if(i<=stage){buttonOffset+=$el.outerHeight(true);return}var isLeft=i%2===0;var offset=$el.offset();offset.left=isLeft?offsetLeft:offsetRight;$el.offset(offset)}));this.$button.css({top:buttonOffset})},nextItem:function(){var items=this.model.get("_items");this.$(".stacklist__button").remove();_.each(items,function(item,index){_.delay(function(){var stage=this.model.get("_stage")+1;this.setStage(stage)}.bind(this),250*(index+1))}.bind(this))},setStage:function(stage){this.model.set("_stage",stage);this.model.get("_items");var isComplete=this.model.get("_items").length-1===stage;var $item=this.$(".stacklist__item").eq(stage);$item.removeClass("display-none");var h=$item.outerHeight(true);$item.velocity({left:0},{delay:this.TRANSITION_TIME,duration:this.TRANSITION_TIME,complete:function(){$item.addClass("show").a11y_focus()}});if(isComplete){this.onComplete();this.updateButton("",h)}},updateButton:function(text,offset,ariaLabel){this.$(".stacklist__button").css({top:"+="+offset});if(text===""){return}var $button=this.$(".stacklist__next");$button.blur();setTimeout((function(){$button.html(text);$button.attr("aria-label",ariaLabel)}),this.TRANSITION_TIME*2)},onComplete:function(){var $buttonDiv=this.$(".stacklist__button");var $button=this.$(".stacklist__next");$buttonDiv.css({opacity:0});setTimeout((function(){$button.remove()}),this.TRANSITION_TIME);this.setCompletionStatus()}});Adapt$1.register("stacklist",StackList);__AMD("components/adapt-stacklist/js/adapt-stacklist",StackList);class TabsView extends ComponentView$1{className(){return[super.className(),`is-${this.layout}-layout`].join(" ")}get layout(){const layout=device$1.screenSize==="large"?this.model.get("_tabLayout"):"vertical";return layout}preRender(){this.reset();this.setItemWidth();this.onTabItemClicked=this.onTabItemClicked.bind(this);this.onTabItemKeyUp=this.onTabItemKeyUp.bind(this);this.listenTo(Adapt$1,"device:resize",this.setItemWidth);this.listenTo(this.model.getChildren(),"change:_isActive",this.onItemsActiveChange)}reset(){this.model.resetActiveItems();const firstItem=this.model.getItem(0);if(!firstItem)return;firstItem.toggleActive(true);firstItem.toggleVisited(true)}setItemWidth(){const itemWidth=this.layout==="horizontal"?100/this.model.get("_items").length+"%":"";this.model.set("itemWidth",itemWidth)}postRender(){this.setReadyStatus();if(this.model.get("_setCompletionOn")!=="inview")return;this.setupInviewCompletion()}onItemsActiveChange(item,isActive){if(!isActive)return;item.toggleVisited(true)}onTabItemClicked(e){if(e&&e.preventDefault)e.preventDefault();Adapt$1.trigger("audio:itemControl",this.$(`.item-${$(e.currentTarget).data("index")}-audio`).find(".item-audio-container").data("audio-id"));const index=$(e.currentTarget).data("index");this.model.setActiveItem(index);const $tabPanel=$(e.currentTarget).parents(".tabs__widget").find("[role=tabpanel]");a11y$1.focus($tabPanel[index])}onTabsWidgetInview(event,visible,visiblePartX,visiblePartY){if(!visible)return;switch(visiblePartY){case"top":this.hasSeenTop=true;break;case"bottom":this.hasSeenBottom=true;break;case"both":this.hasSeenTop=this.hasSeenBottom=true}if(!this.hasSeenTop||!this.hasSeenBottom)return;Adapt$1.trigger("audio:itemControl",`${this.model.get("_id")}-0`);this.$(".component__widget").off("inview.componentView")}onTabItemKeyUp(event){const $tabs=$(event.currentTarget).parents("[role=tablist]").find("[role=tab]");if(!$tabs.length)return;let currentIndex=$tabs.toArray().findIndex((tab=>tab===event.currentTarget));switch(event.which){case 37:if(currentIndex===0)currentIndex=$tabs.length;currentIndex--;break;case 39:if(currentIndex===$tabs.length-1)currentIndex=-1;currentIndex++}this.model.setActiveItem(currentIndex);a11y$1.focus($tabs[currentIndex])}}TabsView.template="tabs.jsx";var TabsView$1=__AMD("components/adapt-tabs/js/TabsView",TabsView);__AMD("components/adapt-tabs/js/adapt-tabs",components$1.register("tabs",{model:ItemsComponentModel.extend({}),view:TabsView$1}));var CONF$1={MAX_WIDTH:340,ANIMATE_TOP:5,DURATION:5,PADDINGFACTOR:1.5,POSIONFROMTEXT:20,EASING:"linear"};var CONFIG$1=__AMD("components/adapt-tooltip/js/conf",CONF$1);var $tooltip$1=null;var $targetEle$1=null;function setUptoolTip$1(){window.tooltip=onMouseEnter$1}var onMouseEnter$1=function(evt){$tooltip$1=$('<div id="tooltip"></div>');$targetEle$1=$(this);var tip=$targetEle$1.attr("data-title");if(!tip||tip=="")return false;var lazyLayout=_.debounce(showTooltip$1,200);$tooltip$1.css("opacity",0).html(tip).appendTo("body");showTooltip$1();$(window).resize(_.bind(lazyLayout,this));$targetEle$1.on("mouseleave",removeTooltip$1);$tooltip$1.on("click",removeTooltip$1)};function showTooltip$1(){if(!$tooltip$1||!$targetEle$1)return;setUptoolTipWidth$1();var targetEleLeft=$targetEle$1.offset().left;var targetEleTop=$targetEle$1.offset().top;var targetEleWidth=$targetEle$1.outerWidth();var tooltipWidth=$tooltip$1.outerWidth();var tooltipHeight=$tooltip$1.outerHeight();var posLeft=targetEleLeft+targetEleWidth/2-tooltipWidth/2;var posTop=targetEleTop-tooltipHeight-CONFIG$1.POSIONFROMTEXT;if(posLeft<0){posLeft=targetEleLeft+targetEleWidth/2-CONFIG$1.POSIONFROMTEXT;$tooltip$1.addClass("left")}else{$tooltip$1.removeClass("left")}if(posLeft+tooltipWidth>$(window).width()){posLeft=targetEleLeft-tooltipWidth+targetEleWidth/2+CONFIG$1.POSIONFROMTEXT;$tooltip$1.addClass("right")}else{$tooltip$1.removeClass("right")}if(posTop<0){var posTop=targetEleTop+targetEleTop;$tooltip$1.addClass("top")}else{$tooltip$1.removeClass("top")}$tooltip$1.css({left:posLeft,top:posTop}).animate({top:"+="+CONFIG$1.ANIMATE_TOP,opacity:1},CONFIG$1.DURATION,CONFIG$1.EASING)}function setUptoolTipWidth$1(){if($(window).width()<$tooltip$1.outerWidth()*CONFIG$1.PADDINGFACTOR){$tooltip$1.css("max-width",$(window).width()/2)}else{$tooltip$1.css("max-width",CONFIG$1.MAX_WIDTH)}}function removeTooltip$1(){$tooltip$1.animate({top:"-="+CONFIG$1.ANIMATE_TOP,opacity:0},CONFIG$1.DURATION,CONFIG$1.EASING,(function(){$(this).remove();$tooltip$1=null;$targetEle$1=null}))}Adapt$1.on("app:dataReady",(function(){var tooltip=Adapt$1.course.get("_tooltip");if(tooltip&&tooltip._isEnabled){setUptoolTip$1()}}));var AnimateMenuView=__AMD("extensions/adapt-animate/js/animate-menuView",class AnimateMenuView extends Backbone.View{initialize(){this.listenTo(Adapt$1,{remove:this.remove,"popup:opened":this.notifyOpened,"popup:closed":this.notifyClosed});this.listenToOnce(Adapt$1,"menuView:ready",this.render);this.listenTo(Adapt$1.config,"change:_activeLanguage",this.remove)}render(){this.firstRun=true;this.notifyIsOpen=false;this.elementIsInView=true;if($("body").children(".notify").css("visibility")=="visible"){this.notifyOpened()}this.modelID=".menu";this.titleEnabled=false;this.bodyEnabled=false;this.customEnabled=false;this.customItems=[];if(this.model.get("_animate")._title._isEnabled){this.titleEnabled=true;this.titleEffect=this.model.get("_animate")._title._effect;this.titleDelay=this.model.get("_animate")._title._delay?this.model.get("_animate")._title._delay:0;$(this.modelID).find(".menu__title-inner").addClass("is-animated");$(this.modelID).find(".menu__title-inner").addClass("is-animate-hidden")}if(this.model.get("_animate")._body._isEnabled){this.bodyEnabled=true;this.bodyEffect=this.model.get("_animate")._body._effect;this.bodyDelay=this.model.get("_animate")._body._delay?this.model.get("_animate")._body._delay:0;$(this.modelID).find(".menu__body-inner").addClass("is-animated");$(this.modelID).find(".menu__body-inner").addClass("is-animate-hidden")}if(this.model.get("_animate")._custom._isEnabled){this.customEnabled=true;this.customElement=this.model.get("_animate")._custom._element;this.customEffect=this.model.get("_animate")._custom._effect;this.customDelay=this.model.get("_animate")._custom._delay?this.model.get("_animate")._custom._delay:0;if(this.customElement!=""){$(this.modelID).find("."+this.customElement).addClass("is-animated");$(this.modelID).find("."+this.customElement).addClass("is-animate-hidden")}if(this.customItems.length>0){for(let i=0,l=this.customItems.length;i<l;i++){$(this.modelID).find("."+this.customItems[i]._element).addClass("is-animated");$(this.modelID).find("."+this.customItems[i]._element).addClass("is-animate-hidden")}}if(this.model.has("_animate")&&this.model.get("_animate")._isEnabled&&this.model.get("_animate")._custom._items){this.customItems=this.model.get("_animate")._custom._items}}_.defer((()=>{this.postRender()}))}postRender(){if(!this.notifyIsOpen){this.animateElements()}}notifyOpened(){this.notifyIsOpen=true}notifyClosed(){this.notifyIsOpen=false;if(this.elementIsInView&&this.firstRun){_.delay((()=>{this.animateElements()}),400)}}animateElements(){this.firstRun=false;if(this.titleEnabled){_.delay((()=>{$(this.modelID).find(".menu__title-inner").addClass(this.titleEffect);$(this.modelID).find(".menu__title-inner").removeClass("is-animate-hidden")}),Math.round(this.titleDelay*1e3))}if(this.bodyEnabled){_.delay((()=>{$(this.modelID).find(".menu__body-inner").addClass(this.bodyEffect);$(this.modelID).find(".menu__body-inner").removeClass("is-animate-hidden")}),Math.round(this.bodyDelay*1e3))}if(this.customEnabled){if(this.customElement!=""){_.delay((()=>{$(this.modelID).find("."+this.customElement).addClass(this.customEffect);$(this.modelID).find("."+this.customElement).removeClass("is-animate-hidden")}),Math.round(this.customDelay*1e3))}if(this.customItems.length==0)return;for(let i=0,l=this.customItems.length;i<l;i++){this.animateItem(this.customItems[i])}}}animateItem(item){_.delay((()=>{$(this.modelID).find("."+item._element).addClass(item._effect);$(this.modelID).find("."+item._element).removeClass("is-animate-hidden")}),Math.round(item._delay*1e3))}});var AnimateArticleView=__AMD("extensions/adapt-animate/js/animate-articleView",class AnimateArticleView extends Backbone.View{initialize(){this.listenTo(Adapt$1,"remove",this.removeInViewListeners);this.listenTo(Adapt$1,"popup:closed",this.notifyClosed);this.render()}render(){if(!Adapt$1.course.get("_animate"))return;this.firstRun=true;this.elementIsInView=false;this.modelID="."+this.model.get("_id");this.titleEnabled=false;this.titleDelay=0;this.bodyEnabled=false;this.bodyDelay=0;this.instructionEnabled=false;this.instructionDelay=0;this.customEnabled=false;this.customDelay=0;this.customItems=[];if(Adapt$1.course.get("_animate")._article._title._isEnabled){this.titleEnabled=true;this.titleEffect=Adapt$1.course.get("_animate")._article._title._effect;this.titleDelay=Adapt$1.course.get("_animate")._article._title._delay}if(this.model.has("_animate")&&this.model.get("_animate")._isEnabled){if(this.model.get("_animate")._title._isEnabled){this.titleEnabled=true;this.titleEffect=this.model.get("_animate")._title._effect;this.titleDelay=this.model.get("_animate")._title._delay}}if(Adapt$1.course.get("_animate")._article._body._isEnabled){this.bodyEnabled=true;this.bodyEffect=Adapt$1.course.get("_animate")._article._body._effect;this.bodyDelay=Adapt$1.course.get("_animate")._article._body._delay}if(this.model.has("_animate")&&this.model.get("_animate")._isEnabled){if(this.model.get("_animate")._body._isEnabled){this.bodyEnabled=true;this.bodyEffect=this.model.get("_animate")._body._effect;this.bodyDelay=this.model.get("_animate")._body._delay}}if(Adapt$1.course.get("_animate")._article._instruction._isEnabled){this.instructionEnabled=true;this.instructionEffect=Adapt$1.course.get("_animate")._article._instruction._effect;this.instructionDelay=Adapt$1.course.get("_animate")._article._instruction._delay}if(this.model.has("_animate")&&this.model.get("_animate")._isEnabled){if(this.model.get("_animate")._instruction._isEnabled){this.instructionEnabled=true;this.instructionEffect=this.model.get("_animate")._instruction._effect;this.instructionDelay=this.model.get("_animate")._instruction._delay}}if(Adapt$1.course.get("_animate")._article._custom._isEnabled){this.customEnabled=true;this.customElement=Adapt$1.course.get("_animate")._article._custom._element;this.customEffect=Adapt$1.course.get("_animate")._article._custom._effect;this.customDelay=Adapt$1.course.get("_animate")._article._custom._delay;if(Adapt$1.course.get("_animate")._article._custom._items){for(let i=0,l=Adapt$1.course.get("_animate")._article._custom._items.length;i<l;i++){this.customItems.push(Adapt$1.course.get("_animate")._article._custom._items[i])}}}if(this.model.has("_animate")&&this.model.get("_animate")._isEnabled){if(this.model.get("_animate")._custom._isEnabled){this.customEnabled=true;this.customElement=this.model.get("_animate")._custom._element;this.customEffect=this.model.get("_animate")._custom._effect;this.customDelay=this.model.get("_animate")._custom._delay;if(this.model.has("_animate")&&this.model.get("_animate")._isEnabled&&this.model.get("_animate")._custom._items){for(let i=0,l=this.model.get("_animate")._custom._items.length;i<l;i++){this.customItems.push(this.model.get("_animate")._custom._items[i])}}}}_.defer((()=>{this.postRender()}))}postRender(){this.addClasses();$(this.modelID).on("inview",this.inview.bind(this))}addClasses(){if(this.titleEnabled){$(this.modelID).find(".article__title-inner").addClass("is-animated");$(this.modelID).find(".article__title-inner").addClass("is-animate-hidden")}if(this.bodyEnabled){$(this.modelID).find(".article__body-inner").addClass("is-animated");$(this.modelID).find(".article__body-inner").addClass("is-animate-hidden")}if(this.instructionEnabled){$(this.modelID).find(".article__instruction-inner").addClass("is-animated");$(this.modelID).find(".article__instruction-inner").addClass("is-animate-hidden")}if(this.customEnabled&&this.customElement!=""){$(this.modelID).find("."+this.customElement).addClass("is-animated");$(this.modelID).find("."+this.customElement).addClass("is-animate-hidden")}if(this.customItems.length>0){for(let i=0,l=this.customItems.length;i<l;i++){$(this.modelID).find("."+this.customItems[i]._element).addClass("is-animated");$(this.modelID).find("."+this.customItems[i]._element).addClass("is-animate-hidden")}}}notifyClosed(){if(this.elementIsInView&&this.firstRun){_.delay((()=>{this.animateElements();this.removeInViewListeners()}),400)}}inview(event,visible,visiblePartX,visiblePartY){if(visible){if(visiblePartY==="top"){this._isVisibleTop=true}else if(visiblePartY==="bottom"){this._isVisibleBottom=true}else{this._isVisibleTop=true;this._isVisibleBottom=true}if(this._isVisibleTop||this._isVisibleBottom&&Adapt$1.animate.notifyIsOpen==false){this.elementIsInView=true;if(!Adapt$1.animate.notifyIsOpen){this.animateElements();this.removeInViewListeners()}}else{this.elementIsInView=false}}}animateElements(){this.firstRun=false;if(this.titleEnabled){_.delay((()=>{$(this.modelID).find(".article__title-inner").addClass(this.titleEffect);$(this.modelID).find(".article__title-inner").removeClass("is-animate-hidden")}),Math.round(this.titleDelay*1e3))}if(this.bodyEnabled){_.delay((()=>{$(this.modelID).find(".article__body-inner").addClass(this.bodyEffect);$(this.modelID).find(".article__body-inner").removeClass("is-animate-hidden")}),Math.round(this.bodyDelay*1e3))}if(this.instructionEnabled){_.delay((()=>{$(this.modelID).find(".article__instruction-inner").addClass(this.instructionEffect);$(this.modelID).find(".article__instruction-inner").removeClass("is-animate-hidden")}),Math.round(this.instructionDelay*1e3))}if(this.customEnabled){if(this.customElement!=""){_.delay((()=>{$(this.modelID).find("."+this.customElement).addClass(this.customEffect);$(this.modelID).find("."+this.customElement).removeClass("is-animate-hidden")}),Math.round(this.customDelay*1e3))}if(this.customItems.length==0)return;for(let i=0,l=this.customItems.length;i<l;i++){this.animateItem(this.customItems[i])}}}animateItem(item){_.delay((()=>{$(this.modelID).find("."+item._element).addClass(item._effect);$(this.modelID).find("."+item._element).removeClass("is-animate-hidden")}),Math.round(item._delay*1e3))}removeInViewListeners(){$(this.modelID).off("inview")}});var AnimateBlockView=__AMD("extensions/adapt-animate/js/animate-blockView",class AnimateBlockView extends Backbone.View{initialize(){this.listenTo(Adapt$1,"remove",this.removeInViewListeners);this.listenTo(Adapt$1,"popup:closed",this.notifyClosed);this.render()}render(){if(!Adapt$1.course.get("_animate"))return;this.firstRun=true;this.elementIsInView=false;this.modelID="."+this.model.get("_id");this.titleEnabled=false;this.titleDelay=0;this.bodyEnabled=false;this.bodyDelay=0;this.instructionEnabled=false;this.instructionDelay=0;this.customEnabled=false;this.customDelay=0;this.customItems=[];if(Adapt$1.course.get("_animate")._block._title._isEnabled){this.titleEnabled=true;this.titleEffect=Adapt$1.course.get("_animate")._block._title._effect;this.titleDelay=Adapt$1.course.get("_animate")._block._title._delay}if(this.model.has("_animate")&&this.model.get("_animate")._isEnabled){if(this.model.get("_animate")._title._isEnabled){this.titleEnabled=true;this.titleEffect=this.model.get("_animate")._title._effect;this.titleDelay=this.model.get("_animate")._title._delay}}if(Adapt$1.course.get("_animate")._block._body._isEnabled){this.bodyEnabled=true;this.bodyEffect=Adapt$1.course.get("_animate")._block._body._effect;this.bodyDelay=Adapt$1.course.get("_animate")._block._body._delay}if(this.model.has("_animate")&&this.model.get("_animate")._isEnabled){if(this.model.get("_animate")._body._isEnabled){this.bodyEnabled=true;this.bodyEffect=this.model.get("_animate")._body._effect;this.bodyDelay=this.model.get("_animate")._body._delay}}if(Adapt$1.course.get("_animate")._block._instruction._isEnabled){this.instructionEnabled=true;this.instructionEffect=Adapt$1.course.get("_animate")._block._instruction._effect;this.instructionDelay=Adapt$1.course.get("_animate")._block._instruction._delay}if(this.model.has("_animate")&&this.model.get("_animate")._isEnabled){if(this.model.get("_animate")._instruction._isEnabled){this.instructionEnabled=true;this.instructionEffect=this.model.get("_animate")._instruction._effect;this.instructionDelay=this.model.get("_animate")._instruction._delay}}if(Adapt$1.course.get("_animate")._block._custom._isEnabled){this.customEnabled=true;this.customElement=Adapt$1.course.get("_animate")._block._custom._element;this.customEffect=Adapt$1.course.get("_animate")._block._custom._effect;this.customDelay=Adapt$1.course.get("_animate")._block._custom._delay;if(Adapt$1.course.get("_animate")._block._custom._items){for(let i=0,l=Adapt$1.course.get("_animate")._block._custom._items.length;i<l;i++){this.customItems.push(Adapt$1.course.get("_animate")._block._custom._items[i])}}}if(this.model.has("_animate")&&this.model.get("_animate")._isEnabled){if(this.model.get("_animate")._custom._isEnabled){this.customEnabled=true;this.customElement=this.model.get("_animate")._custom._element;this.customEffect=this.model.get("_animate")._custom._effect;this.customDelay=this.model.get("_animate")._custom._delay;if(this.model.has("_animate")&&this.model.get("_animate")._isEnabled&&this.model.get("_animate")._custom._items){for(let i=0,l=this.model.get("_animate")._custom._items.length;i<l;i++){this.customItems.push(this.model.get("_animate")._custom._items[i])}}}}_.defer((()=>{this.postRender()}))}postRender(){this.addClasses();$(this.modelID).on("inview",this.inview.bind(this))}addClasses(){if(this.titleEnabled){$(this.modelID).find(".block__title-inner").addClass("is-animated");$(this.modelID).find(".block__title-inner").addClass("is-animate-hidden")}if(this.bodyEnabled){$(this.modelID).find(".block__body-inner").addClass("is-animated");$(this.modelID).find(".block__body-inner").addClass("is-animate-hidden")}if(this.instructionEnabled){$(this.modelID).find(".block__instruction-inner").addClass("is-animated");$(this.modelID).find(".block__instruction-inner").addClass("is-animate-hidden")}if(this.customEnabled&&this.customElement!=""){$(this.modelID).find("."+this.customElement).addClass("is-animated");$(this.modelID).find("."+this.customElement).addClass("is-animate-hidden")}if(this.customItems.length>0){for(let i=0,l=this.customItems.length;i<l;i++){$(this.modelID).find("."+this.customItems[i]._element).addClass("is-animated");$(this.modelID).find("."+this.customItems[i]._element).addClass("is-animate-hidden")}}}notifyClosed(){if(this.elementIsInView&&this.firstRun){_.delay((()=>{this.animateElements();this.removeInViewListeners()}),400)}}inview(event,visible,visiblePartX,visiblePartY){if(visible){if(visiblePartY==="top"){this._isVisibleTop=true}else if(visiblePartY==="bottom"){this._isVisibleBottom=true}else{this._isVisibleTop=true;this._isVisibleBottom=true}if(this._isVisibleTop||this._isVisibleBottom&&Adapt$1.animate.notifyIsOpen==false){this.elementIsInView=true;if(!Adapt$1.animate.notifyIsOpen){this.animateElements();this.removeInViewListeners()}}else{this.elementIsInView=false}}}animateElements(){this.firstRun=false;if(this.titleEnabled){_.delay((()=>{$(this.modelID).find(".block__title-inner").addClass(this.titleEffect);$(this.modelID).find(".block__title-inner").removeClass("is-animate-hidden")}),Math.round(this.titleDelay*1e3))}if(this.bodyEnabled){_.delay((()=>{$(this.modelID).find(".block__body-inner").addClass(this.bodyEffect);$(this.modelID).find(".block__body-inner").removeClass("is-animate-hidden")}),Math.round(this.bodyDelay*1e3))}if(this.instructionEnabled){_.delay((()=>{$(this.modelID).find(".block__instruction-inner").addClass(this.instructionEffect);$(this.modelID).find(".block__instruction-inner").removeClass("is-animate-hidden")}),Math.round(this.instructionDelay*1e3))}if(this.customEnabled){if(this.customElement!=""){_.delay((()=>{$(this.modelID).find("."+this.customElement).addClass(this.customEffect);$(this.modelID).find("."+this.customElement).removeClass("is-animate-hidden")}),Math.round(this.customDelay*1e3))}if(this.customItems.length==0)return;for(let i=0,l=this.customItems.length;i<l;i++){this.animateItem(this.customItems[i])}}}animateItem(item){_.delay((()=>{$(this.modelID).find("."+item._element).addClass(item._effect);$(this.modelID).find("."+item._element).removeClass("is-animate-hidden")}),Math.round(item._delay*1e3))}removeInViewListeners(){$(this.modelID).off("inview")}});var AnimateComponentView=__AMD("extensions/adapt-animate/js/animate-componentView",class AnimateComponentView extends Backbone.View{initialize(){this.listenTo(Adapt$1,"remove",this.removeInViewListeners);this.listenTo(Adapt$1,"popup:closed",this.notifyClosed);this.render()}render(){if(!Adapt$1.course.get("_animate"))return;this.firstRun=true;this.elementIsInView=false;this.modelID="."+this.model.get("_id");this.completeElementEnabled=false;this.completeElementDelay=0;this.titleEnabled=false;this.titleDelay=0;this.bodyEnabled=false;this.bodyDelay=0;this.instructionEnabled=false;this.instructionDelay=0;this.customEnabled=false;this.customDelay=0;this.customItems=[];if(Adapt$1.course.get("_animate")._component._completeElement._isEnabled){this.completeElementEnabled=true;this.completeElementEffect=Adapt$1.course.get("_animate")._component._completeElement._effect;this.completeElementDelay=Adapt$1.course.get("_animate")._component._completeElement._delay}if(this.model.has("_animate")&&this.model.get("_animate")._isEnabled){if(this.model.get("_animate")._completeElement._isEnabled){this.completeElementEnabled=true;this.completeElementEffect=this.model.get("_animate")._completeElement._effect;this.completeElementDelay=this.model.get("_animate")._completeElement._delay}}if(Adapt$1.course.get("_animate")._component._title._isEnabled){this.titleEnabled=true;this.titleEffect=Adapt$1.course.get("_animate")._component._title._effect;this.titleDelay=Adapt$1.course.get("_animate")._component._title._delay}if(this.model.has("_animate")&&this.model.get("_animate")._isEnabled){if(this.model.get("_animate")._title._isEnabled){this.titleEnabled=true;this.titleEffect=this.model.get("_animate")._title._effect;this.titleDelay=this.model.get("_animate")._title._delay}}if(Adapt$1.course.get("_animate")._component._body._isEnabled){this.bodyEnabled=true;this.bodyEffect=Adapt$1.course.get("_animate")._component._body._effect;this.bodyDelay=Adapt$1.course.get("_animate")._component._body._delay}if(this.model.has("_animate")&&this.model.get("_animate")._isEnabled){if(this.model.get("_animate")._body._isEnabled){this.bodyEnabled=true;this.bodyEffect=this.model.get("_animate")._body._effect;this.bodyDelay=this.model.get("_animate")._body._delay}}if(Adapt$1.course.get("_animate")._component._instruction._isEnabled){this.instructionEnabled=true;this.instructionEffect=Adapt$1.course.get("_animate")._component._instruction._effect;this.instructionDelay=Adapt$1.course.get("_animate")._component._instruction._delay}if(this.model.has("_animate")&&this.model.get("_animate")._isEnabled){if(this.model.get("_animate")._instruction._isEnabled){this.instructionEnabled=true;this.instructionEffect=this.model.get("_animate")._instruction._effect;this.instructionDelay=this.model.get("_animate")._instruction._delay}}if(Adapt$1.course.get("_animate")._component._custom._isEnabled){this.customEnabled=true;this.customElement=Adapt$1.course.get("_animate")._component._custom._element;this.customEffect=Adapt$1.course.get("_animate")._component._custom._effect;this.customDelay=Adapt$1.course.get("_animate")._component._custom._delay;if(Adapt$1.course.get("_animate")._component._custom._items){for(let i=0,l=Adapt$1.course.get("_animate")._component._custom._items.length;i<l;i++){this.customItems.push(Adapt$1.course.get("_animate")._component._custom._items[i])}}}if(this.model.has("_animate")&&this.model.get("_animate")._isEnabled){if(this.model.get("_animate")._custom._isEnabled){this.customEnabled=true;this.customElement=this.model.get("_animate")._custom._element;this.customEffect=this.model.get("_animate")._custom._effect;this.customDelay=this.model.get("_animate")._custom._delay;if(this.model.has("_animate")&&this.model.get("_animate")._isEnabled&&this.model.get("_animate")._custom._items){for(let i=0,l=this.model.get("_animate")._custom._items.length;i<l;i++){this.customItems.push(this.model.get("_animate")._custom._items[i])}}}}_.defer((()=>{this.postRender()}))}postRender(){this.addClasses();$(this.modelID).on("inview",this.inview.bind(this))}addClasses(){if(this.completeElementEnabled){$(this.modelID).addClass("is-animated");$(this.modelID).addClass("is-animate-hidden");this.model.set("_isAnimating",true)}if(this.titleEnabled){$(this.modelID).find(".component__title-inner").addClass("is-animated");$(this.modelID).find(".component__title-inner").addClass("is-animate-hidden")}if(this.bodyEnabled){$(this.modelID).find(".component__body-inner").addClass("is-animated");$(this.modelID).find(".component__body-inner").addClass("is-animate-hidden")}if(this.instructionEnabled){$(this.modelID).find(".component__instruction-inner").addClass("is-animated");$(this.modelID).find(".component__instruction-inner").addClass("is-animate-hidden")}if(this.customEnabled&&this.customElement!=""){$(this.modelID).find("."+this.customElement).addClass("is-animated");$(this.modelID).find("."+this.customElement).addClass("is-animate-hidden")}if(this.customItems.length>0){for(let i=0,l=this.customItems.length;i<l;i++){$(this.modelID).find("."+this.customItems[i]._element).addClass("is-animated");$(this.modelID).find("."+this.customItems[i]._element).addClass("is-animate-hidden")}}}notifyClosed(){if(this.elementIsInView&&this.firstRun){_.delay((()=>{this.animateElements();this.removeInViewListeners()}),400)}}inview(event,visible,visiblePartX,visiblePartY){if(visible){if(visiblePartY==="top"){this._isVisibleTop=true}else if(visiblePartY==="bottom"){this._isVisibleBottom=true}else{this._isVisibleTop=true;this._isVisibleBottom=true}if(this._isVisibleTop||this._isVisibleBottom&&Adapt$1.animate.notifyIsOpen==false){this.elementIsInView=true;if(!Adapt$1.animate.notifyIsOpen){this.animateElements();this.removeInViewListeners()}}else{this.elementIsInView=false}}}animateElements(){this.firstRun=false;if(this.completeElementEnabled){_.delay((()=>{$(this.modelID).addClass(this.completeElementEffect);$(this.modelID).removeClass("is-animate-hidden");this.model.set("_isAnimating",false)}),Math.round(this.completeElementDelay*1e3))}if(this.titleEnabled){_.delay((()=>{$(this.modelID).find(".component__title-inner").addClass(this.titleEffect);$(this.modelID).find(".component__title-inner").removeClass("is-animate-hidden")}),Math.round(this.titleDelay*1e3))}if(this.bodyEnabled){_.delay((()=>{$(this.modelID).find(".component__body-inner").addClass(this.bodyEffect);$(this.modelID).find(".component__body-inner").removeClass("is-animate-hidden")}),Math.round(this.bodyDelay*1e3))}if(this.instructionEnabled){_.delay((()=>{$(this.modelID).find(".component__instruction-inner").addClass(this.instructionEffect);$(this.modelID).find(".component__instruction-inner").removeClass("is-animate-hidden")}),Math.round(this.instructionDelay*1e3))}if(this.customEnabled){if(this.customElement!=""){_.delay((()=>{$(this.modelID).find("."+this.customElement).addClass(this.customEffect);$(this.modelID).find("."+this.customElement).removeClass("is-animate-hidden")}),Math.round(this.customDelay*1e3))}if(this.customItems.length==0)return;for(let i=0,l=this.customItems.length;i<l;i++){this.animateItem(this.customItems[i])}}}animateItem(item){_.delay((()=>{$(this.modelID).find("."+item._element).addClass(item._effect);$(this.modelID).find("."+item._element).removeClass("is-animate-hidden")}),Math.round(item._delay*1e3))}removeInViewListeners(){$(this.modelID).off("inview")}});class Animate extends Backbone.Controller{initialize(){this.listenToOnce(Adapt$1,"app:dataReady",this.onAppDataReady)}onAppDataReady(){this.listenTo(Adapt$1.config,"change:_activeLanguage",this.onLangChange);if(!Adapt$1.course.get("_animate"))return;if(Adapt$1.course.get("_animate")._isEnabled){this.setupAnimate();this.setupListeners()}}onLangChange(){this.removeListeners();this.listenToOnce(Adapt$1,"app:dataReady",this.onAppDataReady)}setupListeners(){this.listenTo(Adapt$1,{"popup:opened":this.notifyOpened,"popup:closed":this.notifyClosed,"menuView:postRender":this.onMenuReady,"articleView:postRender":this.onArticleReady,"blockView:postRender":this.onBlockReady,"componentView:postRender":this.onComponentReady})}removeListeners(){this.stopListening(Adapt$1,{"popup:opened":this.notifyOpened,"popup:closed":this.notifyClosed,"menuView:postRender":this.onMenuReady,"articleView:postRender":this.onArticleReady,"blockView:postRender":this.onBlockReady,"componentView:postRender":this.onComponentReady});this.stopListening(Adapt$1.config,"change:_activeLanguage",this.onLangChange)}notifyOpened(){Adapt$1.animate.notifyIsOpen=true}notifyClosed(){Adapt$1.animate.notifyIsOpen=false}setupAnimate(){Adapt$1.animate.notifyIsOpen=false;if(Adapt$1.course.get("_animate")._article&&Adapt$1.course.get("_animate")._article._isEnabled){Adapt$1.animate.animateArticleEnabled=Adapt$1.course.get("_animate")._article._isEnabled}else{Adapt$1.animate.animateArticleEnabled=false}if(Adapt$1.course.get("_animate")._block&&Adapt$1.course.get("_animate")._block._isEnabled){Adapt$1.animate.animateBlockEnabled=Adapt$1.course.get("_animate")._block._isEnabled}else{Adapt$1.animate.animateBlockEnabled=false}if(Adapt$1.course.get("_animate")._component&&Adapt$1.course.get("_animate")._component._isEnabled){Adapt$1.animate.animateComponentEnabled=Adapt$1.course.get("_animate")._component._isEnabled}else{Adapt$1.animate.animateComponentEnabled=false}}onMenuReady(view){if(view.model.get("_type")=="menu"&&view.model&&view.model.get("_animate")&&view.model.get("_animate")._isEnabled){new AnimateMenuView({model:view.model})}}onArticleReady(view){if(view.model&&Adapt$1.animate.animateArticleEnabled){new AnimateArticleView({model:view.model})}else if(view.model&&view.model.get("_animate")&&view.model.get("_animate")._isEnabled){new AnimateArticleView({model:view.model})}}onBlockReady(view){if(view.model&&Adapt$1.animate.animateBlockEnabled){new AnimateBlockView({model:view.model})}else if(view.model&&view.model.get("_animate")&&view.model.get("_animate")._isEnabled){new AnimateBlockView({model:view.model})}}onComponentReady(view){if(view.model&&Adapt$1.animate.animateComponentEnabled){new AnimateComponentView({model:view.model})}else if(view.model&&view.model.get("_animate")&&view.model.get("_animate")._isEnabled){new AnimateComponentView({model:view.model})}}}__AMD("extensions/adapt-animate/js/adapt-animate",Adapt$1.animate=new Animate);var BlockSliderView={_isReady:false,_disableAnimationOnce:false,events:{"click [data-block-slider]":"_onBlockSliderClick"},preRender:function(){ArticleView$1.prototype.preRender.call(this);if(!this.model.isBlockSliderEnabled()){this.$el.addClass("is-disabled");return}this._blockSliderPreRender()},_blockSliderPreRender:function(){Adapt$1.wait.for(function(done){this.resolveQueue=done}.bind(this));this._blockSliderSetupEventListeners()},_blockSliderSetupEventListeners:function(){this._blockSliderResizeHeight=this._blockSliderResizeHeight.bind(this);this.listenTo(Adapt$1,{"device:resize":this._onBlockSliderResize,"device:changed":this._onBlockSliderDeviceChanged,"page:scrollTo":this._onBlockSliderPageScrollTo,"page:scrolledTo":this._onBlockSliderPageScrolledTo});this.listenToOnce(Adapt$1,"remove",this._onBlockSliderRemove);this.listenToOnce(this.model,"change:_isReady",this._onBlockSliderReady);var duration=this.model.get("_articleBlockSlider")._slideAnimationDuration||200;this._blockSliderHideOthers=_.debounce(this._blockSliderHideOthers.bind(this),duration)},render:function(){if(this.model.isBlockSliderEnabled()){this._blockSliderRender()}else ArticleView$1.prototype.render.call(this)},_blockSliderRender:function(){Adapt$1.trigger(this.constructor.type+"View:preRender view:render",this);this._blockSliderConfigureVariables();var data=this.model.toJSON();var template=Handlebars.templates["articleBlockSlider-article"];this.$el.html(template(data));Adapt$1.trigger(this.constructor.type+"View:render",this);this.addChildren();this.$el.addClass("abs");this.delegateEvents();this.$el.imageready(function(){_.delay(this._blockSliderPostRender.bind(this),500)}.bind(this));return this},_blockSliderConfigureVariables:function(){var blocks=this.model.getChildren().models.filter((model=>model.isTypeGroup("block")));var totalBlocks=blocks.length;var itemButtons=[];for(var i=0,l=totalBlocks;i<l;i++){itemButtons.push({_className:(i===0?"home":"not-home")+(" i"+i),_index:i,_includeNumber:i!==0,_title:blocks[i].get("title")})}this.model.set({_currentBlock:0,_totalBlocks:totalBlocks,_itemButtons:itemButtons})},_blockSliderConfigureControls:function(){this.model.get("_articleBlockSlider")._slideAnimationDuration||200;if(this._disableAnimationOnce)animate=false;var _currentBlock=this.model.get("_currentBlock");var _totalBlocks=this.model.get("_totalBlocks");var $left=this.$el.find("[data-block-slider='left']");var $right=this.$el.find("[data-block-slider='right']");if(_currentBlock===0){$left.a11y_cntrl_enabled(false);$right.a11y_cntrl_enabled(true)}else if(_currentBlock==_totalBlocks-1){$left.a11y_cntrl_enabled(true);$right.a11y_cntrl_enabled(false)}else{$left.a11y_cntrl_enabled(true);$right.a11y_cntrl_enabled(true)}var $indexes=this.$el.find("[data-block-slider='index']");$indexes.a11y_cntrl_enabled(true).removeClass("is-selected");$indexes.eq(_currentBlock).a11y_cntrl_enabled(false).addClass("is-selected is-visited");var $blocks=this.$el.find(".block");if(!$blocks.length)return;$blocks.a11y_on(false).eq(_currentBlock).a11y_on(true)},_blockSliderSetButtonLayout:function(){var buttonsLength=this.model.get("_itemButtons").length;var itemwidth=100/buttonsLength;this.$(".js-abs-btn-tab").css({width:itemwidth+"%"})},_blockSliderPostRender:function(){this._blockSliderConfigureControls(false);this._onBlockSliderDeviceChanged();var startIndex=this.model.get("_articleBlockSlider")._startIndex||0;this._blockSliderMoveIndex(startIndex,false);Adapt$1.trigger(this.constructor.type+"View:postRender",this)},_onBlockSliderReady:function(){this._blockSliderHideOthers();_.delay(function(){this._blockSliderConfigureControls(false);this._onBlockSliderResize();this.resolveQueue();this._isReady=true}.bind(this),250);this.$(".component").on("resize",this._blockSliderResizeHeight)},_onBlockSliderClick:function(event){event.preventDefault();var id=$(event.currentTarget).attr("data-block-slider");switch(id){case"left":this._blockSliderMoveLeft();break;case"index":var index=parseInt($(event.currentTarget).attr("data-block-slider-index"));this._blockSliderMoveIndex(index);break;case"right":this._blockSliderMoveRight();break}},_blockSliderMoveLeft:function(){if(this.model.get("_currentBlock")===0)return;var index=this.model.get("_currentBlock");this._blockSliderMoveIndex(--index)},_blockSliderMoveIndex:function(index,animate){if(this.model.get("_currentBlock")!=index){this.model.set("_currentBlock",index);Adapt$1.trigger("media:stop");this._blockSliderSetVisible(this.model.getChildren().models[index],true);this._blockSliderResizeHeight(animate);this._blockSliderScrollToCurrent(animate);this._blockSliderConfigureControls(animate)}var duration=this.model.get("_articleBlockSlider")._slideAnimationDuration||200;if(this._disableAnimationOnce)animate=false;if(animate!==false){_.delay((function(){$(window).resize()}),duration);return}$(window).resize()},_blockSliderMoveRight:function(){if(this.model.get("_currentBlock")==this.model.get("_totalBlocks")-1)return;var index=this.model.get("_currentBlock");this._blockSliderMoveIndex(++index)},_blockSliderScrollToCurrent:function(animate){var isEnabled=this._blockSliderIsEnabledOnScreenSizes();var $container=this.$el.find(".js-abs-slide-container");if(!isEnabled){return $container.scrollLeft(0)}var blocks=this.$el.find(".block");var blockWidth=$(blocks[0]).outerWidth();var lastIndex=blocks.length-1;var currentBlock=this.model.get("_currentBlock");var isRTL=Adapt$1.config.get("_defaultDirection")==="rtl";var totalLeft=isRTL?(lastIndex-currentBlock)*blockWidth:currentBlock*blockWidth;this._blockSliderShowAll();var duration=this.model.get("_articleBlockSlider")._slideAnimationDuration||200;if(this._disableAnimationOnce)animate=false;if(animate===false){_.defer(function(){$container.scrollLeft(totalLeft);this._blockSliderHideOthers()}.bind(this));return}$container.stop(true).animate({scrollLeft:totalLeft},duration,function(){$container.scrollLeft(totalLeft);this._blockSliderHideOthers()}.bind(this))},_blockSliderIsEnabledOnScreenSizes:function(){var isEnabledOnScreenSizes=this.model.get("_articleBlockSlider")._isEnabledOnScreenSizes;var sizes=isEnabledOnScreenSizes.split(" ");if(sizes.indexOf(Adapt$1.device.screenSize)>-1){return true}return false},_blockSliderShowAll:function(){this._blockSliderHideOthers.cancel();this.model.getChildren().models.filter((model=>model.isTypeGroup("block"))).forEach(function(block){this._blockSliderSetVisible(block,true)}.bind(this))},_blockSliderHideOthers:function(){var currentIndex=this.model.get("_currentBlock");this.model.getChildren().models.filter((model=>model.isTypeGroup("block"))).forEach(function(block,index){var makeVisible=index===currentIndex;this._blockSliderSetVisible(block,makeVisible)}.bind(this))},_blockSliderSetVisible:function(model,makeVisible){this.$el.find("."+model.get("_id")+" *").css("visibility",makeVisible?"":"hidden")},_onBlockSliderResize:function(){this._blockSliderResizeWidth(false);this._blockSliderResizeHeight(false);this._blockSliderScrollToCurrent(false);this._blockSliderResizeTab()},_blockSliderResizeHeight:function(animate){if(!this._isReady)animate=false;var $container=this.$el.find(".js-abs-slide-container");var isEnabled=this._blockSliderIsEnabledOnScreenSizes();if(!isEnabled){this._blockSliderShowAll();return $container.velocity("stop").css({height:"","min-height":""})}var currentBlock=this.model.get("_currentBlock");var $blocks=this.$el.find(".block");var currentHeight=$container.height();var blockHeight=$blocks.eq(currentBlock).height();var maxHeight=-1;$container.find(".block").each((function(){if($(this).height()>maxHeight){maxHeight=$(this).height()}}));var duration=(this.model.get("_articleBlockSlider")._heightAnimationDuration||200)*2;if(this._disableAnimationOnce)animate=false;if(this.model.get("_articleBlockSlider")._hasUniformHeight){if(animate===false){$container.css({height:maxHeight+"px"})}else{$container.velocity("stop").velocity({height:maxHeight+"px"},{duration:duration})}}else if(currentHeight<=blockHeight){if(animate===false){$container.css({height:blockHeight+"px"})}else{$container.velocity("stop").velocity({height:blockHeight+"px"},{duration:duration})}}else if(currentHeight>blockHeight){if(animate===false){$container.css({height:blockHeight+"px"})}else{$container.velocity("stop").velocity({height:blockHeight+"px"},{duration:duration})}}var minHeight=this.model.get("_articleBlockSlider")._minHeight;if(minHeight){$container.css({"min-height":minHeight+"px"})}},_blockSliderResizeTab:function(){if(!this.model.get("_articleBlockSlider")._hasTabs)return;this._blockSliderSetButtonLayout();this.$(".js-abs-btn-tab").css({height:""});var parentHeight=this.$(".js-abs-btn-tab").parent().height();this.$(".js-abs-btn-tab").css({height:parentHeight+"px"});var toolbarHeight=this.$(".js-abs-btn-tab-container").height();var additionalMargin="30";this.$(".js-abs-btn-tab-container").css({top:"-"+(toolbarHeight+additionalMargin/2)+"px"});var toolbarMargin=parseFloat(toolbarHeight)+parseFloat(additionalMargin);this.$(".js-abs-slide-container").css({marginTop:toolbarMargin+"px"})},_blockSliderResizeWidth:function(){var isEnabled=this._blockSliderIsEnabledOnScreenSizes();var $blockContainer=this.$el.find(".js-abs-block-container");var $blocks=this.$el.find(".block");if(!isEnabled){$blocks.css("width","");return $blockContainer.css({width:"100%"})}var $container=this.$el.find(".js-abs-slide-container");$blocks.css("width",$container.width()+"px");var blockWidth=$($blocks[0]).outerWidth();var totalWidth=$blocks.length*blockWidth;$blockContainer.width(totalWidth+"px")},_onBlockSliderDeviceChanged:function(){var showToolbar=this._blockSliderIsEnabledOnScreenSizes();this.$(".js-abs-toolbar, .js-abs-toolbar-bottom").toggleClass("u-display-none",!showToolbar);_.delay((function(){$(window).resize()}),250)},_onBlockSliderPageScrollTo:function(selector){this._disableAnimationOnce=true;_.defer(function(){this._disableAnimationOnce=false}.bind(this));if(typeof selector==="object")selector=selector.selector;if(!this._blockSliderIsEnabledOnScreenSizes()){return}if(this.$el.find(selector).length===0)return;var id=selector.substr(1);var model=Adapt$1.findById(id);if(!model)return;var block=model.get("_type")==="block"?model:model.findAncestor("blocks");if(!block)return;this.model.getChildren().models.filter((model=>model.isTypeGroup("block"))).find(((item,index)=>{if(item.get("_id")!==block.get("_id"))return;_.defer((()=>this._blockSliderMoveIndex(index,false)));return true}))},_onBlockSliderPageScrolledTo:function(){_.defer(function(){this._blockSliderScrollToCurrent(false)}.bind(this))},_onBlockSliderRemove:function(){this._blockSliderRemoveEventListeners()},_blockSliderRemoveEventListeners:function(){this.$(".component").off("resize",this._blockSliderResizeHeight);this.stopListening(Adapt$1,"device:changed",this._onBlockSliderDeviceChanged)}};var ArticleViewExtension=__AMD("extensions/adapt-articleBlockSlider/js/adapt-articleView",BlockSliderView);var BlockSliderModel={isBlockSliderEnabled:function(){var config=this.get("_articleBlockSlider");if(!config||!config._isEnabled||config._isDisabledWhenAccessibilityActive&&Adapt$1.accessibility.isActive()){return false}return true}};var ArticleModelExtension=__AMD("extensions/adapt-articleBlockSlider/js/adapt-articleModel",BlockSliderModel);var ArticleViewInitialize$1=ArticleView$1.prototype.initialize;ArticleView$1.prototype.initialize=function(options){if(this.model.get("_articleBlockSlider")){_.extend(this,ArticleViewExtension)}return ArticleViewInitialize$1.apply(this,arguments)};var ArticleModelInitialize$1=ArticleModel$1.prototype.initialize;ArticleModel$1.prototype.initialize=function(options){if(this.get("_articleBlockSlider")){_.extend(this,ArticleModelExtension);var returnValue=ArticleModelInitialize$1.apply(this,arguments);return returnValue}return ArticleModelInitialize$1.apply(this,arguments)};var AudioPromptView=Backbone.View.extend({className:"audio-prompt-content",events:{"click .audio-fullTextAudioOn":"setFullTextAudioOn","click .audio-reducedTextAudioOn":"setReducedTextAudioOn","click .audio-fullTextAudioOff":"setFullTextAudioOff","click .audio-reducedTextAudioOff":"setReducedTextAudioOff","click .audio-selectContinueAudioOn":"setContinueAudioOn","click .audio-selectContinueAudioOff":"setContinueAudioOff","click .audio-selectOff":"setAudioOff","click .audio-selectOn":"setAudioOn"},initialize:function(){this.render()},render:function(){var data=this.model.toJSON();var template=Handlebars.templates["audioPrompt"];this.$el.html(template(data))},setFullTextAudioOn:function(event){Adapt$1.audio.audioStatus=1;Adapt$1.trigger("audio:changeText",0);this.closePopup()},setFullTextAudioOff:function(event){Adapt$1.audio.audioStatus=0;Adapt$1.trigger("audio:changeText",0);this.closePopup()},setReducedTextAudioOn:function(event){Adapt$1.audio.audioStatus=1;Adapt$1.trigger("audio:changeText",1);this.closePopup()},setReducedTextAudioOff:function(event){Adapt$1.audio.audioStatus=0;Adapt$1.trigger("audio:changeText",1);this.closePopup()},setContinueAudioOn:function(event){Adapt$1.audio.audioStatus=1;Adapt$1.trigger("audio:changeText",0);this.closePopup()},setContinueAudioOff:function(event){Adapt$1.audio.audioStatus=0;Adapt$1.trigger("audio:changeText",0);this.closePopup()},setAudioOff:function(event){Adapt$1.audio.audioStatus=0;for(var i=0;i<Adapt$1.audio.numChannels;i++){Adapt$1.audio.audioClip[i].status=parseInt(Adapt$1.audio.audioStatus)}Adapt$1.trigger("audio:updateAudioStatus",0,0);Adapt$1.trigger("audio:changeText",0);this.closePopup()},setAudioOn:function(event){Adapt$1.audio.audioStatus=1;for(var i=0;i<Adapt$1.audio.numChannels;i++){Adapt$1.audio.audioClip[i].status=parseInt(Adapt$1.audio.audioStatus)}Adapt$1.trigger("audio:updateAudioStatus",0,1);Adapt$1.trigger("audio:changeText",0);this.closePopup()},closePopup:function(){Adapt$1.trigger("notify:close")}});var AudioPromptView$1=__AMD("extensions/adapt-audio/js/audio-prompt-view",AudioPromptView);var AudioNavigationView=Backbone.View.extend({className:"audio-navigation",initialize:function(){this.listenTo(Adapt$1.config,"change:_activeLanguage",this.remove);this.listenTo(Adapt$1,"audio:updateAudioStatus",this.updateToggle);this.render()},events:{"click .audio-button":"toggleAudio"},render:function(){var data=this.model.toJSON();var template=Handlebars.templates["audioNavigation"];this.$el.html(template({audioToggle:data}));if(Adapt$1.audio.audioStatus==1){this.$(".audio-button").addClass(Adapt$1.audio.iconOn)}else{this.$(".audio-button").addClass(Adapt$1.audio.iconOff)}if(!Adapt$1.course.get("_audio")._showOnNavbar){this.$el.addClass("hidden")}return this},updateToggle:function(){if(Adapt$1.audio.audioStatus==1){this.$(".audio-button").removeClass(Adapt$1.audio.iconOff);this.$(".audio-button").addClass(Adapt$1.audio.iconOn)}else{this.$(".audio-button").removeClass(Adapt$1.audio.iconOn);this.$(".audio-button").addClass(Adapt$1.audio.iconOff)}},toggleAudio:function(event){if(event)event.preventDefault();Adapt$1.trigger("audio:showAudioDrawer")}});var AudioNavigationView$1=__AMD("extensions/adapt-audio/js/audio-navigation-view",AudioNavigationView);var AudioDrawerView=Backbone.View.extend({className:"audio-drawer",initialize:function(){this.listenTo(Adapt$1,"remove",this.remove);this.listenTo(Adapt$1.config,"change:_activeLanguage",this.remove);this.render()},events:{"click .item-normal-narration":"turnOnNarration","click .item-mute-narration":"turnOffNarration","click .item-effects":"toggleEffects","click .item-music":"toggleMusic","click .full-button":"setFullText","click .reduced-button":"setReducedText","click .item-autoplay-narration":"toggleAutoplay"},render:function(){var modelData=this.model.toJSON();var template=Handlebars.templates["audioDrawer"];this.$el.html(template({model:modelData}));this.numChannels=0;if(Adapt$1.course.get("_audio")._channels._narration._isEnabled){this.checkNarration();this.numChannels++}if(Adapt$1.course.get("_audio")._channels._effects._isEnabled){this.checkEffects();this.numChannels++}if(Adapt$1.course.get("_audio")._channels._music._isEnabled){this.checkMusic();this.numChannels++}this.checkTextSize();_.defer(_.bind(this.postRender,this));return this},postRender:function(){this.listenTo(Adapt$1,"drawer:triggerCustomView",this.remove)},toggleAutoplay:function(event){if(event)event.preventDefault();this.turnOnNarration();Adapt$1.audio.autoPlayGlobal=false;Adapt$1.trigger("audio:updateAudioAutoplayGlobal",Adapt$1.audio.autoPlayGlobal)},turnOnNarration:function(event){if(event)event.preventDefault();Adapt$1.trigger("audio:updateAudioStatus",0,1);Adapt$1.audio.autoPlayGlobal=true;Adapt$1.trigger("audio:updateAudioAutoplayGlobal",Adapt$1.audio.autoPlayGlobal)},turnOffNarration:function(event){Adapt$1.trigger("audio:updateAudioStatus",0,0);Adapt$1.trigger("audio:updateAudioStatus",1,0);Adapt$1.trigger("audio:updateAudioStatus",2,0)},toggleEffects:function(event){if(event)event.preventDefault();if(this.numChannels==1){this.toggleAll(Adapt$1.audio.audioClip[1].status)}else{if(Adapt$1.audio.audioClip[1].status==0){Adapt$1.trigger("audio:updateAudioStatus",1,1)}else{Adapt$1.trigger("audio:updateAudioStatus",1,0)}this.checkEffects()}},toggleMusic:function(event){if(event)event.preventDefault();if(this.numChannels==1){this.toggleAll(Adapt$1.audio.audioClip[2].status)}else{if(Adapt$1.audio.audioClip[2].status==0){Adapt$1.trigger("audio:updateAudioStatus",2,1)}else{Adapt$1.trigger("audio:updateAudioStatus",2,0)}this.checkMusic()}},toggleAll:function(status){if(status==0){Adapt$1.trigger("audio:updateAudioStatus",0,1);Adapt$1.trigger("audio:updateAudioStatus",1,1);Adapt$1.trigger("audio:updateAudioStatus",2,1)}else{Adapt$1.trigger("audio:updateAudioStatus",0,0);Adapt$1.trigger("audio:updateAudioStatus",1,0);Adapt$1.trigger("audio:updateAudioStatus",2,0)}this.checkNarration();this.checkEffects();this.checkMusic()},checkTextSize:function(){if(Adapt$1.audio.textSize==0){this.$(".text-description").html(Adapt$1.course.get("_audio")._reducedText.descriptionFull);this.$(".full-button").hide();this.$(".reduced-button").show()}else{this.$(".text-description").html(Adapt$1.course.get("_audio")._reducedText.descriptionReduced);this.$(".reduced-button").hide();this.$(".full-button").show()}},checkNarration:function(){},checkEffects:function(){if(Adapt$1.audio.audioClip[1].status==1){this.$(".effects-description").html(Adapt$1.course.get("_audio")._channels._effects.descriptionOn);this.$(".item-effects").attr("src","./assets/volume-normal.svg");this.$(".item-effects").attr("aria-label",$.a11y_normalize(Adapt$1.audio.stopAriaLabel))}else{this.$(".effects-description").html(Adapt$1.course.get("_audio")._channels._effects.descriptionOff);this.$(".item-effects").attr("src","./assets/volume-mute.svg");this.$(".item-effects").attr("aria-label",$.a11y_normalize(Adapt$1.audio.playAriaLabel))}},checkMusic:function(){if(Adapt$1.audio.audioClip[2].status==1){this.$(".music-description").html(Adapt$1.course.get("_audio")._channels._music.descriptionOn);this.$(".item-music").attr("src","./assets/volume-normal.svg");this.$(".item-music").attr("aria-label",$.a11y_normalize(Adapt$1.audio.stopAriaLabel))}else{this.$(".music-description").html(Adapt$1.course.get("_audio")._channels._music.descriptionOff);this.$(".item-music").attr("src","./assets/volume-mute.svg");this.$(".item-music").attr("aria-label",$.a11y_normalize(Adapt$1.audio.playAriaLabel))}},setFullText:function(event){if(event)event.preventDefault();Adapt$1.trigger("audio:changeText",0);this.checkTextSize()},setReducedText:function(event){if(event)event.preventDefault();Adapt$1.trigger("audio:changeText",1);this.checkTextSize()}});var AudioDrawerView$1=__AMD("extensions/adapt-audio/js/audio-drawer-view",AudioDrawerView);var AudioMenuView=Backbone.View.extend({className:"audio-controls",initialize:function(){this.listenTo(Adapt$1,{remove:this.remove,"audio:configured":this.audioConfigured,"popup:opened notify:opened":this.popupOpened,"popup:closed":this.popupClosed,"audio:updateAudioStatus":this.updateToggle,"audio:updateAudioAutoplayGlobal":this.updateAutoplay});this.listenToOnce(Adapt$1,"remove",this.removeInViewListeners);this.updateAutoplay();this.render()},events:{"click .audio-toggle":"toggleAudio"},render:function(){var data=this.model.toJSON();var template=Handlebars.templates["audioMenu"];if(this.model.get("_audio")._location=="bottom-left"||this.model.get("_audio")._location=="bottom-right"){$(this.el).html(template(data)).appendTo(".menu")}else{$(this.el).html(template(data)).prependTo(".menu")}this.audioChannel=this.model.get("_audio")._channel;this.elementId=this.model.get("_id");this.audioFile=this.model.get("_audio")._media.src;Adapt$1.audio.audioClip[this.audioChannel].newID=this.elementId;this.audioIcon=Adapt$1.audio.iconPlay;this.pausedTime="";Adapt$1.audio.audioClip[this.audioChannel].onscreenID="";this.popupIsOpen=false;this.onscreenTriggered=false;if(Adapt$1.audio.autoPlayGlobal||this.model.get("_audio")._autoplay){this.canAutoplay=true}else{this.canAutoplay=false}if(this.model.get("_audio")._autoPlayOnce){this.autoplayOnce=true}else{this.autoplayOnce=false}this.$(".audio-toggle").addClass(this.audioIcon);if(this.model.get("_audio")._showControls==false||Adapt$1.audio.audioClip[this.audioChannel].status==0){this.$(".audio-inner button").hide()}$(Adapt$1.audio.audioClip[this.audioChannel]).on("ended",_.bind(this.onAudioEnded,this));if(!this.model.has("_canReplayAudio")){this.model.set("_canReplayAudio",true)}if(!Adapt$1.audio.isConfigured)return;_.delay(_.bind((function(){this.autoplayAudio()}),this),1e3)},onAudioEnded:function(){Adapt$1.trigger("audio:audioEnded",this.audioChannel)},popupOpened:function(){this.popupIsOpen=true},popupClosed:function(){this.popupIsOpen=false;if(this.onscreenTriggered)return;this.autoplayAudio()},toggleAudio:function(event){if(event)event.preventDefault();Adapt$1.audio.audioClip[this.audioChannel].onscreenID="";if($(event.currentTarget).hasClass("playing")){this.pauseAudio()}else{this.playAudio()}},updateAutoplay:function(AutoplayGlobal){this.canAutoplay=Adapt$1.audio.autoPlayGlobal},autoplayAudio:function(){if(this.popupIsOpen)return;if(this.canAutoplay&&this.model.get("_canReplayAudio")){if(Adapt$1.audio.audioClip[this.audioChannel].status==1){Adapt$1.trigger("audio:playAudio",this.audioFile,this.elementId,this.audioChannel)}if(this.autoplayOnce){this.model.set("_canReplayAudio",false)}this.onscreenTriggered=true}},playAudio:function(){Adapt$1.trigger("media:stop");Adapt$1.audio.audioClip[this.audioChannel].pause();if(Adapt$1.audio.audioClip[this.audioChannel].playingID){$("#"+Adapt$1.audio.audioClip[this.audioChannel].playingID).removeClass(Adapt$1.audio.iconPause);$("#"+Adapt$1.audio.audioClip[this.audioChannel].playingID).addClass(Adapt$1.audio.iconPlay);$("#"+Adapt$1.audio.audioClip[this.audioChannel].playingID).removeClass("playing")}this.$(".audio-toggle").removeClass(Adapt$1.audio.iconPlay);this.$(".audio-toggle").addClass(Adapt$1.audio.iconPause);this.$(".audio-toggle").addClass("playing");Adapt$1.audio.audioClip[this.audioChannel].prevID=Adapt$1.audio.audioClip[this.audioChannel].playingID;Adapt$1.audio.audioClip[this.audioChannel].src=this.audioFile;Adapt$1.audio.audioClip[this.audioChannel].newID=this.elementId;if(Adapt$1.audio.pauseStopAction=="pause"){Adapt$1.audio.audioClip[this.audioChannel].play(this.pausedTime);this.$(".audio-toggle").attr("aria-label",$.a11y_normalize(Adapt$1.audio.pauseAriaLabel))}else{Adapt$1.audio.audioClip[this.audioChannel].play();this.$(".audio-toggle").attr("aria-label",$.a11y_normalize(Adapt$1.audio.stopAriaLabel))}Adapt$1.audio.audioClip[this.audioChannel].onscreenID=this.elementId;Adapt$1.audio.audioClip[this.audioChannel].playingID=Adapt$1.audio.audioClip[this.audioChannel].newID;Adapt$1.audio.audioClip[this.audioChannel].isPlaying=true},pauseAudio:function(){if(Adapt$1.audio.pauseStopAction=="pause"){this.pausedTime=Adapt$1.audio.audioClip[this.audioChannel].currentTime;Adapt$1.audio.audioClip[this.audioChannel].pause();this.$(".audio-toggle").removeClass(Adapt$1.audio.iconPause);this.$(".audio-toggle").addClass(Adapt$1.audio.iconPlay);this.$(".audio-toggle").removeClass("playing")}else{Adapt$1.trigger("audio:pauseAudio",this.audioChannel)}this.$(".audio-toggle").attr("aria-label",$.a11y_normalize(Adapt$1.audio.playAriaLabel))},updateToggle:function(){if(Adapt$1.audio.audioClip[this.audioChannel].status==1&&this.model.get("_audio")._showControls==true){this.$(".audio-toggle").removeClass("hidden")}else{this.$(".audio-toggle").addClass("hidden")}},audioConfigured:function(){this.autoplayAudio()},removeInViewListeners:function(){Adapt$1.trigger("audio:pauseAudio",this.audioChannel)}});var AudioMenuView$1=__AMD("extensions/adapt-audio/js/audio-menu-view",AudioMenuView);var AudioMenuItemsView=Backbone.View.extend({className:"audio-controls",initialize:function(){this.listenTo(Adapt$1,{remove:this.remove,"audio:configured":this.audioConfigured,"popup:opened notify:opened":this.popupOpened,"popup:closed":this.popupClosed,"audio:updateAudioStatus":this.updateToggle,"audio:updateAudioAutoplayGlobal":this.updateAutoplay});this.listenToOnce(Adapt$1,"remove",this.removeInViewListeners);this.updateAutoplay();this.render()},events:{"click .audio-toggle":"toggleAudio"},render:function(){var data=this.model.toJSON();var template=Handlebars.templates["audioMenuItemsView"];if(this.model.get("_audio")._location=="top-left"||this.model.get("_audio")._location=="bottom-right"){$(this.el).html(template(data)).appendTo(`.menu-item-${this.model.get("_id")}`)}else{$(this.el).html(template(data)).prependTo(`.menu-item-${this.model.get("_id")}`)}this.audioChannel=this.model.get("_audio")._channel;this.elementId=this.model.get("_id");this.audioFile=this.model.get("_audio")._media.desktop;Adapt$1.audio.audioClip[this.audioChannel].newID=this.elementId;this.audioIcon=Adapt$1.audio.iconPlay;this.pausedTime="";Adapt$1.audio.audioClip[this.audioChannel].onscreenID="";this.popupIsOpen=false;this.onscreenTriggered=false;if(Adapt$1.audio.autoPlayGlobal||this.model.get("_audio")._autoplay){this.canAutoplay=true}else{this.canAutoplay=false}if(this.model.get("_audio")._autoPlayOnce){this.autoplayOnce=true}else{this.autoplayOnce=false}this.$(".audio-toggle").addClass(this.audioIcon);if(this.model.get("_audio")._showControls==false||Adapt$1.audio.audioClip[this.audioChannel].status==0){this.$(".audio-inner button").hide()}$(Adapt$1.audio.audioClip[this.audioChannel]).on("ended",_.bind(this.onAudioEnded,this));if(!this.model.has("_canReplayAudio")){this.model.set("_canReplayAudio",true)}if(!Adapt$1.audio.isConfigured)return;_.delay(_.bind((function(){this.autoplayAudio()}),this),1e3)},onAudioEnded:function(){Adapt$1.trigger("audio:audioEnded",this.audioChannel)},popupOpened:function(){this.popupIsOpen=true},popupClosed:function(){this.popupIsOpen=false;if(this.onscreenTriggered)return;this.autoplayAudio()},toggleAudio:function(event){if(event)event.preventDefault();Adapt$1.audio.audioClip[this.audioChannel].onscreenID="";if($(event.currentTarget).hasClass("playing")){this.pauseAudio()}else{this.playAudio()}},updateAutoplay:function(AutoplayGlobal){this.canAutoplay=Adapt$1.audio.autoPlayGlobal},autoplayAudio:function(){if(this.popupIsOpen)return;if(this.canAutoplay&&this.model.get("_canReplayAudio")){if(Adapt$1.audio.audioClip[this.audioChannel].status==1){Adapt$1.trigger("audio:playAudio",this.audioFile,this.elementId,this.audioChannel)}if(this.autoplayOnce){this.model.set("_canReplayAudio",false)}this.onscreenTriggered=true}},playAudio:function(){Adapt$1.trigger("media:stop");Adapt$1.audio.audioClip[this.audioChannel].pause();if(Adapt$1.audio.audioClip[this.audioChannel].playingID){$("#"+Adapt$1.audio.audioClip[this.audioChannel].playingID).removeClass(Adapt$1.audio.iconPause);$("#"+Adapt$1.audio.audioClip[this.audioChannel].playingID).addClass(Adapt$1.audio.iconPlay);$("#"+Adapt$1.audio.audioClip[this.audioChannel].playingID).removeClass("playing")}this.$(".audio-toggle").removeClass(Adapt$1.audio.iconPlay);this.$(".audio-toggle").addClass(Adapt$1.audio.iconPause);this.$(".audio-toggle").addClass("playing");Adapt$1.audio.audioClip[this.audioChannel].prevID=Adapt$1.audio.audioClip[this.audioChannel].playingID;Adapt$1.audio.audioClip[this.audioChannel].src=this.audioFile;Adapt$1.audio.audioClip[this.audioChannel].newID=this.elementId;if(Adapt$1.audio.pauseStopAction=="pause"){Adapt$1.audio.audioClip[this.audioChannel].play(this.pausedTime);this.$(".audio-toggle").attr("aria-label",$.a11y_normalize(Adapt$1.audio.pauseAriaLabel))}else{Adapt$1.audio.audioClip[this.audioChannel].play();this.$(".audio-toggle").attr("aria-label",$.a11y_normalize(Adapt$1.audio.stopAriaLabel))}Adapt$1.audio.audioClip[this.audioChannel].onscreenID=this.elementId;Adapt$1.audio.audioClip[this.audioChannel].playingID=Adapt$1.audio.audioClip[this.audioChannel].newID;Adapt$1.audio.audioClip[this.audioChannel].isPlaying=true},pauseAudio:function(){if(Adapt$1.audio.pauseStopAction=="pause"){this.pausedTime=Adapt$1.audio.audioClip[this.audioChannel].currentTime;Adapt$1.audio.audioClip[this.audioChannel].pause();this.$(".audio-toggle").removeClass(Adapt$1.audio.iconPause);this.$(".audio-toggle").addClass(Adapt$1.audio.iconPlay);this.$(".audio-toggle").removeClass("playing")}else{Adapt$1.trigger("audio:pauseAudio",this.audioChannel)}this.$(".audio-toggle").attr("aria-label",$.a11y_normalize(Adapt$1.audio.playAriaLabel))},updateToggle:function(){if(Adapt$1.audio.audioClip[this.audioChannel].status==1&&this.model.get("_audio")._showControls==true){this.$(".audio-toggle").removeClass("hidden")}else{this.$(".audio-toggle").addClass("hidden")}},audioConfigured:function(){this.autoplayAudio()},removeInViewListeners:function(){Adapt$1.trigger("audio:pauseAudio",this.audioChannel)}});var AudioMenuItemsView$1=__AMD("extensions/adapt-audio/js/audio-menu-items-view",AudioMenuItemsView);var AudioFeedbackView=Backbone.View.extend({className:"audio-controls",initialize:function(){this.listenTo(Adapt$1,{remove:this.remove,"device:changed":this.setAudioFile,"audio:updateAudioStatus device:resize":this.updateToggle,"audio:updateAudioAutoplayGlobal":this.updateAutoplay});this.listenToOnce(Adapt$1,"remove",this.removeInViewListeners);if(this.model.get("feedbackAudioData")){this.audioChannel=this.model.get("feedbackAudioData").audioChannel}this.elementId=this.model.get("feedbackAudioData").elementId+"-feedback";this.elementType="feedback";this.audioIcon=Adapt$1.audio.iconPlay;this.pausedTime=0;this.onscreenTriggered=false;this.render()},removeInViewListeners:function(){this.$el.off("onscreen")},events:{"click .audio-toggle":"toggleAudio"},render:function(){var data={};data._location=this.model.get("_audio")._location;data._id=this.model.get("_id")+"-feedback";var template=Handlebars.templates["audioFeedbackControls"];this.$el.html(template(data));this.$(".audio-toggle").addClass(this.audioIcon);var itemElem=$("."+this.model.get("_id")).find(".component__feedback");if(this.model.get("_audio")._feedback._location=="bottom-left"||this.model.get("_audio")._feedback._location=="bottom-right"){itemElem.after(this.$el)}else{itemElem.before(this.$el)}$(this.el).addClass(this.elementType+"-audio");if(Adapt$1.audio.autoPlayGlobal||this.model.get("_audio")._feedback._autoplay){this.canAutoplay=true}else{this.canAutoplay=false}if(Adapt$1.audio.autoPlayOnceGlobal||this.model.get("_audio")._feedback._autoPlayOnce){this.autoplayOnce=true}else{this.autoplayOnce=false}this.canAutoplayWhenOnScreen=this.model.get("_audio")._feedback._autoplayWhenOnScreen;this.setAudioFile();Adapt$1.audio.audioClip[this.audioChannel].newID=this.elementId;$(Adapt$1.audio.audioClip[this.audioChannel]).on("ended",_.bind(this.onAudioEnded,this));_.defer(_.bind((function(){this.postRender()}),this))},onAudioEnded:function(){Adapt$1.trigger("audio:audioEnded",this.audioChannel);this.updateToggle()},postRender:function(){this.setupAudio();this.updateToggle()},setupAudio:function(){_.delay(_.bind((function(){this.popupIsOpen=false;$("."+this.model.get("_id")).find(".component__feedback").on("onscreen",_.bind(this.onscreen,this))}),this),500)},updateAutoplay:function(AutoplayGlobal){this.canAutoplay=Adapt$1.audio.autoPlayGlobal},onscreen:function(event,measurements){if(this.popupIsOpen)return;this.updateAutoplay();var visible=$(event.currentTarget).is(":visible");var isOnscreenX=measurements.percentInviewHorizontal==100;var isOnscreen=measurements.onscreen;var elementTopOnscreenY=measurements.percentFromTop<Adapt$1.audio.triggerPosition&&measurements.percentFromTop>0;var elementBottomOnscreenY=measurements.percentFromTop<Adapt$1.audio.triggerPosition&&measurements.percentFromBottom<100-Adapt$1.audio.triggerPosition;var isOnscreenY=elementTopOnscreenY||elementBottomOnscreenY;if(visible&&isOnscreen&&this.canAutoplay&&(isOnscreenY&&isOnscreenX||this.canAutoplayWhenOnScreen)&&!this.onscreenTriggered&&!this.isAnimating){if(Adapt$1.audio.audioClip[this.audioChannel].status==1){this.setAudioFile();this.playAudio($("#"+this.elementId))}if(this.autoplayOnce){this.canAutoplay=false}this.onscreenTriggered=true}if(this.canAutoplayWhenOnScreen){if(!visible&&!isOnscreen){this.onscreenTriggered=false;Adapt$1.trigger("audio:onscreenOff",this.elementId,this.audioChannel)}}else if(visible&&(!isOnscreenY||!isOnscreenX)){this.onscreenTriggered=false;Adapt$1.trigger("audio:onscreenOff",this.elementId,this.audioChannel)}},setAudioFile:function(){try{this.audioFile=this.model.get("feedbackAudioData").FeedbackAudioFile}catch(e){console.log("An error has occured loading audio")}},toggleAudio:function(event){if(event){event.preventDefault();event.stopPropagation()}this.setAudioFile();Adapt$1.audio.audioClip[this.audioChannel].onscreenID="";if($(event.currentTarget).hasClass("playing")){this.pauseAudio($(event.currentTarget))}else{this.playAudio($(event.currentTarget))}},playAudio:function($target){Adapt$1.trigger("media:stop");Adapt$1.audio.audioClip[this.audioChannel].pause();Adapt$1.audio.audioClip[this.audioChannel].isPlaying=false;if(Adapt$1.audio.audioClip[this.audioChannel].playingID){$("#"+Adapt$1.audio.audioClip[this.audioChannel].playingID).removeClass(Adapt$1.audio.iconPause);$("#"+Adapt$1.audio.audioClip[this.audioChannel].playingID).addClass(Adapt$1.audio.iconPlay);$("#"+Adapt$1.audio.audioClip[this.audioChannel].playingID).removeClass("playing")}$target.removeClass(Adapt$1.audio.iconPlay);$target.addClass(Adapt$1.audio.iconPause);$target.addClass("playing");Adapt$1.audio.audioClip[this.audioChannel].prevID=Adapt$1.audio.audioClip[this.audioChannel].playingID;Adapt$1.audio.audioClip[this.audioChannel].src=this.audioFile;Adapt$1.audio.audioClip[this.audioChannel].newID=this.elementId;if(Adapt$1.audio.pauseStopAction=="pause"){Adapt$1.audio.audioClip[this.audioChannel].play(this.pausedTime);$target.attr("aria-label",$.a11y_normalize(Adapt$1.audio.pauseAriaLabel))}else{Adapt$1.audio.audioClip[this.audioChannel].play();$target.attr("aria-label",$.a11y_normalize(Adapt$1.audio.stopAriaLabel))}Adapt$1.audio.audioClip[this.audioChannel].onscreenID=this.elementId;Adapt$1.audio.audioClip[this.audioChannel].playingID=Adapt$1.audio.audioClip[this.audioChannel].newID;Adapt$1.audio.audioClip[this.audioChannel].isPlaying=true},pauseAudio:function($target){if(Adapt$1.audio.pauseStopAction=="pause"){this.pausedTime=Adapt$1.audio.audioClip[this.audioChannel].currentTime;Adapt$1.audio.audioClip[this.audioChannel].pause();Adapt$1.audio.audioClip[this.audioChannel].isPlaying=false;$target.removeClass(Adapt$1.audio.iconPause);$target.addClass(Adapt$1.audio.iconPlay);$target.removeClass("playing")}else{Adapt$1.trigger("audio:pauseAudio",this.audioChannel)}$target.attr("aria-label",$.a11y_normalize(Adapt$1.audio.playAriaLabel))},updateToggle:function(){if(Adapt$1.audio.audioClip[this.audioChannel].status==1&&this.model.get("_audio")._showControls==true){this.$(".audio-inner button").show();var outerWidth=this.$(".audio-toggle").outerWidth();var elementWidth=$("."+this.model.get("_id")).find(".component__feedback").outerWidth();var padding=outerWidth-this.$(".audio-toggle").width();var maxWidth=elementWidth-outerWidth-padding;if(this.model.get("displayTitle")==""){$("."+this.elementId).find("."+this.elementType+"-body-inner").css("max-width",maxWidth)}else{$("."+this.elementId).find("."+this.elementType+"-title-inner").css("max-width",maxWidth)}}else{this.$(".audio-inner button").hide();$("."+this.elementId).find("."+this.elementType+"-body-inner").css("max-width","");$("."+this.elementId).find("."+this.elementType+"-title-inner").css("max-width","")}}});var AudioFeedbackView$1=__AMD("extensions/adapt-audio/js/audio-feedback-view",AudioFeedbackView);var AudioControlsView=Backbone.View.extend({className:"audio-controls",initialize:function(){this.listenTo(Adapt$1,{remove:this.remove,"device:changed":this.setAudioFile,"questionView:showFeedback":this.initFeedback,"popup:opened notify:opened":this.popupOpened,"popup:closed":this.stopFeedbackAudio,"audio:updateAudioStatus device:resize":this.updateToggle,"audio:configured":this.audioConfigured,"audio:changeText":this.replaceText,"audio:updateAudioAutoplayGlobal":this.updateAutoplay});this.listenToOnce(Adapt$1,"remove",this.removeInViewListeners);this.audioChannel=this.model.get("_audio")._channel;this.elementId=this.model.get("_id");this.elementType=this.model.get("_type");this.audioIcon=Adapt$1.audio.iconPlay;this.pausedTime=0;this.onscreenTriggered=false;this.popupIsOpen=false;this.render()},events:{"click .audio-toggle":"toggleAudio"},render:function(){var data=this.model.toJSON();var template=Handlebars.templates["audioControls"];if(this.model.get("_audio")._location=="bottom-left"||this.model.get("_audio")._location=="bottom-right"){$(this.el).html(template(data)).appendTo("."+this.model.get("_id")+">."+this.elementType+"__inner")}else{$(this.el).html(template(data)).prependTo("."+this.model.get("_id")+">."+this.elementType+"__inner")}$(this.el).addClass(this.elementType+"-audio");var audioFeedbackModel=new Backbone.Model(this.model.get("_audio")._feedback);if(audioFeedbackModel.has("_soundEffect")){this.audioEffectsEnabled=this.model.get("_audio")._feedback._soundEffect._isEnabled;this.audioEffectsChannel=1;this.audioEffectsFile=""}else{this.audioEffectsEnabled=false}if(Adapt$1.audio.autoPlayGlobal||this.model.get("_audio")._autoplay){this.canAutoplay=true}else{this.canAutoplay=false}if(Adapt$1.audio.autoPlayOnceGlobal||this.model.get("_audio")._autoPlayOnce){this.autoplayOnce=true}else{this.autoplayOnce=false}this.$(".audio-toggle").addClass(this.audioIcon);this.setAudioFile();Adapt$1.audio.audioClip[this.audioChannel].newID=this.elementId;$(Adapt$1.audio.audioClip[this.audioChannel]).on("ended",_.bind(this.onAudioEnded,this));_.defer(_.bind((function(){this.postRender()}),this))},updateAutoplay:function(AutoplayGlobal){this.canAutoplay=Adapt$1.audio.autoPlayGlobal},postRender:function(){this.updateToggle();this.replaceText(Adapt$1.audio.textSize);this.isAnimating=$("."+this.elementId).hasClass("animate-hidden");if(this.isAnimating){this.listenTo(this.model,"change:_isAnimating",this.checkOnscreen)}if(!Adapt$1.audio.isConfigured)return;_.delay(_.bind((function(){$("."+this.model.get("_id")).on("onscreen",_.bind(this.onscreen,this))}),this),1e3)},setAudioFile:function(){if(Adapt$1.device.screenSize==="large"){try{this.audioFile=this.model.get("_audio")._media.desktop}catch(e){console.log("An error has occured loading audio")}}else{try{this.audioFile=this.model.get("_audio")._media.desktop}catch(e){console.log("An error has occured loading audio")}}},onAudioEnded:function(){Adapt$1.trigger("audio:audioEnded",this.audioChannel)},popupOpened:function(event){if(typeof event==="object"&&$(event[0]).hasClass("js-hint-widget"))return;this.popupIsOpen=true},audioConfigured:function(){_.delay(_.bind((function(){this.popupIsOpen=false;$("."+this.model.get("_id")).on("onscreen",_.bind(this.onscreen,this))}),this),500)},initFeedback:function(view){if(this.elementId==view.model.get("_id")){if(this.model.get("_audio")._feedback&&this.model.get("_audio")._feedback._isEnabled){this.initQuestionFeedbackAudio()}}},initQuestionFeedbackAudio:function(){Adapt$1.audio.audioClip[this.audioChannel].onscreenID="";if(this.model.get("_isCorrect")){this.setupCorrectFeedback()}else if(this.model.get("_isAtLeastOneCorrectSelection")){this.setupPartlyCorrectFeedback()}else{this.setupIncorrectFeedback()}if(this.FeedbackAudioFile){var data={};data.FeedbackAudioFile=this.FeedbackAudioFile;data.elementId=this.elementId;data.audioChannel=this.audioChannel;this.model.set("feedbackAudioData",data);new AudioFeedbackView$1({model:this.model})}},setupCorrectFeedback:function(){try{this.FeedbackAudioFile=this.model.get("_audio")._feedback._correct._correct}catch(e){console.log("An error has occured loading audio")}if(this.audioEffectsEnabled){this.audioEffectsFile=this.model.get("_audio")._feedback._soundEffect._correct}if(this.model.get("_audio")._reducedTextisEnabled&&Adapt$1.audio.textSize==1){$(".notify").find(".notify-popup-body-inner").html(this.model.get("_audio")._feedback._correct.correctReduced)}},setupPartlyCorrectFeedback:function(){if(this.model.get("_attemptsLeft")===0||!this.model.get("_audio")._feedback._partlyCorrect._notFinal){if(this.model.get("_audio")._feedback._partlyCorrect._final){try{this.FeedbackAudioFile=this.model.get("_audio")._feedback._partlyCorrect._final}catch(e){console.log("An error has occured loading audio")}if(this.audioEffectsEnabled){this.audioEffectsFile=this.model.get("_audio")._feedback._soundEffect._partlyCorrect}if(this.model.get("_audio")._reducedTextisEnabled&&Adapt$1.audio.textSize==1){$(".notify").find(".notify-popup-body-inner").html(this.model.get("_audio")._feedback._partlyCorrect.finalReduced)}}else{this.setupIncorrectFeedback()}}else{try{this.FeedbackAudioFile=this.model.get("_audio")._feedback._partlyCorrect._notFinal}catch(e){console.log("An error has occured loading audio")}if(this.audioEffectsEnabled){this.audioEffectsFile=this.model.get("_audio")._feedback._soundEffect._partlyCorrect}if(this.model.get("_audio")._reducedTextisEnabled&&Adapt$1.audio.textSize==1){$(".notify").find(".notify-popup-body-inner").html(this.model.get("_audio")._feedback._partlyCorrect.notFinalReduced)}}},setupIncorrectFeedback:function(){var items=this.model.get("_audio")._feedback._items?this.model.get("_audio")._feedback._items:[];if(this.model.get("_selectable")===1&&items.length>0){this.setupIndividualFeedbackAudio()}else{if(this.model.get("_attemptsLeft")===0){try{this.FeedbackAudioFile=this.model.get("_audio")._feedback._incorrect._final}catch(e){console.log("An error has occured loading audio")}if(this.model.get("_audio")._reducedTextisEnabled&&Adapt$1.audio.textSize==1){$(".notify").find(".notify-popup-body-inner").html(this.model.get("_audio")._feedback._incorrect.finalReduced)}}else{try{this.FeedbackAudioFile=this.model.get("_audio")._feedback._incorrect._notFinal}catch(e){console.log("An error has occured loading audio")}if(this.model.get("_audio")._reducedTextisEnabled&&Adapt$1.audio.textSize==1){$(".notify").find(".notify-popup-body-inner").html(this.model.get("_audio")._feedback._incorrect.notFinalReduced)}}}if(this.audioEffectsEnabled){this.audioEffectsFile=this.model.get("_audio")._feedback._soundEffect._incorrect}},setupIndividualFeedbackAudio:function(item){var activeItem=this.getActiveItem();var index=activeItem.get("_index");var itemArray=this.model.get("_audio")._feedback._items;this.FeedbackAudioFile=itemArray[index]._src},getActiveItem:function(){return this.model.get("_children").findWhere({_isActive:true})},stopFeedbackAudio:function(){this.popupIsOpen=false;if(!this.model.get("_audio"))return;if(this.model.get("_audio")._feedback&&this.model.get("_audio")._feedback._isEnabled){Adapt$1.trigger("audio:pauseAudio",this.audioChannel);if(this.audioEffectsEnabled){Adapt$1.trigger("audio:pauseAudio",this.audioEffectsChannel)}}},onscreen:function(event,measurements){if(this.popupIsOpen)return;this.updateAutoplay();var visible=this.model.get("_isVisible");var isOnscreenX=measurements.percentInviewHorizontal==100;var isOnscreen=measurements.onscreen;var elementTopOnscreenY=measurements.percentFromTop<Adapt$1.audio.triggerPosition&&measurements.percentFromTop>0;var elementBottomOnscreenY=measurements.percentFromTop<Adapt$1.audio.triggerPosition&&measurements.percentFromBottom<100-Adapt$1.audio.triggerPosition;var isOnscreenY=elementTopOnscreenY||elementBottomOnscreenY;if(visible&&isOnscreen&&isOnscreenY&&isOnscreenX&&this.canAutoplay&&!this.onscreenTriggered&&!this.isAnimating){if(Adapt$1.audio.audioClip[this.audioChannel].status==1){this.setAudioFile();if(this.elementType==="component"&&!this.model.get("_isQuestionType")&&this.model.get("_children")&&this.model.get("_children").length){var itemIndex=this.getActiveItemIndex();var currentItem=this.model.get("_items")[itemIndex];if(this.model.get("_component")=="tiles"&&itemIndex!=null){if(itemIndex==0||itemIndex>0){this.audioFile=currentItem._audio.src?currentItem._audio.src:currentItem._audio._src}}else{if(itemIndex>0){this.audioFile=currentItem._audio.src?currentItem._audio.src:currentItem._audio._src}}}Adapt$1.trigger("audio:playAudio",this.audioFile,this.elementId,this.audioChannel)}if(this.autoplayOnce){this.canAutoplay=false}this.onscreenTriggered=true}if(visible&&(!isOnscreenY||!isOnscreenX)){this.onscreenTriggered=false;Adapt$1.trigger("audio:onscreenOff",this.elementId,this.audioChannel)}},checkOnscreen:function(){this.isAnimating=this.model.get("_isAnimating");$("."+this.model.get("_id")).on("onscreen",_.bind(this.onscreen,this))},toggleAudio:function(event){if(event)event.preventDefault();this.setAudioFile();Adapt$1.audio.audioClip[this.audioChannel].onscreenID="";if($(event.currentTarget).hasClass("playing")){this.pauseAudio()}else{this.playAudio()}},playAudio:function(){Adapt$1.trigger("media:stop");Adapt$1.audio.audioClip[this.audioChannel].pause();Adapt$1.audio.audioClip[this.audioChannel].isPlaying=false;if(Adapt$1.audio.audioClip[this.audioChannel].playingID){$("#"+Adapt$1.audio.audioClip[this.audioChannel].playingID).removeClass(Adapt$1.audio.iconPause);$("#"+Adapt$1.audio.audioClip[this.audioChannel].playingID).addClass(Adapt$1.audio.iconPlay);$("#"+Adapt$1.audio.audioClip[this.audioChannel].playingID).removeClass("playing")}this.$(".audio-toggle").removeClass(Adapt$1.audio.iconPlay);this.$(".audio-toggle").addClass(Adapt$1.audio.iconPause);this.$(".audio-toggle").addClass("playing");Adapt$1.audio.audioClip[this.audioChannel].prevID=Adapt$1.audio.audioClip[this.audioChannel].playingID;Adapt$1.audio.audioClip[this.audioChannel].src=this.audioFile;if(this.elementType==="component"&&!this.model.get("_isQuestionType")&&this.model.get("_children")&&this.model.get("_children").length){var itemIndex=this.getActiveItemIndex();var currentItem=this.model.get("_items")[itemIndex];if(this.model.get("_component")=="tiles"&&itemIndex!=null){if(itemIndex==0||itemIndex>0){Adapt$1.audio.audioClip[this.audioChannel].src=currentItem._audio.src?currentItem._audio.src:currentItem._audio._src}}else{if(itemIndex>0){Adapt$1.audio.audioClip[this.audioChannel].src=currentItem._audio.src?currentItem._audio.src:currentItem._audio._src}}}Adapt$1.audio.audioClip[this.audioChannel].newID=this.elementId;if(Adapt$1.audio.pauseStopAction=="pause"){Adapt$1.audio.audioClip[this.audioChannel].play(this.pausedTime);this.$(".audio-toggle").attr("aria-label",$.a11y_normalize(Adapt$1.audio.pauseAriaLabel))}else{Adapt$1.audio.audioClip[this.audioChannel].play();this.$(".audio-toggle").attr("aria-label",$.a11y_normalize(Adapt$1.audio.stopAriaLabel))}Adapt$1.audio.audioClip[this.audioChannel].onscreenID=this.elementId;Adapt$1.audio.audioClip[this.audioChannel].playingID=Adapt$1.audio.audioClip[this.audioChannel].newID;Adapt$1.audio.audioClip[this.audioChannel].isPlaying=true},pauseAudio:function(){if(Adapt$1.audio.pauseStopAction=="pause"){this.pausedTime=Adapt$1.audio.audioClip[this.audioChannel].currentTime;Adapt$1.audio.audioClip[this.audioChannel].pause();Adapt$1.audio.audioClip[this.audioChannel].isPlaying=false;this.$(".audio-toggle").removeClass(Adapt$1.audio.iconPause);this.$(".audio-toggle").addClass(Adapt$1.audio.iconPlay);this.$(".audio-toggle").removeClass("playing")}else{Adapt$1.trigger("audio:pauseAudio",this.audioChannel)}this.$(".audio-toggle").attr("aria-label",$.a11y_normalize(Adapt$1.audio.playAriaLabel))},updateToggle:function(){if(Adapt$1.audio.audioClip[this.audioChannel].status==1&&this.model.get("_audio")._showControls==true){this.$(".audio-inner button").show();var outerWidth=this.$(".audio-toggle").outerWidth();var elementWidth=$("."+this.elementId).find("."+this.elementType+"-header").outerWidth();var padding=outerWidth-this.$(".audio-toggle").width();var maxWidth=elementWidth-outerWidth-padding;if(this.model.get("displayTitle")==""){$("."+this.elementId).find("."+this.elementType+"-body-inner").css("max-width",maxWidth)}else{$("."+this.elementId).find("."+this.elementType+"-title-inner").css("max-width",maxWidth)}}else{this.$(".audio-inner button").hide();$("."+this.elementId).find("."+this.elementType+"-body-inner").css("max-width","");$("."+this.elementId).find("."+this.elementType+"-title-inner").css("max-width","")}},getActiveItemIndex:function(){var activeItem=this.model.get("_children").findWhere({_isActive:true});if(activeItem){var index=activeItem.get("_index");return index}else{return null}},removeInViewListeners:function(){$("."+this.model.get("_id")).off("onscreen")},replaceText:function(value){if(Adapt$1.course.get("_audio")&&Adapt$1.course.get("_audio")._reducedTextisEnabled&&this.model.get("_audio")&&this.model.get("_audio")._reducedTextisEnabled){if(this.elementType=="article"){if(value==0){$("."+this.model.get("_id")).find(".article-title-inner").html(this.stringReplace(this.model.get("displayTitle")));$("."+this.model.get("_id")).find(".article-body-inner").html(this.stringReplace(this.model.get("body")))}else{$("."+this.model.get("_id")).find(".article-title-inner").html(this.stringReplace(this.model.get("_audio").displayTitleReduced));$("."+this.model.get("_id")).find(".article-body-inner").html(this.stringReplace(this.model.get("_audio").bodyReduced))}}if(this.elementType=="block"){if(value==0){$("."+this.model.get("_id")).find(".block-title-inner").html(this.stringReplace(this.model.get("displayTitle")));$("."+this.model.get("_id")).find(".block-body-inner").html(this.stringReplace(this.model.get("body")))}else{$("."+this.model.get("_id")).find(".block-title-inner").html(this.stringReplace(this.model.get("_audio").displayTitleReduced));$("."+this.model.get("_id")).find(".block-body-inner").html(this.stringReplace(this.model.get("_audio").bodyReduced))}}if(this.elementType=="component"){if(value==0){$("."+this.model.get("_id")).find(".component-title-inner").html(this.stringReplace(this.model.get("displayTitle")));$("."+this.model.get("_id")).find(".component-body-inner").html(this.stringReplace(this.model.get("body")))}else{$("."+this.model.get("_id")).find(".component-title-inner").html(this.stringReplace(this.model.get("_audio").displayTitleReduced));$("."+this.model.get("_id")).find(".component-body-inner").html(this.stringReplace(this.model.get("_audio").bodyReduced))}}}},stringReplace:function(text){if(!Adapt$1.course.get("_globals")._learnerInfo)return text;var newText=text.replace(/{{_globals._learnerInfo.name}}/g,Adapt$1.course.get("_globals")._learnerInfo.name);newText=newText.replace(/{{_globals._learnerInfo.firstname}}/g,Adapt$1.course.get("_globals")._learnerInfo.firstname);newText=newText.replace(/{{_globals._learnerInfo.lastname}}/g,Adapt$1.course.get("_globals")._learnerInfo.lastname);return newText}});var AudioControlsView$1=__AMD("extensions/adapt-audio/js/audio-controls-view",AudioControlsView);var AudioResultsView=Backbone.View.extend({className:"audio-controls",initialize:function(){this.listenTo(Adapt$1,{remove:this.remove,"audio:updateAudioStatus":this.updateToggle});this.listenToOnce(Adapt$1,"remove",this.removeInViewListeners);this.render()},render:function(){var data=this.model.toJSON();var template=Handlebars.templates["audioResults"];if(this.model.get("_audioAssessment")._location=="bottom-left"||this.model.get("_audioAssessment")._location=="bottom-right"){$(this.el).html(template(data)).appendTo("."+this.model.get("_id")+" > ."+this.model.get("_type")+"-inner")}else{$(this.el).html(template(data)).prependTo("."+this.model.get("_id")+" > ."+this.model.get("_type")+"-inner")}$(this.el).addClass(this.model.get("_type")+"-audio");this.audioChannel=this.model.get("_audioAssessment")._channel;this.elementId=this.model.get("_id");this.audioIcon=Adapt$1.audio.iconPlay;this.$(".audio-toggle").addClass(this.audioIcon);if(this.model.get("_audioAssessment")._showControls==false||Adapt$1.audio.audioClip[this.audioChannel].status==0){this.$(".audio-inner button").hide()}Adapt$1.audio.audioClip[this.audioChannel].newID=this.elementId;$(Adapt$1.audio.audioClip[this.audioChannel]).on("ended",_.bind(this.onAudioEnded,this))},onAudioEnded:function(){Adapt$1.trigger("audio:audioEnded",this.audioChannel)},updateToggle:function(){if(Adapt$1.audio.audioClip[this.audioChannel].status==1&&this.model.get("_audioAssessment")._showControls==true){this.$(".audio-inner button").show()}else{this.$(".audio-inner button").hide()}},removeInViewListeners:function(){Adapt$1.trigger("audio:pauseAudio",this.audioChannel)}});var AudioResultsView$1=__AMD("extensions/adapt-audio/js/audio-results-view",AudioResultsView);var AudioItemControlsView=Backbone.View.extend({className:"audio-controls",initialize:function(){this.listenTo(Adapt$1,{remove:this.remove,"device:changed":this.setAudioFile,"audio:updateAudioStatus device:resize":this.updateToggle,"audio:updateAudioAutoplayGlobal":this.updateAutoplay});this.listenToOnce(Adapt$1,"remove",this.removeInViewListeners);if(this.model.get("_audio")){this.audioChannel=this.model.get("_audio")._channel}this.elementId=this.model.get("_id");this.elementType=this.model.get("_type");this.audioIcon=Adapt$1.audio.iconPlay;this.pausedTime=0;this.onscreenTriggered=false;this.render()},removeInViewListeners:function(){this.$el.off("onscreen")},events:{"click .audio-toggle":"toggleAudio"},playItemAudio:function(id){if(this.model.get("_id")==id){if(this.canAutoplay){this.playAudio($("#"+this.model.get("_id")))}}},render:function(){this.setupAudio();var data=this.model.toJSON();var template=Handlebars.templates["audioControls"];this.$el.html(template(data));this.$(".audio-toggle").addClass(this.audioIcon);var itemElem=this.model.get("itemElement");if(itemElem.find(".item-audio-container").hasClass("audio-rendered"))return;if(this.model.get("_audio")._location=="bottom-left"||this.model.get("_audio")._location=="bottom-right"){itemElem.find(".item-audio-container").addClass("audio-rendered").append(this.$el)}else{itemElem.find(".item-audio-container").addClass("audio-rendered").prepend(this.$el)}$(this.el).addClass(this.elementType+"-audio");if(Adapt$1.audio.autoPlayGlobal){this.canAutoplay=true}else{this.canAutoplay=false}if(Adapt$1.audio.autoPlayOnceGlobal||this.model.get("_audio")._autoPlayOnce){this.autoplayOnce=true}else{this.autoplayOnce=false}if(this.model.get("_audio")._autoplay){this.canAutoplay=true}else{this.canAutoplay=false}this.canAutoplayWhenOnScreen=this.model.get("_audio")._autoplayWhenOnScreen;this.setAudioFile();_.defer(_.bind((function(){this.postRender()}),this))},postRender:function(){this.updateToggle()},setupAudio:function(){this.popupIsOpen=false;this.$el.on("onscreen",_.bind(this.onscreen,this))},updateAutoplay:function(AutoplayGlobal){if(this.model.get("_audio")._autoplay){this.canAutoplay=Adapt$1.audio.autoPlayGlobal}},onscreen:function(event,measurements){if(this.popupIsOpen)return;this.updateAutoplay();var visible=$(event.currentTarget).is(":visible");var isOnscreenX=measurements.percentInviewHorizontal==100;var isOnscreen=measurements.onscreen;var elementTopOnscreenY=measurements.percentFromTop<Adapt$1.audio.triggerPosition&&measurements.percentFromTop>0;var elementBottomOnscreenY=measurements.percentFromTop<Adapt$1.audio.triggerPosition&&measurements.percentFromBottom<100-Adapt$1.audio.triggerPosition;var isOnscreenY=elementTopOnscreenY||elementBottomOnscreenY;if(visible&&(isOnscreen||this.canAutoplayWhenOnScreen)&&this.canAutoplay&&isOnscreenY&&isOnscreenX&&!this.onscreenTriggered&&!this.isAnimating){if(Adapt$1.audio.audioClip[this.audioChannel].status==1){this.setAudioFile();if(this.elementType==="component"&&!this.model.get("_isQuestionType")&&this.model.get("_children")&&this.model.get("_children").length){var itemIndex=this.getActiveItemIndex();var currentItem=this.model.get("_items")[itemIndex];if(this.model.get("_component")=="tiles"&&itemIndex!=null){if(itemIndex==0||itemIndex>0){this.audioFile=currentItem._audio.src?currentItem._audio.src:currentItem._audio._src}}else{if(itemIndex>0){this.audioFile=currentItem._audio.src?currentItem._audio.src:currentItem._audio._src}}}this.playAudio($("#"+this.elementId))}if(this.autoplayOnce){this.canAutoplay=false}this.onscreenTriggered=true}if(this.canAutoplayWhenOnScreen){if(!visible&&!isOnscreen&&this.onscreenTriggered){this.onscreenTriggered=false;Adapt$1.trigger("audio:onscreenOff",this.elementId,this.audioChannel)}}else if(visible&&(!isOnscreenY||!isOnscreenX)){this.onscreenTriggered=false;Adapt$1.trigger("audio:onscreenOff",this.elementId,this.audioChannel)}},setAudioFile:function(){if(Adapt$1.device.screenSize==="large"){try{this.audioFile=this.model.get("_audio")._media.desktop}catch(e){console.log("An error has occured loading audio")}}else{try{this.audioFile=this.model.get("_audio")._media.desktop}catch(e){console.log("An error has occured loading audio")}}},toggleAudio:function(event){if(event){event.preventDefault();event.stopPropagation()}this.setAudioFile();Adapt$1.audio.audioClip[this.audioChannel].onscreenID="";if($(event.currentTarget).hasClass("playing")){this.pauseAudio($(event.currentTarget))}else{this.playAudio($(event.currentTarget))}},playAudio:function($target){Adapt$1.trigger("media:stop");Adapt$1.audio.audioClip[this.audioChannel].pause();Adapt$1.audio.audioClip[this.audioChannel].isPlaying=false;if(Adapt$1.audio.audioClip[this.audioChannel].playingID){$("#"+Adapt$1.audio.audioClip[this.audioChannel].playingID).removeClass(Adapt$1.audio.iconPause);$("#"+Adapt$1.audio.audioClip[this.audioChannel].playingID).addClass(Adapt$1.audio.iconPlay);$("#"+Adapt$1.audio.audioClip[this.audioChannel].playingID).removeClass("playing")}$target.removeClass(Adapt$1.audio.iconPlay);$target.addClass(Adapt$1.audio.iconPause);$target.addClass("playing");Adapt$1.audio.audioClip[this.audioChannel].prevID=Adapt$1.audio.audioClip[this.audioChannel].playingID;Adapt$1.audio.audioClip[this.audioChannel].src=this.audioFile;if(this.elementType==="component"&&!this.model.get("_isQuestionType")&&this.model.get("_children")&&this.model.get("_children").length){var itemIndex=this.getActiveItemIndex();var currentItem=this.model.get("_items")[itemIndex];if(this.model.get("_component")=="tiles"&&itemIndex!=null){if(itemIndex==0||itemIndex>0){Adapt$1.audio.audioClip[this.audioChannel].src=currentItem._audio.src?currentItem._audio.src:currentItem._audio._src}}else{if(itemIndex>0){Adapt$1.audio.audioClip[this.audioChannel].src=currentItem._audio.src?currentItem._audio.src:currentItem._audio._src}}}Adapt$1.audio.audioClip[this.audioChannel].newID=this.elementId;if(Adapt$1.audio.pauseStopAction=="pause"){Adapt$1.audio.audioClip[this.audioChannel].play(this.pausedTime);$target.attr("aria-label",$.a11y_normalize(Adapt$1.audio.pauseAriaLabel))}else{Adapt$1.audio.audioClip[this.audioChannel].play();$target.attr("aria-label",$.a11y_normalize(Adapt$1.audio.stopAriaLabel))}Adapt$1.audio.audioClip[this.audioChannel].onscreenID=this.elementId;Adapt$1.audio.audioClip[this.audioChannel].playingID=Adapt$1.audio.audioClip[this.audioChannel].newID;Adapt$1.audio.audioClip[this.audioChannel].isPlaying=true},pauseAudio:function($target){if(Adapt$1.audio.pauseStopAction=="pause"){this.pausedTime=Adapt$1.audio.audioClip[this.audioChannel].currentTime;Adapt$1.audio.audioClip[this.audioChannel].pause();Adapt$1.audio.audioClip[this.audioChannel].isPlaying=false;$target.removeClass(Adapt$1.audio.iconPause);$target.addClass(Adapt$1.audio.iconPlay);$target.removeClass("playing")}else{Adapt$1.trigger("audio:pauseAudio",this.audioChannel)}$target.attr("aria-label",$.a11y_normalize(Adapt$1.audio.playAriaLabel))},updateToggle:function(){if(Adapt$1.audio.audioClip[this.audioChannel].status==1&&this.model.get("_audio")._showControls==true){this.$(".audio-inner button").show();this.listenTo(Adapt$1,"audio:itemControl",this.playItemAudio);var outerWidth=this.$(".audio-toggle").outerWidth();var elementWidth=this.model.get("itemElement").outerWidth();var padding=outerWidth-this.$(".audio-toggle").width();var maxWidth=elementWidth-outerWidth-padding;if(this.model.get("displayTitle")==""){$("."+this.elementId).find("."+this.elementType+"-body-inner").css("max-width",maxWidth)}else{$("."+this.elementId).find("."+this.elementType+"-title-inner").css("max-width",maxWidth)}}else{this.$(".audio-inner button").hide();this.stopListening(Adapt$1,"audio:itemControl");$("."+this.elementId).find("."+this.elementType+"-body-inner").css("max-width","");$("."+this.elementId).find("."+this.elementType+"-title-inner").css("max-width","")}}});var AudioItemControlsView$1=__AMD("extensions/adapt-audio/js/audio-itemControls-view",AudioItemControlsView);var AudioController=_.extend({initialize:function(){this.listenToOnce(Adapt$1,"app:dataReady",this.onDataReady)},onDataReady:function(){this.listenTo(Adapt$1.config,"change:_activeLanguage",this.onLangChange);if(Adapt$1.course.get("_audio")&&Adapt$1.course.get("_audio")._isEnabled){this.setupAudio();this.setupEventListeners();this.addAudioDrawerItem()}},setupEventListeners:function(){this.listenToOnce(Adapt$1,"router:location",this.checkLaunch);this.listenTo(Adapt$1,{"navigationView:postRender":this.loadNavigationView,"menuView:postRender":this.onMenuReady,"articleView:postRender blockView:postRender componentView:postRender":this.onABCReady,"audio:onscreenOff":this.onscreenOff,"audio:playAudio":this.playAudio,"audio:pauseAudio":this.pauseAudio,"audio:audioEnded":this.audioEnded,"audio:updateAudioStatus":this.updateAudioStatus,"audio:showAudioDrawer":this.setupDrawerAudio,"audio:changeText":this.changeText,"notify:closed":this.notifyClosed,"audio:popupOpened":this.popupOpened,"audio:popupClosed":this.popupClosed,"audio:stopNarrationChannel":this.stopNarrationChannel,"audio:stopEffectsChannel":this.stopEffectsChannel,"audio:stopMusicChannel":this.stopMusicChannel,"audio:stopAllChannels menuView:preRender pageView:preRender":this.stopAllChannels})},setupAudio:function(){if(Adapt$1.course.get("_audio")&&Adapt$1.course.get("_audio")._reducedTextisEnabled){this.reducedTextEnabled=Adapt$1.course.get("_audio")._reducedTextisEnabled}else{this.reducedTextEnabled=false}Adapt$1.audio={};Adapt$1.audio.audioClip=[];Adapt$1.audio.isConfigured=false;Adapt$1.audio.promptView=null;Adapt$1.audio.promptIsOpen=false;Adapt$1.audio.externalPromptIsOpen=false;Adapt$1.audio.textSize=0;Adapt$1.audio.playAriaLabel=Adapt$1.course.get("_globals")._extensions._audio?Adapt$1.course.get("_globals")._extensions._audio.playAriaLabel:"";Adapt$1.audio.pauseAriaLabel=Adapt$1.course.get("_globals")._extensions._audio?Adapt$1.course.get("_globals")._extensions._audio.pauseAriaLabel:"";Adapt$1.audio.stopAriaLabel=Adapt$1.course.get("_globals")._extensions._audio?Adapt$1.course.get("_globals")._extensions._audio.stopAriaLabel:"";Adapt$1.audio.pauseStopAction=Adapt$1.course.get("_audio")._pauseStopAction;Adapt$1.audio.triggerPosition=Adapt$1.course.get("_audio")._triggerPosition;Adapt$1.audio.autoPlayGlobal=Adapt$1.course.get("_audio")._autoplay?true:false;Adapt$1.audio.autoPlayOnceGlobal=Adapt$1.course.get("_audio")._autoPlayOnce?true:false;Adapt$1.audio.iconOn=Adapt$1.course.get("_audio")._icons._audioOn;Adapt$1.audio.iconOff=Adapt$1.course.get("_audio")._icons._audioOff;Adapt$1.audio.iconPlay=Adapt$1.course.get("_audio")._icons._audioPlay;Adapt$1.audio.iconPause=Adapt$1.course.get("_audio")._icons._audioPause;Adapt$1.audio.numChannels=3;for(var i=0;i<Adapt$1.audio.numChannels;i++){Adapt$1.audio.audioClip[i]=new Audio}for(var i=0;i<Adapt$1.audio.numChannels;i++){Adapt$1.audio.audioClip[i].isPlaying=false;Adapt$1.audio.audioClip[i].playingID="";Adapt$1.audio.audioClip[i].newID="";Adapt$1.audio.audioClip[i].prevID="";Adapt$1.audio.audioClip[i].onscreenID=""}Adapt$1.audio.audioClip[0].status=Adapt$1.course.get("_audio")._channels._narration._status;Adapt$1.audio.audioClip[1].status=Adapt$1.course.get("_audio")._channels._effects._status;Adapt$1.audio.audioClip[2].status=Adapt$1.course.get("_audio")._channels._music._status;Adapt$1.audio.audioStatus=Adapt$1.audio.audioClip[0].status;if(Adapt$1.offlineStorage.get("audio_level")=="1"||Adapt$1.offlineStorage.get("audio_level")=="0"){Adapt$1.audio.audioStatus=Adapt$1.offlineStorage.get("audio_level");Adapt$1.audio.textSize=Adapt$1.offlineStorage.get("audio_textSize")}for(var i=0;i<Adapt$1.audio.numChannels;i++){Adapt$1.audio.audioClip[i].status=parseInt(Adapt$1.audio.audioStatus)}this.updateAudioStatus(0,Adapt$1.audio.audioStatus);this.changeText(Adapt$1.audio.textSize)},loadNavigationView:function(navigationView){var audioModel=Adapt$1.course.get("_audio");var audioNavigationModel=new Backbone.Model(audioModel);navigationView.$(".nav__drawer-btn").after(new AudioNavigationView$1({model:audioNavigationModel}).$el)},checkLaunch:function(){if(Adapt$1.offlineStorage.get("location")==="undefined"||Adapt$1.offlineStorage.get("location")===undefined||Adapt$1.offlineStorage.get("location")==""){if(Adapt$1.course.get("_audio")._prompt._isEnabled){this.listenToOnce(Adapt$1,"pageView:ready menuView:ready",this.onReady)}else{this.audioConfigured()}}else{if(Adapt$1.course.has("_bookmarking")&&Adapt$1.course.get("_bookmarking")._isEnabled&&Adapt$1.course.get("_bookmarking")._showPrompt){if($("body").children(".notify").css("visibility")=="visible"){this.bookmarkOpened()}else{this.listenToOnce(Adapt$1,"popup:opened",this.bookmarkOpened)}}this.audioConfigured()}},onReady:function(){_.defer(function(){this.stopListening(Adapt$1,"pageView:ready menuView:ready",this.onReady);this.showAudioPrompt()}.bind(this))},bookmarkOpened:function(){Adapt$1.audio.promptIsOpen=true;this.listenToOnce(Adapt$1,"bookmarking:cancel",this.onPromptClosed)},onLangChange:function(){this.stopListening(Adapt$1,{"navigationView:postRender":this.loadNavigationView,"menuView:postRender":this.onMenuReady,"articleView:postRender blockView:postRender componentView:postRender":this.onABCReady,"audio:onscreenOff":this.onscreenOff,"audio:playAudio":this.playAudio,"audio:pauseAudio":this.pauseAudio,"audio:audioEnded":this.audioEnded,"audio:updateAudioStatus":this.updateAudioStatus,"audio:showAudioDrawer":this.setupDrawerAudio,"audio:changeText":this.changeText,"notify:closed":this.notifyClosed,"audio:popupOpened":this.popupOpened,"audio:popupClosed":this.popupClosed,"audio:stopNarrationChannel":this.stopNarrationChannel,"audio:stopEffectsChannel":this.stopEffectsChannel,"audio:stopMusicChannel":this.stopMusicChannel,"audio:stopAllChannels menuView:preRender pageView:preRender":this.stopAllChannels,"bookmarking:cancel":this.promptClosed});this.stopListening(Adapt$1.config,"change:_activeLanguage",this.onLangChange);this.listenTo(Adapt$1,"menuView:postRender pageView:postRender",_.debounce(this.checkLaunchOnLangChange,1e3));this.listenToOnce(Adapt$1,"app:dataReady",this.onDataReady);if(!Adapt$1.audio)return;this.stopAllChannels()},checkLaunchOnLangChange:function(){if(Adapt$1.course.get("_audio")&&Adapt$1.course.get("_audio")._isEnabled){this.showAudioPrompt();this.stopListening(Adapt$1,"menuView:postRender pageView:postRender",this.checkLaunchOnLangChange)}},showAudioPrompt:function(){if(Adapt$1.audio.promptIsOpen)return;Adapt$1.audio.promptIsOpen=true;var audioPromptModel=Adapt$1.course.get("_audio")._prompt;var promptTitle="";var promptBody="";var promptButton1Text="";var promptButton2Text="";var promptButton1Callback="";var promptButton2Callback="";if(Adapt$1.audio.audioStatus==0){if(this.reducedTextEnabled){promptTitle=audioPromptModel.title;promptBody=audioPromptModel.bodyAudioOff;promptButton1Text=audioPromptModel._buttons.full;promptButton2Text=audioPromptModel._buttons.reduced;promptButton1Callback="fullTextAudioOff";promptButton2Callback="reducedTextAudioOff"}else{promptTitle=audioPromptModel.titleNoReduced;promptBody=audioPromptModel.bodyNoReducedAudioOff;promptButton1Text=audioPromptModel._buttons.continue;promptButton2Text=audioPromptModel._buttons.turnOn;promptButton1Callback="selectContinueAudioOff";promptButton2Callback="selectOn"}}else{if(this.reducedTextEnabled){promptTitle=audioPromptModel.title;promptBody=audioPromptModel.bodyAudioOn;promptButton1Text=audioPromptModel._buttons.full;promptButton2Text=audioPromptModel._buttons.reduced;promptButton1Callback="fullTextAudioOn";promptButton2Callback="reducedTextAudioOn"}else{promptTitle=audioPromptModel.titleNoReduced;promptBody=audioPromptModel.bodyNoReducedAudioOn;promptButton1Text=audioPromptModel._buttons.continue;promptButton2Text=audioPromptModel._buttons.turnOff;promptButton1Callback="selectContinueAudioOn";promptButton2Callback="selectOff"}}var audioPrompt=new Backbone.Model(audioPromptModel);audioPrompt.set("promptTitle",promptTitle);audioPrompt.set("promptBody",promptBody);audioPrompt.set("promptButton1Text",promptButton1Text);audioPrompt.set("promptButton2Text",promptButton2Text);audioPrompt.set("promptButton1Callback",promptButton1Callback);audioPrompt.set("promptButton2Callback",promptButton2Callback);Adapt$1.audio.promptView=new AudioPromptView$1({model:audioPrompt});Adapt$1.trigger("notify:popup",{_view:Adapt$1.audio.promptView,_isCancellable:true,_showCloseButton:false,_closeOnBackdrop:true,_classes:" audio-prompt"});this.listenToOnce(Adapt$1,{"popup:closed":this.onPromptClosed})},onPromptClosed:function(){if(Adapt$1.audio.externalPromptIsOpen==true){Adapt$1.audio.promptIsOpen=true}else{Adapt$1.audio.promptIsOpen=false}this.audioConfigured()},changeText:function(value){Adapt$1.audio.textSize=value;this.updateOfflineStorage()},onscreenOff:function(id,channel){if(id==Adapt$1.audio.audioClip[channel].playingID){Adapt$1.audio.audioClip[channel].onscreenID="";this.pauseAudio(channel)}},playAudio:function(audioClip,id,channel,popup){if(audioClip=="")return;if(Adapt$1.audio.audioClip[channel].onscreenID!=id||id===null){Adapt$1.trigger("media:stop");Adapt$1.audio.audioClip[channel].pause();this.hideAudioIcon(channel);Adapt$1.audio.audioClip[channel].prevID=Adapt$1.audio.audioClip[channel].playingID;Adapt$1.audio.audioClip[channel].src=audioClip;Adapt$1.audio.audioClip[channel].newID=id;if(Adapt$1.audio.promptIsOpen==false||popup==true){try{var delay=500;if(id===null){delay=0}setTimeout((function(){Adapt$1.audio.audioClip[channel].play();Adapt$1.audio.audioClip[channel].isPlaying=true}),delay);if(id!=null){this.showAudioIcon(channel)}}catch(e){console.log("Audio play error:"+e)}}Adapt$1.audio.audioClip[channel].onscreenID=id;Adapt$1.audio.audioClip[channel].playingID=Adapt$1.audio.audioClip[channel].newID}},pauseAudio:function(channel){if(_.isNumber(channel)&&!Adapt$1.audio.audioClip[channel].paused){Adapt$1.audio.audioClip[channel].isPlaying=false;Adapt$1.audio.audioClip[channel].pause();this.hideAudioIcon(channel)}},audioEnded:function(channel){Adapt$1.audio.audioClip[channel].isPlaying=false;this.hideAudioIcon(channel)},notifyClosed:function(){this.stopNarrationChannel();this.stopEffectsChannel();Adapt$1.audio.promptIsOpen=false},popupOpened:function(){this.stopAllChannels();Adapt$1.audio.promptIsOpen=true;Adapt$1.audio.externalPromptIsOpen=true},popupClosed:function(){this.stopAllChannels();Adapt$1.audio.promptIsOpen=false;Adapt$1.audio.audioClip[0].onscreenID=""},stopAllChannels:function(){for(var i=0;i<Adapt$1.audio.numChannels;i++){this.pauseAudio(i)}},stopNarrationChannel:function(){this.pauseAudio(0)},stopEffectsChannel:function(){this.pauseAudio(1)},stopMusicChannel:function(){this.pauseAudio(2)},showAudioIcon:function(channel){var audioHTMLId="#"+Adapt$1.audio.audioClip[channel].newID;$(audioHTMLId).removeClass(Adapt$1.audio.iconPlay);$(audioHTMLId).addClass(Adapt$1.audio.iconPause);$(audioHTMLId).addClass("playing");if(Adapt$1.audio.pauseStopAction=="pause"){$(audioHTMLId).attr("aria-label",$.a11y_normalize(Adapt$1.audio.pauseAriaLabel))}else{$(audioHTMLId).attr("aria-label",$.a11y_normalize(Adapt$1.audio.stopAriaLabel))}},hideAudioIcon:function(channel){if(!Adapt$1.audio.audioClip[channel].playingID)return;var audioHTMLId="#"+Adapt$1.audio.audioClip[channel].playingID;Adapt$1.trigger("componentItems:audioEnded",audioHTMLId);$(audioHTMLId).removeClass(Adapt$1.audio.iconPause);$(audioHTMLId).addClass(Adapt$1.audio.iconPlay);$(audioHTMLId).removeClass("playing");$(audioHTMLId).attr("aria-label",$.a11y_normalize(Adapt$1.audio.playAriaLabel))},updateAudioStatus:function(channel,value){Adapt$1.audio.audioClip[channel].status=value;Adapt$1.trigger("audio:pauseAudio",channel);Adapt$1.audio.audioStatus=0;if(Adapt$1.audio.audioClip[0].status==1){Adapt$1.audio.audioStatus=1}this.updateOfflineStorage()},updateOfflineStorage:function(){Adapt$1.offlineStorage.set("audio_level",Adapt$1.audio.audioStatus);Adapt$1.offlineStorage.set("audio_textSize",Adapt$1.audio.textSize)},audioConfigured:function(){for(var i=0;i<Adapt$1.audio.numChannels;i++){Adapt$1.audio.audioClip[i].play();Adapt$1.audio.audioClip[i].isPlaying=false;Adapt$1.audio.audioClip[i].pause()}Adapt$1.audio.isConfigured=true;Adapt$1.trigger("audio:configured")},addAudioDrawerItem:function(){var drawerAudio=Adapt$1.course.get("_audio");var drawerObject={title:drawerAudio.title,description:drawerAudio.description,className:"audio-drawer",drawerOrder:drawerAudio._drawerOrder||0};Adapt$1.drawer.addItem(drawerObject,"audio:showAudioDrawer")},setupDrawerAudio:function(){var audioDrawerModel=Adapt$1.course.get("_audio");var audioDrawerModel=new Backbone.Model(audioDrawerModel);Adapt$1.drawer.triggerCustomView(new AudioDrawerView$1({model:audioDrawerModel}).$el)},onMenuReady:function(view){if(view.model&&view.model.get("_audio")&&view.model.get("_audio")._isEnabled){this.stopAllChannels();if(Adapt$1.location._currentId==view.model.get("_id")){_.each(view.model.getChildren().models,(function(page){new AudioMenuItemsView$1({model:page})}));new AudioMenuView$1({model:view.model})}}},onABCReady:function(view){if(view.model&&view.model.get("_audio")&&view.model.get("_audio")._isEnabled){this.stopAllChannels();try{if(!$("."+view.model.get("_id")).find(".audio-controls").length){new AudioControlsView$1({model:view.model})}if(view.model.get("_type")==="component"&&view.model.get("_items")&&view.model.get("_items").length){_.each(view.model.get("_items"),(function(item,index){if(!item._audio)return;item._type="Item";item._id=view.model.get("_id")+"-"+index;item.itemIndex=index;item.itemElement=$("."+view.model.get("_id")).find(".item-"+index+"-audio");new AudioItemControlsView$1({model:new Backbone.Model(item)})}))}}catch(e){console.log(e)}}if(view.model&&view.model.get("_audioAssessment")&&view.model.get("_audioAssessment")._isEnabled){this.stopAllChannels();try{if(!$("."+view.model.get("_id")).find(".audio-controls").length){new AudioResultsView$1({model:view.model})}}catch(e){console.log(e)}}}},Backbone.Events);AudioController.initialize();__AMD("extensions/adapt-audio/js/adapt-audio",AudioController);var BlockBackgroundView=Backbone.View.extend({_blockModels:null,_blockModelsIndexed:null,$backgroundContainer:null,$backgrounds:null,$blockElements:null,_firstId:null,_activeId:null,initialize:function(){this._blockModels=this.model.findDescendantModels("blocks").filter((function(model){return model.get("_blockBackground")}));if(this._blockModels.length==0){return}this._blockModelsIndexed=_.indexBy(this._blockModels,"_id");this.listenTo(Adapt$1,"pageView:ready",this.onPageReady);this.listenTo(Adapt$1,"device:changed",this.onPageReady);this.listenTo(Adapt$1,"device:resize",this.onPageReady)},onPageReady:function(){var self=this;this.$blockElements={};this.callbacks={};for(var i=0,l=this._blockModels.length;i<l;i++){var blockModel=this._blockModels[i];if(!blockModel.get("_blockBackground"))continue;var id=blockModel.get("_id");if(!this._firstId)this._firstId=id;var $blockElement=this.$el.find("."+id);if(!$blockElement.length){self.listenTo(Adapt$1,"blockView:postRender",function(view){if(this.$blockElements.hasOwnProperty(view.model.get("_id"))){this.setBlockBackground(view.$el,view.model,view.model.get("_id"));this._activeId=view.model.get("_id")}}.bind(self))}this.setBlockBackground($blockElement,blockModel,id)}this._activeId=this._firstId},setBlockBackground:function($blockElement,blockModel,id){$blockElement.attr("data-block-background",id);this.$blockElements[id]=$blockElement;this.$blockElements[id].on("onscreen",this.callbacks[id]);var options=blockModel.get("_blockBackground");this.setBackgroundGraphic($blockElement,options)},setBackgroundGraphic:function($blockElement,options){if(Adapt$1.device.screenSize==="large"){$blockElement.addClass("block-background-block").remove("block-background-block-mobile").css({"background-image":"url("+options.src+")","background-color":options.backgroundColor+" !important","background-repeat":options.backgroundRepeat,"background-size":options.backgroundSize,"background-attachment":options.backgroundAttachment,"background-position":options.backgroundPosition,"min-height":options.bannerHeight+"px"})}else{$blockElement.addClass("block-background-block-mobile").remove("block-background-block").css({"background-image":"url("+options.mobileSrc+")","background-color":options.backgroundColor+" !important","background-repeat":options.backgroundRepeat,"background-size":options.backgroundSize,"background-attachment":options.backgroundAttachment,"background-position":options.backgroundPosition,"min-height":options.mobileBannerHeight+"px"})}}});Adapt$1.on("pageView:postRender",(function(view){var model=view.model;if(model.get("_blockBackground")){if(model.get("_blockBackground")._isActive){new BlockBackgroundView({model:model,el:view.el})}}}));$("body").on("click",".js-generate-certificate",(function(){var certConfig=Adapt$1.course.get("_certificate");Adapt$1.course.get("displayTitle");var name=Adapt$1.offlineStorage.get("learnerinfo").name;var date=(new Date).toLocaleDateString("en-GB");var canvas=$('<canvas id="target" width="1200" height="927"></canvas>')[0];var ctx=canvas.getContext("2d");var imageObj=new Image;canvas.width=certConfig._certificateWidth;canvas.height=certConfig._certificateHeight;imageObj.src=certConfig._certificateFilePath;imageObj.onload=function(){ctx.drawImage(imageObj,0,0);ctx.font="30pt Calibri";ctx.textAlign="center";ctx.fillText(name,certConfig._xPosition,certConfig._namePositionHeight);ctx.font="18pt Calibri";ctx.textAlign="center";ctx.fillText(date,certConfig._xPosition,certConfig._datePositionHeight);downloadPDF(canvas)}}));function downloadPDF(canvas){var data=canvas.toDataURL();var docDefinition={pageOrientation:"landscape",pageSize:"A4",content:[{image:data,width:900}]};pdfMake__default["default"].createPdf(docDefinition).download("certificate.pdf")}const CloseView=Backbone.View.extend({initialize:function(){this.listenTo(Adapt$1,{"navigation:closeButton":this.onCloseButton,"close:confirm":this.onCloseConfirm,"app:languageChanged":this.remove}).render()},render:function(){const data=this.model.toJSON();data._globals=Adapt$1.course.get("_globals");const template=Handlebars.templates.close;this.setElement(template(data)).$el.appendTo(".nav__inner")},onCloseButton:function(){const prompt=!Adapt$1.course.get("_isComplete")?this.model.get("_notifyPromptIfIncomplete"):this.model.get("_notifyPromptIfComplete");if(!prompt||!prompt._isEnabled)return Adapt$1.trigger("close:confirm");Adapt$1.notify.prompt({title:prompt.title,body:prompt.body,_prompts:[{promptText:prompt.confirm,_callbackEvent:"close:confirm"},{promptText:prompt.cancel}]})},onCloseConfirm:function(){const config=Adapt$1.course.get("_close");config.browserPromptIfIncomplete=config.browserPromptIfComplete=false;const scormWrapper=require("extensions/adapt-contrib-spoor/js/scorm/wrapper");if(scormWrapper){const scormWrapperInstance=scormWrapper.getInstance();if(scormWrapperInstance.lmsConnected&&!scormWrapperInstance.finishCalled){scormWrapperInstance.finish()}}if(config._button._closeViaLMSFinish)return;top.window.close()}});function onBeforeUnload(config){return!Adapt$1.course.get("_isComplete")?config.browserPromptIfIncomplete||undefined:config.browserPromptIfComplete||undefined}function initialise(){const config=Adapt$1.course.get("_close");if(!config||!config._isEnabled)return;const button=config._button;if(button&&button._isEnabled){new CloseView({model:new Backbone.Model(button)})}if(config.browserPromptIfIncomplete||config.browserPromptIfComplete){$(window).off("beforeunload");$(window).on("beforeunload.close",_.partial(onBeforeUnload,config))}}Adapt$1.once("adapt:start",(function(){initialise();Adapt$1.on("app:languageChanged",(function(){$(window).off("beforeunload.close");Adapt$1.once("router:location",initialise)}))}));const AssessmentView={postRender(){ArticleView$1.prototype.postRender.call(this);if(this.model.isAssessmentEnabled()){this._setupEventListeners();const config=this.model.getConfig();if(config?._questions?._canShowMarking===false){this.$el.addClass("has-no-marking")}}this.$el.addClass("is-assessment")},_setupEventListeners(){this.listenTo(Adapt$1,{"assessments:complete":this._onAssessmentComplete,"assessments:reset":this._onAssessmentReset,remove:this._onRemove})},_removeEventListeners(){this.stopListening(Adapt$1,{"assessments:complete":this._onAssessmentComplete,"assessments:reset":this._onAssessmentReset})},_onAssessmentComplete(state,model){if(state.id!==this.model.get("_assessment")._id)return;logging$1.info("assessment complete",state,model)},_onAssessmentReset(state,model){if(state.id!==this.model.get("_assessment")._id)return;logging$1.info("assessment reset",state,model)},_onRemove(){this._removeEventListeners()}};var AdaptAssessmentArticleView=__AMD("extensions/adapt-contrib-assessment/js/adapt-assessmentArticleView",AssessmentView);class QuestionBank{constructor(quizBankId,articleId){this._bankId=quizBankId;this._articleId=articleId;this._unusedQuestionBlocks=null;this._count=null}calculateAvailableQuestionBlocks(count){this._count=parseInt(count);const articleModel=data$1.findById(this._articleId);const children=articleModel.getAvailableChildModels();this._availableQuestionBlocks=children.map((blockModel=>{if(blockModel.get("_assessment")?._quizBankID!==this._bankId)return null;return blockModel})).filter(Boolean);const availableQuestionBlockIds=this._availableQuestionBlocks?.map((block=>block.get("_id")))||[];const unusedQuestionBlockIds=this._unusedQuestionBlocks?.map((block=>block.get("_id")))||[];const haveBlocksChanged=Boolean(_.difference(unusedQuestionBlockIds,availableQuestionBlockIds).length);if(!haveBlocksChanged)return;this._unusedQuestionBlocks=null}getRandomQuestionBlocks(){let count=this._count;if(count>this.unusedQuestionBlocks.length){logging$1.warn(`Bank ID ${this._bankId}: Attempting to display ${count} question(s), but only ${this.unusedQuestionBlocks.length} available`);count=this.unusedQuestionBlocks.length}const questionBlocks=[];let i=0;while(i++<count){const nextBlock=this.unusedQuestionBlocks.shift();questionBlocks.push(nextBlock)}return questionBlocks}get unusedQuestionBlocks(){const hasUnusedQuestion=Boolean(this._unusedQuestionBlocks?.length);if(!hasUnusedQuestion){this._unusedQuestionBlocks=_.shuffle(this._availableQuestionBlocks.slice(0))}return this._unusedQuestionBlocks}}var QuestionBank$1=__AMD("extensions/adapt-contrib-assessment/js/adapt-assessmentQuestionBank",QuestionBank);let givenIdCount=0;const assessmentConfigDefaults={_isEnabled:true,_questions:{_resetType:"soft",_canShowFeedback:false,_canShowMarking:false,_canShowModelAnswer:false},_suppressMarking:false,_isPercentageBased:true,_scoreToPass:100,_correctToPass:100,_includeInTotalScore:true,_assessmentWeight:1,_isResetOnRevisit:true,_reloadPageOnReset:true,_attempts:"infinite",_allowResetIfPassed:false};const AssessmentModel={_getCurrentQuestionComponents(){return this.findDescendantModels("block").filter((block=>block.get("_isAvailable"))).reduce(((questions,block)=>questions.concat(block.findDescendantModels("question"))),[])},_getAllQuestionComponents(){return this.findDescendantModels("question")},_postInitialize(){if(!this.isAssessmentEnabled())return;const assessmentConfig=this.getConfig();Object.assign(this,{_originalChildModels:null,_questionBanks:null,_forceResetOnRevisit:false});let attemptsLeft;switch(assessmentConfig._attempts){case"infinite":case 0:case undefined:case-1:case null:attemptsLeft="infinite";break;default:attemptsLeft=assessmentConfig._attempts;break}this.set({_assessmentCompleteInSession:false,_attemptInProgress:false,_isAssessmentComplete:false,_numberOfQuestionsAnswered:0,_lastAttemptScoreAsPercent:0,_attempts:attemptsLeft,_attemptsLeft:attemptsLeft,_attemptsSpent:0});this.listenToOnce(Adapt$1,"app:dataReady",this._onDataReady);this.listenTo(Adapt$1,"remove",this._onRemove)},init(){this._originalChildModels=this.getChildren().models;this.setupCurrentQuestionComponents();this._setAssessmentOwnershipOnChildrenModels();this._updateQuestionsState()},setupCurrentQuestionComponents(){const assessmentQuestionsConfig=this.getConfig()._questions;this._getAllQuestionComponents().forEach((component=>{component.set({_canShowFeedback:assessmentQuestionsConfig._canShowFeedback,_canShowMarking:assessmentQuestionsConfig._canShowMarking,_canShowModelAnswer:assessmentQuestionsConfig._canShowModelAnswer})}))},_setAssessmentOwnershipOnChildrenModels(){const assessmentConfig=this.get("_assessment");const childConfig={_isPartOfAssessment:true,_assessmentId:assessmentConfig._id};for(const blockModel of this._originalChildModels){blockModel.set(childConfig);blockModel.setOnChildren(childConfig)}},checkIfResetOnRevisit(){},_onDataReady(){Adapt$1.assessment.register(this);const questions=this._getCurrentQuestionComponents();if(this.get("_attemptInProgress")&&questions.every((q=>q.get("_isSubmitted")))&&this.get("_requireCompletionOf")!==Number.POSITIVE_INFINITY){this.set("_attemptInProgress",false);logging$1.warn(`Assessment ${this.get("_id")} _attemptInProgress corrected as all questions are submitted`)}},_setupAssessmentData(force,callback){const assessmentConfig=this.getConfig();const state=this.getState();const hasAttemptsLeft=state.attemptsLeft>0||state.attemptsLeft==="infinite";const isFirstAttempt=state.attemptsSpent===0;const shouldResetOnRevisit=(isFirstAttempt||assessmentConfig._isResetOnRevisit)&&!this.get("_attemptInProgress");const shouldResetAssessment=shouldResetOnRevisit&&!state.isPass&&hasAttemptsLeft||force===true;const shouldResetQuestions=shouldResetOnRevisit&&(state.allowResetIfPassed||!state.isPass)||force===true;if(shouldResetAssessment||shouldResetQuestions){Adapt$1.trigger("assessments:preReset",this.getState(),this)}let quizModels;if(shouldResetAssessment){if(isFirstAttempt||assessmentConfig?._questions?._resetType==="hard"){this.set({_numberOfQuestionsAnswered:0,_isAssessmentComplete:false,_assessmentCompleteInSession:false,_score:0})}else{this.set({_assessmentCompleteInSession:false})}this.getChildren().reset(this._originalChildModels);if(assessmentConfig?._banks._isEnabled&&assessmentConfig?._banks._split.length>1){quizModels=this._setupBankedAssessment()}else if(assessmentConfig?._randomisation._isEnabled){quizModels=this._setupRandomisedAssessment()}}if(!quizModels){quizModels=this.getChildren().models}else if(quizModels.length===0){quizModels=this.getChildren().models;logging$1.warn("assessment: Not enough unique questions to create a fresh assessment, using last selection")}this.getChildren().reset(quizModels);this.setupCurrentQuestionComponents();if(shouldResetAssessment||shouldResetQuestions){this._resetQuestions();this.set("_attemptInProgress",true);Adapt$1.trigger("assessments:reset",this.getState(),this)}if(!state.isComplete){this.set("_attemptInProgress",true)}this._overrideQuestionComponentSettings();this._setupQuestionListeners();this._checkNumberOfQuestionsAnswered();this._updateQuestionsState();Adapt$1.assessment.saveState();this.trigger("reset");if(shouldResetAssessment||shouldResetQuestions){Adapt$1.trigger("assessments:postReset",this.getState(),this)}},_setupBankedAssessment(){const assessmentConfig=this.getConfig();this._setupBanks();let questionModels=this._questionBanks.flatMap((questionBank=>questionBank.getRandomQuestionBlocks()));if(assessmentConfig._banks._randomisation){questionModels=_.shuffle(questionModels)}return questionModels},_setupBanks(){const assessmentConfig=this.getConfig();const bankSplits=assessmentConfig._banks._split.split(",");this.findDescendantModels("block").filter((block=>block.get("_isAvailable")&&block.findDescendantModels("question").length>0)).forEach((block=>{const quizBankId=block.get("_assessment")?._quizBankId;const isInvalidNumber=isNaN(quizBankId)||quizBankId<1;const isOutOfBounds=quizBankId>bankSplits.length;if(isInvalidNumber)logging$1.warn(`Bank ID ${quizBankId} is not a valid number`);if(isOutOfBounds)logging$1.warn(`Bank ID ${quizBankId} exceeds the number of available splits (${bankSplits.length})`)}));const hasBankSplitsChanged=bankSplits.length!==this._questionBanks?.length;if(hasBankSplitsChanged){this._questionBanks=[]}bankSplits.forEach(((count,index)=>{const bankId=index+1;const articleId=this.get("_id");this._questionBanks[bankId]=this._questionBanks[bankId]||new QuestionBank$1(bankId,articleId);this._questionBanks[bankId].calculateAvailableQuestionBlocks(count)}))},_setupRandomisedAssessment(){const assessmentConfig=this.getConfig();const randomisationModel=assessmentConfig._randomisation;const blockModels=this.getChildren().models;let questionModels=_.shuffle(blockModels);if(randomisationModel._blockCount>0){questionModels=questionModels.slice(0,randomisationModel._blockCount)}return questionModels},_overrideQuestionComponentSettings(){const newSettings=this._getMarkingSettings();const questionConfig=this.getConfig()._questions;if(Object.prototype.hasOwnProperty.call(questionConfig,"_canShowFeedback")){newSettings._canShowFeedback=questionConfig._canShowFeedback}if(!_.isEmpty(newSettings)){const questionComponents=this._getAllQuestionComponents();questionComponents.forEach((model=>model.set(newSettings,{pluginName:"_assessment"})))}},_setupQuestionListeners(){this._removeQuestionListeners();this.listenTo(this,"bubble:change:_isInteractionComplete",this._onCompletionEvent)},_checkNumberOfQuestionsAnswered(){const questionComponents=this._getCurrentQuestionComponents();const numberOfQuestionsAnswered=questionComponents.filter((model=>model.get("_isInteractionComplete"))).length;this.set("_numberOfQuestionsAnswered",numberOfQuestionsAnswered)},_removeQuestionListeners(){this.stopListening(this,"bubble:change:_isInteractionComplete",this._onCompletionEvent)},_onCompletionEvent(event){if(event.target?.isTypeGroup("block"))return this._onBlockCompleted(event.target,event.value);if(event.target?.isTypeGroup("question"))return this._onQuestionCompleted(event.target,event.value)},_onBlockCompleted(blockModel,value){if(value===false)return;const questionModels=blockModel.findDescendantModels("question");questionModels.forEach((questionModel=>{this._onQuestionCompleted(questionModel,value)}));if(!blockModel.get("_isInteractionComplete"))return;this._checkAssessmentComplete()},_onQuestionCompleted(questionModel,value){if(value===false)return;if(!questionModel.get("_isInteractionComplete"))return;const numberOfQuestionsAnswered=this._getCurrentQuestionComponents().reduce(((count,question)=>count+=question.get("_isSubmitted")?1:0),0);this.set("_numberOfQuestionsAnswered",numberOfQuestionsAnswered);this._updateQuestionsState();Adapt$1.assessment.saveState();this._checkAssessmentComplete()},_checkAssessmentComplete(){const allQuestionsAdded=this.get("_requireCompletionOf")!==Number.POSITIVE_INFINITY;if(!allQuestionsAdded)return;const numberOfQuestionsAnswered=this.get("_numberOfQuestionsAnswered");const allQuestionsAnswered=numberOfQuestionsAnswered>=this._getCurrentQuestionComponents().length;if(!allQuestionsAnswered)return;this._onAssessmentComplete()},_onAssessmentComplete(){const wasAttemptInProgess=this.get("_attemptInProgress");if(!wasAttemptInProgess)return;this.set("_attemptInProgress",false);this._spendAttempt();const _scoreAsPercent=this._getScoreAsPercent();const _score=this._getScore();const _maxScore=this._getMaxScore();const _minScore=this._getMinScore();const _correctCount=this._getCorrectCount();const _correctAsPercent=this._getCorrectAsPercent();const _questionCount=this._getQuestionCount();this.set({_scoreAsPercent:_scoreAsPercent,_score:_score,_maxScore:_maxScore,_minScore:_minScore,_correctAsPercent:_correctAsPercent,_correctCount:_correctCount,_questionCount:_questionCount,_lastAttemptScoreAsPercent:_scoreAsPercent,_assessmentCompleteInSession:true,_isAssessmentComplete:true});this._updateQuestionsState();this._checkIsPass();this._removeQuestionListeners();if(this._isMarkingSuppressionEnabled()&&(!this._isAttemptsLeft()||this._isPassed())){_.defer((()=>{this._overrideMarkingSettings();this._refreshQuestions()}))}Adapt$1.trigger("assessments:complete",this.getState(),this)},_updateQuestionsState(){const questionComponents=this._getCurrentQuestionComponents();const questions=questionComponents.map((model=>({_id:model.get("_id"),_isCorrect:model.get("_isCorrect")??null})));this.set("_questions",questions)},_checkIsPass(){const assessmentConfig=this.getConfig();const isPercentageBased=assessmentConfig._isPercentageBased;const scoreToPass=assessmentConfig._scoreToPass;const correctToPass=assessmentConfig._correctToPass||0;const scoreAsPercent=this.get("_scoreAsPercent");const score=this.get("_score");const correctAsPercent=this.get("_correctAsPercent");const correctCount=this.get("_correctCount");const isPass=isPercentageBased?scoreAsPercent>=scoreToPass&&correctAsPercent>=correctToPass:score>=scoreToPass&&correctCount>=correctToPass;this.set("_isPass",isPass)},_getMarkingSettings(){let markingSettings={};if(this._shouldSuppressMarking()){markingSettings={_canShowMarking:false,_canShowModelAnswer:false}}else{const questionConfig=this.getConfig()._questions;if(Object.prototype.hasOwnProperty.call(questionConfig,"_canShowModelAnswer")){markingSettings._canShowModelAnswer=questionConfig._canShowModelAnswer}if(Object.prototype.hasOwnProperty.call(questionConfig,"_canShowMarking")){markingSettings._canShowMarking=questionConfig._canShowMarking}}return markingSettings},_overrideMarkingSettings(){const newMarkingSettings=this._getMarkingSettings();const questionComponents=this._getAllQuestionComponents();questionComponents.forEach((model=>model.set(newMarkingSettings,{pluginName:"_assessment"})))},_refreshQuestions(){const questionComponents=this._getCurrentQuestionComponents();questionComponents.forEach((model=>model.refresh()))},_shouldSuppressMarking(){return this._isMarkingSuppressionEnabled()&&this._isAttemptsLeft()&&!this._isPassed()},_isMarkingSuppressionEnabled(){const assessmentConfig=this.getConfig();return assessmentConfig._suppressMarking},_isAttemptsLeft(){if(this.get("_attemptsLeft")===0)return false;return true},_isPassed(){return this.get("_isAssessmentComplete")&&this.get("_isPass")},_spendAttempt(){if(!this._isAttemptsLeft())return false;let attemptsSpent=this.get("_attemptsSpent");this.set("_attemptsSpent",++attemptsSpent);if(this.get("_attempts")==="infinite")return true;let attemptsLeft=this.get("_attemptsLeft");this.set("_attemptsLeft",--attemptsLeft);return true},_getScore(){const questionComponents=this._getCurrentQuestionComponents();const score=questionComponents.reduce(((score,model)=>score+=model.score||0),0);return score},_getMaxScore(){const questionComponents=this._getCurrentQuestionComponents();const maxScore=questionComponents.reduce(((maxScore,model)=>maxScore+=model.maxScore||0),0);return maxScore},_getMinScore(){const questionComponents=this._getCurrentQuestionComponents();const minScore=questionComponents.reduce(((minScore,model)=>minScore+=model.minScore||0),0);return minScore},_getScoreAsPercent(){const minScore=this._getMinScore();const maxScore=this._getMaxScore();const score=this._getScore();const range=maxScore-minScore;return range===0?0:Math.round((score-minScore)/range*100)},_getCorrectCount(){return this._getCurrentQuestionComponents().reduce(((count,model)=>count+=model.get("_isCorrect")?1:0),0)},_getQuestionCount(){return this._getCurrentQuestionComponents().length},_getCorrectAsPercent(){const questionCount=this._getQuestionCount();return questionCount===0?0:Math.round(this._getCorrectCount()/questionCount*100)},_getLastAttemptScoreAsPercent(){return this.get("_lastAttemptScoreAsPercent")},_checkReloadPage(){if(!this.canResetInPage())return false;const parentId=this.getParent().get("_id");const currentLocation=location$1._currentId;if(currentLocation!==parentId)return false;if(!this.get("_isReady"))return false;return true},_reloadPage(callback){const assessmentConfig=this.getConfig();this._forceResetOnRevisit=true;this.listenToOnce(Adapt$1,"pageView:ready",(async()=>{if(assessmentConfig._scrollToOnReset){await router$1.navigateToElement(this.get("_id"))}callback()}));_.delay((()=>{Backbone.history.navigate("#/id/"+location$1._currentId,{replace:true,trigger:true})}),250)},_resetQuestions(){const assessmentConfig=this.getConfig();const questionModels=this._getCurrentQuestionComponents();questionModels.forEach((model=>model.reset(assessmentConfig._questions._resetType,true)))},_onRemove(){this._removeQuestionListeners()},_setCompletionStatus(){this.set({_isComplete:true,_isInteractionComplete:true})},_checkIfQuestionsWereRestored(){if(this.get("_assessmentCompleteInSession"))return;if(!this.get("_isAssessmentComplete"))return;let wereQuestionsRestored=true;const questions=this.get("_questions");for(const question of questions){const questionModel=data$1.findById(question._id);if(questionModel.get("_isAvailable")&&!questionModel.get("_isSubmitted")){wereQuestionsRestored=false;break}}if(!wereQuestionsRestored){this.set("_assessmentCompleteInSession",true);return true}return false},isAssessmentEnabled(){if(this.get("_assessment")?._isEnabled)return true;return false},canResetInPage(){const assessmentConfig=this.getConfig();if(assessmentConfig._reloadPageOnReset===false)return false;return true},reset(force,callback){const assessmentConfig=this.getConfig();force=this._forceResetOnRevisit||force===true;this._forceResetOnRevisit=false;const isPageReload=this._checkReloadPage();if(this.get("_assessmentCompleteInSession")&&!assessmentConfig._isResetOnRevisit&&!isPageReload&&!force){if(typeof callback==="function")callback(false);return false}const wereQuestionsRestored=this._checkIfQuestionsWereRestored();force=force||wereQuestionsRestored;if(force&&!this._isAttemptsLeft()){this.set({_attemptsLeft:this.get("_attempts"),_attemptsSpent:0})}const allowResetIfPassed=this.get("_assessment")._allowResetIfPassed;if(!this._isAttemptsLeft()&&!force&&!allowResetIfPassed){if(typeof callback==="function")callback(false);return false}if(!isPageReload){this._setupAssessmentData(force);if(typeof callback==="function")callback(true)}else{this._reloadPage((()=>{if(typeof callback==="function")callback(true)}))}return true},getSaveState(){const state=this.getState();let blocks;const cfg=this.getConfig();const banksActive=cfg._banks?._isEnabled&&cfg._banks._split.length>1;const randomisationActive=cfg._randomisation?._isEnabled;if(!banksActive&&!randomisationActive){blocks=this.findDescendantModels("block")}else{blocks=state.questions.map((question=>data$1.findById(question._id).getParent()))}blocks=[...new Set(blocks)].filter((block=>block.trackingPosition));const blockTrackingPositions=blocks.map((block=>block.trackingPosition));const blockCompletion=blocks.map((block=>{const questions=block.findDescendantModels("question");return questions.map((question=>question.get("_isCorrect")||false))}));const blockData=[blockTrackingPositions,blockCompletion];const saveState=[state.isComplete?1:0,state.attemptsSpent,state.maxScore||0,state.score,state.attemptInProgress?1:0,state.minScore||0,state.correctAsPercent||0,state.correctCount||0,state.questionCount||0];const dataPackage=[saveState,blockData];return dataPackage},setRestoreState(dataPackage){const restoreState=dataPackage[0];const blockData=dataPackage[1];const _isAssessmentComplete=restoreState[0]===1;const attempts=this.get("_attempts");const _attemptsSpent=restoreState[1];const maxScore=restoreState[2];const score=restoreState[3];const _scoreAsPercent=score?Math.round(score/maxScore*100):0;const _attemptInProgress=restoreState[4]===1;const minScore=restoreState[5];const correctAsPercent=restoreState[6];const correctCount=restoreState[7];const questionCount=restoreState[8];const blocks=blockData[0].map((trackingPosition=>{if(typeof trackingPosition==="number"){return data$1.findWhere({_trackingId:trackingPosition})}return data$1.findByTrackingPosition(trackingPosition)}));if(blocks.length){const nonBlockChildren=this.getChildren().models.filter((model=>!model.isTypeGroup("block")));this.getChildren().reset(blocks.concat(nonBlockChildren))}const _questions=[];blocks.forEach(((block,blockIndex)=>{const blockQuestions=block.findDescendantModels("question");blockQuestions.forEach(((question,questionIndex)=>{_questions.push({_id:question.get("_id"),_isCorrect:blockData[1][blockIndex][questionIndex]})}))}));this.set({_isAssessmentComplete:_isAssessmentComplete,_assessmentCompleteInSession:false,_attemptsSpent:_attemptsSpent,_attemptInProgress:_attemptInProgress,_attemptsLeft:attempts==="infinite"?attempts:attempts-_attemptsSpent,_maxScore:maxScore||this._getMaxScore(),_minScore:minScore||this._getMinScore(),_score:score||0,_scoreAsPercent:_scoreAsPercent,_correctAsPercent:correctAsPercent||0,_correctCount:correctCount||0,_questions:_questions,_questionCount:questionCount||0,_lastAttemptScoreAsPercent:_scoreAsPercent});if(_isAssessmentComplete)this._checkIsPass();Adapt$1.trigger("assessments:restored",this.getState(),this)},getState(){const assessmentConfig=this.getConfig();const state={id:assessmentConfig._id,type:"article-assessment",pageId:this.getParent().get("_id"),articleId:this.get("_id"),isEnabled:assessmentConfig._isEnabled,isComplete:this.get("_isAssessmentComplete"),isPercentageBased:assessmentConfig._isPercentageBased,scoreToPass:assessmentConfig._scoreToPass,score:this.get("_score"),scoreAsPercent:this.get("_scoreAsPercent"),maxScore:this.get("_maxScore"),minScore:this.get("_minScore"),correctCount:this.get("_correctCount"),correctAsPercent:this.get("_correctAsPercent"),correctToPass:assessmentConfig._correctToPass,questionCount:this.get("_questionCount"),isPass:this.get("_isPass"),includeInTotalScore:assessmentConfig._includeInTotalScore,assessmentWeight:assessmentConfig._assessmentWeight,attempts:this.get("_attempts"),attemptsSpent:this.get("_attemptsSpent"),attemptsLeft:this.get("_attemptsLeft"),attemptInProgress:this.get("_attemptInProgress"),lastAttemptScoreAsPercent:this.get("_lastAttemptScoreAsPercent"),questions:this.get("_questions"),resetType:assessmentConfig._questions._resetType,allowResetIfPassed:assessmentConfig._allowResetIfPassed,questionModels:new Backbone.Collection(this._getCurrentQuestionComponents())};return state},getConfig(){let assessmentConfig=this.get("_assessment");if(!assessmentConfig){assessmentConfig=$.extend(true,{},assessmentConfigDefaults)}else{assessmentConfig=$.extend(true,{},assessmentConfigDefaults,assessmentConfig)}if(assessmentConfig._id===undefined){assessmentConfig._id="givenId"+givenIdCount++}this.set("_assessment",assessmentConfig);return assessmentConfig}};var AdaptAssessmentArticleModel=__AMD("extensions/adapt-contrib-assessment/js/adapt-assessmentArticleModel",AssessmentModel);const assessmentsConfigDefaults={_isPercentageBased:true,_scoreToPass:100,_isDefaultsLoaded:true};class Assessment extends Backbone.Controller{initialize(){this._assessments=Object.assign([],{_byPageId:{},_byAssessmentId:{}});this.listenTo(Adapt$1,{"assessments:complete":this._onAssessmentsComplete,"router:location":this._checkResetAssessmentsOnRevisit,"router:plugin":this._handleRoute,"app:dataReady":this._onDataReady})}_onAssessmentsComplete(state){const assessmentId=state.id;state.isComplete=true;if(assessmentId===undefined)return;if(!this._getStateByAssessmentId(assessmentId)){logging$1.warn("assessments: state was not registered when assessment was created")}this.saveState();this._setPageProgress();this._checkAssessmentsComplete()}_restoreModelState(assessmentModel){if(!this._saveStateModel){this._saveStateModel=offlineStorage$1.get("a")}if(this._saveStateModel){const state=assessmentModel.getState();if(this._saveStateModel[state.id]){assessmentModel.setRestoreState(offlineStorage$1.deserialize(this._saveStateModel[state.id]))}}}_handleRoute(plugin,id){if(plugin!=="assessment"&&plugin!=="article-assessment"||id===undefined){return}if(!data$1.findById(id)){const assessment=Adapt$1.assessment._assessments._byAssessmentId[id];if(assessment){id=assessment.get("_id")}else{logging$1.warn("Assessment not found with _id: "+id);return}}_.defer((()=>{Backbone.history.navigate("#/id/"+id,{trigger:true,replace:true})}))}_checkResetAssessmentsOnRevisit(toObject){if(toObject._contentType!=="page")return;const pageAssessmentModels=this._getAssessmentByPageId(toObject._currentId);if(pageAssessmentModels===undefined)return;wait$1.for((function resetAllAssessments(allAssessmentHaveReset){const numberOfAssessments=pageAssessmentModels.length;let numberOfResetAssessments=0;const forceAssessmentReset=false;pageAssessmentModels.forEach((model=>{model.reset(forceAssessmentReset,(()=>{numberOfResetAssessments++;const haveAllModelsReset=numberOfResetAssessments===numberOfAssessments;if(!haveAllModelsReset){return}allAssessmentHaveReset()}))}))}));this._setPageProgress()}_onDataReady(){this._assessments=Object.assign([],{_byPageId:{},_byAssessmentId:{}});this._restoredCount=0}_checkAssessmentsComplete(){let allAssessmentsComplete=true;let assessmentToPostBack=0;const states=this._getStatesByAssessmentId();const assessmentStates=[];for(const id in states){const state=states[id];if(!state.includeInTotalScore)continue;if(!state.isComplete){allAssessmentsComplete=false;break}assessmentToPostBack++;assessmentStates.push(state)}if(!allAssessmentsComplete||assessmentToPostBack===0)return false;if(assessmentToPostBack===1){this._setupSingleAssessmentConfiguration(assessmentStates[0])}_.defer((()=>Adapt$1.trigger("assessment:complete",this.getState())));return true}_setupSingleAssessmentConfiguration(assessmentState){const assessmentsConfig=Adapt$1.course.get("_assessment");$.extend(true,assessmentsConfig,{_isPercentageBased:assessmentState.isPercentageBased,_scoreToPass:assessmentState.scoreToPass});Adapt$1.course.set("_assessment",assessmentsConfig)}_getAssessmentByPageId(pageId){return this._assessments._byPageId[pageId]}_getStateByAssessmentId(assessmentId){if(assessmentId===undefined){return null}return this._assessments._byAssessmentId[assessmentId].getState()}_getStatesByAssessmentId(){const states={};for(const assessmentModel of this._assessments){if(!assessmentModel.get("_isAvailable"))continue;const state=assessmentModel.getState();states[state.id]=state}return states}_setPageProgress(){for(const[id,assessments]of Object.entries(this._assessments._byPageId)){const availableAssessments=assessments.filter((model=>model.get("_isAvailable")));const assessmentsTotal=availableAssessments.length;let assessmentsPassed=0;for(const assessment of availableAssessments){const assessmentState=assessment.getState();if(assessmentState.includeInTotalScore&&!assessmentState.isPass)continue;if(assessmentState.isComplete){assessmentsPassed++}}const pageModel=data$1.findById(id);pageModel?.set({_subProgressTotal:assessmentsTotal,_subProgressComplete:assessmentsPassed})}}_addToAssessmentIdMap(id,model){if(id===undefined){logging$1.warn('An assessment has been registered with an undefined value for "_id"');return}if(id===""){logging$1.warn('An assessment has been registered with an empty value for "_id"')}if(!this._assessments._byAssessmentId[id]){this._assessments._byAssessmentId[id]=model}else{logging$1.warn('An assessment with an _id of "'+id+'" already exists!')}}_setupQuestionNumbering(){const getRelatedQuestions=data=>{const currentAssessmentId=data._assessmentId;const currentAssessment=Adapt$1.assessment.get(currentAssessmentId);return currentAssessment.getState().questions};Handlebars.registerHelper("questionNumber",(function getQuestionNumber(){const data=this.view?.model.toJSON()||this;if(!data._isPartOfAssessment)return;const related=_.pluck(getRelatedQuestions(data),"_id");return related.indexOf(data._id)+1}));Handlebars.registerHelper("questionCount",(function getTotalQuestions(){const data=this.view?this.view.model.toJSON():this;if(!data._isPartOfAssessment)return;return getRelatedQuestions(data).length}))}register(assessmentModel){const state=assessmentModel.getState();const assessmentId=state.id;const pageId=state.pageId;if(this._assessments._byPageId[pageId]===undefined){this._assessments._byPageId[pageId]=[]}this._assessments._byPageId[pageId].push(assessmentModel);this._addToAssessmentIdMap(assessmentId,assessmentModel);this._assessments.push(assessmentModel);this._restoreModelState(assessmentModel);this._restoredCount++;Adapt$1.trigger("assessments:register",state,assessmentModel);this._setPageProgress();this._setupQuestionNumbering();if(this._restoredCount===this._assessments.length){Adapt$1.trigger("assessment:restored",this.getState())}}get(id){return id===undefined?this._assessments.slice(0):this._assessments._byAssessmentId[id]}saveState(){this._saveStateModel={};for(const assessmentModel of this._assessments){const state=assessmentModel.getState();this._saveStateModel[state.id]=offlineStorage$1.serialize(assessmentModel.getSaveState())}offlineStorage$1.set("a",this._saveStateModel)}getConfig(){let assessmentsConfig=Adapt$1.course.get("_assessment");if(assessmentsConfig?._isDefaultsLoaded){return assessmentsConfig}if(assessmentsConfig===undefined){assessmentsConfig=$.extend(true,{},assessmentsConfigDefaults)}else{assessmentsConfig=$.extend(true,{},assessmentsConfigDefaults,assessmentsConfig)}Adapt$1.course.set("_assessment",assessmentsConfig);return assessmentsConfig}getState(){const assessmentsConfig=this.getConfig();let score=0;let maxScore=0;let minScore=0;let correctCount=0;let questionCount=0;let assessments=0;const states=this._getStatesByAssessmentId();let assessmentsComplete=0;for(const id in states){const state=states[id];if(!state.includeInTotalScore)continue;if(state.isComplete)assessmentsComplete++;assessments++;maxScore+=state.maxScore/state.assessmentWeight;minScore+=state.minScore/state.assessmentWeight;score+=state.score/state.assessmentWeight;correctCount+=state.correctCount/state.assessmentWeight;questionCount+=state.questionCount/state.assessmentWeight}const isComplete=assessmentsComplete===assessments;const scoreRange=maxScore-minScore;const scoreAsPercent=scoreRange===0?0:Math.round((score-minScore)/scoreRange*100);const correctAsPercent=questionCount===0?0:Math.round(correctCount/questionCount*100);if(assessmentsConfig._correctToPass===undefined){logging$1.warnOnce("Assessment course config is missing _correctToPass")}const scoreToPass=assessmentsConfig._scoreToPass;const correctToPass=assessmentsConfig._correctToPass||scoreToPass;const isPercentageBased=assessmentsConfig._isPercentageBased;const isPass=isComplete&&(isPercentageBased?scoreAsPercent>=scoreToPass&&correctAsPercent>=correctToPass:score>=scoreToPass&&correctCount>=correctToPass);const canRetry=Object.values(states).some((state=>{const isFailed=!state.isPass;const hasAttemptsLeft=state.attemptsLeft>0||state.attemptsLeft==="infinite";return isFailed&&hasAttemptsLeft}));return{isComplete:isComplete,isPercentageBased:isPercentageBased,isPass:isPass,maxScore:maxScore,minScore:minScore,score:score,scoreToPass:scoreToPass,scoreAsPercent:scoreAsPercent,correctCount:correctCount,correctAsPercent:correctAsPercent,correctToPass:correctToPass,questionCount:questionCount,assessmentsComplete:assessmentsComplete,assessments:assessments,canRetry:canRetry}}}__AMD("extensions/adapt-contrib-assessment/js/assessment",Adapt$1.assessment=new Assessment);const ArticleViewInitialize=ArticleView$1.prototype.initialize;ArticleView$1.prototype.initialize=function(options){if(this.model.get("_assessment")?._isEnabled===true){Object.assign(this,AdaptAssessmentArticleView)}return ArticleViewInitialize.apply(this,arguments)};const ArticleModelInitialize=ArticleModel$1.prototype.initialize;ArticleModel$1.prototype.initialize=function(options){if(this.get("_assessment")?._isEnabled===true){Object.assign(this,AdaptAssessmentArticleModel);const returnValue=ArticleModelInitialize.apply(this,arguments);this._postInitialize();return returnValue}return ArticleModelInitialize.apply(this,arguments)};class Bookmarking extends Backbone.Controller{initialize(){this.bookmarkLevel=null;this.restoredLocationID=null;this.currentLocationID=null;this.listenToOnce(Adapt$1,"router:location",this.onAdaptInitialize)}onAdaptInitialize(){if(!this.checkCourseIsEnabled())return;this.setupEventListeners();this.checkRestoreLocation()}checkCourseIsEnabled(){const courseBookmarkModel=Adapt$1.course.get("_bookmarking");if(!courseBookmarkModel||!courseBookmarkModel._isEnabled)return false;return true}setupEventListeners(){this._onScroll=_.debounce(this.checkLocation.bind(this),250);this.listenTo(Adapt$1,{"menuView:ready":this.setupMenu,"pageView:preRender":this.setupPage,"view:childAdded":this.checkLocation})}checkRestoreLocation(){this.restoredLocationID=offlineStorage$1.get("location");if(!this.restoredLocationID||this.restoredLocationID==="undefined"||!data$1.findById(this.restoredLocationID)){return}this.listenToOnce(Adapt$1,"pageView:ready menuView:ready",this.restoreLocation)}restoreLocation(){this.stopListening(Adapt$1,"pageView:ready menuView:ready",this.restoreLocation);_.delay((()=>{if(this.isAlreadyOnScreen(this.restoredLocationID)){return}if(Adapt$1.course.get("_bookmarking")._showPrompt===false){this.navigateToPrevious();return}this.showPrompt()}),500)}isAlreadyOnScreen(id){if(id===location$1._currentId)return true;const type=data$1.findById(id).getTypeGroup();if(type==="menu"||type==="page"){return false}const locationOnscreen=$("."+id).onscreen();const isLocationOnscreen=locationOnscreen&&locationOnscreen.percentInview>0;const isLocationFullyInview=locationOnscreen&&locationOnscreen.percentInview===100;if(isLocationOnscreen&&isLocationFullyInview){return true}return false}showPrompt(){const courseBookmarkModel=Adapt$1.course.get("_bookmarking");const buttons=courseBookmarkModel._buttons||{yes:"Yes",no:"No"};this.listenToOnce(Adapt$1,{"bookmarking:continue":this.navigateToPrevious,"bookmarking:cancel":this.navigateCancel});notify$1.prompt({_classes:"is-bookmarking",_showIcon:true,title:courseBookmarkModel.title,body:courseBookmarkModel.body,_prompts:[{promptText:buttons.yes||"Yes",_callbackEvent:"bookmarking:continue"},{promptText:buttons.no||"No",_callbackEvent:"bookmarking:cancel"}]})}navigateToPrevious(){_.defer((async()=>{const isSinglePage=Adapt$1.contentObjects.models.length===1;try{await router$1.navigateToElement(this.restoredLocationID,{trigger:true,replace:isSinglePage,duration:400})}catch(err){logging$1.warn(`Bookmarking cannot navigate to id: ${this.restoredLocationID}\n`,err)}}));this.stopListening(Adapt$1,"bookmarking:cancel")}navigateCancel(){this.stopListening(Adapt$1,"bookmarking:continue")}resetLocationID(){this.setLocationID("")}setupMenu(menuView){const menuModel=menuView.model;if(!menuModel.get("_parentId")){this.resetLocationID();return}this.setLocationID(menuModel.get("_id"))}getBookmarkLevel(pageModel){const defaultLevel=Adapt$1.course.get("_bookmarking")._level||"component";const bookmarkModel=pageModel.get("_bookmarking");const isInherit=!bookmarkModel||!bookmarkModel._level||bookmarkModel._level==="inherit";return isInherit?defaultLevel:bookmarkModel._level}setupPage(pageView){const pageBookmarkModel=pageView.model.get("_bookmarking");if(pageBookmarkModel?._isEnabled===false){this.resetLocationID();return}this.setLocationID(pageView.model.get("_id"));this.bookmarkLevel=this.getBookmarkLevel(pageView.model);if(this.bookmarkLevel==="page"){return}this.listenToOnce(Adapt$1,"remove",this.releaseViews);$(window).on("scroll",this._onScroll)}setLocationID(id){if(this.currentLocationID===id)return;offlineStorage$1.set("location",id);this.currentLocationID=id}releaseViews(){this.stopListening(Adapt$1,"remove",this.releaseViews);$(window).off("scroll",this._onScroll)}checkLocation(){const contentObjectBookmarkModel=Adapt$1.parentView?.model?.get("_bookmarking");if(contentObjectBookmarkModel?._isEnabled===false){this.resetLocationID();return}const currentModel=location$1._currentModel;if(!currentModel||!this.bookmarkLevel)return;const possibleViewIds=currentModel.findDescendantModels(this.bookmarkLevel).filter((desc=>desc.get("_isTrackable")!==false)).map((desc=>desc.get("_id")));let highestOnscreen=0;let highestOnscreenLocation="";possibleViewIds.forEach((id=>{const element=$(`[data-adapt-id=${id}]`);if(!element.length)return;const measurements=element.onscreen();if(!measurements.onscreen)return;if(measurements.percentInview<=highestOnscreen)return;highestOnscreen=measurements.percentInview;highestOnscreenLocation=id}));if(highestOnscreenLocation)this.setLocationID(highestOnscreenLocation)}}__AMD("extensions/adapt-contrib-bookmarking/js/adapt-contrib-bookmarking",new Bookmarking);var NavigationView=__AMD("extensions/adapt-contrib-languagePicker/js/languagePickerNavigationView",class NavigationView extends Backbone.View{className(){return"nav"}attributes(){return{role:"navigation"}}initialize(){this.template="languagePickerNavigation";this.setupHelpers();this.preRender()}preRender(){Adapt$1.trigger("navigationView:preRender",this);this.render()}render(){const template=Handlebars.templates[this.template];this.$el.html(template({_config:this.model.get("_accessibility"),_accessibility:Adapt$1.config.get("_accessibility")})).insertBefore("#app");_.defer((()=>Adapt$1.trigger("navigationView:postRender",this)));return this}setupHelpers(){Handlebars.registerHelper("a11y_aria_label",(text=>`<div class="aria-label">${text}</div>`))}});var LanguagePickerView=__AMD("extensions/adapt-contrib-languagePicker/js/languagePickerView",class LanguagePickerView extends Backbone.View{get template(){return"languagePickerView"}events(){return{"click .js-languagepicker-btn-click":"onLanguageClick"}}className(){return"languagepicker"}initialize(){this.initializeNavigation();$("html").addClass("in-languagepicker");this.listenTo(Adapt$1,"remove",this.remove);this.render()}render(){const data=this.model.toJSON();const template=Handlebars.templates[this.template];this.$el.html(template(data));this.$el.addClass(data._classes);document.title=this.model.get("title")||"";_.defer(this.postRender.bind(this))}postRender(){$(".js-loading").hide()}onLanguageClick(event){this.destroyNavigation();const lang=event.currentTarget.value;this.model.setLanguage(lang)}initializeNavigation(){this.navigationView=new NavigationView({model:this.model})}destroyNavigation(){this.navigationView.remove()}remove(){$("html").removeClass("in-languagepicker");super.remove()}});var LanguagePickerDrawerView=__AMD("extensions/adapt-contrib-languagePicker/js/languagePickerDrawerView",class LanguagePickerDrawerView extends Backbone.View{get template(){return"languagePickerDrawerView"}events(){return{"click .js-languagepicker-item-btn":"onButtonClick"}}initialize(){this.listenTo(Adapt$1,"remove",this.remove);this.render()}render(){const data=this.model.toJSON();const template=Handlebars.templates[this.template];this.$el.html(template(data))}onButtonClick(event){const newLanguage=this.$(event.currentTarget).attr("data-language");this.model.set("newLanguage",newLanguage);this.promptObject=this.getPromptObject(newLanguage);this.listenToOnce(Adapt$1,"drawer:closed",this.onDrawerClosed);Adapt$1.trigger("drawer:closeDrawer")}onDrawerClosed(){_.delay((()=>{this.listenToOnce(Adapt$1,{"popup:opened":this.onPopupOpened,"languagepicker:changelanguage:yes":this.onDoChangeLanguage,"languagepicker:changelanguage:no":this.onDontChangeLanguage});notify$1.prompt(this.promptObject)}),250)}onPopupOpened(){this.$finishFocus=a11y$1.setPopupCloseTo($("#a11y-focuser"))}onDoChangeLanguage(){const newLanguage=this.model.get("newLanguage");this.model.setTrackedData();this.model.setLanguage(newLanguage);this.remove()}onDontChangeLanguage(){this.remove();_.delay((()=>a11y$1.focusFirst(this.$finishFocus)),500)}getPromptObject(newLanguage){const data=this.model.getLanguageDetails(newLanguage);return{_attributes:{lang:newLanguage},_classes:`is-lang-${newLanguage} ${data._direction==="rtl"?"is-rtl":"is-ltr"}`,title:data.warningTitle,body:data.warningMessage,_prompts:[{promptText:data._buttons.yes,_callbackEvent:"languagepicker:changelanguage:yes"},{promptText:data._buttons.no,_callbackEvent:"languagepicker:changelanguage:no"}],_showIcon:true}}});var LanguagePickerNavView=__AMD("extensions/adapt-contrib-languagePicker/js/languagePickerNavView",class LanguagePickerNavView extends Backbone.View{tagName(){return"button"}className(){const classNames="btn-icon nav__btn nav__languagepicker-btn js-languagepicker-nav-btn icon";const customClass=this.model.get("_languagePickerIconClass")||"icon-language-2";return`${classNames} ${customClass}`}events(){return{click:"onClick"}}initialize(){this.listenTo(Adapt$1,"remove",this.remove)}onClick(event){drawer.triggerCustomView(new LanguagePickerDrawerView({model:this.model}).$el,false)}});var LanguagePickerModel=__AMD("extensions/adapt-contrib-languagePicker/js/languagePickerModel",class LanguagePickerModel extends Backbone.Model{preinitialize(){this.trackedData={components:[],blocks:[]};this.locationId=null}defaults(){return{_isEnabled:false,displayTitle:"",body:"",_languages:[]}}initialize(){this.listenTo(Adapt$1.config,"change:_activeLanguage",this.markLanguageAsSelected);this.listenTo(Adapt$1,"app:dataLoaded",this.onDataLoaded)}getLanguageDetails(language){return this.get("_languages").find((_ref=>{let{_language:_language}=_ref;return _language===language}))}setLanguage(language){let{canReset:canReset=true}=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};Adapt$1.config.set({_activeLanguage:language,_defaultDirection:this.getLanguageDetails(language)._direction});if(canReset)this.checkResetOnLanguageChange()}checkResetOnLanguageChange(){const shouldReset=!this.get("_restoreStateOnLanguageChange");const hasOfflineStorageClear=Boolean(offlineStorage$1.clear);if(!shouldReset||!hasOfflineStorageClear)return;offlineStorage$1.clear()}markLanguageAsSelected(model,language){this.get("_languages").forEach((item=>{item._isSelected=item._language===language}))}onDataLoaded(){const shouldReset=!this.get("_restoreStateOnLanguageChange");const hasOfflineStorageClear=Boolean(Adapt$1.offlineStorage.clear);if(hasOfflineStorageClear||shouldReset)return;_.defer((()=>{this.locationId=offlineStorage$1.get("location")||null;this.restoreState()}))}restoreLocation(){if(!data$1.findById(this.locationId))return;_.defer((()=>router$1.navigateToElement("."+this.locationId)))}restoreState(){if(this.isTrackedDataEmpty())return;this.trackedData.components?.forEach(this.setTrackableState);this.trackedData.blocks?.forEach(this.setTrackableState)}isTrackedDataEmpty(){return _.isEqual(this.trackedData,{components:[],blocks:[]})}getTrackableState(){return{components:this.getState(Adapt$1.components.models).filter(Boolean),blocks:this.getState(Adapt$1.blocks.models).filter(Boolean)}}getState(models){return models.map((model=>model.get("_isComplete")&&model.getTrackableState()))}setTrackedData(){if(!this.get("_restoreStateOnLanguageChange")){return}this.listenToOnce(Adapt$1,"contentObjectView:ready",this.restoreLocation);this.trackedData=this.getTrackableState()}setTrackableState(stateObject){const restoreModel=data$1.findById(stateObject._id);if(!restoreModel){logging$1.warn("LanguagePicker unable to restore state for: "+stateObject._id);return}restoreModel.setTrackableState(stateObject)}});class LanguagePicker extends Backbone.Controller{initialize(){this.listenTo(Adapt$1,"configModel:dataLoaded",this.onConfigLoaded)}onConfigLoaded(){const config=Adapt$1.config.get("_languagePicker");if(!config?._isEnabled)return;this.languagePickerModel=new LanguagePickerModel(config);this.listenTo(Adapt$1,"router:menu router:page",this.setupNavigationView);const params=new URLSearchParams(window.location.search);const paramLang=params.get("lang");if(paramLang&&Adapt$1.build.get("availableLanguageNames").includes(paramLang))return;Adapt$1.config.set("_canLoadData",false);if(offlineStorage$1.ready){this.onOfflineStorageReady();return}this.listenToOnce(Adapt$1,"offlineStorage:ready",this.onOfflineStorageReady)}async onOfflineStorageReady(){await Adapt$1.wait.queue();const storedLanguage=offlineStorage$1.get("lang");if(storedLanguage){this.languagePickerModel.setLanguage(storedLanguage,{canReset:false});return}if(this.languagePickerModel.get("_showOnCourseLoad")===false){this.languagePickerModel.setLanguage(Adapt$1.config.get("_defaultLanguage"),{canReset:false});return}this.showLanguagePickerView()}showLanguagePickerView(){const languagePickerView=new LanguagePickerView({model:this.languagePickerModel});languagePickerView.$el.appendTo("#wrapper")}setupNavigationView(){const courseGlobals=Adapt$1.course.get("_globals")._extensions;let navigationBarLabel="";if(courseGlobals._languagePicker){navigationBarLabel=courseGlobals._languagePicker.navigationBarLabel}const languagePickerNavView=new LanguagePickerNavView({model:this.languagePickerModel,attributes:{"aria-label":navigationBarLabel}});languagePickerNavView.$el.appendTo(".nav__inner")}}__AMD("extensions/adapt-contrib-languagePicker/js/adapt-languagePicker",new LanguagePicker);class Completion extends Backbone.Controller{initialize(){this.subProgressCompleted=0;this.subProgressTotal=0;this.nonAssessmentCompleted=0;this.nonAssessmentTotal=0;this.assessmentCompleted=0;this.assessmentTotal=0}calculateCompletion(contentObjectModel){const completion=Adapt$1.completion;const viewType=contentObjectModel.get("_type");const isComplete=contentObjectModel.get("_isComplete")?1:0;let children;switch(viewType){case"page":children=contentObjectModel.getAllDescendantModels().filter((model=>model.get("_isAvailable")&&!model.get("_isOptional")));const availableChildren=this.filterAvailableChildren(children);const components=this.getPageLevelProgressEnabledModels(availableChildren);const nonAssessmentComponents=this.getNonAssessmentComponents(components);completion.nonAssessmentTotal=nonAssessmentComponents.length;completion.nonAssessmentCompleted=this.getComponentsCompleted(nonAssessmentComponents).length;const assessmentComponents=this.getAssessmentComponents(components);completion.assessmentTotal=assessmentComponents.length;completion.assessmentCompleted=this.getComponentsInteractionCompleted(assessmentComponents).length;if(contentObjectModel.get("_pageLevelProgress")._excludeAssessments!==true){completion.subProgressCompleted=contentObjectModel.get("_subProgressComplete")||0;completion.subProgressTotal=contentObjectModel.get("_subProgressTotal")||0}const showPageCompletionCourse=Adapt$1.course.get("_pageLevelProgress")?._showPageCompletion!==false;const showPageCompletionPage=contentObjectModel.get("_pageLevelProgress")?._showPageCompletion!==false;if(showPageCompletionCourse&&showPageCompletionPage){completion.nonAssessmentCompleted+=isComplete;completion.nonAssessmentTotal+=1}break;case"menu":case"course":children=contentObjectModel.get("_children").models;children.forEach((contentObject=>{const completionObject=Adapt$1.completion.calculateCompletion(contentObject);completion.subProgressCompleted+=completionObject.subProgressCompleted||0;completion.subProgressTotal+=completionObject.subProgressTotal||0;completion.nonAssessmentTotal+=completionObject.nonAssessmentTotal;completion.nonAssessmentCompleted+=completionObject.nonAssessmentCompleted;completion.assessmentTotal+=completionObject.assessmentTotal;completion.assessmentCompleted+=completionObject.assessmentCompleted}));break}return completion}getNonAssessmentComponents(models){return models.filter((model=>!model.get("_isPartOfAssessment")))}getAssessmentComponents(models){return models.filter((model=>model.get("_isPartOfAssessment")))}getComponentsCompleted(models){return models.filter((item=>item.get("_isComplete")))}getComponentsInteractionCompleted(models){return models.filter((item=>item.get("_isComplete")))}getPageLevelProgressEnabledModels(models){return models.filter((model=>{const config=model.get("_pageLevelProgress");return config?._isEnabled}))}unavailableInHierarchy(parents){if(!parents)return;return parents.some((parent=>!parent.get("_isAvailable")))}filterAvailableChildren(children){const availableChildren=[];for(let i=0,count=children.length;i<count;i++){const parents=children[i].getAncestorModels();if(this.unavailableInHierarchy(parents))continue;availableChildren.push(children[i])}return availableChildren}calculatePercentageComplete(model){const completionObject=this.calculateCompletion(model);const completed=completionObject.nonAssessmentCompleted+completionObject.assessmentCompleted+completionObject.subProgressCompleted;const total=completionObject.nonAssessmentTotal+completionObject.assessmentTotal+completionObject.subProgressTotal;const percentageComplete=Math.floor(completed/total*100);return percentageComplete}}var completionCalculations=__AMD("extensions/adapt-contrib-pageLevelProgress/js/completionCalculations",Adapt$1.completion=new Completion);class PageLevelProgressIndicatorView extends Backbone.View{initialize(options){options=options||{};this.parent=options.parent;this.calculatePercentage=options.calculatePercentage||this.calculatePercentage;this.ariaLabel=options.ariaLabel||"";this.type=options.type||this.model.get("_type");this.addClasses();this.setUpEventListeners();this.setPercentageComplete();this.render();this.refresh()}addClasses(){this.$el.addClass(["pagelevelprogress__indicator","is-"+this.type].join(" "))}checkAria(){if(!this.ariaLabel){this.$el.attr("aria-hidden",true);return}const data=this.getRenderData();this.$(".js-indicator-aria-label").html(Handlebars.compile(this.ariaLabel)(data))}setUpEventListeners(){if(this.parent){this.listenToOnce(this.parent,"postRemove",this.remove)}else{this.listenTo(Adapt$1,"remove",this.remove)}this.listenTo(this.model,"change:_isComplete",this.refresh);if(!this.collection)return;this.listenTo(this.collection,"change:_isComplete",this.refresh)}setPercentageComplete(){const percentage=this.calculatePercentage();this.model.set("percentageComplete",percentage);return percentage}calculatePercentage(){return this.model.get("_isComplete")?100:0}render(){const data=this.getRenderData();const template=Handlebars.templates[this.constructor.template];this.$el.html(template(data))}getRenderData(){const data=this.model.toJSON();data.ariaLabel=this.ariaLabel;data.type=this.type;return data}refresh(){this.checkCompletion();this.checkAria();this.$(".js-indicator-bar").css({width:this.calculatePercentage()+"%"})}checkCompletion(){const percentage=this.setPercentageComplete();this.$el.toggleClass("is-complete",percentage===100).toggleClass("is-incomplete",percentage!==100)}}PageLevelProgressIndicatorView.template="pageLevelProgressIndicator";var PageLevelProgressIndicatorView$1=__AMD("extensions/adapt-contrib-pageLevelProgress/js/PageLevelProgressIndicatorView",PageLevelProgressIndicatorView);class PageLevelProgressItemView extends Backbone.View{className(){return["pagelevelprogress__item drawer__item",this.model.get("_type")+"__indicator"].join(" ")}attributes(){return{role:"listitem"}}initialize(){this.listenTo(Adapt$1,"remove",this.remove);this.render();this.addIndicator()}render(){const data=this.model.toJSON();const template=Handlebars.templates[this.constructor.template];this.$el.html(template(data))}addIndicator(){if(this.model.get("_isOptional"))return;const item=new PageLevelProgressIndicatorView$1({model:this.model});this.$(".js-indicator").append(item.$el)}}PageLevelProgressItemView.template="pageLevelProgressItem";var PageLevelProgressItemView$1=__AMD("extensions/adapt-contrib-pageLevelProgress/js/PageLevelProgressItemView",PageLevelProgressItemView);var PageLevelProgressView=__AMD("extensions/adapt-contrib-pageLevelProgress/js/PageLevelProgressView",class PageLevelProgressView extends Backbone.View{className(){return"pagelevelprogress"}events(){return{"click .js-pagelevelprogress-item-click":"scrollToPageElement"}}initialize(){this.listenTo(Adapt$1,"remove",this.remove);this.render();this.addChildren()}async scrollToPageElement(event){if(event&&event.preventDefault)event.preventDefault();const $target=$(event.currentTarget);if($target.is(".is-disabled"))return;const id=$target.attr("data-pagelevelprogress-id");const model=Adapt$1.findById(id);if(!model.get("_isRendered")){try{await Adapt$1.parentView.renderTo(id)}catch(err){return}}const currentComponentSelector=`.${id}`;Adapt$1.once("drawer:closed",(()=>{Adapt$1.scrollTo(currentComponentSelector,{duration:400})})).trigger("drawer:closeDrawer",$(currentComponentSelector))}render(){const template=Handlebars.templates.pageLevelProgress;this.$el.html(template({}))}addChildren(){const $children=this.$(".js-children");this.collection.each((model=>{$children.append(new PageLevelProgressItemView$1({model:model}).$el)}))}});var PageLevelProgressNavigationView=__AMD("extensions/adapt-contrib-pageLevelProgress/js/PageLevelProgressNavigationView",class PageLevelProgressNavigationView extends Backbone.View{tagName(){return"button"}className(){return"btn-icon nav__btn nav__pagelevelprogress-btn pagelevelprogress__nav-btn"}events(){return{click:"onProgressClicked"}}initialize(){_.bindAll(this,"updateProgressBar");this.setUpEventListeners();this.render();this.addIndicator();this.deferredUpdate()}setUpEventListeners(){this.listenTo(Adapt$1,{remove:this.remove,"router:location":this.updateProgressBar,"view:childAdded pageLevelProgress:update":this.refreshProgressBar})}render(){const template=Handlebars.templates.pageLevelProgressNavigation;this.$el.html(template({}));this.$el.prop("title","Page Level Progress")}addIndicator(){this.indicatorView=new PageLevelProgressIndicatorView$1({model:this.model,collection:this.collection,calculatePercentage:this._getPageCompletionPercentage,ariaLabel:Adapt$1.course.get("_globals")._extensions._pageLevelProgress.pageLevelProgressIndicatorBar});this.$el.prepend(this.indicatorView.$el)}_getPageCompletionPercentage(){return completionCalculations.calculatePercentageComplete(this.model)}deferredUpdate(){_.defer(this.updateProgressBar)}updateProgressBar(){this.indicatorView.refresh()}refreshProgressBar(){this.collection.repopulate();this.updateProgressBar()}onProgressClicked(event){if(event&&event.preventDefault)event.preventDefault();Adapt$1.drawer.triggerCustomView(new PageLevelProgressView({collection:this.collection}).$el,false)}remove(){super.remove();this.collection.reset()}});var PageLevelProgressCollection=__AMD("extensions/adapt-contrib-pageLevelProgress/js/PageLevelProgressCollection",class PageLevelProgressCollection extends Backbone.Collection{initialize(models,options){this.listenTo(Adapt$1,"remove",this.reset);if(!options?.pageModel)return;this._pageModel=options.pageModel;this.repopulate()}repopulate(){this.reset();if(!this._pageModel)return;const allDescendants=this._pageModel.getAllDescendantModels(true);const currentPageItems=allDescendants.filter((item=>item.get("_isAvailable")===true));const availableItems=completionCalculations.filterAvailableChildren(currentPageItems);const enabledProgressItems=completionCalculations.getPageLevelProgressEnabledModels(availableItems);this.add(enabledProgressItems)}});class PageLevelProgress extends Backbone.Controller{initialize(){this.listenTo(Adapt$1,{"app:dataReady":this.onDataReady,"app:languageChanged":this.onLanguageChange})}getCourseConfig(){return Adapt$1.course.get("_pageLevelProgress")}onDataReady(){const coursePLPConfig=this.getCourseConfig();if(!coursePLPConfig?._isEnabled)return;this.setUpEventListeners()}onLanguageChange(){this.stopListening();this.initialize()}setUpEventListeners(){const headerIndicatorTypes=["menu","menuItem","page","article","block","component"];const headerIndicatorEventNames=headerIndicatorTypes.concat([""]).join("View:render ");this.listenTo(Adapt$1,headerIndicatorEventNames,this.renderHeaderIndicatorView);this.listenTo(Adapt$1,{"menuItemView:postRender":this.renderMenuItemIndicatorView,"router:page":this.renderNavigationView});this.listenTo(Adapt$1.course,"bubble:change:_isComplete",this.onCompletionChange)}onCompletionChange(event){if(!Adapt$1.location._currentId)return;const currentModel=Adapt$1.findById(Adapt$1.location._currentId);const completionState={currentLocation:completionCalculations.calculatePercentageComplete(currentModel),course:completionCalculations.calculatePercentageComplete(Adapt$1.course)};const hasChanged=!_.isMatch(this._previousCompletionState,completionState);if(!hasChanged)return;this._previousCompletionState=completionState;Adapt$1.trigger("pageLevelProgress:percentageCompleteChange",completionState)}renderHeaderIndicatorView(view){const model=view.model;const config=model.get("_pageLevelProgress");if(!config?._isEnabled||!config?._isCompletionIndicatorEnabled)return;const pageModel=model.findAncestor("contentObjects");const pageConfig=pageModel&&pageModel.get("_pageLevelProgress");if(!pageConfig?._isEnabled)return;const $headings=view.$(".js-heading");$headings.each(((index,el)=>{const $el=$(el);const indicatorView=new PageLevelProgressIndicatorView$1({parent:view,model:model});indicatorView.$el.insertAfter($el)}))}renderMenuItemIndicatorView(view){if(view.model.get("_id")===Adapt$1.location._currentId)return;const viewType=view.model.get("_type");if(viewType==="course")return;const pageLevelProgress=view.model.get("_pageLevelProgress");if(!pageLevelProgress?._isEnabled)return;view.$el.find(".js-menu-item-progress").append(new PageLevelProgressIndicatorView$1({parent:view,model:view.model,type:"menu-item",calculatePercentage:this._getMenuItemCompletionPercentage.bind(view),ariaLabel:Adapt$1.course.get("_globals")._extensions._pageLevelProgress.pageLevelProgressMenuBar}).$el)}_getMenuItemCompletionPercentage(){return completionCalculations.calculatePercentageComplete(this.model)}renderNavigationView(pageModel){const coursePLPConfig=this.getCourseConfig();if(coursePLPConfig?._isShownInNavigationBar===false)return;const pagePLPConfig=pageModel.get("_pageLevelProgress");if(!pagePLPConfig?._isEnabled)return;const collection=new PageLevelProgressCollection(null,{pageModel:pageModel});if(collection.length===0)return;$(".nav__drawer-btn").after(new PageLevelProgressNavigationView({model:pageModel,collection:collection}).$el)}}__AMD("extensions/adapt-contrib-pageLevelProgress/js/adapt-contrib-pageLevelProgress",Adapt$1.pageLevelProgress=new PageLevelProgress);var ResourcesView=__AMD("extensions/adapt-contrib-resources/js/ResourcesView",class ResourcesView extends Backbone.View{className(){return"resources"}initialize(){this.listenTo(Adapt$1,"remove",this.remove);this.render()}events(){return{"click .js-resources-filter-btn-click":"onFilterClicked","click .resources-item-open":"onOpenResource"}}render(){this.$el.html(Handlebars.templates.resources({model:this.model.toJSON(),resources:this.collection.toJSON()}));_.defer((()=>{this.listenTo(Adapt$1,"drawer:triggerCustomView",this.remove)}));return this}onFilterClicked(e){this.$(".js-resources-filter-btn-click").removeClass("is-selected");let items;const filter=$(e.currentTarget).addClass("is-selected").attr("data-filter");if(filter==="all"){items=this.$(".js-resources-item").removeClass("u-display-none")}else{this.$(".js-resources-item").removeClass("u-display-none").not(".is-"+filter).addClass("u-display-none");items=this.$(".js-resources-item.is-"+filter)}if(items.length<0)return;a11y$1.focusFirst($(items[0]))}onOpenResource(evt){var resourceLink=$(evt.currentTarget).attr("data-resource-link");if($(evt.currentTarget).data("shouldopeninpopup")){this.popupWindow(resourceLink,"_blank",window,"600","500")}}popupWindow(url,windowName,win,w,h){const y=win.top.outerHeight/2+win.top.screenY-h/2;const x=win.top.outerWidth/2+win.top.screenX-w/2;return win.open(url,windowName,`toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width=${w}, height=${h}, top=${y}, left=${x}`)}});const helpers={resources_has_type(resources,type,block){const hasType=resources.some(_.matcher({_type:type}));return hasType?block.fn(this):block.inverse(this)},resources_has_multiple_types(resources,block){if(resources.length===1)return block.inverse(this);const allSameType=resources.every(_.matcher({_type:resources[0]._type}));return allSameType?block.inverse(this):block.fn(this)},resources_get_column_count(resources){return _.uniq(_.pluck(resources,"_type")).length+1},resources_force_download(resource,block){if(device$1.browser==="internet explorer"||device$1.OS==="ios"){return block.inverse(this)}return resource._forceDownload||resource.filename?block.fn(this):block.inverse(this)}};for(const name in helpers){Handlebars__default["default"].registerHelper(name,helpers[name])}__AMD("extensions/adapt-contrib-resources/js/ResourcesHelpers",helpers);class Resources extends Backbone.Controller{initialize(){this.listenTo(Adapt$1,"adapt:start",this.initResources)}initResources(){const courseResources=Adapt$1.course.get("_resources");if(!courseResources||courseResources._isEnabled===false)return;const drawerObject={title:courseResources.title,description:courseResources.description,className:"is-resources",drawerOrder:courseResources._drawerOrder||0};drawer.addItem(drawerObject,"resources:showResources");this.setupResources(courseResources)}setupResources(resourcesData){const model=new Backbone.Model(resourcesData);const collection=new Backbone.Collection(model.get("_resourcesItems"));this.listenTo(Adapt$1,"resources:showResources",(()=>{drawer.triggerCustomView(new ResourcesView({model:model,collection:collection}).$el)}))}}__AMD("extensions/adapt-contrib-resources/js/adapt-contrib-resources",new Resources);class Logger{constructor(){this.logArr=[];this.registeredViews=[]}static getInstance(){if(Logger.instance===null){Logger.instance=new Logger}return Logger.instance}getEntries(){return this.logArr}getLastEntry(){return this.logArr[this.logArr.length-1]}info(str){this.logArr[this.logArr.length]={str:str,type:Logger.LOG_TYPE_INFO,time:Date.now()};this.updateViews()}warn(str){this.logArr[this.logArr.length]={str:str,type:Logger.LOG_TYPE_WARN,time:Date.now()};this.updateViews()}error(str){this.logArr[this.logArr.length]={str:str,type:Logger.LOG_TYPE_ERROR,time:Date.now()};this.updateViews()}debug(str){this.logArr[this.logArr.length]={str:str,type:Logger.LOG_TYPE_DEBUG,time:Date.now()};this.updateViews()}registerView(_view){this.registeredViews[this.registeredViews.length]=_view}unregisterView(_view){for(let i=0,l=this.registeredViews.length;i<l;i++){if(this.registeredViews[i]!==_view)continue;this.registeredViews.splice(i,1);i--}}updateViews(){for(let i=0,l=this.registeredViews.length;i<l;i++){if(!this.registeredViews[i])continue;this.registeredViews[i].update(this)}}}Logger.instance=null;Logger.LOG_TYPE_INFO=0;Logger.LOG_TYPE_WARN=1;Logger.LOG_TYPE_ERROR=2;Logger.LOG_TYPE_DEBUG=3;var Logger$1=__AMD("extensions/adapt-contrib-spoor/js/scorm/logger",window.Logger=Logger);class ScormError{constructor(name){let data=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};this.name=name;this.data=data}}ScormError.CLIENT_COULD_NOT_CONNECT="CLIENT_COULD_NOT_CONNECT";ScormError.SERVER_STATUS_UNSUPPORTED="SERVER_STATUS_UNSUPPORTED";ScormError.CLIENT_STATUS_UNSUPPORTED="CLIENT_STATUS_UNSUPPORTED";ScormError.CLIENT_COULD_NOT_COMMIT="CLIENT_COULD_NOT_COMMIT";ScormError.CLIENT_NOT_CONNECTED="CLIENT_NOT_CONNECTED";ScormError.CLIENT_COULD_NOT_FINISH="CLIENT_COULD_NOT_FINISH";ScormError.CLIENT_COULD_NOT_GET_PROPERTY="CLIENT_COULD_NOT_GET_PROPERTY";ScormError.CLIENT_COULD_NOT_SET_PROPERTY="CLIENT_COULD_NOT_SET_PROPERTY";ScormError.CLIENT_INVALID_CHOICE_VALUE="CLIENT_INVALID_CHOICE_VALUE";ScormError.defaultMessages={title:"An error has occurred",pressOk:"Press 'OK' to view detailed debug information to send to technical support.",CLIENT_COULD_NOT_CONNECT:"The course could not connect to the Learning Management System",SERVER_STATUS_UNSUPPORTED:"An invalid lesson status of '{{{status}}}' was received from Learning Management System",CLIENT_STATUS_UNSUPPORTED:"The status '{{{status}}}' is not supported.",CLIENT_COULD_NOT_COMMIT:"There was a problem saving data to the Learning Management System\n\nError: {{errorCode}} - {{{errorInfo}}}\nLMS Error Info: {{{diagnosticInfo}}}",CLIENT_NOT_CONNECTED:"The course is not connected to the Learning Management System",CLIENT_COULD_NOT_FINISH:"The course was unable to terminate the learning session\n\nError: {{errorCode}} - {{{errorInfo}}}\nLMS Error Info: {{{diagnosticInfo}}}",CLIENT_COULD_NOT_GET_PROPERTY:"Unable to get the value of {{property}} from the Learning Management System\n\nError: {{errorCode}} - {{{errorInfo}}}\nLMS Error Info: {{{diagnosticInfo}}}",CLIENT_COULD_NOT_SET_PROPERTY:"Unable to set {{property}} to: '{{{value}}}'\n\nError: {{errorCode}} - {{{errorInfo}}}\nLMS Error Info: {{{diagnosticInfo}}}",CLIENT_INVALID_CHOICE_VALUE:"Numeric choice/matching response elements must use a value from 0 to 35 in SCORM 1.2"};var ScormError$1=__AMD("extensions/adapt-contrib-spoor/js/scorm/error",ScormError);var Connection=__AMD("extensions/adapt-contrib-spoor/js/scorm/Connection",class Connection{constructor(){let{_isEnabled:_isEnabled=true,_silentRetryLimit:_silentRetryLimit=2,_silentRetryDelay:_silentRetryDelay=1e3,_testOnSetValue:_testOnSetValue=true}=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};let ScormWrapper=arguments.length>1?arguments[1]:undefined;this.test=this.test.bind(this);this._isEnabled=_isEnabled;this._isInProgress=false;this._isSilentDisconnection=false;this._isDisconnected=false;this._silentRetryLimit=_silentRetryLimit;this._silentRetryDelay=_silentRetryDelay;this._silentRetryTimeout=null;this._silentRetryCount=0;this._testOnSetValue=_testOnSetValue;this._scorm=ScormWrapper}async test(){if(!this._isEnabled||this._isInProgress)return;this._isInProgress=true;try{const response=await fetch(`connection.txt?nocache=${Date.now()}`);if(response?.ok)return this.onConnectionSuccess()}catch(err){}this.onConnectionError()}async testOnSetValue(){if(!this._isEnabled||!this._testOnSetValue)return;return this.test()}reset(){this._silentRetryCount=0;this._isSilentDisconnection=false;if(this._silentRetryTimeout===null)return;window.clearTimeout(this._silentRetryTimeout);this._silentRetryTimeout=null}stop(){this.reset();this._isEnabled=false}onConnectionSuccess(){if(this._isDisconnected){this._scorm.commit();if(!this._isSilentDisconnection)Adapt$1.trigger("tracking:connectionSuccess")}this._isInProgress=false;this._isDisconnected=false;this.reset()}onConnectionError(){if(!this._isEnabled)return;this._isInProgress=false;this._isDisconnected=true;if(this._silentRetryCount<this._silentRetryLimit){this._isSilentDisconnection=true;this._silentRetryCount++;this._silentRetryTimeout=window.setTimeout(this.test,this._silentRetryDelay);return}this.reset();this._scorm.handleConnectionError(this.test)}});const{CLIENT_COULD_NOT_CONNECT:CLIENT_COULD_NOT_CONNECT,SERVER_STATUS_UNSUPPORTED:SERVER_STATUS_UNSUPPORTED,CLIENT_STATUS_UNSUPPORTED:CLIENT_STATUS_UNSUPPORTED,CLIENT_COULD_NOT_COMMIT:CLIENT_COULD_NOT_COMMIT,CLIENT_NOT_CONNECTED:CLIENT_NOT_CONNECTED,CLIENT_COULD_NOT_FINISH:CLIENT_COULD_NOT_FINISH,CLIENT_COULD_NOT_GET_PROPERTY:CLIENT_COULD_NOT_GET_PROPERTY,CLIENT_COULD_NOT_SET_PROPERTY:CLIENT_COULD_NOT_SET_PROPERTY,CLIENT_INVALID_CHOICE_VALUE:CLIENT_INVALID_CHOICE_VALUE}=ScormError$1;class ScormWrapper{constructor(){this.setCompletedWhenFailed=true;this.commitOnStatusChange=true;this.commitOnAnyChange=false;this.timedCommitFrequency=10;this.maxCommitRetries=5;this.commitRetryDelay=1e3;this.commitRetryPending=false;this.commitRetries=0;this.lastCommitSuccessTime=null;this.exitStateIfIncomplete="auto";this.exitStateIfComplete="auto";this.timedCommitIntervalID=null;this.retryCommitTimeoutID=null;this.logOutputWin=null;this.startTime=null;this.endTime=null;this.lmsConnected=false;this.finishCalled=false;this.logger=Logger$1.getInstance();this.scorm=pipwerks__default["default"].SCORM;this.scorm.handleExitMode=false;this.suppressErrors=false;this.commit=this.commit.bind(this);this.doRetryCommit=this.doRetryCommit.bind(this);this.debouncedCommit=_.debounce(this.commit,100);if(window.__debug)this.showDebugWindow();this._connection=null;if(!(window.API?.__offlineAPIWrapper&&window?.API_1484_11?.__offlineAPIWrapper))return;this.logger.error("Offline SCORM API is being used. No data will be reported to the LMS!")}static getInstance(){if(ScormWrapper.instance===null){ScormWrapper.instance=new ScormWrapper}return ScormWrapper.instance}getVersion(){return this.scorm.version}setVersion(value){this.logger.debug(`ScormWrapper::setVersion: ${value}`);this.scorm.version=value}initialize(settings){if(settings){if(settings._showDebugWindow){this.showDebugWindow()}this.setVersion(settings._scormVersion||"1.2");if(_.isBoolean(settings._suppressErrors)){this.suppressErrors=settings._suppressErrors}if(_.isBoolean(settings._commitOnStatusChange)){this.commitOnStatusChange=settings._commitOnStatusChange}if(_.isBoolean(settings._commitOnAnyChange)){this.commitOnAnyChange=settings._commitOnAnyChange}if(_.isFinite(settings._timedCommitFrequency)){this.timedCommitFrequency=settings._timedCommitFrequency}if(_.isFinite(settings._maxCommitRetries)){this.maxCommitRetries=settings._maxCommitRetries}if(_.isFinite(settings._commitRetryDelay)){this.commitRetryDelay=settings._commitRetryDelay}if("_exitStateIfIncomplete"in settings){this.exitStateIfIncomplete=settings._exitStateIfIncomplete}if("_exitStateIfComplete"in settings){this.exitStateIfComplete=settings._exitStateIfComplete}if(_.isBoolean(settings._setCompletedWhenFailed)){this.setCompletedWhenFailed=settings._setCompletedWhenFailed}}this.logger.debug("ScormWrapper::initialize");this.lmsConnected=this.scorm.init();if(!this.lmsConnected){this.handleInitializeError();return this.lmsConnected}if(settings?._connectionTest?._isEnabled!==false){this._connection=new Connection(settings?._connectionTest,this)}this.startTime=new Date;this.initTimedCommit();return this.lmsConnected}isFirstSession(){return this.getValue(this.isSCORM2004()?"cmi.entry":"cmi.core.entry")==="ab-initio"}setIncomplete(){this.setValue(this.isSCORM2004()?"cmi.completion_status":"cmi.core.lesson_status","incomplete");if(this.commitOnStatusChange&&!this.commitOnAnyChange)this.commit()}setCompleted(){this.setValue(this.isSCORM2004()?"cmi.completion_status":"cmi.core.lesson_status","completed");if(this.commitOnStatusChange&&!this.commitOnAnyChange)this.commit()}setPassed(){if(this.isSCORM2004()){this.setValue("cmi.completion_status","completed");this.setValue("cmi.success_status","passed")}else{this.setValue("cmi.core.lesson_status","passed")}if(this.commitOnStatusChange&&!this.commitOnAnyChange)this.commit()}setFailed(){if(this.isSCORM2004()){this.setValue("cmi.success_status","failed");if(this.setCompletedWhenFailed){this.setValue("cmi.completion_status","completed")}}else{this.setValue("cmi.core.lesson_status","failed")}if(this.commitOnStatusChange&&!this.commitOnAnyChange)this.commit()}getStatus(){const status=this.getValue(this.isSCORM2004()?"cmi.completion_status":"cmi.core.lesson_status");switch(status.toLowerCase()){case"passed":case"completed":case"incomplete":case"failed":case"browsed":case"not attempted":case"not_attempted":case"unknown":return status;default:this.handleDataError(new ScormError$1(SERVER_STATUS_UNSUPPORTED,{status:status}));return null}}setStatus(status){switch(status.toLowerCase()){case"incomplete":this.setIncomplete();break;case"completed":this.setCompleted();break;case"passed":this.setPassed();break;case"failed":this.setFailed();break;default:this.handleDataError(new ScormError$1(CLIENT_STATUS_UNSUPPORTED,{status:status}))}}getScore(){return this.getValue(this.isSCORM2004()?"cmi.score.raw":"cmi.core.score.raw")}setScore(score){let minScore=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;let maxScore=arguments.length>2&&arguments[2]!==undefined?arguments[2]:100;let isPercentageBased=arguments.length>3&&arguments[3]!==undefined?arguments[3]:true;if(this.isSCORM2004()){this.setValue("cmi.score.raw",score);this.setValue("cmi.score.min",minScore);this.setValue("cmi.score.max",maxScore);const range=score<0?Math.abs(minScore):maxScore;const scaledScore=score/range;this.setValue("cmi.score.scaled",scaledScore.toFixed(7));return}if(isPercentageBased){score=score<0?0:Math.round(score/maxScore*100);minScore=0;maxScore=100}else{const validate=(attribute,value)=>{const isValid=value>=0&&score<=100;if(!isValid)this.logger.warn(`${attribute} must be between 0-100.`)};validate("cmi.core.score.raw",score);validate("cmi.core.score.min",minScore);validate("cmi.core.score.max",maxScore)}this.setValue("cmi.core.score.raw",score);if(this.isSupported("cmi.core.score.min"))this.setValue("cmi.core.score.min",minScore);if(this.isSupported("cmi.core.score.max"))this.setValue("cmi.core.score.max",maxScore)}getLessonLocation(){return this.getValue(this.isSCORM2004()?"cmi.location":"cmi.core.lesson_location")}setLessonLocation(location){this.setValue(this.isSCORM2004()?"cmi.location":"cmi.core.lesson_location",location)}getSuspendData(){return this.getValue("cmi.suspend_data")}setSuspendData(data){this.setValue("cmi.suspend_data",data)}getStudentName(){return this.getValue(this.isSCORM2004()?"cmi.learner_name":"cmi.core.student_name")}getStudentId(){return this.getValue(this.isSCORM2004()?"cmi.learner_id":"cmi.core.student_id")}setLanguage(lang){if(this.isSCORM2004()){this.setValue("cmi.learner_preference.language",lang);return}if(!this.isSupported("cmi.student_preference.language"))return;this.setValue("cmi.student_preference.language",lang)}commit(){this.logger.debug("ScormWrapper::commit");if(!this.lmsConnected){this.handleConnectionError();return}if(this.commitRetryPending){this.logger.debug("ScormWrapper::commit: skipping this commit call as one is already pending.");return}if(this.scorm.save()){this.commitRetries=0;this.lastCommitSuccessTime=new Date;if(this._connection)this._connection.test();Adapt$1.trigger("spoor:commit",this);return}if(this.commitRetries<this.maxCommitRetries&&!this.finishCalled){this.commitRetries++;this.initRetryCommit();return}const errorCode=this.scorm.debug.getCode();this.handleDataError(new ScormError$1(CLIENT_COULD_NOT_COMMIT,{errorCode:errorCode,errorInfo:this.scorm.debug.getInfo(errorCode),diagnosticInfo:this.scorm.debug.getDiagnosticInfo(errorCode)}))}finish(){this.logger.debug("ScormWrapper::finish");if(!this.lmsConnected||this.finishCalled){this.handleConnectionError();return}this.finishCalled=true;if(this.timedCommitIntervalID!==null){window.clearInterval(this.timedCommitIntervalID)}if(this.commitRetryPending){window.clearTimeout(this.retryCommitTimeoutID);this.commitRetryPending=false}if(this.logOutputWin&&!this.logOutputWin.closed){this.logOutputWin.close()}this.endTime=new Date;if(this.isSCORM2004()){this.scorm.set("cmi.session_time",this.convertToSCORM2004Time(this.endTime.getTime()-this.startTime.getTime()));this.scorm.set("cmi.exit",this.getExitState())}else{this.scorm.set("cmi.core.session_time",this.convertToSCORM12Time(this.endTime.getTime()-this.startTime.getTime()));this.scorm.set("cmi.core.exit",this.getExitState())}if(this._connection){this._connection.stop();this._connection=null}this.lmsConnected=false;if(this.scorm.quit())return;const errorCode=this.scorm.debug.getCode();this.handleFinishError(new ScormError$1(CLIENT_COULD_NOT_FINISH,{errorCode:errorCode,errorInfo:this.scorm.debug.getInfo(errorCode),diagnosticInfo:this.scorm.debug.getDiagnosticInfo(errorCode)}))}recordInteraction(id,response,correct,latency,type){if(!this.isSupported("cmi.interactions._count")){this.logger.info("ScormWrapper::recordInteraction: cmi.interactions are not supported by this LMS...");return}switch(type){case"choice":this.recordInteractionMultipleChoice.apply(this,arguments);break;case"matching":this.recordInteractionMatching.apply(this,arguments);break;case"numeric":this.isSCORM2004()?this.recordInteractionScorm2004.apply(this,arguments):this.recordInteractionScorm12.apply(this,arguments);break;case"fill-in":this.recordInteractionFillIn.apply(this,arguments);break;default:console.error(`ScormWrapper.recordInteraction: unknown interaction type of '${type}' encountered...`)}}getValue(property){this.logger.debug(`ScormWrapper::getValue: _property=${property}`);if(this.finishCalled){this.logger.debug("ScormWrapper::getValue: ignoring request as 'finish' has been called");return}if(!this.lmsConnected){this.handleConnectionError();return}const value=this.scorm.get(property);const errorCode=this.scorm.debug.getCode();switch(errorCode){case 0:break;case 403:this.logger.warn("ScormWrapper::getValue: data model element not initialized");break;default:this.handleDataError(new ScormError$1(CLIENT_COULD_NOT_GET_PROPERTY,{property:property,errorCode:errorCode,errorInfo:this.scorm.debug.getInfo(errorCode),diagnosticInfo:this.scorm.debug.getDiagnosticInfo(errorCode)}))}this.logger.debug(`ScormWrapper::getValue: returning ${value}`);return value+""}setValue(property,value){this.logger.debug(`ScormWrapper::setValue: _property=${property} _value=${value}`);if(this.finishCalled){this.logger.debug("ScormWrapper::setValue: ignoring request as 'finish' has been called");return}if(!this.lmsConnected){this.handleConnectionError();return}const success=this.scorm.set(property,value);if(success){this._connection?.testOnSetValue()}else{const errorCode=this.scorm.debug.getCode();if(errorCode!==0){this.handleDataError(new ScormError$1(CLIENT_COULD_NOT_SET_PROPERTY,{property:property,value:value,errorCode:errorCode,errorInfo:this.scorm.debug.getInfo(errorCode),diagnosticInfo:this.scorm.debug.getDiagnosticInfo(errorCode)}));return success}this.logger.warn("ScormWrapper::setValue: LMS reported that the 'set' call failed but then said there was no error!")}if(this.commitOnAnyChange)this.debouncedCommit();return success}isSupported(property){this.logger.debug(`ScormWrapper::isSupported: _property=${property}`);if(this.finishCalled){this.logger.debug("ScormWrapper::isSupported: ignoring request as 'finish' has been called");return}if(!this.lmsConnected){this.handleConnectionError();return false}this.scorm.get(property);return this.scorm.debug.getCode()!==401}initTimedCommit(){this.logger.debug("ScormWrapper::initTimedCommit");if(!this.commitOnAnyChange&&this.timedCommitFrequency>0){const delay=this.timedCommitFrequency*(60*1e3);this.timedCommitIntervalID=window.setInterval(this.commit,delay)}}initRetryCommit(){this.logger.debug(`ScormWrapper::initRetryCommit ${this.commitRetries} out of ${this.maxCommitRetries}`);this.commitRetryPending=true;this.retryCommitTimeoutID=window.setTimeout(this.doRetryCommit,this.commitRetryDelay)}doRetryCommit(){this.logger.debug("ScormWrapper::doRetryCommit");this.commitRetryPending=false;this.commit()}async handleInitializeError(){if(!data$1.isReady)await data$1.whenReady();Adapt$1.trigger("tracking:initializeError");_.defer((()=>this.handleError(new ScormError$1(CLIENT_COULD_NOT_CONNECT))))}handleConnectionError(){let callback=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;Adapt$1.trigger("tracking:connectionError",callback);this.handleError(new ScormError$1(CLIENT_NOT_CONNECTED))}handleDataError(error){Adapt$1.trigger("tracking:dataError");this.handleError(error)}handleFinishError(error){Adapt$1.trigger("tracking:terminationError");this.handleError(error)}handleError(error){if("value"in error.data){if(error.data.value.length&&error.data.value.length>80)error.data.value=error.data.value.slice(0,80)+"...";if(error.data.value==="")error.data.value="''"}const config=Adapt$1.course.get("_spoor");const messages=Object.assign({},ScormError$1.defaultMessages,config&&config._messages);const message=Handlebars.compile(messages[error.name])(error.data);switch(error.name){case CLIENT_COULD_NOT_CONNECT:if(!notify$1.isOpen){wait$1.begin();$(".js-loading").hide();notify$1.popup({_isCancellable:false,title:messages.title,body:message})}}this.logger.error(message);if(!this.suppressErrors&&(!this.logOutputWin||this.logOutputWin.closed)&&confirm(`${messages.title}:\n\n${message}\n\n${messages.pressOk}`)){this.showDebugWindow()}}getInteractionCount(){const count=this.getValue("cmi.interactions._count");return count===""?0:count}recordInteractionScorm12(id,response,correct,latency,type){id=id.trim();const cmiPrefix=`cmi.interactions.${this.getInteractionCount()}`;this.setValue(`${cmiPrefix}.id`,id);this.setValue(`${cmiPrefix}.type`,type);this.setValue(`${cmiPrefix}.student_response`,response);this.setValue(`${cmiPrefix}.result`,correct?"correct":"wrong");if(latency!==null&&latency!==undefined)this.setValue(`${cmiPrefix}.latency`,this.convertToSCORM12Time(latency));this.setValue(`${cmiPrefix}.time`,this.getCMITime())}recordInteractionScorm2004(id,response,correct,latency,type){id=id.trim();const cmiPrefix=`cmi.interactions.${this.getInteractionCount()}`;this.setValue(`${cmiPrefix}.id`,id);this.setValue(`${cmiPrefix}.type`,type);this.setValue(`${cmiPrefix}.learner_response`,response);this.setValue(`${cmiPrefix}.result`,correct?"correct":"incorrect");if(latency!==null&&latency!==undefined)this.setValue(`${cmiPrefix}.latency`,this.convertToSCORM2004Time(latency));this.setValue(`${cmiPrefix}.timestamp`,this.getISO8601Timestamp())}recordInteractionMultipleChoice(id,response,correct,latency,type){if(this.isSCORM2004()){response=response.replace(/,|#/g,"[,]")}else{response=response.replace(/#/g,",");response=this.checkResponse(response,"choice")}const scormRecordInteraction=this.isSCORM2004()?this.recordInteractionScorm2004:this.recordInteractionScorm12;scormRecordInteraction.call(this,id,response,correct,latency,type)}recordInteractionMatching(id,response,correct,latency,type){response=response.replace(/#/g,",");if(this.isSCORM2004()){response=response.replace(/,/g,"[,]");response=response.replace(/\./g,"[.]")}else{response=this.checkResponse(response,"matching")}const scormRecordInteraction=this.isSCORM2004()?this.recordInteractionScorm2004:this.recordInteractionScorm12;scormRecordInteraction.call(this,id,response,correct,latency,type)}recordInteractionFillIn(id,response,correct,latency,type){const maxLength=this.isSCORM2004()?250:255;if(response.length>maxLength){response=response.substr(0,maxLength);this.logger.warn(`ScormWrapper::recordInteractionFillIn: response data for ${id} is longer than the maximum allowed length of ${maxLength} characters; data will be truncated to avoid an error.`)}const scormRecordInteraction=this.isSCORM2004()?this.recordInteractionScorm2004:this.recordInteractionScorm12;scormRecordInteraction.call(this,id,response,correct,latency,type)}showDebugWindow(){if(this.logOutputWin&&!this.logOutputWin.closed){this.logOutputWin.close()}this.logOutputWin=window.open("log_output.html","Log","width=600,height=300,status=no,scrollbars=yes,resizable=yes,menubar=yes,toolbar=yes,location=yes,top=0,left=0");if(!this.logOutputWin)return;this.logOutputWin.focus()}convertToSCORM12Time(msConvert){const msPerSec=1e3;const msPerMin=msPerSec*60;const msPerHour=msPerMin*60;const ms=msConvert%msPerSec;msConvert=msConvert-ms;let secs=msConvert%msPerMin;msConvert=msConvert-secs;secs=secs/msPerSec;let mins=msConvert%msPerHour;msConvert=msConvert-mins;mins=mins/msPerMin;const hrs=msConvert/msPerHour;if(hrs>9999){return"9999:99:99.99"}const str=[this.padWithZeroes(hrs,4),this.padWithZeroes(mins,2),this.padWithZeroes(secs,2)].join(":");return`${str}.${Math.floor(ms/10)}`}convertToSCORM2004Time(msConvert){let csConvert=Math.floor(msConvert/10);const csPerSec=100;const csPerMin=csPerSec*60;const csPerHour=csPerMin*60;const csPerDay=csPerHour*24;let days=Math.floor(csConvert/csPerDay);csConvert-=days*csPerDay;days=days?days+"D":"";let hours=Math.floor(csConvert/csPerHour);csConvert-=hours*csPerHour;hours=hours?hours+"H":"";let mins=Math.floor(csConvert/csPerMin);csConvert-=mins*csPerMin;mins=mins?mins+"M":"";let secs=Math.floor(csConvert/csPerSec);csConvert-=secs*csPerSec;secs=secs||"0";let cs=csConvert;cs=cs?"."+cs:"";const seconds=secs+cs+"S";const hms=[hours,mins,seconds].join("");return"P"+days+"T"+hms}getCMITime(){const date=new Date;const hours=this.padWithZeroes(date.getHours(),2);const min=this.padWithZeroes(date.getMinutes(),2);const sec=this.padWithZeroes(date.getSeconds(),2);return[hours,min,sec].join(":")}getISO8601Timestamp(){const date=(new Date).toISOString();return date.replace(/.\d\d\dZ/,"")}padWithZeroes(numToPad,padBy){let len=padBy;while(--len){numToPad="0"+numToPad}return numToPad.slice(-padBy)}isSCORM2004(){return this.scorm.version==="2004"}checkResponse(response,responseType){if(!response)return response;if(responseType!=="choice"&&responseType!=="matching")return response;response=response.split(/,|#/);const self=this;if(responseType==="choice"){response=response.map(checkIdentifier)}else{response=response.map((r=>{const identifiers=r.split(".");return checkIdentifier(identifiers[0])+"."+checkIdentifier(identifiers[1])}))}function checkIdentifier(r){if(r.length===1&&r>="0"&&r<="9")return r;if(r.length===1&&r>="a"&&r<="z")return r;const i=parseInt(r);if(isNaN(i)||i<10||i>35){self.handleError(new ScormError$1(CLIENT_INVALID_CHOICE_VALUE))}return Number(i).toString(36)}return response.join(",")}getExitState(){const completionStatus=this.scorm.data.completionStatus;const isIncomplete=completionStatus==="incomplete"||completionStatus==="not attempted";const exitState=isIncomplete?this.exitStateIfIncomplete:this.exitStateIfComplete;if(exitState!=="auto")return exitState;if(this.isSCORM2004())return isIncomplete?"suspend":"normal";return""}}ScormWrapper.instance=null;var ScormWrapper$1=__AMD("extensions/adapt-contrib-spoor/js/scorm/wrapper",ScormWrapper);const LZMAWorker=window.LZMAFactory("./libraries/lzma_worker-min.js");const ZeroString={};function makeZeroString(length){ZeroString[length]=ZeroString[length]||new Array(length+1).join("0");return ZeroString[length]}for(let i=1,l=64;i<=l;i++){makeZeroString(i)}function zeroPadRightToLength(string,length){const padLength=length-string.length;if(padLength>0){string+=makeZeroString(padLength)}return string}function zeroPadLeftToLength(string,length){const padLength=length-string.length;if(padLength>0){string=makeZeroString(padLength)+string}return string}function zeroPadRightToMultiple(string,multiple){const padLength=multiple-string.length%multiple;if(padLength!==multiple){string+=makeZeroString(padLength)}return string}function binaryToUnsignedInteger(binary,binaryLength){if(binaryLength===0){return 0}binary=zeroPadLeftToLength(binary,binaryLength);const integer=parseInt(binary.slice(0,binaryLength),2);return integer}function shiftUnsignedIntegerFromBinary(binary,binaryLength){if(binaryLength===0){return[0,binary]}binary=zeroPadLeftToLength(binary,binaryLength);const integer=parseInt(binary.slice(0,binaryLength),2);binary=binary.slice(binaryLength);return[integer,binary]}function shiftBinary(binary,binaryLength){if(binaryLength===0){return["",binary]}binary=zeroPadLeftToLength(binary,binaryLength);const shifted=binary.slice(0,binaryLength);binary=binary.slice(binaryLength);return[shifted,binary]}function unsignedIntegerToBinary(integer,binaryLength){if(binaryLength===0){return""}let binary=Math.abs(integer).toString(2);if(typeof binaryLength==="undefined"){return binary}const length=binary.length;if(length>binaryLength){throw new Error(`Integer too big for specified binary length. integer: ${integer} binarylen: ${binaryLength}`)}binary=zeroPadLeftToLength(binary,binaryLength);return binary}function byteArrayToString(array){const arrayLength=array.length;let string=new Array(arrayLength);for(let i=0,l=arrayLength;i<l;i++){string[i]=String.fromCharCode(array[i])}string=string.join("");return string}function stringToByteArray(string){const stringLength=string.length;const array=new Array(stringLength);for(let i=0,l=stringLength;i<l;i++){array[i]=string.charCodeAt(i)}return array}const BYTE_BIT_LENGTH=8;function binaryToBase64(binary){binary=___default["default"].flatten(binary).join("");binary=zeroPadRightToMultiple(binary,BYTE_BIT_LENGTH);const bytesCount=binary.length/BYTE_BIT_LENGTH;const charCodes=new Array(bytesCount);for(let i=0,l=bytesCount;i<l;i++){[charCodes[i],binary]=shiftUnsignedIntegerFromBinary(binary,BYTE_BIT_LENGTH)}let base64=btoa(byteArrayToString(charCodes));base64=base64.replace(/=/g,"");base64=base64.replace(/\+/g,"-");return base64}function base64ToBinary(base64){base64=base64.replace(/-/g,"+");const charCodes=stringToByteArray(atob(base64));const bytesCount=charCodes.length;let binary=new Array(bytesCount);for(let i=0,l=bytesCount;i<l;i++){binary[i]=unsignedIntegerToBinary(charCodes[i],BYTE_BIT_LENGTH)}binary=binary.join("");return binary}const logs={usedTypes:{},typeLengths:{},binarySamples:{}};class AbstractValueType{constructor(options){Object.assign(this,options);this.binaryTypeLength=this.binaryType.length}log(binary){const name=this.name;logs.usedTypes[name]=logs.usedTypes[name]||0;logs.usedTypes[name]++;logs.binarySamples[name]=logs.binarySamples[name]||[];logs.binarySamples[name].push(binary)}}class FixedIntegerType extends AbstractValueType{constructor(options){super(options);this.esType="number";if(!this.valueBinaryLength){return}this.minValue=options.minValue||0;this.maxValue=options.maxValue||Math.pow(2,this.valueBinaryLength)-1}valueToBinary(integer){let logStats=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;let binary=unsignedIntegerToBinary(integer,this.valueBinaryLength);if(logStats){this.log(binary)}binary=[binary];return binary}shiftValueFromBinary(binary){let integer;[integer,binary]=shiftUnsignedIntegerFromBinary(binary,this.valueBinaryLength);return[integer,binary]}}class FixedBooleanType extends FixedIntegerType{constructor(options){options.valueBinaryLength=1;super(options);this.esType="boolean"}shiftValueFromBinary(binary){const bool=binary[0]==="1";binary=binary.slice(1);return[bool,binary]}}class LengthAndValueBinary{constructor(parent,name,bitSizes){this.parent=parent;this.name=name;this.bitSizes=bitSizes;this.maxValues=___default["default"].flatten(this.bitSizes).map((value=>Math.pow(2,value)-1));this.maxValue=this.maxValues[this.maxValues.length-1];this.sizeBinaryLength=unsignedIntegerToBinary(this.bitSizes.length-1).length}valueToBinary(integer){let logStats=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;const parentName=this.parent.name;const sizeIndex=this.maxValues.findIndex((maxValue=>integer<=maxValue));if(sizeIndex===-1){throw new Error(`Value is too large for type: ${parentName} value: ${integer} max: ${this.maxValue}`)}const sizeBinary=unsignedIntegerToBinary(sizeIndex,this.sizeBinaryLength);const valueLength=this.bitSizes[sizeIndex];const name=this.name;if(logStats){logs.typeLengths[parentName]=logs.typeLengths[parentName]||{};logs.typeLengths[parentName][name]=logs.typeLengths[parentName][name]||{};logs.typeLengths[parentName][name][valueLength]=logs.typeLengths[parentName][name][valueLength]||0;logs.typeLengths[parentName][name][valueLength]++}const integerBinary=unsignedIntegerToBinary(integer,valueLength);const binary=[sizeBinary,integerBinary];return binary}shiftValueFromBinary(binary){let sizeBinary;[sizeBinary,binary]=shiftBinary(binary,this.sizeBinaryLength);const sizeIndex=binaryToUnsignedInteger(sizeBinary);const valueLength=this.bitSizes[sizeIndex];let integer;[integer,binary]=shiftUnsignedIntegerFromBinary(binary,valueLength);return[integer,binary]}}class VariableIntegerType extends FixedIntegerType{constructor(options){super(options);this.isNegative=this.minValue<0&&this.maxValue===0;this.integer=new LengthAndValueBinary(this,"integer",options.integerBitSizes)}valueToBinary(integer){let logStats=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;integer=integer.toFixed(0);const binary=this.integer.valueToBinary(Math.abs(integer),logStats);if(logStats){this.log(binary)}return binary}shiftValueFromBinary(binary){let integer;[integer,binary]=this.integer.shiftValueFromBinary(binary);if(this.isNegative){integer=-integer}return[integer,binary]}}class VariableArrayType extends VariableIntegerType{constructor(options){super(options);this.esType="array"}valueToBinary(array){let logStats=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;const arrayLength=array.length;const binary=super.valueToBinary(arrayLength);if(arrayLength){const valueType=findValueTypeFromValues(array);binary.push(valueType.binaryType);binary.type=valueType.name;binary.push(array.map((value=>valueType.valueToBinary(value,logStats))))}if(logStats){this.log(binary)}return binary}shiftValueFromBinary(binary){let arrayLength;[arrayLength,binary]=super.shiftValueFromBinary(binary);const value=new Array(arrayLength);if(arrayLength){let valueType;[valueType,binary]=shiftValueTypeFromBinary(binary);for(let i=0,l=arrayLength;i<l;i++){[value[i],binary]=valueType.shiftValueFromBinary(binary)}}return[value,binary]}}class VariableSignedIntegerType extends VariableIntegerType{valueToBinary(integer){let logStats=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;integer=integer.toFixed(0);const isNegative=integer<0;const signBinary=isNegative?"1":"0";const integerBinary=this.integer.valueToBinary(Math.abs(integer),logStats);const binary=[signBinary,integerBinary];if(logStats){this.log(binary)}return binary}shiftValueFromBinary(binary){let isNegative;[isNegative,binary]=shiftUnsignedIntegerFromBinary(binary,1);let integer;[integer,binary]=this.integer.shiftValueFromBinary(binary);if(isNegative){integer=-integer}return[integer,binary]}}class VariableDecimalType extends VariableIntegerType{constructor(options){super(options);this.isFloat=true;this.decimal=new LengthAndValueBinary(this,"decimal",options.decimalBitSizes)}valueToBinary(float){let logStats=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;float=float.toFixed(2);const isNegative=float<0;float=Math.abs(float);const parts=String(float).split(".");const higherInteger=parseInt(parts[0]);const lowerInteger=parseInt(zeroPadRightToLength(parts[1]||0,2));const signBinary=isNegative?"1":"0";const integerValueBinary=this.integer.valueToBinary(higherInteger,logStats);const decimalValueBinary=this.decimal.valueToBinary(lowerInteger,logStats);const binary=[signBinary,integerValueBinary,decimalValueBinary];if(logStats){this.log(binary)}return binary}shiftValueFromBinary(binary){let isNegative;[isNegative,binary]=shiftUnsignedIntegerFromBinary(binary,1);let higherInteger;[higherInteger,binary]=this.integer.shiftValueFromBinary(binary);let lowerInteger;[lowerInteger,binary]=this.decimal.shiftValueFromBinary(binary);lowerInteger=zeroPadLeftToLength(String(lowerInteger),2);let float=parseFloat(higherInteger+"."+lowerInteger);if(isNegative){float=-float}return[float,binary]}}const arrayType=new VariableArrayType({name:"array",binaryType:"10",integerBitSizes:[4,16]});const booleanType=new FixedBooleanType({name:"boolean",binaryType:"0"});const integerTypes=[new FixedIntegerType({name:"uint3",binaryType:"1110",valueBinaryLength:3}),new VariableIntegerType({name:"vint8+",binaryType:"110",minValue:0,maxValue:255,integerBitSizes:[2,8]}),new VariableIntegerType({name:"vint8-",binaryType:"111100",minValue:-255,maxValue:0,integerBitSizes:[2,8]}),new VariableSignedIntegerType({name:"sint32",binaryType:"111110",minValue:-4294967295,maxValue:4294967295,integerBitSizes:[2,4,16,32]})];const decimalTypes=[new VariableDecimalType({name:"sdec15",binaryType:"111101",minValue:-255.99,maxValue:255.99,integerBitSizes:[2,8],decimalBitSizes:[0,7]}),new VariableDecimalType({name:"sdec39",binaryType:"111111",minValue:-4294967295.99,maxValue:4294967295.99,integerBitSizes:[2,4,16,32],decimalBitSizes:[0,7]})];const ValueTypes=[booleanType,arrayType].concat(integerTypes).concat(decimalTypes);ValueTypes.nameIndex={};ValueTypes.forEach((valueType=>ValueTypes.nameIndex[valueType.name]=valueType));function esTypeOf(value){if(Array.isArray(value)){return"array"}if(value===null){return"null"}return typeof value}function findValueTypeFromName(name){return ValueTypes.nameIndex[name.toLowerCase()]}function findValueTypeFromValue(value){const esType=esTypeOf(value);switch(esType){case"array":return arrayType;case"boolean":return booleanType}value=value.toFixed(2);const isFloat=!Number.isInteger(value);const isValueInValueTypeRange=valueType=>value>=valueType.minValue&&value<=valueType.maxValue;const valueType=isFloat?decimalTypes.find(isValueInValueTypeRange):integerTypes.find(isValueInValueTypeRange);if(!valueType){throw new Error(`Cannot find type from value: ${value}`)}return valueType}function findValueTypeFromValues(values){if(!values.length){return}let minValue=0;let maxValue=0;let isFloat=false;const esTypes=values.map((value=>{const valueType=findValueTypeFromValue(value);if(valueType.esType==="number"){minValue=Math.min(value,minValue);maxValue=Math.max(value,maxValue);isFloat=isFloat||!Number.isInteger(value)}return valueType.esType}));const uniqESTypes=[...new Set(esTypes)];if(uniqESTypes.length>1){throw new Error(`Cannot resolve array to one type: ${uniqESTypes.join()}`)}const esType=uniqESTypes[0];switch(esType){case"array":return arrayType;case"boolean":return booleanType}const isRangeInValueTypeRange=valueType=>minValue>=valueType.minValue&&maxValue<=valueType.maxValue;const valueType=isFloat?decimalTypes.find(isRangeInValueTypeRange):integerTypes.find(isRangeInValueTypeRange);if(!valueType){throw new Error(`Cannot find type from value. min: ${minValue} max: ${maxValue} isfloat: ${isFloat}`)}return valueType}function shiftValueTypeFromBinary(binary){const valueType=ValueTypes.find((valueType=>{const binaryType=binary.slice(0,valueType.binaryTypeLength);return binaryType===valueType.binaryType}));if(!valueType){throw new Error(`Cannot find type from binary: ${binary.slice(0,6)}...`)}binary=binary.slice(valueType.binaryTypeLength);return[valueType,binary]}function convertValuesToNumbers(value){const esType=esTypeOf(value);switch(esType){case"array":return value.map(convertValuesToNumbers);case"undefined":case"null":return value?1:0;case"boolean":case"number":return value}throw new Error(`Cannot convert ${esType} to number`)}class Converter{getInvalidTypeError(value){try{value=convertValuesToNumbers(value);esTypeOf(value)==="array"?findValueTypeFromValues(value):findValueTypeFromValue(value);return}catch(err){return err}}valueToBinary(value){let typeName=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;let logStats=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;this.clearLog();const hasInitialType=typeof typeName==="string";value=convertValuesToNumbers(value);const valueType=hasInitialType?findValueTypeFromName(typeName):findValueTypeFromValue(value);if(!valueType){throw new Error(`Could not find value type from ${hasInitialType?`name ${typeName}`:`value ${value}`} accepts: ${Object.keys(ValueTypes.nameIndex)}. Leave typeName empty for auto-detect.`)}const binary=valueType.valueToBinary(value,logStats);if(!hasInitialType){binary.unshift(valueType.binaryType)}if(logStats){this.printLog()}return binary}valueFromBinary(binary){let typeName=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;binary=___default["default"].flatten(binary).join("");const hasInitialType=typeof typeName==="string";let valueType;if(hasInitialType){valueType=findValueTypeFromName(typeName)}else{[valueType,binary]=shiftValueTypeFromBinary(binary)}if(!valueType||!(valueType instanceof AbstractValueType)){throw new Error(`Could not find value type from ${hasInitialType?`name "${typeName}"`:`binary "${binary.slice(0,8)}"...`} accepts: ${Object.keys(ValueTypes.nameIndex)}. Leave typeName empty for auto-detect.`)}const[value]=valueType.shiftValueFromBinary(binary);return value}clearLog(){logs.usedTypes={};logs.typeLengths={};logs.binarySamples={}}printLog(){console.log("Types used count:",logs.usedTypes);console.log("Type lengths used count:",logs.typeLengths);console.log("Type binary samples:",logs.binarySamples)}serialize(value){let typeName=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;let logStats=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;const binary=this.valueToBinary(value,typeName,logStats);const base64=binaryToBase64(binary);return base64}async serializeAsync(value){const binary=this.valueToBinary(value,null,null);const base64=binaryToBase64(binary);const isLargeArray=Array.isArray(value)&&value.length>10;if(isLargeArray){return new Promise((resolve=>{LZMAWorker.compress(JSON.stringify(value),1,(data=>{const compressedBase64=`#${window.btoa(data.map((i=>String.fromCharCode(i+128))).join("")).replace(/=/g,"")}`;const isCompressedSmaller=compressedBase64.length<base64.length;if(isCompressedSmaller)return resolve(compressedBase64);return resolve(base64)}))}))}return base64}deserialize(base64){let typeName=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;const isLZMACompressed=base64[0]==="#";if(isLZMACompressed)return JSON.parse(window.LZMA.decompress(window.atob(base64.slice(1)).split("").map((c=>c.charCodeAt(0)-128))));const binary=base64ToBinary(base64);const value=this.valueFromBinary(binary,typeName);return value}}var SCORMSuspendData=__AMD("extensions/adapt-contrib-spoor/js/serializers/SCORMSuspendData",window.SCORMSuspendData=new Converter);var ComponentSerializer=__AMD("extensions/adapt-contrib-spoor/js/serializers/ComponentSerializer",class ComponentSerializer extends Backbone.Controller{initialize(trackingIdType,shouldCompress){this.trackingIdType=trackingIdType;this.shouldCompress=shouldCompress}async serialize(shouldStoreResponses,shouldStoreAttempts){if(shouldStoreAttempts&&!shouldStoreResponses){logging$1.warnOnce("SPOOR configuration error, cannot use '_shouldStoreAttempts' without '_shouldStoreResponses'")}const states=[];data$1.each((model=>{if(model.get("_type")!==this.trackingIdType){return}const trackingId=model.get("_trackingId");if(typeof trackingId==="undefined"){return}const isContainer=model.hasManagedChildren;let components=isContainer?model.findDescendantModels("component"):[model];components=components.filter((component=>component.get("_isTrackable")!==false));components.forEach(((component,index)=>{if(component.get("_isTrackable")===false){return}if(!shouldStoreResponses){const state=[[trackingId,index],[component.get("_isComplete")]];states.push(state);return}let modelState=null;if(!component.getAttemptState){modelState=component.get("_isQuestionType")?[[component.get("_score")||0,component.get("_attemptsLeft")||0],[component.get("_isComplete")||false,component.get("_isInteractionComplete")||false,component.get("_isSubmitted")||false,component.get("_isCorrect")||false],[component.get("_userAnswer")]]:[[],[component.get("_isComplete")||false,component.get("_isInteractionComplete")||false],[component.get("_userAnswer")]]}else{modelState=component.getAttemptState()}const userAnswer=modelState[2][0];const hasUserAnswer=typeof userAnswer!=="undefined"&&userAnswer!==null;const isUserAnswerArray=Array.isArray(userAnswer);if(!hasUserAnswer){modelState[2][0]=[]}else if(!isUserAnswerArray){modelState[2][0]=[modelState[2][0]]}const attemptStates=component.get("_attemptStates");const hasAttemptStates=shouldStoreAttempts&&Array.isArray(attemptStates);if(hasAttemptStates){modelState[2][1]=attemptStates}const state=[[trackingId,index],[hasUserAnswer,isUserAnswerArray,hasAttemptStates],modelState];states.push(state)}))}));if(this.shouldCompress)return await SCORMSuspendData.serializeAsync(states);return SCORMSuspendData.serialize(states)}deserialize(binary){const trackingIdMap=data$1.toArray().reduce(((trackingIdMap,model)=>{const trackingId=model.get("_trackingId");if(typeof trackingId==="undefined")return trackingIdMap;trackingIdMap[trackingId]=model;return trackingIdMap}),{});const states=SCORMSuspendData.deserialize(binary);const shouldStoreResponses=states[0].length>2;states.forEach((state=>{const[trackingId,index]=state[0];const model=trackingIdMap[trackingId];if(!model){return}const isContainer=model.hasManagedChildren;let components=isContainer?model.findDescendantModels("component"):[model];components=components.filter((component=>component.get("_isTrackable")!==false));const component=components[index];if(!component){logging$1.warn(`SPOOR could not restore tracking id: ${trackingId}, index: ${index}`);return}if(!shouldStoreResponses){const isComplete=state[1][0];component.set("_isComplete",isComplete);return}const[hasUserAnswer,isUserAnswerArray,hasAttemptStates]=state[1];const modelState=state[2];if(!hasUserAnswer){modelState[2][0]=null}else if(!isUserAnswerArray){modelState[2][0]=modelState[2][0][0]}if(!hasAttemptStates){modelState[2][1]=null}if(component.setAttemptObject){component.set("_attemptStates",modelState[2][1]);const attemptObject=component.getAttemptObject(modelState);component.setAttemptObject(attemptObject,false);return}component.get("_isQuestionType")?component.set({_score:modelState[0][0],_attemptsLeft:modelState[0][1],_isComplete:modelState[1][0],_isInteractionComplete:modelState[1][1],_isSubmitted:modelState[1][2],_isCorrect:modelState[1][3],_userAnswer:modelState[2][0],_attemptStates:modelState[2][1]}):component.set({_isComplete:modelState[1][0],_isInteractionComplete:modelState[1][1],_userAnswer:modelState[2][0],_attemptStates:modelState[2][1]})}))}});var StatefulSession=__AMD("extensions/adapt-contrib-spoor/js/adapt-stateful-session",class StatefulSession extends Backbone.Controller{initialize(){_.bindAll(this,"beginSession","onVisibilityChange","endSession");this.debouncedSaveSession=_.debounce(this.saveSessionState.bind(this),1);this.scorm=ScormWrapper$1.getInstance();this._trackingIdType="block";this._componentSerializer=null;this._shouldCompress=false;this._shouldStoreResponses=true;this._shouldStoreAttempts=false;this._shouldRecordInteractions=true;this.beginSession()}beginSession(){this.listenTo(Adapt$1,"app:dataReady",this.restoreSession);this._trackingIdType=Adapt$1.build.get("trackingIdType")||"block";if(window.location.search.indexOf("nolmserrors")!==-1){this.scorm.suppressErrors=true}const config=Adapt$1.spoor.config;if(!config)return;const tracking=config._tracking;this._shouldStoreResponses=tracking&&tracking._shouldStoreResponses||false;this._shouldStoreAttempts=tracking&&tracking._shouldStoreAttempts||false;this._shouldCompress=tracking&&tracking._shouldCompress||false;this._componentSerializer=new ComponentSerializer(this._trackingIdType,this._shouldCompress);if(tracking?._shouldRecordInteractions===false){this._shouldRecordInteractions=false}const settings=config._advancedSettings;if(!settings){this.scorm.setVersion("1.2");this.scorm.initialize();return}this.scorm.initialize(settings)}restoreSession(){this.setupLearnerInfo();this.restoreSessionState();_.defer(this.setupEventListeners.bind(this))}setupLearnerInfo(){const globals=Adapt$1.course.get("_globals");if(!globals._learnerInfo){globals._learnerInfo={}}Object.assign(globals._learnerInfo,offlineStorage$1.get("learnerinfo"))}restoreSessionState(){const sessionPairs=offlineStorage$1.get();const hasNoPairs=!Object.keys(sessionPairs).length;if(hasNoPairs)return;if(sessionPairs.c){const[_isComplete,_isAssessmentPassed]=SCORMSuspendData.deserialize(sessionPairs.c);Adapt$1.course.set({_isComplete:_isComplete,_isAssessmentPassed:_isAssessmentPassed})}if(!sessionPairs.q)return;this._componentSerializer?.deserialize(sessionPairs.q)}setupEventListeners(){this.removeEventListeners();this.listenTo(Adapt$1.components,"change:_isComplete",this.debouncedSaveSession);this.listenTo(Adapt$1.course,"change:_isComplete",this.debouncedSaveSession);if(this._shouldStoreResponses){this.listenTo(data$1,"change:_isSubmitted change:_userAnswer",this.debouncedSaveSession)}this.listenTo(Adapt$1,{"app:dataReady":this.restoreSession,"app:languageChanged":this.onLanguageChanged,"questionView:recordInteraction":this.onQuestionRecordInteraction,"tracking:complete":this.onTrackingComplete});const config=Adapt$1.spoor.config;const advancedSettings=config._advancedSettings;const shouldCommitOnVisibilityChange=!advancedSettings||advancedSettings._commitOnVisibilityChangeHidden!==false;if(shouldCommitOnVisibilityChange){document.addEventListener("visibilitychange",this.onVisibilityChange)}$(window).on("beforeunload unload",this.endSession)}async saveSessionState(){const isMidRender=!Adapt$1.parentView?.model.get("_isReady");if(isMidRender)return this.debouncedSaveSession();const courseState=SCORMSuspendData.serialize([Boolean(Adapt$1.course.get("_isComplete")),Boolean(Adapt$1.course.get("_isAssessmentPassed"))]);const componentStates=await(this._componentSerializer?.serialize(this._shouldStoreResponses,this._shouldStoreAttempts));const sessionPairs={c:courseState,q:componentStates};offlineStorage$1.set(sessionPairs);this.printCompletionInformation(sessionPairs)}printCompletionInformation(suspendData){if(typeof suspendData==="string"){suspendData=JSON.parse(suspendData)}const courseState=SCORMSuspendData.deserialize(suspendData.c);const courseComplete=courseState[0];const assessmentPassed=courseState[1];const trackingIdModels=data$1.filter((model=>model.get("_type")===this._trackingIdType&&model.has("_trackingId")));const trackingIds=trackingIdModels.map((model=>model.get("_trackingId")));if(!trackingIds.length){logging$1.info(`course._isComplete: ${courseComplete}, course._isAssessmentPassed: ${assessmentPassed}, ${this._trackingIdType} completion: no tracking ids found`);return}const completionData=SCORMSuspendData.deserialize(suspendData.q);const max=Math.max(...completionData.map((item=>item[0][0])));const shouldStoreResponses=completionData[0].length===3;const completionString=completionData.reduce(((markers,item)=>{const trackingId=item[0][0];const isComplete=shouldStoreResponses?item[2][1][0]:item[1][0];const mark=isComplete?"1":"0";markers[trackingId]=markers[trackingId]==="-"||markers[trackingId]==="1"?mark:"0";return markers}),new Array(max+1).fill("-")).join("");logging$1.info(`course._isComplete: ${courseComplete}, course._isAssessmentPassed: ${assessmentPassed}, ${this._trackingIdType} completion: ${completionString}`)}onLanguageChanged(){const config=Adapt$1.spoor.config;if(config?._reporting?._resetStatusOnLanguageChange!==true)return;offlineStorage$1.set("status","incomplete")}onVisibilityChange(){if(document.visibilityState==="hidden")this.scorm.commit()}onQuestionRecordInteraction(questionView){if(!this._shouldRecordInteractions)return;const questionModel=questionView.model;const responseType=questionModel.getResponseType?questionModel.getResponseType():questionView.getResponseType();if(_.isEmpty(responseType))return;const id=`${this.scorm.getInteractionCount()}-${questionModel.get("_id")}`;const response=questionModel.getResponse?questionModel.getResponse():questionView.getResponse();const result=questionModel.isCorrect?questionModel.isCorrect():questionView.isCorrect();const latency=questionModel.getLatency?questionModel.getLatency():questionView.getLatency();offlineStorage$1.set("interaction",id,response,result,latency,responseType)}onTrackingComplete(completionData){const config=Adapt$1.spoor.config;this.saveSessionState();let completionStatus=completionData.status.asLowerCase;switch(completionData.status){case COMPLETION_STATE$1.COMPLETED:case COMPLETION_STATE$1.PASSED:{if(!config?._reporting?._onTrackingCriteriaMet){logging$1.warn(`No value defined for '_onTrackingCriteriaMet', so defaulting to '${completionStatus}'`)}else{completionStatus=config._reporting._onTrackingCriteriaMet}break}case COMPLETION_STATE$1.FAILED:{if(!config?._reporting?._onAssessmentFailure){logging$1.warn(`No value defined for '_onAssessmentFailure', so defaulting to '${completionStatus}'`)}else{completionStatus=config._reporting._onAssessmentFailure}}}offlineStorage$1.set("status",completionStatus)}endSession(){if(!this.scorm.finishCalled){this.scorm.finish()}this.removeEventListeners()}removeEventListeners(){$(window).off("beforeunload unload",this.endSession);document.removeEventListener("visibilitychange",this.onVisibilityChange);this.stopListening()}});var OfflineStorage=__AMD("extensions/adapt-contrib-spoor/js/adapt-offlineStorage-scorm",class OfflineStorageScorm extends Backbone.Controller{initialize(statefulSession){this.offlineStorage=offlineStorage$1;this.scorm=ScormWrapper$1.getInstance();this.statefulSession=statefulSession;this.temporaryStore={};this.suspendDataStore={};this.suspendDataRestored=false;offlineStorage$1.initialize(this)}save(){this.statefulSession.saveSessionState();this.scorm.commit()}serialize(){return SCORMSuspendData.serialize(...arguments)}deserialize(){return SCORMSuspendData.deserialize(...arguments)}get(name){if(name===undefined){if(this.useTemporaryStore())return this.temporaryStore;this.suspendDataStore=this.getCustomStates();const data=Object.assign(_.clone(this.suspendDataStore),{location:this.scorm.getLessonLocation(),score:this.scorm.getScore(),status:this.scorm.getStatus(),student:this.scorm.getStudentName(),learnerInfo:this.getLearnerInfo()});this.suspendDataRestored=true;return data}if(this.useTemporaryStore())return this.temporaryStore[name];let courseState;switch(name.toLowerCase()){case"location":return this.scorm.getLessonLocation();case"score":return this.scorm.getScore();case"status":return this.scorm.getStatus();case"student":return this.scorm.getStudentName();case"learnerinfo":return this.getLearnerInfo();case"coursestate":{courseState=this.getCustomState("c");const stateArray=courseState&&SCORMSuspendData.deserialize(courseState)||[];return{_isCourseComplete:Boolean(stateArray.slice(0,1).map(Number)[0]),_isAssessmentPassed:Boolean(stateArray.slice(1,2).map(Number)[0]),completion:stateArray.slice(2).map(Number).map(String).join("")||""}}case"completion":courseState=this.getCustomState("c");return courseState&&SCORMSuspendData.deserialize(courseState).slice(2).map(Number).map(String).join("")||"";case"_iscoursecomplete":courseState=this.getCustomState("c");return Boolean(courseState&&SCORMSuspendData.deserialize(courseState).slice(0,1).map(Number)[0]);case"_isassessmentpassed":courseState=this.getCustomState("c");return Boolean(courseState&&SCORMSuspendData.deserialize(courseState).slice(1,2).map(Number)[0]);case"questions":{const questionsState=this.getCustomState("q");return questionsState||""}default:return this.getCustomState(name)}}set(name,value){const args=[...arguments].slice(1);const isObject=typeof name==="object";if(isObject){value=name;name="suspendData"}if(this.useTemporaryStore()){if(isObject){Object.assign(this.temporaryStore,value)}else{this.temporaryStore[name]=value}return true}switch(name.toLowerCase()){case"interaction":return this.scorm.recordInteraction(...args);case"location":return this.scorm.setLessonLocation(...args);case"score":return this.scorm.setScore(...args);case"status":return this.scorm.setStatus(...args);case"student":case"learnerinfo":return false;case"lang":this.scorm.setLanguage(value);break}if(isObject){Object.assign(this.suspendDataStore,value)}else{this.suspendDataStore[name]=value}const dataAsString=JSON.stringify(this.suspendDataStore);return this.suspendDataRestored?this.scorm.setSuspendData(dataAsString):false}clear(){this.temporaryStore={};this.suspendDataStore={};const dataAsString=JSON.stringify(this.suspendDataStore);this.scorm.setSuspendData(dataAsString)}getCustomStates(){const isSuspendDataStoreEmpty=_.isEmpty(this.suspendDataStore);if(!isSuspendDataStoreEmpty&&this.suspendDataRestored){return _.clone(this.suspendDataStore)}const dataAsString=this.scorm.getSuspendData();if(dataAsString===""||dataAsString===" "||dataAsString===undefined){return{}}const dataAsJSON=JSON.parse(dataAsString);if(!isSuspendDataStoreEmpty&&!this.suspendDataRestored){Object.assign(dataAsJSON,this.suspendDataStore)}return dataAsJSON}getCustomState(name){const dataAsJSON=this.getCustomStates();return dataAsJSON[name]}useTemporaryStore(){const cfg=Adapt$1.config.get("_spoor");if(!this.scorm.lmsConnected||cfg?._isEnabled===false)return true;return false}getLearnerInfo(){const id=this.scorm.getStudentId();let name=this.scorm.getStudentName();let firstname="";let lastname="";let hasName=name&&name!=="undefined";const isNameCommaSeparated=hasName&&name.includes(",");const isNameSpaceSeparated=hasName&&name.includes(" ");hasName=hasName&&(isNameCommaSeparated||isNameSpaceSeparated);if(!hasName){console.log("SPOOR: LMS learner_name not in 'lastname, firstname' or 'firstname lastname' format");return{id:id,name:name,firstname:firstname,lastname:lastname}}const separator=isNameCommaSeparated?",":" ";const nameParts=name.split(separator);if(isNameCommaSeparated){nameParts.reverse()}[firstname,lastname]=nameParts.map((part=>part.trim()));name=`${firstname} ${lastname}`;return{id:id,name:name,firstname:firstname,lastname:lastname}}});const shouldStart=Object.prototype.hasOwnProperty.call(window,"ISCOOKIELMS")&&window.ISCOOKIELMS!==null;const isStoringData=window.ISCOOKIELMS===true;function createResetButton(){const resetButtonStyle='<style id="spoor-clear-button">.spoor-reset-button { position:fixed; right:0px; bottom:0px; } </style>';const resetButton='<button class="spoor-reset-button btn-text">Reset</button>';$("body").append($(resetButtonStyle));const $button=$(resetButton);$("body").append($button);$button.on("click",(e=>{if(!e.shiftKey){Cookies__default["default"].remove("_spoor");alert("SCORM tracking cookie has been deleted! Tip: shift-click reset to preserve cookie.")}window.location=window.location.pathname}))}function configure(){if(!isStoringData)return;const spoorConfig=Adapt$1.config.get("_spoor");if(spoorConfig?._showCookieLmsResetButton)createResetButton();if(!spoorConfig?._shouldPersistCookieLMSData){Cookies__default["default"].defaults={sameSite:"strict"}}}function postStorageWarning(){if(postStorageWarning.__storageWarningTimeoutId!==null)return;postStorageWarning.__storageWarningTimeoutId=setTimeout((()=>{const notificationMethod=Adapt$1.config.get("_spoor")?._advancedSettings?._suppressErrors===true?console.error:alert;postStorageWarning.__storageWarningTimeoutId=null;notificationMethod("Warning: possible cookie storage limit exceeded - tracking may malfunction")}),1e3)}function start(){const GenericAPI={__offlineAPIWrapper:true,store:function(force){if(!isStoringData)return;if(!force&&Cookies__default["default"].get("_spoor")===undefined)return;Cookies__default["default"].set("_spoor",this.data);if(Cookies__default["default"].get("_spoor").length!==JSON.stringify(this.data).length)postStorageWarning()},fetch:function(){if(!isStoringData){this.data={};return}this.data=Cookies__default["default"].getJSON("_spoor");if(!this.data){this.data={};return false}return true}};window.API={...GenericAPI,LMSInitialize:function(){configure();if(!this.fetch()){this.data["cmi.core.lesson_status"]="not attempted";this.data["cmi.suspend_data"]="";this.data["cmi.core.student_name"]="Surname, Sam";this.data["cmi.core.student_id"]="sam.surname@example.org";this.store(true)}return"true"},LMSFinish:function(){return"true"},LMSGetValue:function(key){return this.data[key]},LMSSetValue:function(key,value){const str="cmi.interactions.";if(key.indexOf(str)!==-1)return"true";this.data[key]=value;this.store();return"true"},LMSCommit:function(){return"true"},LMSGetLastError:function(){return 0},LMSGetErrorString:function(){return"Fake error string."},LMSGetDiagnostic:function(){return"Fake diagnostic information."}};window.API_1484_11={...GenericAPI,Initialize:function(){configure();if(!this.fetch()){this.data["cmi.completion_status"]="not attempted";this.data["cmi.suspend_data"]="";this.data["cmi.learner_name"]="Surname, Sam";this.data["cmi.learner_id"]="sam.surname@example.org";this.store(true)}return"true"},Terminate:function(){return"true"},GetValue:function(key){return this.data[key]},SetValue:function(key,value){const str="cmi.interactions.";if(key.indexOf(str)!==-1)return"true";this.data[key]=value;this.store();return"true"},Commit:function(){return"true"},GetLastError:function(){return 0},GetErrorString:function(){return"Fake error string."},GetDiagnostic:function(){return"Fake diagnostic information."}}}class Spoor extends Backbone.Controller{initialize(){this.config=null;if(shouldStart)start();this.scorm=ScormWrapper$1.getInstance();this.listenToOnce(Adapt$1,"offlineStorage:prepare",this._prepare)}_prepare(){this.config=Adapt$1.config.get("_spoor");if(!this.isEnabled){offlineStorage$1.setReadyStatus();return}this.statefulSession=new StatefulSession;this.offlineStorage=new OfflineStorage(this.statefulSession);offlineStorage$1.get();offlineStorage$1.setReadyStatus();require(["libraries/jquery.keycombo"],(()=>{$.onKeyCombo([68,69,86],(()=>{Adapt$1.spoor.scorm.showDebugWindow()}))}))}get isEnabled(){return this.config&&this.config._isEnabled}}Adapt$1.spoor=new Spoor;__AMD("extensions/adapt-contrib-spoor/js/adapt-contrib-spoor",Adapt$1.spoor);function _deepDefaults$1(original){for(var _len=arguments.length,defaultObjects=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){defaultObjects[_key-1]=arguments[_key]}defaultObjects.reverse();defaultObjects.forEach((defaults=>{const keyValuePairs=Object.entries(defaults);keyValuePairs.forEach((_ref=>{let[key,defaultValue]=_ref;const isRecursiveObject=typeof defaultValue==="object"&&!Array.isArray(defaultValue)&&defaultValue!==null;if(isRecursiveObject){original[key]=_deepDefaults$1(original[key]||{},defaultValue);return}const isValueAlreadySet=Object.prototype.hasOwnProperty.call(original,key);if(isValueAlreadySet)return;original[key]=defaultValue}))}));return original}const configDefaults$1={_isEnabled:false,_isInherited:false,_autoScroll:true,_scrollTo:"@block +1",_onChildren:false,_button:{_isEnabled:true,_isFullWidth:true,_autoHide:false,_hasIcon:false,_styleBeforeCompletion:"hidden",_styleAfterClick:"hidden",_component:"trickle-button",_className:"",text:"Continue",ariaLabel:"",startText:"",startAriaLabel:"",finalText:"",finalAriaLabel:""},_stepLocking:{_isEnabled:true,_isCompletionRequired:true,_isLockedOnRevisit:false}};function isModelArticleWithOnChildren(model){const type=model.get("_type");const trickleConfig=model.get("_trickle");return type==="article"&&trickleConfig?._onChildren!==false}function isModelBlockWithArticleNotChildren(model){const type=model.get("_type");const parentTrickleConfig=model.getParent()?.get("_trickle");return type==="block"&&parentTrickleConfig?._isEnabled===true&&parentTrickleConfig?._onChildren===false}function getModelConfigDefaults(model){const type=model.get("_type");const config={};_deepDefaults$1(config,configDefaults$1,{_onChildren:type==="article"});if(config._onChildren){config._button.startText=config._button.startText??"Begin";config._button.startAriaLabel=config._button.startAriaLabel??"";config._button.finalText=config._button.finalText??"Finish";config._button.finalAriaLabel=config._button.finalAriaLabel??""}if(config._button._isFullWidth){config._stepLocking._isEnabled=true}return config}function getModelInheritanceChain(configModel){if(!data$1.isReady)throw new Error("Trickle cannot resolve inheritance chains until data is ready");const type=configModel.get("_type");if(type==="block"){const parentModel=configModel.getParent();const parentConfig=parentModel.get("_trickle");const blockConfig=configModel.get("_trickle");const isParentEnabledNotOnChildren=parentConfig?._isEnabled&&parentConfig._onChildren===false;const isNoChildConfig=!blockConfig?._isEnabled;if(isParentEnabledNotOnChildren&&isNoChildConfig){return null}return[configModel,parentModel].filter((ancestor=>{const config=ancestor.get("_trickle");return config&&!config._isInherited}))}if(type==="article"){return[configModel]}return null}function getModelConfig(model){const inheritance=getModelInheritanceChain(model);if(!inheritance?.length||isModelArticleWithOnChildren(model)||isModelBlockWithArticleNotChildren(model))return null;const config=$.extend(true,{},...inheritance.reverse().map(((inheritModel,index,arr)=>{const isLast=index===arr.length-1;const defaults=isLast?getModelConfigDefaults(inheritModel):null;return $.extend(true,{},defaults,inheritModel.get("_trickle"))})));if(!config._isEnabled)return null;return config}function getModelContainer(model){const inheritance=getModelInheritanceChain(model);return inheritance?.find((inheritModel=>{const defaults=getModelConfigDefaults(inheritModel);const config=$.extend(true,{},defaults,inheritModel.get("_trickle"));return config._onChildren}))??inheritance?.[0]}function getCompletionAttribute(){let model=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;return getModelConfig(model)?._completionAttribute||Adapt$1.config.get("_trickle")?._completionAttribute||"_isComplete"}function checkApplyLocks(model){if(!data$1.isReady)return;const completionAttribute=getCompletionAttribute(model);const hasCompletionChanged=Object.prototype.hasOwnProperty.call(model.changed,completionAttribute);const hasAvailabilityChanged=Object.prototype.hasOwnProperty.call(model.changed,"_isAvailable");if(!hasCompletionChanged&&!hasAvailabilityChanged)return;debouncedApplyLocks()}function applyLocks(){if(!data$1.isReady)return;const locks={};const modelsById={};const TrickleButtonModel=components$1.getModelClass("trickle-button");Adapt$1.course.getAllDescendantModels(true).filter((model=>model.get("_isAvailable"))).forEach((siteModel=>{const trickleConfig=getModelConfig(siteModel);if(!isEnabled$1(siteModel,{trickleConfig:trickleConfig}))return;const isModelLocked=isLocked(siteModel,{trickleConfig:trickleConfig});const id=siteModel.get("_id");modelsById[id]=siteModel;locks[id]=locks[id]||false;const subsequentLockingModels=_getAncestorNextSiblings(siteModel);subsequentLockingModels.forEach(((model,index)=>{const id=model.get("_id");const isButtonModel=model instanceof TrickleButtonModel;const isTrickled=model.get("_isTrickled");if(isTrickled!==isButtonModel)model.set("_isTrickled",!isButtonModel);modelsById[id]=model;locks[id]=locks[id]||isModelLocked;if(model.get("_lockType"))return;model.getAllDescendantModels().forEach((descendant=>{const descendantId=descendant.get("_id");modelsById[descendantId]=descendant;locks[descendantId]=locks[id]}))}))}));Object.entries(locks).forEach((_ref2=>{let[id,isModelLocked]=_ref2;const model=modelsById[id];const wasLocked=model.get("_isLocked");if(wasLocked===isModelLocked)return;model.set("_isLocked",isModelLocked)}));logTrickleState()}function isEnabled$1(model){let{trickleConfig:trickleConfig=getModelConfig(model)}=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return trickleConfig?._isEnabled===true}function isLocked(model){let{trickleConfig:trickleConfig=getModelConfig(model)}=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};const isStepLocked=Boolean(trickleConfig?._stepLocking?._isEnabled);if(!isStepLocked)return false;const isCompletionRequired=Boolean(trickleConfig?._stepLocking?._isCompletionRequired);const completionAttribute=getCompletionAttribute(model);if(!isCompletionRequired){const TrickleModel=components$1.getModelClass("trickle-button");const trickleButton=model.getAvailableChildModels().find((model=>model instanceof TrickleModel));const isTrickleButtonComplete=Boolean(trickleButton?.get(completionAttribute));return!isTrickleButtonComplete}const isModelLocked=!model?.get(completionAttribute)&&!model?.get("_isOptional");return isModelLocked}const debouncedApplyLocks=_.debounce(applyLocks,1);function _getAncestorNextSiblings(fromModel){if(!fromModel)return[];const allSiblings=fromModel.getParent().getAvailableChildModels();const subsequentSiblings=allSiblings.slice(allSiblings.findIndex((sibling=>sibling===fromModel))+1);const allAncestors=fromModel.getAncestorModels();const inPageAncestors=allAncestors.slice(0,allAncestors.findIndex((parent=>parent instanceof ContentObjectModel))+1);const subsequentInPageAncestors=[];inPageAncestors.slice(1).forEach(((grandParent,previousIndex)=>{const parent=inPageAncestors[previousIndex];const allGrandParentChildren=grandParent.getAvailableChildModels();const subsequentAncestorSiblings=allGrandParentChildren.slice(allGrandParentChildren.findIndex((child=>child===parent))+1);subsequentInPageAncestors.push(...subsequentAncestorSiblings)}));const subsequentContentObjectDescendantModels=subsequentSiblings.concat(subsequentInPageAncestors);return subsequentContentObjectDescendantModels}function addButtonComponents(){const TrickleButtonModel=components$1.getModelClass("trickle-button");let uid=0;data$1.forEach((buttonModelSite=>{if(buttonModelSite instanceof CourseModel$1)return;const trickleConfig=getModelConfig(buttonModelSite);if(!trickleConfig||!trickleConfig?._isEnabled||buttonModelSite.get("_isTrickleSiteConfigured"))return;buttonModelSite.set("_isTrickleSiteConfigured",true);const parentId=buttonModelSite.get("_id");const trickleButtonModel=new TrickleButtonModel({_id:`trickle-${uid++}`,_type:"component",_component:"trickle-button",_parentId:parentId,_isAvailable:true,_layout:"full",_trickle:{_isEnabled:true},_renderPosition:"outer-append",_isTrackable:false});trickleButtonModel.setupModel();buttonModelSite.getChildren().add(trickleButtonModel)}))}function logTrickleState(){if(logging$1._config?._level!=="debug")return;if(!Adapt$1.parentView?.model?.isTypeGroup("page")){logging$1.debug("TRICKLE GLOBAL STATE");Adapt$1.course.getAllDescendantModels(true).filter((model=>model.get("_isAvailable"))).forEach((model=>{const isLocked=model.get("_isLocked");const isTrickled=model.get("_isTrickled");logging$1.debug(`${" ".repeat(model.getAncestorModels().length)}${model.get("_type")} ${model.get("_id")} isLocked: ${isLocked} isTrickled: ${isTrickled}`)}));return}logging$1.debug("TRICKLE STATE");Adapt$1.parentView.model.getAllDescendantModels(true).filter((model=>model.get("_isAvailable"))).forEach((model=>{const isLocked=model.get("_isLocked");const isTrickled=model.get("_isTrickled");logging$1.debug(`${" ".repeat(model.getAncestorModels().length)}${model.get("_type")} ${model.get("_id")} isLocked: ${isLocked} isTrickled: ${isTrickled}`)}))}__AMD("extensions/adapt-contrib-trickle/js/models",{_deepDefaults:_deepDefaults$1,configDefaults:configDefaults$1,getModelConfigDefaults:getModelConfigDefaults,getModelInheritanceChain:getModelInheritanceChain,getModelConfig:getModelConfig,getModelContainer:getModelContainer,getCompletionAttribute:getCompletionAttribute,checkApplyLocks:checkApplyLocks,applyLocks:applyLocks,debouncedApplyLocks:debouncedApplyLocks,_getAncestorNextSiblings:_getAncestorNextSiblings,addButtonComponents:addButtonComponents,logTrickleState:logTrickleState});class TrickleController extends Backbone.Controller{initialize(){this.checkIsFinished=_.debounce(this.checkIsFinished,1);this.listenTo(data$1,{ready:this.onDataReady})}async onDataReady(){const trickleConfig=Adapt$1.config.get("_trickle");if(trickleConfig?._isEnabled===false)return;this.setUpEventListeners();wait$1.for((done=>{addButtonComponents();applyLocks();done()}))}setUpEventListeners(){this.listenTo(data$1,{"change:_isInteractionComplete change:_isComplete change:_isAvailable add remove":checkApplyLocks,"change:_isLocked":this.checkIsFinished});this.listenTo(Adapt$1,{"assessments:reset":this.onAssessmentReset,"contentObjectView:preRender":this.reset,"view:addChild":this.onAddChildView,"trickle:kill":this.kill})}onAssessmentReset(){const isMidRender=!Adapt$1.parentView?.model.get("_isReady");if(isMidRender)return applyLocks();debouncedApplyLocks()}get isStarted(){return Boolean(Adapt$1.parentView?.model.get("_isTrickleStarted"))}set isStarted(value){if(!Adapt$1.parentView)return;Adapt$1.parentView.model.set("_isTrickleStarted",value);if(!value)return;Adapt$1.trigger("trickle:started")}onAddChildView(event){if(this.isKilled)return;if(event.hasRequestChild)applyLocks();const isManagedByTrickleAndLocked=event.model.get("_isTrickled")&&event.model.get("_isLocked");if(!isManagedByTrickleAndLocked)return;event.stop()}get isTrickling(){const isTrickling=Adapt$1.parentView.model.getAllDescendantModels().some((model=>model.get("_isAvailable")&&model.get("_isTrickled")&&model.get("_isLocked")));return isTrickling}async continue(){applyLocks();await Adapt$1.parentView.addChildren();await Adapt$1.parentView.whenReady()}async scroll(fromModel){const trickleConfig=getModelConfig(fromModel);if(!trickleConfig?._isEnabled)return false;if(isModelArticleWithOnChildren(fromModel))return false;const isAutoScrollOff=!trickleConfig._autoScroll;const hasTrickleButton=trickleConfig._button._isEnabled;if(isAutoScrollOff&&!hasTrickleButton){return}const getScrollToId=()=>{const scrollTo=trickleConfig._scrollTo;const firstCharacter=scrollTo.substr(0,1);switch(firstCharacter){case"@":{const relativeModel=fromModel.findRelativeModel(scrollTo,{filter:model=>model.get("_isAvailable")});if(relativeModel===undefined)return;return relativeModel.get("_id")}case".":return scrollTo.substr(1,scrollTo.length-1);default:return scrollTo}};let scrollToId=getScrollToId();if(!scrollToId){logging$1.error(`Cannot scroll to the next id as none was found at id: "${fromModel.get("_id")}" with _scrollTo: "${trickleConfig._scrollTo}". Suggestion: Set _showEndOfPage to false.`);return}const isDescendant=Adapt$1.parentView.model.getAllDescendantModels().some((model=>model.get("_id")===scrollToId));if(!isDescendant){applyLocks();const model=data$1.findById(scrollToId);const contentObject=model.isTypeGroup("contentobject")?model:model.findAncestor("contentobject");await router$1.navigateToElement(contentObject.get("_id"));scrollToId=getScrollToId();await router$1.navigateToElement(scrollToId);return}await Adapt$1.parentView.renderTo(scrollToId);if(hasTrickleButton){a11y$1.focusFirst($("."+scrollToId),{preventScroll:true})}if(isAutoScrollOff)return false;const duration=trickleConfig._scrollDuration||500;router$1.navigateToElement("."+scrollToId,{duration:duration})}get isFinished(){if(!Adapt$1.parentView)return false;return Boolean(!this.isStarted||Adapt$1.parentView.model.get("_isTrickleFinished")||this.isKilled)}set isFinished(value){if(!Adapt$1.parentView)return;Adapt$1.parentView.model.set("_isTrickleFinished",value);if(!value)return;Adapt$1.trigger("trickle:finished")}checkIsFinished(){if(!this.isStarted)return;if(this.isKilled||this.isFinished)return;if(this.isTrickling)return;this.isFinished=true}async kill(){const TrickleModel=components$1.getModelClass("trickle-button");this.isKilled=true;Adapt$1.parentView.model.getAllDescendantModels().forEach((model=>{const isButtonModel=model instanceof TrickleModel;if(isButtonModel){model.setCompletionStatus()}if(!model.get("_isTrickled"))return;model.set("_isLocked",false)}));await this.continue()}get isKilled(){if(!Adapt$1.parentView)return false;return!this.isStarted||Adapt$1.parentView.model.get("_isTrickleKilled")}set isKilled(value){if(!Adapt$1.parentView)return;Adapt$1.parentView.model.set("_isTrickleKilled",value);if(!value)return;Adapt$1.trigger("trickle:killed")}reset(){this.isKilled=false;if(!this.isTrickling){this.isStarted=false;this.isFinished=false;return}this.isStarted=true;this.isFinished=false}}var controller=__AMD("extensions/adapt-contrib-trickle/js/controller",new TrickleController);class TrickleButtonView extends ComponentView$1{className(){const config=getModelConfig(this.model.getParent());return["trickle",this.model.get("_id"),config._button._component,config._button._isFullWidth&&"is-full-width",config._button._className].filter(Boolean).join(" ")}events(){return{"click .js-trickle-btn":"onButtonClick"}}initialize(){this.openPopupCount=0;this.isAwaitingPopupClose=false;this.wasButtonClicked=false;this.model.calculateButtonText();this.calculateButtonState();this.setupEventListeners();this.render();if(!this.model.isEnabled()){this.setCompletionStatus()}_.defer(this.setReadyStatus.bind(this))}calculateButtonState(){const isDisabledByPopups=this.openPopupCount>0;this.model.calculateButtonState(isDisabledByPopups,this.wasButtonClicked)}render(){const data=this.model.toJSON();data._globals=Adapt$1.course.get("_globals");data._trickle=getModelConfig(this.model.getParent());this.$el.html(Handlebars.templates[TrickleButtonView.template](data))}setupEventListeners(){this.tryButtonAutoHide=this.tryButtonAutoHide.bind(this);const onParentComplete=this.onParentComplete.bind(this);this.onParentComplete=function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}return _.delay((()=>onParentComplete(...args)),100)};this.listenTo(Adapt$1.parentView,"postRemove",this.onRemove);this.listenTo(Adapt$1,"trickle:killed",this.updateButtonState);if(this.model.isStepUnlocked()&&this.model.isFinished()){return}this.$el.on("onscreen",this.tryButtonAutoHide);this.listenTo(Adapt$1,{"popup:opened":this.onPopupOpened,"popup:closed":this.onPopupClosed});const parentModel=this.model.getParent();const completionAttribute=getCompletionAttribute(parentModel);this.listenTo(parentModel,{"change:_requireCompletionOf":this.onStepUnlocked,[`bubble:change:${completionAttribute}`]:this.onStepUnlocked,[`change:${completionAttribute}`]:this.onParentComplete})}onPopupOpened(){this.openPopupCount++;const shouldUserInteractWithButton=this.model.isStepUnlocked()&&!this.model.isFinished();if(!shouldUserInteractWithButton)return;this.updateButtonState()}async onPopupClosed(){this.openPopupCount--;if(this.openPopupCount)return;if(this.isAwaitingPopupClose){return this.finish()}const shouldUserInteractWithButton=this.model.isStepUnlocked()&&!this.model.isFinished();if(!shouldUserInteractWithButton)return;this.updateButtonState();await Adapt$1.parentView.addChildren()}updateButtonState(){this.calculateButtonState();const isButtonHidden=!(this.model.get("_isButtonVisible")&&!this.model.get("_isButtonAutoHidden"));this.$(".js-trickle-btn-container").toggleClass("u-display-none",isButtonHidden);const isButtonDisabled=this.model.get("_isButtonDisabled");const $button=this.$(".js-trickle-btn");const $ariaLabel=this.$(".aria-label");a11y$1.toggleEnabled($button,!isButtonDisabled);if(!isButtonDisabled){if(document.activeElement instanceof HTMLElement&&document.activeElement.isSameNode($ariaLabel[0])){a11y$1.focusNext($ariaLabel)}a11y$1.toggleAccessibleEnabled($ariaLabel,false)}const $buttonText=this.$(".js-trickle-btn-text");const text=this.model.get("buttonText");const ariaLabel=this.model.get("buttonAriaLabel");$buttonText.html(text);$button.attr("aria-label",ariaLabel)}async onStepUnlocked(event){if(event.value===false)return;_.defer(this.updateButtonState.bind(this))}async onButtonClick(){const wasComplete=this.model.get("_isComplete");this.model.setCompletionStatus();this.wasButtonClicked=true;const isStepLockingCompletionRequired=this.model.isStepLockingCompletionRequired();if(isStepLockingCompletionRequired&&!wasComplete)return;await this.continue()}async onParentComplete(model,value){if(!value)return;const parentModel=this.model.getParent();const completionAttribute=getCompletionAttribute(parentModel);this.stopListening(parentModel,{[`bubble:change:${completionAttribute}`]:this.onStepUnlocked,[`change:${completionAttribute}`]:this.onParentComplete});if(controller.isKilled)return;if(this.openPopupCount>0){this.isAwaitingPopupClose=true;return}await this.finish()}async finish(){this.stopListening(Adapt$1,{"popup:opened":this.onPopupOpened,"popup:closed":this.onPopupClosed});this.updateButtonState();const isStepLockingCompletionRequired=this.model.isStepLockingCompletionRequired();if(!isStepLockingCompletionRequired)return;await this.continue()}async continue(){const parent=this.model.getParent();await controller.continue();await controller.scroll(parent)}tryButtonAutoHide(){if(!this.model.get("_isButtonVisible"))return;const trickleConfig=getModelConfig(this.model.getParent());if(!trickleConfig._button._autoHide){this.model.set("_isButtonAutoHidden",false);return}const measurements=this.$el.onscreen();const isJustOffscreen=measurements.bottom>-100;const isButtonAutoHidden=!measurements.onscreen&&!isJustOffscreen;this.model.set("_isButtonAutoHidden",isButtonAutoHidden);this.updateButtonState()}onRemove(){this.$el.off("onscreen",this.tryButtonAutoHide);this.remove()}}TrickleButtonView.template="trickle-button";var TrickleButtonView$1=__AMD("extensions/adapt-contrib-trickle/js/TrickleButtonView",TrickleButtonView);var TrickleButtonModel=__AMD("extensions/adapt-contrib-trickle/js/TrickleButtonModel",class TrickleButtonModel extends ComponentModel$1{init(){super.init();if(!this.isStepComplete())return;this.setCompletionStatus()}isEnabled(){const trickleConfig=getModelConfig(this.getParent());const isEnabled=trickleConfig._isEnabled&&trickleConfig._button?._isEnabled;return isEnabled}isStepLocking(){const config=getModelConfig(this.getParent());const isStepLocking=config._stepLocking?._isEnabled;return isStepLocking}isStepLockingCompletionRequired(){const config=getModelConfig(this.getParent());const isStepLockingCompletionRequired=config._stepLocking&&config._stepLocking._isEnabled&&config._stepLocking._isCompletionRequired;return isStepLockingCompletionRequired}isStepUnlocked(){const parentModel=this.getParent();const completionAttribute=getCompletionAttribute(parentModel);const isCompletionBlocked=parentModel.get("_requireCompletionOf")===Number.POSITIVE_INFINITY;if(isCompletionBlocked)return;return this.getSiblings().every((sibling=>{if(sibling===this){return true}return sibling.get(completionAttribute)||sibling.get("_isOptional")||!sibling.get("_isAvailable")}))}isStepComplete(){const parentModel=this.getParent();const completionAttribute=getCompletionAttribute(parentModel);const isParentComplete=parentModel.get(completionAttribute);return isParentComplete}isStepLockedOnRevisit(){const trickleConfig=getModelConfig(this.getParent());return Boolean(trickleConfig._stepLocking._isLockedOnRevisit)}isFinished(){const isStepUnlocked=this.isStepUnlocked();const isStepLockingCompletionRequired=this.isStepLockingCompletionRequired();const isButtonComplete=this.get("_isComplete");const isFinished=(isStepUnlocked||!isStepLockingCompletionRequired)&&isButtonComplete;return isFinished}isLastInContentObject(){const contentObject=this.findAncestor("contentobject");const allDescendants=contentObject.getAllDescendantModels(true);const lastDescendant=allDescendants[allDescendants.length-1];const parentModel=this.getParent();const trickleParent=getModelContainer(parentModel);const isParentFinished=trickleParent.get("_requireCompletionOf")!==Number.POSITIVE_INFINITY;return isParentFinished&&this===lastDescendant}calculateButtonText(){const parentModel=this.getParent();const trickleConfig=getModelConfig(parentModel);let isStart=false;let isFinal=false;if(trickleConfig._onChildren){const parentId=parentModel.get("_id");const trickleParent=getModelContainer(parentModel);const trickleSiblings=trickleParent.getAllDescendantModels(true).filter((model=>model.get("_isAvailable")&&model.get("_isTrickled")));const index=trickleSiblings.findIndex((model=>model.get("_id")===parentId));isStart=index===0;isFinal=index===trickleSiblings.length-1&&!trickleParent.get("_canRequestChild")}const text=isStart&&trickleConfig._button.startText?trickleConfig._button.startText:isFinal&&trickleConfig._button.finalText?trickleConfig._button.finalText:trickleConfig._button.text;const ariaLabel=isStart&&trickleConfig._button.startAriaLabel?trickleConfig._button.startAriaLabel:isFinal&&trickleConfig._button.finalAriaLabel?trickleConfig._button.finalAriaLabel:trickleConfig._button.ariaLabel;this.set({buttonText:text,buttonAriaLabel:ariaLabel})}checkIfResetOnRevisit(){if(this.isFinished()&&!this.isStepLockedOnRevisit())return;if(!this.get("_isComplete")&&!this.get("_isInteractionComplete"))return;this.set({_isComplete:false,_isInteractionComplete:false});applyLocks()}calculateButtonState(){let isButtonDisableForced=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;let isButtonHiddenForced=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(!this.isEnabled()){this.set({_isButtonVisible:false,_isButtonDisabled:!this.isStepUnlocked()});return}const trickleConfig=getModelConfig(this.getParent());if(this.isLastInContentObject()&&trickleConfig._button._showEndOfPage===false){return this.set({_isButtonVisible:false,_isButtonDisabled:true})}const isTrickleKilled=controller.isKilled;const isStepUnlocked=this.isStepUnlocked()||isTrickleKilled;const isFinished=this.isFinished()||isTrickleKilled;const isButtonVisibleBeforeCompletion=trickleConfig._button._styleBeforeCompletion!=="hidden";const isButtonVisibleAfterCompletion=trickleConfig._button._styleAfterClick!=="hidden"&&!trickleConfig._button._isFullWidth;const isStepLockingCompletionRequired=this.isStepLockingCompletionRequired();const isNoCompletionRequiredAndLockedVisible=!isStepLockingCompletionRequired&&!isFinished&&isButtonVisibleBeforeCompletion;const isNoCompletionRequiredAndUnlockedVisible=!isStepLockingCompletionRequired&&isStepUnlocked&&!isFinished;const isNoCompletionRequiredAndFinishedVisible=!isStepLockingCompletionRequired&&isFinished&&isButtonVisibleAfterCompletion;const isStepLockedAndVisibleBeforeCompletion=isStepLockingCompletionRequired&&!isStepUnlocked&&isButtonVisibleBeforeCompletion&&!isButtonHiddenForced;const isFinishedAndVisibleAfterCompletion=isStepLockingCompletionRequired&&isFinished&&isButtonVisibleAfterCompletion;const isStepUnlockedAndButtonIncomplete=isStepLockingCompletionRequired&&isStepUnlocked&&!isFinished;const isButtonVisible=isNoCompletionRequiredAndLockedVisible||isNoCompletionRequiredAndUnlockedVisible||isNoCompletionRequiredAndFinishedVisible||isStepLockedAndVisibleBeforeCompletion||isFinishedAndVisibleAfterCompletion||isStepUnlockedAndButtonIncomplete;const isButtonEnabledBeforeCompletion=trickleConfig._button._styleBeforeCompletion!=="disabled";const isButtonEnabledAfterCompletion=trickleConfig._button._styleAfterClick!=="disabled";const isNoCompletionRequiredAndLockedEnabled=!isStepLockingCompletionRequired&&!isFinished&&isButtonEnabledBeforeCompletion;const isNoCompletionRequiredAndUnlockedEnabled=!isStepLockingCompletionRequired&&isStepUnlocked&&!isFinished;const isNoCompletionRequiredAndFinishedEnabled=!isStepLockingCompletionRequired&&isFinished&&isButtonEnabledAfterCompletion;const isStepUnlockedAndButtonIncompleteWithoutButtonDisabledForced=isStepLockingCompletionRequired&&isStepUnlockedAndButtonIncomplete&&!isButtonDisableForced;const isFinishedAndEnabledAfterCompletion=isStepLockingCompletionRequired&&isFinished&&isButtonEnabledAfterCompletion;const isButtonEnabled=isNoCompletionRequiredAndLockedEnabled||isNoCompletionRequiredAndUnlockedEnabled||isNoCompletionRequiredAndFinishedEnabled||isStepUnlockedAndButtonIncompleteWithoutButtonDisabledForced||isFinishedAndEnabledAfterCompletion||false;this.set({_isButtonVisible:isButtonVisible,_isButtonDisabled:!isButtonEnabled})}});__AMD("extensions/adapt-contrib-trickle/js/trickleButton",components$1.register("trickle-button",{view:TrickleButtonView$1,model:TrickleButtonModel}));__AMD("extensions/adapt-contrib-trickle/js/adapt-contrib-trickle",Adapt$1.trickle=controller);Adapt$1.once("adapt:initialize",(function(){var template=Handlebars.templates["favicons"];$("head").append(template({_favicons:Adapt$1.course.get("_favicons")}))}));const HintPopupView=Backbone.View.extend({className:"hint-popup",initialize:function(){this.render()},render:function(){const data=this.model.toJSON();data.view=this;const template=Handlebars.templates.hintPopup;this.$el.html(template(data))}});const HintView=Backbone.View.extend({events:{"click .js-hint-btn-toggle":"onHintToggleClicked","click .close-popup":"onHintToggleClicked","click .js-hint-btn-popup":"onHintPopupClicked"},className:"hint",initialize:function(){this.listenTo(Adapt$1,"remove",this.remove);if(!this.model.get("_hint")._isNotifyPopup){this.listenTo(Adapt$1,"hint:opened",this.checkIfShouldClose)}this.render()},render:function(){const data=this.model.toJSON();const template=Handlebars.templates.hint;this.$el.html(template(data)).appendTo($("."+this.model.get("_id")));_.defer(this.postRender.bind(this))},postRender:function(){this.$el.parents(".component").addClass("has-hint")},onHintPopupClicked:function(){Adapt$1.notify.popup({_view:new HintPopupView({model:this.model}),_isCancellable:true,_showCloseButton:true,_closeOnBackdrop:true})},onHintToggleClicked:function(e){const $button=this.$(".js-hint-btn-toggle");const $widget=this.$(".js-hint-widget");const globals=Adapt$1.course.get("_globals")._extensions._hint;const isBeingOpened=$widget.hasClass("is-closed");$widget.toggleClass("is-open",isBeingOpened).toggleClass("is-closed",!isBeingOpened);$button.toggleClass("is-open",isBeingOpened).toggleClass("is-closed",!isBeingOpened).attr({"aria-expanded":isBeingOpened?true:false});_.delay(function(){$button.attr({"aria-label":isBeingOpened?globals.closeButtonText:globals.openButtonText});if(isBeingOpened){Adapt$1.a11y.popupOpened($widget);Adapt$1.trigger("hint:opened",this.model.get("_id"));$widget.attr({"aria-hidden":false});return}else{$widget.removeAttr("tabindex").attr({"aria-hidden":true});if(!e)return;$button.focus()}Adapt$1.a11y.popupClosed($button)}.bind(this),500)},checkIfShouldClose:function(id){if(this.model.get("_id")===id)return;if(this.$(".js-hint-btn-toggle").hasClass("is-closed"))return;this.onHintToggleClicked()}});Adapt$1.on("componentView:postRender",(function(view){if(view.model.has("_hint")&&view.model.get("_hint")._items.length>0){new HintView({model:view.model})}}));class HomeButton extends Backbone__default["default"].Controller{initialize(){this.listenTo(Adapt$1,"app:dataReady",this.onDataReady)}onDataReady(){const config=Adapt$1.config.get("_homeButton");if(config?._isEnabled===false)return;this.$html=$("html");this.stopListening();this.listenTo(Adapt$1,{remove:this.disable,"router:menu router:page":this.onRouterEvent,"navigation:redirectedHomeButton":this.redirected})}get currentModelConfig(){return location$1._currentModel?.get("_homeButton")}get courseConfig(){return Adapt$1.course?.get("_homeButton")}onRouterEvent(){const isEnabled=this.currentModelConfig?._isEnabled;if(!isEnabled)return this.disable();this.enable()}disable(){this.$html.removeClass("hide-nav-home-btn");$(".js-nav-home-btn").remove()}enable(){const currentModelConfig=this.currentModelConfig;const courseConfig=this.courseConfig;this.$html.toggleClass("hide-nav-home-btn",Boolean(currentModelConfig?._hideHomeButton));this.$html.toggleClass("hide-nav-back-btn",Boolean(currentModelConfig?._hideBackButton));const altText=currentModelConfig?.alt||courseConfig?.alt||"";const $backButton=$('button[data-event="backButton"]');const $icon=$("<div>",{class:"icon","aria-hidden":true});const $homeButton=$("<button>",{attr:{"data-event":currentModelConfig?._redirectToId?"redirectedHomeButton":"homeButton"},class:"btn-icon nav__btn nav__homebutton-btn js-nav-home-btn","aria-label":altText,role:"link"}).append($icon);$homeButton.insertAfter($backButton)}redirected(){const redirectToId=this.currentModelConfig?._redirectToId;if(!redirectToId)return;const model=data$1.findById(redirectToId);if(!model)return;switch(model.get("_type")){case"course":router$1.navigateToHomeRoute();break;case"menu":case"page":router$1.navigateToElement(model.get("_id"));break}}}__AMD("extensions/adapt-homeButton/js/adapt-homeButton",new HomeButton);const InlineFeedbackComponentView={postRender(){this.$el.addClass("has-inline-feedback");this.renderFeedbackContainer();QuestionView$1.prototype.postRender.call(this);if(!this.model.get("_isSubmitted"))return;this.populateFeedback()},renderFeedbackContainer(){this.$(".component__inner").append(Handlebars.templates.inlineFeedback())},populateFeedback:function(){const $feedbackMessage=this.$feedback(".component__feedback-content");let feedbackContent=this.model.get("feedbackMessage");$feedbackMessage.html("<div class='feedbackTitle'>"+this.model.get("_feedback").title+"</div>"+feedbackContent);this.$feedback().addClass("show-feedback");if(!this.model.get("feedbackImage")){this.$feedback(".component__feedback-image-container").css("display","none");$feedbackMessage.css("width","auto");return}const $feedbackImage=this.$feedback(".component__feedback-image");$feedbackImage.attr("src",this.model.get("feedbackImage"));if(this.model.get("feedbackImageAlt"))$feedbackImage.attr("aria-label",this.model.get("feedbackImageAlt"))},$feedback(selector){const isParentBlock=this.$(".component__feedback").length===0;const model=isParentBlock?this.model.getParent():this.model;const $feedback=$("."+model.get("_id")+" .component__feedback");return selector?$feedback.find(selector):$feedback},showFeedback:function(){if(this.model.get("_canShowFeedback")){this.populateFeedback();this.scrollToFeedback()}QuestionView$1.prototype.showFeedback.call(this)},showMarking(){const isCorrect=this.model.get("_isCorrect");const ariaLabels=Adapt$1.course.get("_globals")._accessibility._ariaLabels;this.$(".js-btn-marking").removeClass("u-display-none").addClass(isCorrect?"is-correct":"is-incorrect").attr("aria-label",isCorrect?ariaLabels.answeredCorrectly:ariaLabels.answeredIncorrectly)},checkQuestionCompletion:function(){const isCorrect=this.model.get("_isCorrect");const isComplete=this.model.get("_isCorrect")||this.model.get("_attemptsLeft")===0;if(!isComplete)return;this.model.set("_isInteractionComplete",true);this.$(".js-btn-marking").removeClass("u-display-none").addClass(isCorrect?"is-correct":"is-incorrect");this.$(".component__widget").addClass("is-complete show-user-answer")},scrollToFeedback(){const $anchor=this.$anchor();const $feedback=this.$feedback();const $target=$feedback.length?$feedback:$anchor;_.delay((()=>{$.scrollTo($target,{offset:-($(".nav").outerHeight()+100),duration:500,onAfter:this.onScrolledToFeedback.bind(this)})}),250)},$anchor(){return $("."+this.model.get("_id")+" .feedback-anchor")},onScrolledToFeedback(){this.setCompletionStatus();const parentPage=this.model.findAncestor("contentObjects");if(parentPage.findDescendantModels("components",{where:{_isAvailable:true,_isOptional:false,_isComplete:false}}).length===0){parentPage.once("change:_isComplete",(function(){Adapt$1.trigger("pageLevelProgress:update")}));return}Adapt$1.trigger("pageLevelProgress:update")}};var InlineFeedbackQuestionView=__AMD("extensions/adapt-inline-feedback/js/inlineFeedbackQuestionView",InlineFeedbackComponentView);const QuestionViewInitialize=QuestionView$1.prototype.initialize;QuestionView$1.prototype.initialize=function(){if(this.model.get("_canShowFeedback")){_.extend(this,InlineFeedbackQuestionView)}return QuestionViewInitialize.apply(this,arguments)};var mobileIframe=__AMD("extensions/adapt-iOSScrollFix/js/mobile-iframe",(function(){switch(Adapt$1.device.OS){case"android":case"ios":break;default:return false}var isInChildWindow=window.top.document!==document;if(!isInChildWindow)return false;var containerFrame=function getContainerFrame(){if(!isInChildWindow)return;var frames=$("iframe, frame",window.top.document);if(!frames.length)return;var containerFrame=null;for(var i=0,l=frames.length;i<l;i++){var frame=frames[i];if(window.location.href.substr(0,frame.src.length)!==frame.src)continue;containerFrame=frame;break}return containerFrame}();var isInIFrame=!!containerFrame;if(!isInIFrame)return false;+$(containerFrame).attr("data-iframefix",true);window.addEventListener("message",(function(message){if(typeof message.data!=="object")return;if(!message.data.type)return;switch(message.data.type){case"orientationchange":case"resize":Adapt$1.trigger("iframe:change",window.top,containerFrame);break}}),false);var a=document.createElement("a");a.href="iframe-fix.js";window.top.eval('var head = document.querySelector("head"); var script = document.createElement("script"); script.id="iframefix"; script.src="'+a.href+'"; head.appendChild(script);');Adapt$1.trigger("iframe:change",window.top,containerFrame)}));var Extension=Backbone.Controller.extend({initialize:function(){this.listenTo(Adapt$1,"configModel:dataLoaded",this.onConfigDataLoaded)},onConfigDataLoaded:function(){var config=Adapt$1.config.get("_iosscrollfix");var isEnabled=config&&config._isEnabled&&config._onHTMLClasses&&$("html").is(config._onHTMLClasses);if(!isEnabled)return;this.scrollFix();if(config._isReflowFixEnabled){this.reflow()}if(config._isIFrameFixEnabled){this.iFrameFix();mobileIframe()}},scrollFix:function(){$("html").addClass("iosscrollfix");var $navigationContainer=$('<div class="navigation-container"></div>');$("body").prepend($navigationContainer);Adapt$1.once("adapt:initialize",(function(){$(".navigation").prependTo($navigationContainer)}));var $scrollingContainer=$('<div class="scrolling-container"><div class="scrolling-inner body"></div></div>');var $scrollingInner=$scrollingContainer.find(".scrolling-inner");$scrollingContainer.insertAfter($navigationContainer);$("#wrapper").appendTo($scrollingInner);var originalElementScrollTo=$.fn.scrollTo;$.fn.scrollTo=function(target,duration,settings){if(this[0]===window||this[0]===document.body){return originalElementScrollTo.apply($(".scrolling-container"),arguments)}else{return originalElementScrollTo.apply(this,arguments)}};var originalScrollTo=$.scrollTo;$.scrollTo=_.extend((function(target,duration,settings){return originalElementScrollTo.apply($(".scrolling-container"),arguments)}),originalScrollTo);var originalScrollTop=$.fn.scrollTop;$.fn.scrollTop=function(){if(this[0]===window||this[0]===document.body){return originalScrollTop.apply($(".scrolling-container"),arguments)}else{return originalScrollTop.apply(this,arguments)}};window.scrollTo=function(x,y){$(".scrolling-container")[0].scrollTop=y||0;$(".scrolling-container")[0].scrollLeft=x||0};$(".scrolling-container").on("scroll",(function(){$(window).scroll()}));var jqueryOffset=$.fn.offset;$.fn.offset=function(){var offset=jqueryOffset.call(this);var $stack=this.parents().add(this);var $scrollParents=$stack.filter(".scrolling-container");$scrollParents.each((function(index,item){var $item=$(item);var scrolltop=parseInt($item.scrollTop());var scrollleft=parseInt($item.scrollLeft());offset.top+=scrolltop;offset.left+=scrollleft}));return offset}},reflow:function(){var reflowParent=function(){console.log("iOSScrollFix: reflow parent");var $redraw=$('<div class="redraw">Redraw in progress</div>',window.top.document);$(".scrolling-container",window.top.document).append($redraw);_.defer((function(){$redraw.remove()}))}.bind(this);var reflowChild=function(){console.log("iOSScrollFix: reflow child");var $redraw=$('<div class="redraw">Redraw in progress</div>');$(".scrolling-container").append($redraw);_.defer((function(){$redraw.remove()}))}.bind(this);var reflowMe=function(){reflowParent();reflowChild()}.bind(this);var reflow=function(){reflowMe()}.bind(this);Adapt$1.on("device:resize",reflow);Adapt$1.on("menuView:postRender pageView:postRender",reflow);reflow();$(document).on("touchstart",reflow)},iFrameFix:function(){var config=Adapt$1.config.get("_iosscrollfix");var heightTrim=config._iFrameFixHeightTrim||0;var resizeMe=function(window,iframe){console.log("iOSScrollFix: iframe resize");var scale=window.document.body.clientWidth/window.innerWidth;var style={position:"fixed !important",top:0,left:0,right:window.innerWidth*scale+"px",width:window.innerWidth*scale+"px",height:(window.innerHeight+heightTrim)*scale+"px",bottom:(window.innerHeight+heightTrim)*scale+"px","-webkit-overflow-scrolling":"auto",border:0,margin:0,padding:0};var styles=[];for(var k in style){styles.push(k+":"+style[k]+";")}$(iframe).attr({style:styles.join(" "),scrolling:"no",referrerpolicy:"no-referrer",allowfullscreen:"yes",sandbox:["allow-forms","allow-modals","allow-orientation-lock","allow-pointer-lock","allow-popups","allow-popups-to-escape-sandbox","allow-presentation","allow-same-origin","allow-scripts","allow-top-navigation","allow-top-navigation-by-user-activation"].join(" ")});window.document.body.scrollTop=0;iframe.contentDocument.activeElement.focus()}.bind(this);Adapt$1.on("iframe:change",resizeMe);Adapt$1.on("iframe:change",_.debounce(resizeMe,100));Adapt$1.on("iframe:change",_.debounce(resizeMe,500))}});__AMD("extensions/adapt-iOSScrollFix/js/adapt-iOSScrollFix",new Extension);const position={};function savePosition(){if(!isEnabled())return;position[Adapt$1.location._currentId]=$(window).scrollTop()}function restorePosition(){if(!isEnabled())return;const savedPosition=position[Adapt$1.location._currentId];if(!savedPosition)return;$(window).scrollTop(savedPosition)}function isEnabled(){if(!Adapt$1.location._currentId)return false;const model=Adapt$1.findById(Adapt$1.location._currentId);const config=model.get("_keepScrollPosition");return config&&config._isEnabled}Adapt$1.on({"menuView:ready pageView:ready":restorePosition,remove:savePosition});var menuBackground=Backbone__default["default"].View.extend({className:"extension",initialize:function(){}});Adapt$1.on("pageView:ready",(function(){if(!Adapt$1.course.get("_menuBackground"))return;if(Adapt$1.course.get("_menuBackground")._menuHeader._applyToPage||!(Adapt$1.course.get("_menuBackground")._menuHeader._link==="")){$(".page-header").css("background","url("+Adapt$1.course.get("_menuBackground")._menuHeader._link+")");$(".page-header").css("background-size","cover");$(".page-header").attr({role:"img","aria-label":""})}}));Adapt$1.on("menuView:ready",(function(){if(!Adapt$1.course.get("_menuBackground"))return;if(!(Adapt$1.course.get("_menuBackground")._menuHeader._link==="")){$(".menu__header").css("background","url("+Adapt$1.course.get("_menuBackground")._menuHeader._link+")");$(".menu__header").css("background-size","cover")}if(!(Adapt$1.course.get("_menuBackground")._backgroundLink==="")){$(".menu__inner").css("background","url("+Adapt$1.course.get("_menuBackground")._backgroundLink+")");$(".menu__inner").css("background-size","cover");$(".menu__inner").css("background-position-y","300px")}}));__AMD("extensions/adapt-menu-background/js/adapt-menu-background",menuBackground);var LogoView=Backbone.View.extend({className:"navigation-logo",initialize:function(){this.render();this.listenTo(Adapt$1,"device:changed",this.onDeviceResize)},onDeviceResize:function(){this.postRender()},postRender:function(){var config=this.model.get("_graphic");if(this.model.get("_hideLogoForMobile")){this.hideLogoForMobile()}if(config&&config._mobileSrc){this.setLogoImageSrc(config)}},hideLogoForMobile:function(){var isDeviceSmall=Adapt$1.device.screenSize==="small";$(".navigation-logo__image").toggleClass("u-display-none",isDeviceSmall)},setLogoImageSrc:function(config){var src=Adapt$1.device.screenSize==="small"?config._mobileSrc:config.src;$(".navigation-logo__image").attr("src",src)},render:function(){var data=this.model.toJSON();this.$el.html(Handlebars.templates[this.constructor.template](data));_.defer(this.postRender.bind(this));return this}},{template:"navigationLogo"});var LogoView$1=__AMD("extensions/adapt-navigationLogo/js/LogoView",LogoView);var NavigationLogo=Backbone.Controller.extend({initialize:function(){this.listenTo(Adapt$1,"adapt:initialize",this.onDataReady)},onDataReady:function(){if(this.logoView)this.logoView.remove();var config=Adapt$1.course.get("_navigationLogo");if(!config||!config._isEnabled)return;this.logoView=new LogoView$1({model:new Backbone.Model(config)});var selector=".js-nav-back-btn";this.logoView.$el.insertAfter($(selector))}});__AMD("extensions/adapt-navigationLogo/js/adapt-navigationLogo",new NavigationLogo);var orig={onKeyUp:NotifyView.prototype.onKeyUp};NotifyView.prototype.onKeyUp=function(options){if(navigator.onLine!==false||!Adapt$1.course.get("_offline")._modal){orig.onKeyUp.apply(this,arguments)}};var configDefaults={_isEnabled:false,_notifyWhenOffline:true,_notifyWhenOnline:false,_modal:false,_offlineMessageTitle:"Warning",_offlineMessageBody:"You are not online",_onlineMessageTitle:"Information",_onlineMessageBody:"You are online"};var OfflineView=Backbone.View.extend({events:{click:"onClick"},initialize:function(){this.listenTo(Adapt$1,"notify:opened",this.onNotifyOpened);this.listenTo(Adapt$1,"notify:closed",this.onNotifyClosed);$(window).on("offline",_.bind(this.onNotifiedOffline,this));$(window.parent).on("beforeunload",_.bind(this.onNotifiedOffline,this));if(navigator.onLine===false)this.onNotifiedOffline()},pauseAV:function(){$("embed object").each((function(index,el){if(el.pauseMedia)el.pauseMedia()}));$("video").each((function(index,el){if(el.pause)el.pause()}));Adapt$1.trigger("audio:stop")},triggerOnlinePopup:function(){var config=Adapt$1.course.get("_offline");var alertObject={_classes:"online",title:config._onlineMessageTitle,body:config._onlineMessageBody,_isCancellable:true};if(this.notifyView)this.notifyView.closeNotify();this.pauseAV();Adapt$1.trigger("notify:popup",alertObject)},triggerOfflinePopup:function(){var config=Adapt$1.course.get("_offline");var alertObject={_classes:"offline"+(config._modal?" modal":""),title:config._offlineMessageTitle,body:config._offlineMessageBody,_isCancellable:true};if(this.notifyView)this.notifyView.closeNotify();this.pauseAV();Adapt$1.trigger("notify:popup",alertObject)},onNotifyOpened:function(notifyView){this.notifyView=notifyView},onNotifyClosed:function(){this.notifyView=null},onNotifiedOnline:function(){var config=Adapt$1.course.get("_offline");this.$el.removeClass("offline modal");if(config._notifyWhenOnline)this.triggerOnlinePopup();else if(this.notifyView)this.notifyView.closeNotify()},onNotifiedOffline:function(){var config=Adapt$1.course.get("_offline");this.$el.addClass("offline"+(config._modal?" modal":""));if(config._notifyWhenOffline)this.triggerOfflinePopup();else if(this.notifyView)this.notifyView.closeNotify()},onClick:function(){navigator.onLine?this.triggerOnlinePopup():this.triggerOfflinePopup()}});function setup(){new OfflineView({el:$(".navigation-logo")})}Adapt$1.on("adapt:initialize",(function(){var config=_.extend({},configDefaults,Adapt$1.course.get("_offline"));Adapt$1.course.set("_offline",config);if(config._isEnabled)setup()}));const PageIncompletePrompt=Backbone.Controller.extend({PLUGIN_NAME:"_pageIncompletePrompt",handleRoute:true,inPage:false,inPopup:false,isChangingLanguage:false,pageModel:null,model:null,_ignoreAccessibilityNavigation:false,initialize:function(){this.setupEventListeners()},setupEventListeners:function(){this.listenTo(Adapt$1,{"app:languageChanged":this.onLanguageChanging,"pageView:ready":this.onPageViewReady,"pageIncompletePrompt:leavePage":this.onLeavePage,"pageIncompletePrompt:cancel":this.onLeaveCancel,"router:navigate":this.onRouterNavigate});this.listenToOnce(Adapt$1,"app:dataLoaded",(function(){this.setupModel();this.listenTo(Adapt$1,"accessibility:toggle",this.onAccessibilityToggle)}))},onLanguageChanging:function(){this.isChangingLanguage=true;this.setupModel();Adapt$1.once("router:page",function(){this.isChangingLanguage=false}.bind(this))},setupModel:function(){this.model=Adapt$1.course.get(this.PLUGIN_NAME)},onPageViewReady:function(){this.inPage=true;this.pageModel=Adapt$1.findById(Adapt$1.location._currentId)},onLeavePage:function(){if(!this.inPopup)return;this.inPopup=false;this.stopListening(Adapt$1,"notify:cancelled");this.enableRouterNavigation(true);this.handleRoute=false;this.inPage=false;window.location.href=this.href;this.handleRoute=true},onLeaveCancel:function(){if(!this.inPopup)return;this.inPopup=false;this.stopListening(Adapt$1,"notify:cancelled");this.enableRouterNavigation(true);this.handleRoute=true},onRouterNavigate:function(routeArguments){if(!this.isEnabled()||this.pageModel.get("_isComplete"))return;this.href=/#/.test(window.location.href)?window.location.href:window.location.href+"#";const id=routeArguments[0];if(id){if(id===Adapt$1.location._currentId)return;const model=Adapt$1.findById(id);const parent=model&&model.findAncestor("contentObjects");if(parent&&parent.get("_id")===this.pageModel.get("_id")){return}}if(this._ignoreAccessibilityNavigation){this._ignoreAccessibilityNavigation=false;return}this.enableRouterNavigation(false);this.showPrompt()},onAccessibilityToggle:function(){if(Adapt$1.device.touch){this._ignoreAccessibilityNavigation=false;return}this._ignoreAccessibilityNavigation=true},showPrompt:function(){const promptObject={title:this.model.title,body:this.model.message,_classes:"is-pageincompleteprompt "+(this.model._classes||""),_prompts:[{promptText:this.model._buttons.yes,_callbackEvent:"pageIncompletePrompt:leavePage"},{promptText:this.model._buttons.no,_callbackEvent:"pageIncompletePrompt:cancel"}],_showIcon:true};const pipConfig=this.pageModel.get("_pageIncompletePrompt");if(pipConfig&&pipConfig._buttons){promptObject.title=pipConfig.title;promptObject.body=pipConfig.message;promptObject._classes=pipConfig._classes;promptObject._prompts[0].promptText=pipConfig._buttons.yes;promptObject._prompts[1].promptText=pipConfig._buttons.no}this.listenToOnce(Adapt$1,"notify:cancelled",this.onLeaveCancel);Adapt$1.trigger("notify:prompt",promptObject);this.inPopup=true},isEnabled:function(){if(!Adapt$1.location._currentId)return false;if(!this.handleRoute)return false;if(!this.inPage)return false;if(this.inPopup)return false;if(this.isChangingLanguage)return false;switch(Adapt$1.location._contentType){case"menu":case"course":this.inPage=false;return false}const pageModel=Adapt$1.findById(Adapt$1.location._currentId);if(pageModel.get("_isOptional"))return false;const isEnabledForCourse=this.model&&!!this.model._isEnabled;const isEnabledForPage=pageModel.get("_pageIncompletePrompt")&&!!pageModel.get("_pageIncompletePrompt")._isEnabled;return isEnabledForCourse&&isEnabledForPage!==false||isEnabledForPage},enableRouterNavigation:function(value){Adapt$1.router.set("_canNavigate",value,{pluginName:this.PLUGIN_NAME})}});__AMD("extensions/adapt-pageIncompletePrompt/js/adapt-pageIncompletePrompt",new PageIncompletePrompt);var SearchDrawerItemView=__AMD("extensions/adapt-search/js/searchDrawerItemView",class SearchDrawerItemView extends Backbone.View{className(){return"search"}events(){return{"click .js-search-textbox-change":this.onSearch,"keyup .js-search-textbox-change":this.onSearch}}initialize(options){this.listenTo(Adapt$1,"drawer:empty",this.remove);this.render();this.search=_.debounce(this.onSearch.bind(this),1e3);if(!options.query)return;this.$(".js-search-textbox-change").val(options.query)}render(){const data=this.model.toJSON();const template=Handlebars.templates.searchBox;this.$el.html(template(data));return this}onSearch(event){if(event&&event.preventDefault)event.preventDefault();const query=this.$(".js-search-textbox-change").val();Adapt$1.trigger("search:query",query)}});const WORD_CHARACTERS=["A-Z","0-9","a-z","ª","µ","º","À-Ö","Ø-ö","ø-ˁ","ˆ-ˑ","ˠ-ˤ","ˬ","ˮ","Ͱ-ʹ","Ͷ","ͷ","ͺ-ͽ","Ά","Έ-Ί","Ό","Ύ-Ρ","Σ-ϵ","Ϸ-ҁ","Ҋ-ԧ","Ա-Ֆ","ՙ","ա-և","א-ת","װ-ײ","ؠ-ي","ٮ","ٯ","ٱ-ۓ","ە","ۥ","ۦ","ۮ","ۯ","ۺ-ۼ","ۿ","ܐ","ܒ-ܯ","ݍ-ޥ","ޱ","ߊ-ߪ","ߴ","ߵ","ߺ","ࠀ-ࠕ","ࠚ","ࠤ","ࠨ","ࡀ-ࡘ","ࢠ","ࢢ-ࢬ","ऄ-ह","ऽ","ॐ","क़-ॡ","ॱ-ॷ","ॹ-ॿ","অ-ঌ","এ","ঐ","ও-ন","প-র","ল","শ-হ","ঽ","ৎ","ড়","ঢ়","য়-ৡ","ৰ","ৱ","ਅ-ਊ","ਏ","ਐ","ਓ-ਨ","ਪ-ਰ","ਲ","ਲ਼","ਵ","ਸ਼","ਸ","ਹ","ਖ਼-ੜ","ਫ਼","ੲ-ੴ","અ-ઍ","એ-ઑ","ઓ-ન","પ-ર","લ","ળ","વ-હ","ઽ","ૐ","ૠ","ૡ","ଅ-ଌ","ଏ","ଐ","ଓ-ନ","ପ-ର","ଲ","ଳ","ଵ-ହ","ଽ","ଡ଼","ଢ଼","ୟ-ୡ","ୱ","ஃ","அ-ஊ","எ-ஐ","ஒ-க","ங","ச","ஜ","ஞ","ட","ண","த","ந-ப","ம-ஹ","ௐ","అ-ఌ","ఎ-ఐ","ఒ-న","ప-ళ","వ-హ","ఽ","ౘ","ౙ","ౠ","ౡ","ಅ-ಌ","ಎ-ಐ","ಒ-ನ","ಪ-ಳ","ವ-ಹ","ಽ","ೞ","ೠ","ೡ","ೱ","ೲ","അ-ഌ","എ-ഐ","ഒ-ഺ","ഽ","ൎ","ൠ","ൡ","ൺ-ൿ","අ-ඖ","ක-න","ඳ-ර","ල","ව-ෆ","ก-ะ","า","ำ","เ-ๆ","ກ","ຂ","ຄ","ງ","ຈ","ຊ","ຍ","ດ-ທ","ນ-ຟ","ມ-ຣ","ລ","ວ","ສ","ຫ","ອ-ະ","າ","ຳ","ຽ","ເ-ໄ","ໆ","ໜ-ໟ","ༀ","ཀ-ཇ","ཉ-ཬ","ྈ-ྌ","က-ဪ","ဿ","ၐ-ၕ","ၚ-ၝ","ၡ","ၥ","ၦ","ၮ-ၰ","ၵ-ႁ","ႎ","Ⴀ-Ⴥ","Ⴧ","Ⴭ","ა-ჺ","ჼ-ቈ","ቊ-ቍ","ቐ-ቖ","ቘ","ቚ-ቝ","በ-ኈ","ኊ-ኍ","ነ-ኰ","ኲ-ኵ","ኸ-ኾ","ዀ","ዂ-ዅ","ወ-ዖ","ዘ-ጐ","ጒ-ጕ","ጘ-ፚ","ᎀ-ᎏ","Ꭰ-Ᏼ","ᐁ-ᙬ","ᙯ-ᙿ","ᚁ-ᚚ","ᚠ-ᛪ","ᜀ-ᜌ","ᜎ-ᜑ","ᜠ-ᜱ","ᝀ-ᝑ","ᝠ-ᝬ","ᝮ-ᝰ","ក-ឳ","ៗ","ៜ","ᠠ-ᡷ","ᢀ-ᢨ","ᢪ","ᢰ-ᣵ","ᤀ-ᤜ","ᥐ-ᥭ","ᥰ-ᥴ","ᦀ-ᦫ","ᧁ-ᧇ","ᨀ-ᨖ","ᨠ-ᩔ","ᪧ","ᬅ-ᬳ","ᭅ-ᭋ","ᮃ-ᮠ","ᮮ","ᮯ","ᮺ-ᯥ","ᰀ-ᰣ","ᱍ-ᱏ","ᱚ-ᱽ","ᳩ-ᳬ","ᳮ-ᳱ","ᳵ","ᳶ","ᴀ-ᶿ","Ḁ-ἕ","Ἐ-Ἕ","ἠ-ὅ","Ὀ-Ὅ","ὐ-ὗ","Ὑ","Ὓ","Ὕ","Ὗ-ώ","ᾀ-ᾴ","ᾶ-ᾼ","ι","ῂ-ῄ","ῆ-ῌ","ῐ-ΐ","ῖ-Ί","ῠ-Ῥ","ῲ-ῴ","ῶ-ῼ","ⁱ","ⁿ","ₐ-ₜ","ℂ","ℇ","ℊ-ℓ","ℕ","ℙ-ℝ","ℤ","Ω","ℨ","K-ℭ","ℯ-ℹ","ℼ-ℿ","ⅅ-ⅉ","ⅎ","Ↄ","ↄ","Ⰰ-Ⱞ","ⰰ-ⱞ","Ⱡ-ⳤ","Ⳬ-ⳮ","Ⳳ","ⳳ","ⴀ-ⴥ","ⴧ","ⴭ","ⴰ-ⵧ","ⵯ","ⶀ-ⶖ","ⶠ-ⶦ","ⶨ-ⶮ","ⶰ-ⶶ","ⶸ-ⶾ","ⷀ-ⷆ","ⷈ-ⷎ","ⷐ-ⷖ","ⷘ-ⷞ","ⸯ","々","〆","〱-〵","〻","〼","ぁ-ゖ","ゝ-ゟ","ァ-ヺ","ー-ヿ","ㄅ-ㄭ","ㄱ-ㆎ","ㆠ-ㆺ","ㇰ-ㇿ","㐀-䶵","一-鿌","ꀀ-ꒌ","ꓐ-ꓽ","ꔀ-ꘌ","ꘐ-ꘟ","ꘪ","ꘫ","Ꙁ-ꙮ","ꙿ-ꚗ","ꚠ-ꛥ","ꜗ-ꜟ","Ꜣ-ꞈ","Ꞌ-ꞎ","Ꞑ-ꞓ","Ꞡ-Ɦ","ꟸ-ꠁ","ꠃ-ꠅ","ꠇ-ꠊ","ꠌ-ꠢ","ꡀ-ꡳ","ꢂ-ꢳ","ꣲ-ꣷ","ꣻ","ꤊ-ꤥ","ꤰ-ꥆ","ꥠ-ꥼ","ꦄ-ꦲ","ꧏ","ꨀ-ꨨ","ꩀ-ꩂ","ꩄ-ꩋ","ꩠ-ꩶ","ꩺ","ꪀ-ꪯ","ꪱ","ꪵ","ꪶ","ꪹ-ꪽ","ꫀ","ꫂ","ꫛ-ꫝ","ꫠ-ꫪ","ꫲ-ꫴ","ꬁ-ꬆ","ꬉ-ꬎ","ꬑ-ꬖ","ꬠ-ꬦ","ꬨ-ꬮ","ꯀ-ꯢ","가-힣","ힰ-ퟆ","ퟋ-ퟻ","豈-舘","並-龎","ﬀ-ﬆ","ﬓ-ﬗ","יִ","ײַ-ﬨ","שׁ-זּ","טּ-לּ","מּ","נּ","סּ","ףּ","פּ","צּ-ﮱ","ﯓ-ﴽ","ﵐ-ﶏ","ﶒ-ﷇ","ﷰ-ﷻ","ﹰ-ﹴ","ﹶ-ﻼ","Ａ-Ｚ","ａ-ｚ","ｦ-ﾾ","ￂ-ￇ","ￊ-ￏ","ￒ-ￗ","ￚ-ￜ"].join("");var WORD_CHARACTERS$1=__AMD("extensions/adapt-search/js/WORD_CHARACTERS",WORD_CHARACTERS);var escapeRegExp=__AMD("extensions/adapt-search/js/escapeRegExp",(function escapeRegExp(str){return str.replace(/[-[\]/{}()*+?.\\^$|]/g,"\\$&")}));const accentedCharacterMap=[{base:"A",letters:"AⒶＡÀÁÂẦẤẪẨÃĀĂẰẮẴẲȦǠÄǞẢÅǺǍȀȂẠẬẶḀĄȺⱯ"},{base:"AA",letters:"Ꜳ"},{base:"AE",letters:"ÆǼǢ"},{base:"AO",letters:"Ꜵ"},{base:"AU",letters:"Ꜷ"},{base:"AV",letters:"ꜸꜺ"},{base:"AY",letters:"Ꜽ"},{base:"B",letters:"BⒷＢḂḄḆɃƂƁ"},{base:"C",letters:"CⒸＣĆĈĊČÇḈƇȻꜾ"},{base:"D",letters:"DⒹＤḊĎḌḐḒḎĐƋƊƉꝹ"},{base:"DZ",letters:"ǱǄ"},{base:"Dz",letters:"ǲǅ"},{base:"E",letters:"EⒺＥÈÉÊỀẾỄỂẼĒḔḖĔĖËẺĚȄȆẸỆȨḜĘḘḚƐƎ"},{base:"F",letters:"FⒻＦḞƑꝻ"},{base:"G",letters:"GⒼＧǴĜḠĞĠǦĢǤƓꞠꝽꝾ"},{base:"H",letters:"HⒽＨĤḢḦȞḤḨḪĦⱧⱵꞍ"},{base:"I",letters:"IⒾＩÌÍÎĨĪĬİÏḮỈǏȈȊỊĮḬƗ"},{base:"J",letters:"JⒿＪĴɈ"},{base:"K",letters:"KⓀＫḰǨḲĶḴƘⱩꝀꝂꝄꞢ"},{base:"L",letters:"LⓁＬĿĹĽḶḸĻḼḺŁȽⱢⱠꝈꝆꞀ"},{base:"LJ",letters:"Ǉ"},{base:"Lj",letters:"ǈ"},{base:"M",letters:"MⓂＭḾṀṂⱮƜ"},{base:"N",letters:"NⓃＮǸŃÑṄŇṆŅṊṈȠƝꞐꞤ"},{base:"NJ",letters:"Ǌ"},{base:"Nj",letters:"ǋ"},{base:"O",letters:"OⓄＯÒÓÔỒỐỖỔÕṌȬṎŌṐṒŎȮȰÖȪỎŐǑȌȎƠỜỚỠỞỢỌỘǪǬØǾƆƟꝊꝌ"},{base:"OI",letters:"Ƣ"},{base:"OO",letters:"Ꝏ"},{base:"OU",letters:"Ȣ"},{base:"P",letters:"PⓅＰṔṖƤⱣꝐꝒꝔ"},{base:"Q",letters:"QⓆＱꝖꝘɊ"},{base:"R",letters:"RⓇＲŔṘŘȐȒṚṜŖṞɌⱤꝚꞦꞂ"},{base:"S",letters:"SⓈＳẞŚṤŜṠŠṦṢṨȘŞⱾꞨꞄ"},{base:"T",letters:"TⓉＴṪŤṬȚŢṰṮŦƬƮȾꞆ"},{base:"TZ",letters:"Ꜩ"},{base:"U",letters:"UⓊＵÙÚÛŨṸŪṺŬÜǛǗǕǙỦŮŰǓȔȖƯỪỨỮỬỰỤṲŲṶṴɄ"},{base:"V",letters:"VⓋＶṼṾƲꝞɅ"},{base:"VY",letters:"Ꝡ"},{base:"W",letters:"WⓌＷẀẂŴẆẄẈⱲ"},{base:"X",letters:"XⓍＸẊẌ"},{base:"Y",letters:"YⓎＹỲÝŶỸȲẎŸỶỴƳɎỾ"},{base:"Z",letters:"ZⓏＺŹẐŻŽẒẔƵȤⱿⱫꝢ"},{base:"a",letters:"aⓐａẚàáâầấẫẩãāăằắẵẳȧǡäǟảåǻǎȁȃạậặḁąⱥɐ"},{base:"aa",letters:"ꜳ"},{base:"ae",letters:"æǽǣ"},{base:"ao",letters:"ꜵ"},{base:"au",letters:"ꜷ"},{base:"av",letters:"ꜹꜻ"},{base:"ay",letters:"ꜽ"},{base:"b",letters:"bⓑｂḃḅḇƀƃɓ"},{base:"c",letters:"cⓒｃćĉċčçḉƈȼꜿↄ"},{base:"d",letters:"dⓓｄḋďḍḑḓḏđƌɖɗꝺ"},{base:"dz",letters:"ǳǆ"},{base:"e",letters:"eⓔｅèéêềếễểẽēḕḗĕėëẻěȅȇẹệȩḝęḙḛɇɛǝ"},{base:"f",letters:"fⓕｆḟƒꝼ"},{base:"g",letters:"gⓖｇǵĝḡğġǧģǥɠꞡᵹꝿ"},{base:"h",letters:"hⓗｈĥḣḧȟḥḩḫẖħⱨⱶɥ"},{base:"hv",letters:"ƕ"},{base:"i",letters:"iⓘｉìíîĩīĭïḯỉǐȉȋịįḭɨı"},{base:"j",letters:"jⓙｊĵǰɉ"},{base:"k",letters:"kⓚｋḱǩḳķḵƙⱪꝁꝃꝅꞣ"},{base:"l",letters:"lⓛｌŀĺľḷḹļḽḻſłƚɫⱡꝉꞁꝇ"},{base:"lj",letters:"ǉ"},{base:"m",letters:"mⓜｍḿṁṃɱɯ"},{base:"n",letters:"nⓝｎǹńñṅňṇņṋṉƞɲŉꞑꞥ"},{base:"nj",letters:"ǌ"},{base:"o",letters:"oⓞｏòóôồốỗổõṍȭṏōṑṓŏȯȱöȫỏőǒȍȏơờớỡởợọộǫǭøǿɔꝋꝍɵ"},{base:"oi",letters:"ƣ"},{base:"ou",letters:"ȣ"},{base:"oo",letters:"ꝏ"},{base:"p",letters:"pⓟｐṕṗƥᵽꝑꝓꝕ"},{base:"q",letters:"qⓠｑɋꝗꝙ"},{base:"r",letters:"rⓡｒŕṙřȑȓṛṝŗṟɍɽꝛꞧꞃ"},{base:"s",letters:"sⓢｓßśṥŝṡšṧṣṩșşȿꞩꞅẛ"},{base:"t",letters:"tⓣｔṫẗťṭțţṱṯŧƭʈⱦꞇ"},{base:"tz",letters:"ꜩ"},{base:"u",letters:"uⓤｕùúûũṹūṻŭüǜǘǖǚủůűǔȕȗưừứữửựụṳųṷṵʉ"},{base:"v",letters:"vⓥｖṽṿʋꝟʌ"},{base:"vy",letters:"ꝡ"},{base:"w",letters:"wⓦｗẁẃŵẇẅẘẉⱳ"},{base:"x",letters:"xⓧｘẋẍ"},{base:"y",letters:"yⓨｙỳýŷỹȳẏÿỷẙỵƴɏỿ"},{base:"z",letters:"zⓩｚźẑżžẓẕƶȥɀⱬꝣ"}];const flattedAccentedCharacters=accentedCharacterMap.reduce(((flattedAccentedCharacters,item)=>{item.letters.split("").forEach((letter=>{flattedAccentedCharacters[letter]=item.base;return flattedAccentedCharacters}));return flattedAccentedCharacters}),{});var replaceAccents=__AMD("extensions/adapt-search/js/replaceAccents",(function replaceAccents(str){const accentReplacer=function(chr){return flattedAccentedCharacters[chr]||chr};return str.replace(/\S/g,accentReplacer)}));var SearchResultsView=__AMD("extensions/adapt-search/js/searchResultsView",class SearchResultsView extends Backbone.View{className(){return"search__items-container is-inactive"}events(){return{"click [data-id]":"navigateToResultPage"}}initialize(){let{searchObject:searchObject=null}=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.listenTo(Adapt$1,{"drawer:empty":this.remove,"search:queried":this.updateResults});this.render();if(!searchObject)return;this.updateResults(searchObject)}render(){const template=Handlebars.templates.searchResults;$(this.el).html(template());return this}updateResults(searchObject){this.$el.removeClass("is-inactive");const formattedResults=this.formatResults(searchObject);this.renderResults(formattedResults)}formatResults(searchObject){const stripHTMLAndHandlebars=text=>{const replaceTagsRegEx=/<{1}[^>]+>/g;const replaceEscapedTagsRegEx=/&lt;[^&gt;]+&gt;/g;const replaceEndTagsRegEx=/<{1}\/{1}[^>]+>/g;const replaceEscapedEndTagsRegEx=/&lt;\/[^&gt;]+&gt;/g;const replaceHandlebarsRegEx=/{{[^}}]*/g;const replaceHandlebarsEndRegEx=/}}/g;text=$(`<span>${text}</span>`).html();return text.replace(replaceEndTagsRegEx," ").replace(replaceTagsRegEx,"").replace(replaceEscapedEndTagsRegEx," ").replace(replaceEscapedTagsRegEx,"").replace(replaceHandlebarsRegEx," ").replace(replaceHandlebarsEndRegEx,"").trim()};const checkSkipTitlePhrases=(title,result)=>result.foundPhrases.find((foundPhrase=>{const lowerPhrase=stripHTMLAndHandlebars(foundPhrase.phrase).toLowerCase();const lowerTitle=title.toLowerCase();const isNotTitle=lowerPhrase!==lowerTitle;return isNotTitle}))||result.foundPhrases[result.foundPhrases.length-1];const makeTextPreview=result=>{const numberOfPreviewCharacters=this.model.get("_previewCharacters");const numberOfPreviewWords=this.model.get("_previewWords");const bodyPrettify=new RegExp(`(([^${WORD_CHARACTERS$1}]*[${WORD_CHARACTERS$1}]{1}){1,${numberOfPreviewWords*2}}|.{0,${numberOfPreviewCharacters*2}})`,"i");const title=stripHTMLAndHandlebars(result.model.get("_search")?.title||"")||stripHTMLAndHandlebars(result.model.get("title"))||stripHTMLAndHandlebars(result.model.get("displayTitle"))||"No title found";const safeTitle=replaceAccents(title);const body=stripHTMLAndHandlebars(result.model.get("body"))||"";const hasNoFoundPhrases=result.foundPhrases.length===0;if(hasNoFoundPhrases){const textPreview=body.match(bodyPrettify)[0]+"...";return[title,textPreview]}const foundPhrase=checkSkipTitlePhrases(title,result);const phrase=stripHTMLAndHandlebars(foundPhrase.phrase);const safePhrase=stripHTMLAndHandlebars(foundPhrase.safePhrase);const lowerPhrase=safePhrase.toLowerCase();const lowerTitle=safeTitle.toLowerCase();if(lowerPhrase===lowerTitle){const textPreview=body.match(bodyPrettify)[0]+"...";return[title,textPreview]}const word=result.foundWords.slice(0).sort(((a,b)=>a.count-b.count)).find((_ref=>{let{word:word}=_ref;return lowerPhrase.includes(word)})).word;const snippetMatcher=new RegExp(`(([^${WORD_CHARACTERS$1}]*[${WORD_CHARACTERS$1}]{1}){1,${numberOfPreviewWords}}|.{0,${numberOfPreviewCharacters}})${escapeRegExp(word)}(([${WORD_CHARACTERS$1}]{1}[^${WORD_CHARACTERS$1}]*){1,${numberOfPreviewWords}}|.{0,${numberOfPreviewCharacters}})`,"i");const snippet=safePhrase.match(snippetMatcher)[0];const snippetIndexInPhrase=safePhrase.indexOf(snippet);const snippetEndInPhrase=snippetIndexInPhrase+snippet.length;const isSnippetAtPhraseStart=snippetIndexInPhrase===0;const isSnippetAtPhraseEnd=snippetEndInPhrase===phrase.length;const unsafeSnippet=phrase.slice(snippetIndexInPhrase,snippetEndInPhrase);const textPreview=`${isSnippetAtPhraseStart?"":"..."}${unsafeSnippet}${isSnippetAtPhraseEnd?"":"..."}`;return[title,textPreview]};const wrapWordsWithSpan=(words,text)=>{const tagWords=words.map((_ref2=>{let{word:word}=_ref2;return word}));const initial=[];while(text){const lowerCaseText=text.toLowerCase();const wordTextPositions=tagWords.map((word=>lowerCaseText.indexOf(word)));const firstWordIndex=wordTextPositions.reduce(((firstWordIndex,wordTextPosition,wordIndex)=>{if(wordTextPosition===-1)return firstWordIndex;if(firstWordIndex===-1)return wordIndex;const firstWordTextPosition=wordTextPositions[firstWordIndex];if(wordTextPosition>=firstWordTextPosition)return firstWordIndex;return wordIndex}),-1);if(firstWordIndex===-1)break;const word=tagWords[firstWordIndex];const wordTextPosition=wordTextPositions[firstWordIndex];initial.push(text.slice(0,wordTextPosition));initial.push(`<span class='is-found'>${text.slice(wordTextPosition,wordTextPosition+word.length)}</span>`);text=text.slice(wordTextPosition+word.length,text.length)}initial.push(text);return initial.join("")};const resultsLimit=Math.min(5,searchObject.searchResults.length);const formattedResults=searchObject.searchResults.slice(0,resultsLimit).map((result=>{const[title,textPreview]=makeTextPreview(result);return{title:title,textPreview:textPreview,titleTagged:wrapWordsWithSpan(result.foundWords,title),textPreviewTagged:wrapWordsWithSpan(result.foundWords,textPreview),foundWords:result.foundWords.map((_ref3=>{let{word:word}=_ref3;return word})).join(" "),id:result.model.get("_id")}}));searchObject.formattedResults=formattedResults;return searchObject}renderResults(results){const template=Handlebars.templates.searchResultsContent;this.$(".search__items-container-inner").html(template(results))}navigateToResultPage(event){event&&event.preventDefault();const blockID=$(event.currentTarget).attr("data-id");Adapt$1.navigateToElement("."+blockID);Adapt$1.trigger("drawer:closeDrawer")}});const SEARCH_DEFAULTS={title:"Search",description:"Type in search words",placeholder:"",noResultsMessage:"Sorry, no results were found",awaitingResultsMessage:"Formulating results...",_previewWords:15,_previewCharacters:30,_showHighlights:true,_showFoundWords:true,_searchAttributes:[{_attributeName:"_search",_level:1,_allowTextPreview:false},{_attributeName:"_keywords",_level:1,_allowTextPreview:false},{_attributeName:"keywords",_level:1,_allowTextPreview:false},{_attributeName:"displayTitle",_level:2,_allowTextPreview:true},{_attributeName:"title",_level:2,_allowTextPreview:false},{_attributeName:"body",_level:3,_allowTextPreview:true},{_attributeName:"alt",_level:4,_allowTextPreview:false},{_attributeName:"_alt",_level:4,_allowTextPreview:false},{_attributeName:"_items",_level:5,_allowTextPreview:false},{_attributeName:"_options",_level:5,_allowTextPreview:false},{_attributeName:"items",_level:5,_allowTextPreview:false},{_attributeName:"text",_level:5,_allowTextPreview:true}],_hideComponents:["blank","assessmentResults"],_hideTypes:[],_ignoreWords:["a","an","and","are","as","at","be","by","for","from","has","he","in","is","it","its","of","on","that","the","to","was","were","will","wish",""],_matchOn:{_contentWordBeginsPhraseWord:false,_contentWordContainsPhraseWord:false,_contentWordEqualsPhraseWord:true,_phraseWordBeginsContentWord:true},_scoreQualificationThreshold:20,_minimumWordLength:2,_frequencyImportance:5};var SEARCH_DEFAULTS$1=__AMD("extensions/adapt-search/js/SEARCH_DEFAULTS",SEARCH_DEFAULTS);const matchNotWordBoundaries=new RegExp(`[${WORD_CHARACTERS$1}]+`,"g");const trimReplaceNonWordCharacters=new RegExp(`^([^${WORD_CHARACTERS$1}])+|([^${WORD_CHARACTERS$1}])+$`,"g");var SearchablePhrase=__AMD("extensions/adapt-search/js/SearchablePhrase",class SearchablePhrase{constructor(){let{phrase:phrase,score:score=null,level:level=null,allowTextPreview:allowTextPreview=null,searchAttribute:searchAttribute=null}=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.name=searchAttribute?._attributeName??null;this.phrase=phrase;this.safePhrase=replaceAccents(phrase).toLowerCase();this.level=level??searchAttribute?._level??null;this.score=score??(this.level!==null?1/this.level:null);this.allowTextPreview=allowTextPreview??searchAttribute?._allowTextPreview??null;const config=Adapt$1.course.get("_search");const ignoreWords=Array.isArray(config._ignoreWords)?config._ignoreWords:config._ignoreWords.split(",");const minimumWordLength=config._minimumWordLength;this.words=this.safePhrase.match(matchNotWordBoundaries).map((chunk=>chunk.replace(trimReplaceNonWordCharacters,""))).filter((word=>word.length>=minimumWordLength)).reduce(((wordCounts,word)=>{word=word.toLowerCase();if(ignoreWords.includes(word))return wordCounts;wordCounts[word]=wordCounts[word]||0;wordCounts[word]++;return wordCounts}),{})}static allFromModel(model){const htmlToText=html=>$(`<div>${html.trim()}</div>`).text().trim();const searchAttributes=Adapt$1.course.get("_search")._searchAttributes;const searchablePhrases=[];const processValue=(value,searchAttribute,level)=>{if(typeof value==="object")return _recursivelyCollectPhrases(value,searchAttribute._level);if(typeof value!=="string")return;const phrase=htmlToText(value);if(!phrase)return;searchablePhrases.push(new SearchablePhrase({phrase:phrase,level:level,searchAttribute:searchAttribute}))};const _recursivelyCollectPhrases=function(){let json=arguments.length>0&&arguments[0]!==undefined?arguments[0]:model.toJSON();let level=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;for(const searchAttribute of searchAttributes){const attributeName=searchAttribute._attributeName;const attributeValue=json[attributeName];if(!attributeValue)continue;if(Array.isArray(attributeValue)){for(const attributeValueItem of attributeValue){processValue(attributeValueItem,searchAttribute,level)}continue}processValue(attributeValue,searchAttribute,level)}};_recursivelyCollectPhrases();return searchablePhrases}});var SearchableWord=__AMD("extensions/adapt-search/js/SearchableWord",class SearchableWord{constructor(){let{word:word,score:score,count:count}=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.word=word;this.score=score;this.count=count}});var SearchableModel=__AMD("extensions/adapt-search/js/SearchableModel",class SearchableModel{constructor(){let{model:model}=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.model=model;this._phrases=null;this._words=null}get isSearchable(){const modelConfig=this.model.get("_search");if(modelConfig?._isEnabled===false)return false;const isUnavailableInPage=this.model.getAncestorModels(true).some((model=>model.get("_search")?._isEnabled===false||!model.get("_isAvailable")||model.get("_isLocked")||model.get("_isPartOfAssessment")));if(isUnavailableInPage)return false;const config=Adapt$1.course.get("_search");const hideComponents=config._hideComponents;const hideTypes=config._hideTypes;const component=this.model.get("_component");const type=this.model.get("_type");const shouldIgnore=hideTypes.includes(type)||type==="component"&&hideComponents.includes(component);if(shouldIgnore)return false;const displayTitle=this.model.get("displayTitle").trim();const title=this.model.get("title").trim();const hasTitleOrDisplayTitle=Boolean(displayTitle||title);return hasTitleOrDisplayTitle}get phrases(){if(this._phrases)return this._phrases;return this._phrases=SearchablePhrase.allFromModel(this.model)}get words(){if(this._words)return this._words;const config=Adapt$1.course.get("_search");const minimumWordLength=config._minimumWordLength;const ignoreWords=config._ignoreWords;const phrases=this.phrases;const indexedSearchableWords={};for(const phrase of phrases){for(const word in phrase.words){const count=phrase.words[word];const searchableWord=indexedSearchableWords[word]=indexedSearchableWords[word]||new SearchableWord({word:word,count:0,score:0});searchableWord.count+=count;searchableWord.score=Math.max(searchableWord.score,phrase.score)}}const words=Object.values(indexedSearchableWords).filter((_ref=>{let{word:word}=_ref;return word.length>=minimumWordLength&&!ignoreWords.includes(word)}));return this._words=words}static get all(){return Adapt$1.data.map((model=>new SearchableModel({model:model}))).filter((_ref2=>{let{isSearchable:isSearchable}=_ref2;return isSearchable}))}});var SearchObject=__AMD("extensions/adapt-search/js/SearchObject",class SearchObject{constructor(shouldSearch,searchPhrase,searchResults){const searchConfig=Adapt$1.course.get("_search");Object.assign(this,searchConfig,{query:searchPhrase,searchResults:searchResults,isAwaitingResults:searchPhrase.length!==0&&!shouldSearch,isBlank:searchPhrase.length===0})}});var SearchResult=__AMD("extensions/adapt-search/js/SearchResult",class SearchResult{constructor(){let{searchableModel:searchableModel,score:score=0,foundWords:foundWords=[],foundPhrases:foundPhrases=[]}=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.searchableModel=searchableModel;this.model=this.searchableModel.model;this.score=score;this.foundWords=foundWords;this.foundPhrases=foundPhrases}addFoundWord(word,isFullMatch,partMatchRatio){if(this.foundWords.find((_ref=>{let{word:matchWord}=_ref;return matchWord===word})))return;const config=Adapt$1.course.get("_search");const frequencyImportance=config._frequencyImportance;const searchableWord=this.searchableModel.words.find((_ref2=>{let{word:matchWord}=_ref2;return matchWord===word}));this.foundWords.push(searchableWord);const frequencyBonus=searchableWord.score*searchableWord.count/frequencyImportance;const wordFrequencyHitBonus=searchableWord.score+frequencyBonus;this.score+=isFullMatch?wordFrequencyHitBonus:wordFrequencyHitBonus*partMatchRatio;const foundWords=this.foundWords.map((_ref3=>{let{word:word}=_ref3;return word}));const phrases=this.searchableModel.phrases;this.foundPhrases=[];for(const phrase of phrases){if(!phrase.allowTextPreview)continue;if(!_.intersection(foundWords,Object.keys(phrase.words)).length>0)continue;this.foundPhrases.push(phrase)}}});var Searcher=__AMD("extensions/adapt-search/js/Searcher",class Searcher{constructor(){this.searchableModels=SearchableModel.all;this.wordIndex=this.searchableModels.reduce(((wordIndex,searchableModel)=>{searchableModel.words.forEach((_ref=>{let{word:word}=_ref;wordIndex[word]=wordIndex[word]||[];wordIndex[word].push(searchableModel)}));return wordIndex}),{})}query(searchPhrase){const config=Adapt$1.course.get("_search");const wordIndex=this.wordIndex;const scoreQualificationThreshold=config._scoreQualificationThreshold;const matchOn=config._matchOn||{};const findWords=new SearchablePhrase({phrase:searchPhrase}).words;const indexedSearchResults={};for(const findWord in findWords){for(const indexWord in wordIndex){const rIndexWordBegins=new RegExp("^"+escapeRegExp(indexWord),"g");const rFindWordContains=new RegExp(escapeRegExp(findWord),"g");const rFindWordBegins=new RegExp("^"+escapeRegExp(findWord),"g");const isIndexBeginsMatch=matchOn._contentWordBeginsPhraseWord===false?false:rIndexWordBegins.test(findWord);const isFindContainsMatch=matchOn._contentWordContainsPhraseWord===false?false:rFindWordContains.test(indexWord);const isFindBeginsMatch=matchOn._phraseWordBeginsContentWord===false?false:rFindWordBegins.test(indexWord);const isFullMatch=matchOn._contentWordEqualsPhraseWord===false?false:findWord===indexWord;const isPartMatch=isIndexBeginsMatch||isFindContainsMatch||isFindBeginsMatch;if(!isFullMatch&&!isPartMatch)continue;const partMatchRatio=isFullMatch?1:findWord.length>indexWord.length?indexWord.length/findWord.length:findWord.length/indexWord.length;wordIndex[indexWord].forEach((searchableModel=>{const id=searchableModel.model.get("_id");indexedSearchResults[id]=indexedSearchResults[id]||new SearchResult({searchableModel:searchableModel});indexedSearchResults[id].addFoundWord(indexWord,isFullMatch,partMatchRatio)}))}}const searchResults=Object.values(indexedSearchResults);const qualifyingScoreThreshold=1/scoreQualificationThreshold;const qualifyingSearchResults=searchResults.filter((item=>item.score>=qualifyingScoreThreshold)).sort(((a,b)=>b.score-a.score));return qualifyingSearchResults}search(searchPhrase){const config=Adapt$1.course.get("_search");const shouldSearch=searchPhrase.length>=config._minimumWordLength;const searchResults=shouldSearch?this.query(searchPhrase):[];return new SearchObject(shouldSearch,searchPhrase,searchResults)}});class Search extends Backbone.Controller{initialize(){this.isSetup=false;this.lastSearchQuery=null;this.lastSearchObject=null;this.reIndex=_.debounce(this.reIndex.bind(this),10);this.listenTo(Adapt$1,{"app:dataReady":this.onDataReady,"search:query":this.query,"resources:showSearch":this.onShowSearch,"drawer:openedItemView search:draw":this.onOpenedItemView,"drawer:closed":this.onDrawerClosed,"drawer:noItems":this.onNoItems,"change:_isStarted":this.onAdaptIsStartedChange})}onAdaptIsStartedChange(model,value){if(value)return;this.onPreLanguageChange()}onPreLanguageChange(){this.isSetup=false;this.stopListening(data$1,{"add remove change:_isAvailable change:_isLocked":this.reIndex})}onDataReady(){const config=Adapt$1.course.get("_search");if(!config||config._isEnabled===false)return;this.setupConfig()}setupConfig(){const model=Adapt$1.course.get("_search")||{};const modelWithDefaults=$.extend(true,{},SEARCH_DEFAULTS$1,model);Adapt$1.course.set("_search",modelWithDefaults);this.isSetup=true;this.listenTo(data$1,{"add remove change:_isAvailable change:_isLocked":this.reIndex});this.reIndex();this.clearSearchResults();this.addDrawerItem()}reIndex(){if(!this.isSetup)return;window.search=this.searcher=new Searcher}clearSearchResults(){this.lastSearchQuery=null;this.lastSearchObject=null}addDrawerItem(){const searchConfig=Adapt$1.course.get("_search");searchConfig.title=searchConfig.title||"Search";searchConfig.description=searchConfig.description||"Description";const drawerObject={title:searchConfig.title,description:searchConfig.description,className:"is-search",drawerOrder:searchConfig._drawerOrder||0};Adapt$1.drawer.addItem(drawerObject,"resources:showSearch")}onShowSearch(){if(this.isSearchShown)return;const searchConfig=Adapt$1.course.get("_search");const template=Handlebars.templates.searchSingleItem;const $element=$(template(searchConfig));Adapt$1.drawer.triggerCustomView($element,true);Adapt$1.trigger("search:draw")}onOpenedItemView(){this.isSearchShown=true;const searchConfigModel=new Backbone.Model(Adapt$1.course.get("_search"));const $searchDrawerButton=$(".is-search");if($searchDrawerButton.is(":not(div)")){const $replacementButton=$("<div></div>");$replacementButton.attr("class",$searchDrawerButton.attr("class"));$searchDrawerButton.children().appendTo($replacementButton);$searchDrawerButton.replaceWith($replacementButton)}if(this.lastSearchObject&&this.lastSearchObject.searchResults&&this.lastSearchObject.searchResults.length===0){this.lastSearchObject=null;this.lastSearchQuery=null}$(".drawer__holder .is-search").append(new SearchDrawerItemView({model:searchConfigModel,query:this.lastSearchQuery}).el).append(new SearchResultsView({model:searchConfigModel,searchObject:this.lastSearchObject}).el)}onDrawerClosed(){this.isSearchShown=false}query(query){if(!this.isSetup)return;this.lastSearchQuery=query;const searchObject=this.searcher.search(query);this.lastSearchObject=searchObject;Adapt$1.trigger("search:queried",searchObject)}onNoItems(){$(".nav-drawer-btn").removeClass("u-display-none")}}__AMD("extensions/adapt-search/js/adapt-search",Adapt$1.search=new Search);var CONF={MAX_WIDTH:340,ANIMATE_TOP:5,DURATION:5,PADDINGFACTOR:1.5,POSIONFROMTEXT:20,EASING:"linear"};var CONFIG=__AMD("extensions/adapt-tooltip/js/conf",CONF);var $tooltip=null;var $targetEle=null;function setUptoolTip(){window.tooltip=onMouseEnter;window.tooltipFocus=onMouseEnter}var onMouseEnter=function(evt){$targetEle=$(this);var tip=$targetEle.attr("data-title");if($targetEle.attr("data-type")!=undefined&&$targetEle.attr("data-type")!="undefined"){tip+=$targetEle.find(".pagelevelprogress__indicator-bar")[0].style.width}if(!tip||tip=="")return false;$tooltip=$('<div id="tooltip" role="tooltip"></div>');var lazyLayout=_.debounce(showTooltip,200);$tooltip.css("opacity",0).html(tip).appendTo("body");showTooltip();$(window).resize(_.bind(lazyLayout,this));$targetEle.on("mouseleave",removeTooltip);$targetEle.on("focusout",removeTooltip);$tooltip.on("click",removeTooltip);$(window).on("click scroll",removeTooltip)};function showTooltip(){if(!$tooltip||!$targetEle)return;setUptoolTipWidth();var targetEleLeft=$targetEle.offset().left;var targetEleTop=$targetEle[0].getBoundingClientRect().top;var targetEleWidth=$targetEle.outerWidth();var targetEleHeight=$targetEle.outerHeight();var tooltipWidth=$tooltip.outerWidth();var tooltipHeight=$tooltip.outerHeight();var posLeft=targetEleLeft+targetEleWidth/2-tooltipWidth/2;var posTop=targetEleTop-tooltipHeight-CONFIG.POSIONFROMTEXT;if(posLeft<0){posLeft=targetEleLeft+targetEleWidth/2-CONFIG.POSIONFROMTEXT;$tooltip.addClass("left")}else{$tooltip.removeClass("left")}if(posLeft+tooltipWidth>$(window).width()){posLeft=targetEleLeft-tooltipWidth+targetEleWidth/2+CONFIG.POSIONFROMTEXT;$tooltip.addClass("right")}else{$tooltip.removeClass("right")}if(posTop<0){var posTop=targetEleTop+targetEleHeight+targetEleTop;$tooltip.addClass("top")}else{$tooltip.removeClass("top")}$tooltip.css({left:posLeft,top:posTop}).animate({top:"+="+CONFIG.ANIMATE_TOP,opacity:1},CONFIG.DURATION,CONFIG.EASING)}function setUptoolTipWidth(){if($(window).width()<$tooltip.outerWidth()*CONFIG.PADDINGFACTOR){$tooltip.css("max-width",$(window).width()/2)}else{$tooltip.css("max-width",CONFIG.MAX_WIDTH)}}function removeTooltip(){$("#tooltip").remove()}Adapt$1.on("app:dataReady",(function(){var tooltip=Adapt$1.course.get("_tooltip");if(tooltip&&tooltip._isEnabled){setUptoolTip()}}));Adapt$1.on("menuView:postRender menuItemView:postRender pageView:postRender",(function(){var globalTooltip=Adapt$1.course.get("_tooltip")&&Adapt$1.course.get("_tooltip").globalTooltip;_.delay((()=>{_.each(globalTooltip,((tooltip,index)=>{_.each($(tooltip.selector),(ele=>{if(!$(ele).parent().hasClass("tooltip-span")){$(ele).wrap(`<span id="tooltip-span-${index}" class="tooltip-span" data-title="${tooltip.text}" data-rel="tooltip" data-type="${tooltip.type}" onmouseenter="tooltip.call(this)" onfocusin="tooltipFocus.call(this)"></span>`)}}))}))}),1e3)}));var TopNavigatorView=Backbone__default["default"].View.extend({className:"top-navigator-container ",initialize:function(){this.listenTo(Adapt$1,"remove",this.remove);this.listenTo(Adapt$1,"pageView:ready",this.onPageViewReady,this);window.addEventListener("scroll",_.bind(this.onScrollMove,this))},events:{"click .top-navigator-arrow":"scrollToPageToTop"},onPageViewReady:function(){this.render()},scrollToPageToTop:function(event){if(event&&event.preventDefault)event.preventDefault();$("body").velocity("scroll",{duration:1e3,easing:"easeInBack"})},onScrollMove:function(event){var scrollY=this.getScrollY();if(scrollY>100){this.$(".top-navigator-arrow").removeClass("visibility-hidden")}if(scrollY===0){this.$(".top-navigator-arrow").addClass("visibility-hidden")}},getScrollY:function(){return window.scrollY||window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop},render:function(){var data=this.model.toJSON();var template=Handlebars.templates["topNavigator"];var isTopNavigator=this.model.get("_topNavigator");if(isTopNavigator&&isTopNavigator._isEnabled){this.$el.html(template(data))}return this}});var TopNavigatorView$1=__AMD("extensions/adapt-topNavigator/js/topNavigatorView",TopNavigatorView);function setupTopNavigatorView(page){page.$el.append(new TopNavigatorView$1({model:page.model}).$el)}Adapt$1.on("pageView:postRender",(function(page){if(!Adapt$1.course.get("_topNavigator")||!Adapt$1.course.get("_topNavigator")._isEnabled){return}setupTopNavigatorView(page)}));var NAMED_COLOR=__AMD("extensions/adapt-visua11y/js/COLOR_NAMES",{transparent:"#00000000",black:"#000000",silver:"#c0c0c0",gray:"#808080",white:"#ffffff",maroon:"#800000",red:"#ff0000",purple:"#800080",fuchsia:"#ff00ff",green:"#008000",lime:"#00ff00",olive:"#808000",yellow:"#ffff00",navy:"#000080",blue:"#0000ff",teal:"#008080",aqua:"#00ffff",orange:"#ffa500",aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",blanchedalmond:"#ffebcd",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",oldlace:"#fdf5e6",olivedrab:"#6b8e23",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",whitesmoke:"#f5f5f5",yellowgreen:"#9acd32",rebeccapurple:"#663399"});class Color{constructor(){let color=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;this.h=null;this.s=null;this.l=null;this.r=null;this.g=null;this.b=null;this.a=null;this.luminance=null;if(color===null)return;this.parseString(color)}clone(){const clone=new Color;clone.h=this.h;clone.s=this.s;clone.l=this.l;clone.r=this.r;clone.g=this.g;clone.b=this.b;clone.a=this.a;clone.luminance=this.luminance;clone.source=this.source;return clone}parseString(color){color=color.toLowerCase();this.source=color;const isHEX=color.startsWith("#");const isRGB=color.startsWith("rgb");const isHSL=color.startsWith("hsl");if(isHEX)return this.parseHEXAString(color);if(isRGB)return this.parseRGBAString(color);if(isHSL)return this.parseHSLAString(color);return this.parseCOLORNAME(color)}parseHSLAString(hsla){const sep=hsla.indexOf(",")>-1?",":" ";hsla=hsla.substr(5).split(")")[0].split(sep);if(hsla.indexOf("/")>-1){hsla.splice(3,1)}let h=hsla[0];let s=hsla[1];let l=hsla[2];const a=parseFloat(hsla[3]??1);if(h.indexOf("deg")>-1){h=h.substr(0,h.length-3)}else if(h.indexOf("rad")>-1){h=Math.round(h.substr(0,h.length-3)*(180/Math.PI))}else if(h.indexOf("turn")>-1){h=Math.round(h.substr(0,h.length-4)*360)}if(h>=360){h%=360}h=parseFloat(h);s=parseFloat(s);l=parseFloat(l);this.h=h;this.s=s;this.l=l;s/=100;l/=100;const c=(1-Math.abs(2*l-1))*s;const x=c*(1-Math.abs(h/60%2-1));const m=l-c/2;let r=0;let g=0;let b=0;if(h>=0&&h<60){r=c;g=x;b=0}else if(h>=60&&h<120){r=x;g=c;b=0}else if(h>=120&&h<180){r=0;g=c;b=x}else if(h>=180&&h<240){r=0;g=x;b=c}else if(h>=240&&h<300){r=x;g=0;b=c}else if(h>=300&&h<360){r=c;g=0;b=x}this.r=Math.round((r+m)*255);this.g=Math.round((g+m)*255);this.b=Math.round((b+m)*255);this.luminance=this.r/255*21.26+this.g/255*71.52+this.b/255*7.22;this.a=a;return this}parseRGBAString(rgba){const sep=rgba.indexOf(",")>-1?",":" ";rgba=rgba.split("(")[1].split(")")[0].split(sep);if(rgba.indexOf("/")>-1)rgba.splice(3,1);for(const R in rgba){const r=rgba[R];if(r.indexOf("%")===-1){rgba[R]=R<3?parseInt(rgba[R]):rgba[R];continue}const p=r.substr(0,r.length-1)/100;rgba[R]=R<3?Math.round(p*255):p}const r=rgba[0]/255;const g=rgba[1]/255;const b=rgba[2]/255;const a=parseFloat(rgba[3]??1);const cmin=Math.min(r,g,b);const cmax=Math.max(r,g,b);const delta=cmax-cmin;let h=0;let s=0;let l=0;if(delta===0){h=0}else if(cmax===r){h=(g-b)/delta%6}else if(cmax===g){h=(b-r)/delta+2}else{h=(r-g)/delta+4}h=Math.round(h*60);if(h<0)h+=360;l=(cmax+cmin)/2;s=delta===0?0:delta/(1-Math.abs(2*l-1));s=+(s*100).toFixed(1);l=+(l*100).toFixed(1);this.h=h;this.s=s;this.l=l;this.r=rgba[0];this.g=rgba[1];this.b=rgba[2];this.luminance=rgba[0]/255*21.26+rgba[1]/255*71.52+rgba[2]/255*7.22;this.a=a;return this}parseHEXAString(hex){let r=0;let g=0;let b=0;let a=255;if(hex.length===5){r="0x"+hex[1]+hex[1];g="0x"+hex[2]+hex[2];b="0x"+hex[3]+hex[3];a="0x"+hex[4]+hex[4]}else if(hex.length===7){r="0x"+hex[1]+hex[2];g="0x"+hex[3]+hex[4];b="0x"+hex[5]+hex[6]}else if(hex.length===9){r="0x"+hex[1]+hex[2];g="0x"+hex[3]+hex[4];b="0x"+hex[5]+hex[6];a="0x"+hex[7]+hex[8]}a=+(a/255).toFixed(3);this.parseRGBAString(`rgba(${parseInt(r)},${parseInt(g)},${parseInt(b)},${a})`);return this}parseCOLORNAME(name){name=name.toLowerCase();if(!NAMED_COLOR[name])throw new Error(`Invalid color: ${name}`);this.parseHEXAString(NAMED_COLOR[name]);return this}toRGBAString(){return`rgba(${this.r},${this.g},${this.b},${this.a})`}toHEXString(){if(this.a===0){return"#00000000"}if(this.a===1){return`#${((1<<24)+(parseInt(this.r)<<16)+(parseInt(this.g)<<8)+parseInt(this.b)).toString(16).slice(1)}`.toLowerCase()}return`#${((1<<24)+(parseInt(this.r)<<16)+(parseInt(this.g)<<8)+parseInt(this.b)).toString(16).slice(1)}${((1<<8)+parseInt(this.a*255)).toString(16).slice(1)}`.toLowerCase()}toColorString(){const hex=this.toHEXString();return Object.entries(NAMED_COLOR).find((_ref=>{let[name,h]=_ref;return h.toLocaleLowerCase()===hex}))?.[0]??hex}get isTransparent(){return this.a===0}static get BLACK(){return this._BLACK=this._BLACK||new Color("black")}static get WHITE(){return this._WHITE=this._WHITE||new Color("white")}static get TRANSPARENT(){return this._TRANSPARENT=this._TRANSPARENT||new Color("transparent")}static parse(color){if(color instanceof Color)return color.clone();return new Color(color)}static isTransparent(color){return Color.parse(color).isTransparent}static bestLuminanceMatch(color,bottomColor,topColor){const colorLuminance=Math.round(color.luminance);const rangeBottom=Math.round(bottomColor.luminance);const rangeTop=Math.round(topColor.luminance);const bottomDistance=Math.abs(colorLuminance-rangeBottom);const topDistance=Math.abs(colorLuminance-rangeTop);if(colorLuminance<rangeBottom||colorLuminance>rangeTop){return false}if(bottomDistance===topDistance&&(color.a!==bottomColor.a||color.a!==topColor.a)){if(color.a!==bottomColor.a&&color.a!==topColor.a)return false;if(color.a===bottomColor.a)return bottomColor;return topColor}return bottomDistance<=topDistance?bottomColor:topColor}static toRGBAString(color){return Color.parse(color).toRGBAString()}static toHEXString(color){return Color.parse(color).toHEXString()}static toColorString(color){return Color.parse(color).toColorString()}}var Color$1=__AMD("extensions/adapt-visua11y/js/Color",Color);var CSSRuleModifiers=__AMD("extensions/adapt-visua11y/js/CSSRuleModifiers",[["box-shadow",null,function(){if(!this.noTransparency)return;return"none"}],["opacity",null,function(output){if(!this.noTransparency||isNaN(output))return;return parseInt(output)<=.4?0:1}],["background-image",null,function(){return this.noBackgroundImages?"none !important":undefined}],[(name,selector)=>selector&&name==="background-image"&&(String(selector).endsWith(":before")||String(selector).endsWith(":after")),null,function(output,original,style){if(output==="none")return;style.filter="invert(var(--visua11y-invert)) var(--visua11y-color-profile-url) contrast(var(--visua11y-contrast)) brightness(var(--visua11y-brightness))";return output}],["line-height",null,function(output){if(output==="normal")output=1.2;output=String(output);const value=parseFloat(output);if(isNaN(value))return output;const lineHeight=this.lineHeight??1;const adjusted=value===0?lineHeight:value*lineHeight;const unit=output.match(/[^0-9.]+/)?.[0];return adjusted+(unit??"")}],["letter-spacing",null,function(output){if(output==="normal")output=0;output=String(output);const value=parseFloat(output);if(isNaN(value))return output;const spacing=this.letterSpacing??1;const adjusted=value===0?spacing-1:value*(spacing-1);const unit=output.match(/[^0-9.]+/)?.[0];const modified=adjusted+(unit??"em");return modified}],["word-spacing",null,function(output){if(output==="normal")output=0;output=String(output);const value=parseFloat(output);if(isNaN(value))return output;const spacing=this.wordSpacing??1;const adjusted=value===0?spacing-1:value*(spacing-1);const unit=output.match(/[^0-9.]+/)?.[0];const modified=adjusted+(unit??"em");return modified}],[(name,selector)=>{if(!selector||!["margin-top","margin-bottom","margin-block-start","margin-block-end"].some((p=>p===name)))return;const elements=selector.split(/[*, >~+|]/).filter(Boolean).map((e=>e.toLowerCase()));if(elements.length===0)return;const isPTagSelector=[elements[0],elements[elements.length-1]].some((e=>(/^p[^\w]+/.test(e)||e==="p")&&!e.includes(":")));return isPTagSelector},null,function(output,original,style,selector,propertyName){if(output===""){const camelPropertyName=propertyName.replace(/-([a-z])/g,(g=>g[1].toUpperCase()));output=this.tagMeasurements.p[camelPropertyName];output=parseFloat(output)/parseFloat(this.originalFontSize)+"em"}output=String(output);const value=parseFloat(output);if(isNaN(value))return output;const spacing=this.paragraphSpacing??1;const adjusted=value*spacing;const unit=output.match(/[^0-9.]+/)?.[0];const modified=adjusted+(unit??0);return modified}],["color",Color$1.parse,function(output){if(!this.highContrast)return;const color=Color$1.parse(output);if(color.isTransparent)return;if(color.luminance<=80){return Color$1.BLACK.toRGBAString()}return Color$1.bestLuminanceMatch(color,Color$1.BLACK,Color$1.WHITE).toRGBAString()}],[name=>/color/i.test(name),Color$1.parse,function(output){if(!this.noTransparency)return;const color=Color$1.parse(output);const isTransparent=color.a<=.4;if(isTransparent){return Color$1.TRANSPARENT.toRGBAString()}color.a=1;return color.toRGBAString()}],[name=>/color/i.test(name),Color$1.parse,function(output){let color=Color$1.parse(output);if(color.isTransparent)return color.toRGBAString();const colorIndex=this.distinctColors.findIndex((primaryColor=>color.r===primaryColor.r&&color.g===primaryColor.g&&color.b===primaryColor.b&&color.a===primaryColor.a));if(colorIndex!==-1){color=this.outputColors[colorIndex].clone()}return color.toRGBAString()}]]);var CSSRule=__AMD("extensions/adapt-visua11y/js/CSSRule",class CSSRule{constructor(rule){this.rule=rule;this.selectorText=rule.selectorText??null;this.keyText=rule.keyText;this.style=rule.style;this.output=[];this.original=[];this.propertyNames=null}initialize(context){this.propertyNames=Array.prototype.slice.call(this.style).concat(["margin-top","margin-bottom"]).filter((name=>CSSRuleModifiers.some((_ref=>{let[matchName,validation]=_ref;if(typeof matchName==="string"&&matchName!==name)return false;if(typeof matchName==="function"&&!matchName.call(context,name,this.selectorText))return false;try{const original=this.style[name];validation&&validation.call(context,original);this.original.push(original);this.output.push(original);return true}catch(err){return false}}))));return this}reset(){this.propertyNames.forEach(((name,index)=>this.output[index]=this.original[index]))}modify(context){this.propertyNames.forEach(((name,index)=>{CSSRuleModifiers.forEach((_ref2=>{let[matchName,validation,modifier]=_ref2;if(typeof matchName==="string"&&matchName!==name)return;if(typeof matchName==="function"&&!matchName.call(context,name,this.selectorText))return;const value=modifier.call(context,this.output[index],this.original[index],this.style,this.selectorText,this.propertyNames[index]);if(value===undefined)return;this.output[index]=value}))}))}get styleSheetPart(){var _this=this;const parentRule=this.rule.parentRule;const leafRule=function(){let spaces=arguments.length>0&&arguments[0]!==undefined?arguments[0]:2;const shortSpace="".padStart(spaces-2," ");const longSpace="".padStart(spaces," ");return`${shortSpace}${_this.selectorText||_this.keyText} {\n${longSpace}${_this.propertyNames.map(((name,index)=>{const isImportant=_this.style.getPropertyPriority(name)==="important";return`${name}: ${_this.output[index]}${isImportant?" !important":""};`})).join(`\n${longSpace}`)}\n${shortSpace}}`};if(parentRule){if(parentRule instanceof CSSMediaRule)return`@media ${this.rule.parentRule.conditionText} {\n${leafRule(4)}\n}\n`;if(parentRule instanceof CSSKeyframesRule){return`@keyframes ${this.rule.parentRule.name} {\n${leafRule(4)}\n}\n`}throw new Error("parentRule type not supported:",parentRule)}return leafRule()}isMatch(){return Boolean(this.propertyNames.length)}get distinctColors(){const colors=_.uniq(this.propertyNames.map(((name,index)=>{try{return Color$1.parse(this.original[index])}catch(err){return false}})).filter(Boolean));return colors}static getAllModifiable(context){const stylesheets=Array.prototype.slice.call(document.styleSheets,0);const allCSSRules=stylesheets.reduce(((allCSSRules,stylesheet)=>{const rules=Array.prototype.slice.call(stylesheet.rules,0);allCSSRules.push(...rules.map((rule=>{if(!(rule instanceof CSSStyleRule))return false;return new CSSRule(rule)})));allCSSRules.push(..._.flatten(rules.map((rule=>{if(!(rule instanceof CSSMediaRule))return false;const rules=Array.prototype.slice.call(rule.cssRules,0);return rules.map((rule=>new CSSRule(rule)))}))));allCSSRules.push(..._.flatten(rules.map((rule=>{if(!(rule instanceof CSSKeyframesRule))return false;const rules=Array.prototype.slice.call(rule.cssRules,0);return rules.map((rule=>new CSSRule(rule)))}))));return allCSSRules.filter(Boolean)}),[]).filter((rule=>rule.selectorText||rule.keyText));const rules=allCSSRules.map((rule=>rule.initialize(context))).filter((rule=>rule.isMatch()));return rules}});var DEFAULTS=__AMD("extensions/adapt-visua11y/js/DEFAULTS",{_isEnabled:false,description:"Use the controls below to customise your learning experience to your individual needs.",_groups:{visualDisplay:"Enhance visual display",distractions:"Reduce distractions",readability:"Readability"},_preview:{title:"Title",character:"A"},_colorProfiles:{default:"Default",achromatopsia:"Greyscale (Achromatopsia)",protanopia:"Red/green (Protanopia)",deuteranopia:"Green/red (Deuteranopia)",tritanopia:"Blue/yellow (Tritanopia)",dyslexia:"Yellow tint (Dyslexia)"},_colorProfile:{_isEnabled:true,title:"Colour profile",_default:"default"},_highContrast:{_isEnabled:true,title:"High contrast",_default:false},_highContrastLuminanceThreshold:{_isEnabled:true,title:"High contrast luminance threshold",_default:70},_noTransparency:{_isEnabled:true,title:"No transparency",_default:false},_lowBrightness:{_isEnabled:true,title:"Low brightness",_default:false},_invert:{_isEnabled:true,title:"Invert",_default:false},_noAnimations:{_isEnabled:true,title:"No animations",_default:false},_noBackgroundImages:{_isEnabled:true,title:"No background images",_default:false},_fontSize:{_isEnabled:true,title:"Font size",smallLabel:"Small",_small:"9pt",mediumLabel:"Medium",_medium:"",largeLabel:"Large",_large:"18pt",_default:""},_lineHeight:{_isEnabled:true,title:"Line height",smallLabel:"Small",_small:.9,mediumLabel:"Medium",_medium:1,largeLabel:"Large",_large:1.2,_default:1},_paragraphSpacing:{_isEnabled:true,title:"Paragraph spacing",smallLabel:"Small",_small:.5,mediumLabel:"Medium",_medium:1,largeLabel:"Large",_large:2,_default:1},_letterSpacing:{_isEnabled:true,title:"Letter spacing",smallLabel:"Small",_small:.97,mediumLabel:"Medium",_medium:1,largeLabel:"Large",_large:1.2,_default:1},_wordSpacing:{_isEnabled:true,title:"Word spacing",smallLabel:"Small",_small:.97,mediumLabel:"Medium",_medium:1,largeLabel:"Large",_large:1.2,_default:1},_button:{navigationAriaLabel:"Visual accessibility settings",resetText:"Reset",closeText:"Close"},resetAriaMessage:"Accessibility controls reset"});var FILTERS=__AMD("extensions/adapt-visua11y/js/COLOR_FILTERS",{"":[[1,0,0,0,0],[0,1,0,0,0],[0,0,1,0,0],[0,0,0,1,0]],achromatopsia:[[.299,.587,.114,0,0],[.299,.587,.114,0,0],[.299,.587,.114,0,0],[0,0,0,1,0]],protanopia:[[.567,.433,0,0,0],[.558,.442,0,0,0],[0,.242,.758,0,0],[0,0,0,1,0]],deuteranopia:[[.625,.375,0,0,0],[.7,.3,0,0,0],[0,.3,.7,0,0],[0,0,0,1,0]],tritanopia:[[.95,.05,0,0,0],[0,.433,.567,0,0],[0,.475,.525,0,0],[0,0,0,1,0]],dyslexia:[[.9,.1,0,0,0],[.1,.9,0,0,0],[0,0,.7,0,0],[0,0,0,1,0]]});const HIGH_CONTRAST=_ref=>{let{_highContrastLuminanceThreshold:_highContrastLuminanceThreshold}=_ref;return[[0,10,0],[10,_highContrastLuminanceThreshold+1,10,30,false],[_highContrastLuminanceThreshold,90,90,70,false],[90,100,100]]};const LOW_BRIGHTNESS=config=>[[0,100,0,80,true]];function brightnessTransform(colors,instructions){const brightnesses=colors.map((c=>c.l));const output=[];brightnesses.forEach((brightness=>{instructions.find((grouping=>{const isToAbsolute=grouping.length===3;const[includeFrom,includeTo,moveTowards,moveEnd,isInclusive=true]=grouping;const includeRange=includeTo-includeFrom;const moveRange=moveEnd-moveTowards;if(!isInclusive&&(brightness<=includeFrom||brightness>=includeTo)||isInclusive&&(brightness<includeFrom||brightness>includeTo)){return false}if(isToAbsolute){output.push(moveTowards);return true}const normalized=brightness-moveTowards;const ratio=Math.abs(moveRange/includeRange);const corrected=normalized*ratio;const final=corrected+moveTowards;output.push(final);return true}))}));return output}function highContrast(colors,config){return brightnessTransform(colors,HIGH_CONTRAST(config)).map(((l,index)=>{const c=colors[index];return Color$1.parse(`hsla(${c.h},${c.s},${l},${c.a})`)}))}function invert(colors,config){return colors.map((c=>Color$1.parse(`hsla(${c.h},${c.s},${100-c.l},${c.a})`)))}function lowBrightness(colors,config){return brightnessTransform(colors,LOW_BRIGHTNESS()).map(((l,index)=>{const c=colors[index];return Color$1.parse(`hsla(${c.h},${c.s},${l},${c.a})`)}))}function profileFilter(colors,colorProfileId){return colors.map((c=>{const filter=FILTERS[colorProfileId];if(!filter)return c.clone();const R=c.r;const G=c.g;const B=c.b;const A=c.a;const r=filter[0][0]*R+filter[0][1]*G+filter[0][2]*B+filter[0][3]*A+filter[0][4];const g=filter[1][0]*R+filter[1][1]*G+filter[1][2]*B+filter[1][3]*A+filter[1][4];const b=filter[2][0]*R+filter[2][1]*G+filter[2][2]*B+filter[2][3]*A+filter[2][4];const a=filter[3][0]*R+filter[3][1]*G+filter[3][2]*B+filter[3][3]*A+filter[3][4];return Color$1.parse(`rgba(${r},${g},${b},${a})`)}))}var Visua11ySettingsView=__AMD("extensions/adapt-visua11y/js/Visua11ySettingsView",class Visua11ySettingsView extends Backbone__default["default"].View{className(){return"visua11ysettings"}initialize(){this.render();this.listenTo(Adapt$1.visua11y,"changed",this.render)}render(){ReactDOM__default["default"].render(React__default["default"].createElement(templates.Visua11ySettings,Adapt$1.visua11y.config),this.el)}});class AnimationsButtonView extends Backbone.View{attributes(){return{"aria-label":Adapt$1.visua11y.config._button.navigationAriaLabel,title:Adapt$1.visua11y.config._button.navigationAriaLabel,"data-order":Adapt$1.course.get("_globals")?._extensions?._visua11y?._navOrder||0}}tagName(){return"button"}className(){return"btn-icon nav__btn visua11y-btn"}events(){return{click:"onClick"}}initialize(){this.onNotifyClosed=this.onNotifyClosed.bind(this);this.onNotifyClicked=this.onNotifyClicked.bind(this);this.render()}render(){const template=Handlebars.templates.visua11yButton;const data={_globals:Adapt$1.course?.get("_globals")};this.$el.html(template(data));this.$el.prop("title","Accessibility Settings")}onClick(event){if(event&&event.preventDefault)event.preventDefault();const config=Adapt$1.course.get("_visua11y");Adapt$1.visua11y.settingsPrompt=notify$1.popup({_view:new Visua11ySettingsView,_classes:"is-visua11ysettings",_showCloseButton:config._showCloseButton||false});this.render();Adapt$1.visua11y.settingsPrompt.$el.on("click",this.onNotifyClicked);Adapt$1.trigger("visua11y:opened");this.listenTo(Adapt$1,"notify:closed",this.onNotifyClosed)}onNotifyClicked(event){const $target=$(event.target);const isChild=$target.parents(".notify__popup-inner").length!==0;if(isChild)return;Adapt$1.visua11y.settingsPrompt.closeNotify()}onNotifyClosed(notify){if(notify!==Adapt$1.visua11y.settingsPrompt)return;Adapt$1.visua11y.settingsPrompt.$el.off("click",this.onNotifyClicked);Adapt$1.visua11y.settingsPrompt=null;this.stopListening(Adapt$1,"notify:closed",this.onNotifyClosed)}}var Visua11yButtonView=__AMD("extensions/adapt-visua11y/js/Visua11yButtonView",AnimationsButtonView);function _deepDefaults(original){if(!original)return original;for(var _len=arguments.length,defaultObjects=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){defaultObjects[_key-1]=arguments[_key]}defaultObjects.reverse();defaultObjects.filter(Boolean).forEach((defaults=>{const keyValuePairs=Object.entries(defaults);keyValuePairs.forEach((_ref=>{let[key,defaultValue]=_ref;const isRecursiveObject=typeof defaultValue==="object"&&!Array.isArray(defaultValue)&&defaultValue!==null;if(isRecursiveObject){original[key]=_deepDefaults(original[key]||{},defaultValue);return}const isValueAlreadySet=Object.prototype.hasOwnProperty.call(original,key);if(isValueAlreadySet)return;original[key]=defaultValue}))}));return original}class Visua11y extends Backbone__default["default"].Controller{initialize(){this.injectSVG();this.apply=_.debounce(this.apply.bind(this),50);this.listenTo(Adapt$1,"configModel:dataLoaded",this.onPreAdaptStart);this.listenTo(Adapt$1,"adapt:start",this.onAdaptStart);this._adaptStarted=false}async injectSVG(){const response=await fetch("assets/visua11y-filters.svg");const text=await response.text();$("body").append($(text))}get config(){return _deepDefaults((this._adaptStarted?Adapt$1.course:Adapt$1.config).get("_visua11y")??{},DEFAULTS)}get colorProfiles(){return Object.entries(this.config._colorProfiles).map((_ref2=>{let[_id,name]=_ref2;return{_id:_id,name:name}}))}get colorProfileId(){return this._colorProfileId}set colorProfileId(value){this._colorProfileId=value.toLowerCase();this._outputColors=null;this.apply()}get invert(){return this._invert}set invert(value){this._invert=value;this._outputColors=null;this.apply()}get originalFontSize(){return this._originalFontSize}get fontSize(){return this._fontSize||this._originalFontSize}set fontSize(value){this._fontSize=value;this.apply()}get lineHeight(){return parseFloat(this._lineHeight)}set lineHeight(value){this._lineHeight=value;this.apply()}get letterSpacing(){return parseFloat(this._letterSpacing)}set letterSpacing(value){this._letterSpacing=value;this.apply()}get wordSpacing(){return parseFloat(this._wordSpacing)}set wordSpacing(value){this._wordSpacing=value;this.apply()}get paragraphSpacing(){return parseFloat(this._paragraphSpacing)}set paragraphSpacing(value){this._paragraphSpacing=value;this.apply()}get noAnimations(){return this._noAnimations}set noAnimations(value){this._noAnimations=value;this.apply()}get highContrast(){return this._highContrast}set highContrast(value){this._highContrast=value;this._outputColors=null;this.apply()}get noTransparency(){return this._noTransparency}set noTransparency(value){this._noTransparency=value;this.apply()}get lowBrightness(){return this._lowBrightness}set lowBrightness(value){this._lowBrightness=value;this._outputColors=null;this.apply()}get noBackgroundImages(){return this._noBackgroundImages}set noBackgroundImages(value){this._noBackgroundImages=value;this.apply()}get distinctColors(){if(this._distinctColors)return this._distinctColors;const allColors=_.uniq(_.flatten(this.rules.map((rule=>rule.distinctColors))).map(Color$1.toRGBAString));const colors=allColors.map(Color$1.parse).filter((color=>!Color$1.isTransparent(color)));this._distinctColors=[Color$1.BLACK,...colors.sort(((a,b)=>a.luminance-b.luminance)),Color$1.WHITE];return this._distinctColors}get outputColors(){if(!this._outputColors){let outputColors=this.distinctColors;if(this.highContrast)outputColors=highContrast(outputColors,this);if(this.invert)outputColors=invert(outputColors);if(this.lowBrightness)outputColors=lowBrightness(outputColors);this._outputColors=profileFilter(outputColors,this.colorProfileId)}const output=this._outputColors.slice(0);return output}onPreAdaptStart(){if(!this.config?._isEnabled)return;this.setupStyleTag();this.measure();this.restore();this.setupNavigationButton();this.rules=CSSRule.getAllModifiable(this);this.apply()}onAdaptStart(){this._adaptStarted=true;if(!this.config?._isEnabled)return;if(this.rules){this.setupNavigationButton();return}this.setupStyleTag();this.measure();this.restore();this.setupNavigationButton();this.rules=this.rules||CSSRule.getAllModifiable(this);this.apply()}measure(){const computedStyle=window.getComputedStyle(document.querySelector("html"));this._originalFontSize=computedStyle.fontSize;this._tagMeasurements=["p"].reduce(((measures,tagName)=>{const tag=document.createElement(tagName);document.body.appendChild(tag);const computedStyle=window.getComputedStyle(tag);measures[tagName]={};for(const k in computedStyle){try{measures[tagName][k]=computedStyle[k]}catch(err){}}$(tag).remove();return measures}),{})}get tagMeasurements(){return this._tagMeasurements}save(){const boolToInt=bool=>bool?1:0;const largeMediumSmallToInt=(config,value)=>{const values=[config._large,config._medium,config._small];const index=values.findIndex((v=>String(v)===String(value)));return index>=0?index:values.findIndex((v=>String(v)===String(config._default)))};const data=[Object.keys(DEFAULTS._colorProfiles).findIndex((k=>k===this._colorProfileId))??0,boolToInt(this._invert),largeMediumSmallToInt(this.config._fontSize,this._fontSize),largeMediumSmallToInt(this.config._lineHeight,this._lineHeight),largeMediumSmallToInt(this.config._letterSpacing,this._letterSpacing),largeMediumSmallToInt(this.config._wordSpacing,this._wordSpacing),largeMediumSmallToInt(this.config._paragraphSpacing,this._paragraphSpacing),boolToInt(this._noAnimations),boolToInt(this._highContrast),boolToInt(this._noTransparency),boolToInt(this._lowBrightness),boolToInt(this._noBackgroundImages),parseInt(this._highContrastLuminanceThreshold)];Adapt$1.offlineStorage.set("v",Adapt$1.offlineStorage.serialize(data))}restore(){const intToBool=(config,value)=>{if(value===undefined)return config._default;return Boolean(value)};const intToLargeMediumSmall=(config,value)=>{if(value===undefined)return config._default;value=value??1;return value===0?config._large:value===2?config._small:config._medium};const serialized=this.config._shouldSavePreferences===false?null:Adapt$1.offlineStorage.get("v");const data=serialized?Adapt$1.offlineStorage.deserialize(serialized):[];this._colorProfileId=Object.keys(DEFAULTS._colorProfiles)[data[0]??Object.keys(DEFAULTS._colorProfiles).findIndex((k=>k===this.config._colorProfile._default))];this._invert=intToBool(this.config._invert,data[1]);this._fontSize=intToLargeMediumSmall(this.config._fontSize,data[2]);this._lineHeight=intToLargeMediumSmall(this.config._lineHeight,data[3]);this._letterSpacing=intToLargeMediumSmall(this.config._letterSpacing,data[4]);this._wordSpacing=intToLargeMediumSmall(this.config._wordSpacing,data[5]);this._paragraphSpacing=intToLargeMediumSmall(this.config._paragraphSpacing,data[6]);this._noAnimations=intToBool(this.config._noAnimations,data[7]);this._highContrast=intToBool(this.config._highContrast,data[8]);this._noTransparency=intToBool(this.config._noTransparency,data[9]);this._lowBrightness=intToBool(this.config._lowBrightness,data[10]);this._noBackgroundImages=intToBool(this.config._noBackgroundImages,data[11]);this._highContrastLuminanceThreshold=data[12]??this.config._highContrastLuminanceThreshold._default}setupNavigationButton(){if(!this.config?._isEnabled)return;$(".nav__drawer-btn").after((new Visua11yButtonView).$el)}apply(){if(!this.config?._isEnabled)return;this.save();this.rules.forEach((rule=>rule.reset()));const $html=$("html");this.colorProfileId?$html.attr("data-color-profile",this.colorProfileId):$html.removeAttr("data-color-profile");const documentStyle=document.documentElement.style;documentStyle.setProperty("--visua11y-color-profile-url",`url(#adapt-visua11y-${this.colorProfileId})`);documentStyle.setProperty("--visua11y-invert",this.invert?"100%":"0%");documentStyle.setProperty("--visua11y-contrast",this.highContrast?"108%":"100%");documentStyle.setProperty("--visua11y-brightness",this.lowBrightness?"80%":"100%");$html[0].style.fontSize=this.fontSize??"";$.fx.off=this.noAnimations;$.Velocity.mock=this.noAnimations;$html.toggleClass("a11y-high-contrast",this.highContrast).toggleClass("a11y-invert",this.invert).toggleClass("a11y-no-animations",this.noAnimations).toggleClass("a11y-no-background-images",this.noBackgroundImages);this.rules.forEach((rule=>rule.modify(this)));const stylesheet=this.rules.map((rule=>rule.styleSheetPart)).filter(Boolean).join("\n");this._tag.html(stylesheet);$(window).resize();this.triggerChanged()}setupStyleTag(){const tag=$('<style id="visua11y"><style>');tag.appendTo("body");this._tag=tag}triggerChanged(){this.trigger("changed");Adapt$1.trigger("visua11y:changed");this.forceRerender()}forceRerender(){if(device$1.browser!=="safari")return;$("body").hide().show(0)}reset(){this._colorProfileId=this.config._colorProfile._default;this._invert=this.config._invert._default;this._fontSize=this.config._fontSize._default;this._lineHeight=this.config._lineHeight._default;this._letterSpacing=this.config._letterSpacing._default;this._wordSpacing=this.config._wordSpacing._default;this._paragraphSpacing=this.config._paragraphSpacing._default;this._noAnimations=this.config._noAnimations._default;this._highContrast=this.config._highContrast._default;this._highContrastLuminanceThreshold=this.config._highContrastLuminanceThreshold._default;this._noTransparency=this.config._noTransparency._default;this._lowBrightness=this.config._lowBrightness._default;this._noBackgroundImages=this.config._noBackgroundImages._default;this.save();this.rules.forEach((rule=>rule.reset()));const $html=$("html");const documentStyle=document.documentElement.style;documentStyle.setProperty("--visua11y-color-profile-url","url(#adapt-visua11y-default)");documentStyle.setProperty("--visua11y-invert","0%");documentStyle.setProperty("--visua11y-contrast","100%");documentStyle.setProperty("--visua11y-brightness","100%");$html.removeAttr("data-color-profile").removeAttr("data-color-inverted");$html[0].style.fontSize="";$.fx.off=false;$.Velocity.mock=false;$html.removeClass("a11y-high-contrast").removeClass("a11y-no-animations").removeClass("a11y-no-background-images");const stylesheet=this.rules.map((rule=>rule.styleSheetPart)).filter(Boolean).join("\n");this._tag.html(stylesheet);$(window).resize();this.triggerChanged();if(Adapt$1.visua11y.config.resetAriaMessage){notify$1.create({_type:"a11y-push",body:Adapt$1.visua11y.config.resetAriaMessage})}}}__AMD("extensions/adapt-visua11y/js/adapt-visua11y",Adapt$1.visua11y=new Visua11y);var pageHeaderBackground=Backbone__default["default"].View.extend({className:"extension",initialize:function(){}});Adapt$1.on("pageView:ready",(function(view){var headerBackground=view.model.get("_pageHeaderBackground");if(!headerBackground||!headerBackground._isEnabled)return;var $pageHeader=view.$el.find(".page__header");var $pageHeaderContent=view.$el.find(".page__header-inner");if(headerBackground.pageHeaderBackgroundLink){$pageHeader.css("background","url("+headerBackground.pageHeaderBackgroundLink+")")}if(headerBackground.pageHeaderTitleImage&&headerBackground.pageHeaderTitleImage.src){$pageHeader.addClass("page-header-title-image image-align-"+headerBackground.pageHeaderTitleImage.alignment);var $div=$('<div class="page-header-image-inner">');var $titleImage=$("<img>");var isIE=Adapt$1.device.browser=="microsoft edge"||Adapt$1.device.browser=="internet explorer";var titleImageSource=isIE?headerBackground.pageHeaderTitleImage.fallbackPageHeaderTitleImage:headerBackground.pageHeaderTitleImage.src;$titleImage.attr("src",titleImageSource);$div.append($titleImage);$pageHeaderContent.append($div)}}));__AMD("extensions/pageHeader-background/js/pageHeader-background",pageHeaderBackground);class MenuItemView extends AdaptView$1{attributes(){return AdaptView$1.resultExtend("attributes",{role:"listitem","aria-labelledby":this.model.get("_id")+"-heading"},this)}className(){return["menu-item",this.constructor.className,this.model.get("_id"),this.model.get("_classes"),this.setVisibility(),this.setHidden(),this.model.get("_isVisited")?"is-visited":"",this.model.get("_isComplete")?"is-complete":"",this.model.get("_isLocked")?"is-locked":"",this.model.get("_isOptional")?"is-optional":""].join(" ")}preRender(){this.model.checkCompletionStatus();this.model.checkInteractionCompletionStatus()}postRender(){this.$el.imageready(this.setReadyStatus.bind(this))}}MenuItemView.type="menuItem";var MenuItemView$1=__AMD("core/js/views/menuItemView",MenuItemView);class MenuView extends ContentObjectView{}Object.assign(MenuView,{childContainer:".js-children",childView:MenuItemView$1,type:"menu",template:"menu"});var MenuView$1=__AMD("core/js/views/menuView",MenuView);var SideMenuView=MenuView$1.extend({postRender:function(){var nthChild=0;this.model.getChildren().each((function(item){if(item.get("_isAvailable")){nthChild++;item.set("_nthChild",nthChild);this.$(".menu-container-inner").append(new SideMenuItemView({model:item}).$el)}}))}},{template:"sidemenu"});var SideMenuItemView=MenuView$1.extend({events:{"click .audio-toggle":"onAudioClick","click .menu-item-button > button":"onClickMenuItemButton"},onAudioClick:function(e){e.stopPropagation()},className:function(){var nthChild=this.model.get("_nthChild");return["menu-item","menu-item-"+this.model.get("_id"),this.model.get("_classes"),this.model.get("_isVisited")?"visited":"",this.model.get("_isComplete")?"completed":"",this.model.get("_isLocked")?"locked":"","nth-child-"+nthChild,nthChild%2===0?"nth-child-even":"nth-child-odd"].join(" ")},preRender:function(){this.model.checkCompletionStatus();this.model.checkInteractionCompletionStatus()},postRender:function(){var graphic=this.model.get("_graphic");if(graphic&&graphic.src&&graphic.src.length>0){this.$el.imageready(_.bind((function(){this.setReadyStatus()}),this))}else{this.setReadyStatus()}},onClickMenuItemButton:function(event){if(event&&event.preventDefault)event.preventDefault();if(this.model.get("_isLocked"))return;Backbone.history.navigate("#/id/"+this.model.get("_id"),{trigger:true})}},{template:"sidemenu-item"});Adapt$1.on("router:menu",(function(model){$("#wrapper").append(new SideMenuView({model:model}).$el)}));var ThemeView=__AMD("theme/adapt-contrib-vanilla/js/themeView",class ThemeView extends Backbone.View{className(){}initialize(){this.setStyles();this.listenTo(Adapt$1,{"device:changed":this.onDeviceResize,remove:this.remove})}onDeviceResize(){this.setStyles()}remove(){super.remove();this.onRemove()}setStyles(){this.setClasses();this.setBackgroundImage();this.setBackgroundStyles();this.setMinimumHeight();this.setResponsiveClasses();this.setCustomStyles()}setClasses(){this.$el.addClass(this.className())}setBackgroundImage(){const backgroundImages=this.model.get("_backgroundImage");if(!backgroundImages)return;let backgroundImage;switch(Adapt$1.device.screenSize){case"large":backgroundImage=backgroundImages._large;break;case"medium":backgroundImage=backgroundImages._medium;break;default:backgroundImage=backgroundImages._small}if(backgroundImage){this.$el.addClass("has-bg-image").css("background-image","url("+backgroundImage+")");return}this.$el.removeClass("has-bg-image").css("background-image","")}setBackgroundStyles(){const styles=this.model.get("_backgroundStyles");if(!styles)return;this.$el.css({"background-repeat":styles._backgroundRepeat,"background-size":styles._backgroundSize,"background-position":styles._backgroundPosition})}setMinimumHeight(){const minimumHeights=this.model.get("_minimumHeights");if(!minimumHeights)return;let minimumHeight;switch(Adapt$1.device.screenSize){case"large":minimumHeight=minimumHeights._large;break;case"medium":minimumHeight=minimumHeights._medium;break;default:minimumHeight=minimumHeights._small}if(minimumHeight){this.$el.addClass("has-min-height").css("min-height",minimumHeight+"px");return}this.$el.removeClass("has-min-height").css("min-height","")}setResponsiveClasses(){const responsiveClasses=this.model.get("_responsiveClasses");if(!responsiveClasses)return;this.$el.removeClass(Object.values(responsiveClasses)).addClass(responsiveClasses[`_${Adapt$1.device.screenSize}`])}setCustomStyles(){}onRemove(){}});var ThemePageView=__AMD("theme/adapt-contrib-vanilla/js/themePageView",class ThemePageView extends ThemeView{className(){}setCustomStyles(){this.processHeader()}processHeader(){const header=this.model.get("_pageHeader");if(!header)return;const $header=this.$(".page__header");this.setHeaderBackgroundImage(header,$header);this.setHeaderBackgroundStyles(header,$header);this.setHeaderMinimumHeight(header,$header)}setHeaderBackgroundImage(config,$header){const backgroundImages=config._backgroundImage;if(!backgroundImages)return;let backgroundImage;switch(Adapt$1.device.screenSize){case"large":backgroundImage=backgroundImages._large;break;case"medium":backgroundImage=backgroundImages._medium;break;default:backgroundImage=backgroundImages._small}if(backgroundImage){$header.addClass("has-bg-image").css("background-image","url("+backgroundImage+")");return}$header.removeClass("has-bg-image").css("background-image","")}setHeaderBackgroundStyles(config,$header){const styles=config._backgroundStyles;if(!styles)return;$header.css({"background-repeat":styles._backgroundRepeat,"background-size":styles._backgroundSize,"background-position":styles._backgroundPosition})}setHeaderMinimumHeight(config,$header){const minimumHeights=config._minimumHeights;if(!minimumHeights)return;let minimumHeight;switch(Adapt$1.device.screenSize){case"large":minimumHeight=minimumHeights._large;break;case"medium":minimumHeight=minimumHeights._medium;break;default:minimumHeight=minimumHeights._small}if(minimumHeight){$header.addClass("has-min-height").css("min-height",minimumHeight+"px");return}$header.removeClass("has-min-height").css("min-height","")}onRemove(){}});var ThemeArticleView=__AMD("theme/adapt-contrib-vanilla/js/themeArticleView",class ThemeArticleView extends ThemeView{className(){}setCustomStyles(){}onRemove(){}});var ThemeBlockView=__AMD("theme/adapt-contrib-vanilla/js/themeBlockView",class ThemeBlockView extends ThemeView{className(){return this.model.get("_isDividerBlock")?"is-divider-block":""}setCustomStyles(){}onRemove(){}});class Theme extends Backbone.Controller{initialize(){this.listenTo(Adapt$1,{"app:dataReady":this.onDataReady,"pageView:postRender articleView:postRender blockView:postRender":this.onPostRender})}onDataReady(){$("html").addClass(Adapt$1.course.get("_courseStyle"))}onPostRender(view){const viewModel=view.model;const theme=viewModel.get("_vanilla");const model=new Backbone.Model(theme);const el=view.$el;if(!theme)return;switch(viewModel.get("_type")){case"page":new ThemePageView({model:model,el:el});break;case"article":new ThemeArticleView({model:model,el:el});break;case"block":new ThemeBlockView({model:model,el:el});break;default:new ThemeView({model:model,el:el})}}}__AMD("theme/adapt-contrib-vanilla/js/theme",new Theme);register("header",(function Header(props){const jsxHeading=React.useRef(null);const{_id:_id,displayTitle:displayTitle,body:body,instruction:instruction,mobileInstruction:mobileInstruction,_type:_type,_component:_component,_extension:_extension,_isA11yComponentDescriptionEnabled:_isA11yComponentDescriptionEnabled,classNamePrefixes:classNamePrefixes=[_type&&_type.toLowerCase(),_component&&_component.toLowerCase(),_extension&&_extension.toLowerCase()].filter(Boolean)}=props;const sizedInstruction=mobileInstruction&&!device$1.isScreenSizeMin("medium")?mobileInstruction:instruction;const _globals=Adapt$1.course.get("_globals");const ariaRegion=_globals?._components?.[`_${_component}`]?.ariaRegion??_globals?._extensions?.[`_${_extension}`]?.ariaRegion;const isSet=displayTitle||body||sizedInstruction;if(!isSet&&_isA11yComponentDescriptionEnabled&&ariaRegion){return React__default["default"].createElement("div",{className:"aria-label",dangerouslySetInnerHTML:{__html:compile(ariaRegion)}})}if(!isSet)return null;return React__default["default"].createElement("div",{id:`${_id}-header`,className:prefixClasses(classNamePrefixes,["__header"])},React__default["default"].createElement("div",{className:prefixClasses(classNamePrefixes,["__header-inner"])},displayTitle&&React__default["default"].createElement("div",{className:prefixClasses(classNamePrefixes,["__title"])},React__default["default"].createElement("div",{className:prefixClasses(classNamePrefixes,["__title-inner"])+" js-heading",ref:jsxHeading})),_isA11yComponentDescriptionEnabled&&ariaRegion&&React__default["default"].createElement("div",{className:"aria-label",dangerouslySetInnerHTML:{__html:compile(ariaRegion,props)}}),body&&React__default["default"].createElement("div",{className:prefixClasses(classNamePrefixes,["__body"])},React__default["default"].createElement("div",{className:prefixClasses(classNamePrefixes,["__body-inner"]),dangerouslySetInnerHTML:{__html:compile(body,props)}})),sizedInstruction&&React__default["default"].createElement("div",{className:prefixClasses(classNamePrefixes,["__instruction"])},React__default["default"].createElement("span",{className:"icon","aria-hidden":"true"}),React__default["default"].createElement("div",{className:prefixClasses(classNamePrefixes,["__instruction-inner"]),dangerouslySetInnerHTML:{__html:compile(sizedInstruction,props)}}))))}));register("image",(function Image(props){const hasMatchingSetting=Object.hasOwn(props,`_${device$1.screenSize}`)||Object.hasOwn(props,device$1.screenSize);const screenSize=hasMatchingSetting?device$1.screenSize:device$1.isScreenSizeMin("medium")?"large":"small";const src=props[`_${screenSize}`]||props[`${screenSize}`]||props._src||props.src;const hasSource=Boolean(src);if(!hasSource)return null;const attributionClassNamePrefixes=props.attributionClassNamePrefixes||props.classNamePrefixes;return React__default["default"].createElement("span",{id:props.id,className:classes([prefixClasses(props.classNamePrefixes,["__image-container"]),props.classes,props.attribution&&"has-attribution"])},React__default["default"].createElement("img",{className:prefixClasses(props.classNamePrefixes,["__image"]),src:src,"aria-label":a11y$1.normalize(props.alt),"aria-hidden":!props.alt,loading:"eager","aria-describedby":props.longdescription?props.longDescriptionId:undefined}),props.attribution&&React__default["default"].createElement("span",{className:prefixClasses(attributionClassNamePrefixes,["__attribution"])},React__default["default"].createElement("span",{className:prefixClasses(attributionClassNamePrefixes,["__attribution-inner"])},html(props.attribution))))}));register("navButton",(function NavButton(props){const{text:text,_iconClasses:_iconClasses}=props;return React__default["default"].createElement(React__default["default"].Fragment,null,React__default["default"].createElement("span",{className:classes(["icon",_iconClasses]),"aria-hidden":"true"}),React__default["default"].createElement("span",{className:"nav__btn-label","aria-hidden":"true"},compile(text,props)))}));register("tooltip",(function Tooltip(props){const{text:text,disabledText:disabledText,isDisabled:isDisabled,ariaHidden:ariaHidden}=props;return React__default["default"].createElement(React__default["default"].Fragment,null,React__default["default"].createElement("div",{className:classes(["tooltip__arrow"]),"aria-hidden":"true"}),React__default["default"].createElement("div",{className:classes(["tooltip__body"]),"aria-hidden":ariaHidden},React__default["default"].createElement("div",{className:"tooltip__body-inner",dangerouslySetInnerHTML:{__html:compile((isDisabled?disabledText:text)||"",props)}})))}));function _extends(){_extends=Object.assign?Object.assign.bind():function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}register("accordion",(function Accordion(props){const visited=Adapt$1.course.get("_globals")?._accessibility?._ariaLabels.visited;const{_id:_id,_ariaLevel:_ariaLevel,onClick:onClick}=props;const itemAriaLevel=_.isNumber(_ariaLevel)&&_ariaLevel!==0?_ariaLevel+1:_ariaLevel;return React__default["default"].createElement("div",{className:"component__inner accordion__inner"},React__default["default"].createElement(templates.header,props),React__default["default"].createElement("div",{className:"component__widget accordion__widget"},props._items.map(((_ref,index)=>{let{_graphic:_graphic,_imageAlignment:_imageAlignment,_classes:_classes,title:title,body:body,_index:_index,_isVisited:_isVisited,_isActive:_isActive,_ariaLevel:_ariaLevel}=_ref;const ariaLabel=`${_isVisited?visited+". ":""}${compile(title)}`;return React__default["default"].createElement("div",{className:classes(["accordion-item","js-accordion-item",_graphic?.src&&"has-image",_graphic?.src&&_imageAlignment&&`align-image-${_imageAlignment}`,_classes]),key:_index,"data-index":_index},React__default["default"].createElement("div",{role:"heading","aria-level":a11y$1.ariaLevel({id:_id,level:"componentItem",override:_ariaLevel??itemAriaLevel})},React__default["default"].createElement("button",{id:`${_id}-${index}-accordion-button`,className:classes(["accordion-item__btn","js-toggle-item",_isVisited&&"is-visited",_isActive?"is-open is-selected":"is-closed"]),onClick:onClick,"aria-expanded":_isActive.toString(),"aria-controls":`${_id}-${index}-accordion-button-panel`},React__default["default"].createElement("span",{className:"accordion-item__btn-inner"},React__default["default"].createElement("span",{className:"accordion-item__icon"},React__default["default"].createElement("span",{className:"icon","aria-hidden":"true"})),React__default["default"].createElement("span",{className:"accordion-item__title"},React__default["default"].createElement("span",{className:"aria-label",dangerouslySetInnerHTML:{__html:compile(ariaLabel)}}),React__default["default"].createElement("span",{className:"accordion-item__title-inner","aria-hidden":"true",dangerouslySetInnerHTML:{__html:compile(title)}}))))),React__default["default"].createElement("div",{id:`${_id}-${index}-accordion-button-panel`,className:"accordion-item__content js-accordion-item-content",role:"region","aria-labelledby":`${_id}-${index}-accordion-button`},React__default["default"].createElement("div",{className:"accordion-item__content-inner"},body&&React__default["default"].createElement("div",{className:"accordion-item__body"},React__default["default"].createElement("div",{className:"accordion-item__body-inner",dangerouslySetInnerHTML:{__html:compile(body)}})),React__default["default"].createElement(templates.image,_extends({},_graphic,{classNamePrefixes:["component-item","accordion-item"],attributionClassNamePrefixes:["component","accordion"]})))))}))))}));register("assessmentResults",(function AssessmentResults(props){const{_globals:_globals,_retry:_retry,retryFeedback:retryFeedback,_isRetryEnabled:_isRetryEnabled}=props;return React__default["default"].createElement("div",{className:"component__inner assessmentresults__inner"},React__default["default"].createElement(templates.header,props),React__default["default"].createElement("div",{className:"component__widget assessmentresults__widget"},_isRetryEnabled&&React__default["default"].createElement("div",{className:"component__feedback assessmentresults__feedback"},React__default["default"].createElement("div",{className:"component__feedback-inner assessmentresults__feedback-inner"},retryFeedback&&React__default["default"].createElement("div",{className:"assessmentresults__retry-feedback"},React__default["default"].createElement("div",{className:"assessmentresults__retry-feedback-inner",dangerouslySetInnerHTML:{__html:compile(retryFeedback,props)}})),React__default["default"].createElement("button",{className:"btn-text assessmentresults__retry-btn js-assessment-retry-btn"},React__default["default"].createElement("span",null,_retry.button||_globals._components._assessmentResults.retryText))))))}));register("blank",(function Blank(props){return React__default["default"].createElement("div",{className:"component__inner blank__inner"})}));register("gmcq",(function Gmcq(props){const ariaLabels=Adapt$1.course.get("_globals")._accessibility._ariaLabels;const{_id:_id,_isEnabled:_isEnabled,_isInteractionComplete:_isInteractionComplete,_isCorrect:_isCorrect,_isCorrectAnswerShown:_isCorrectAnswerShown,_shouldShowMarking:_shouldShowMarking,_isRadio:_isRadio,_columns:_columns,displayTitle:displayTitle,body:body,instruction:instruction,ariaQuestion:ariaQuestion,onKeyPress:onKeyPress,onItemSelect:onItemSelect,onItemFocus:onItemFocus,onItemBlur:onItemBlur}=props;const hasColumnLayout=device$1.isScreenSizeMin("medium");return React__default["default"].createElement("div",{className:"component__inner gmcq__inner"},React__default["default"].createElement(templates.header,props),React__default["default"].createElement("div",{className:classes(["component__widget","gmcq__widget",!_isEnabled&&"is-disabled",_isInteractionComplete&&"is-complete is-submitted show-user-answer",_isCorrect&&"is-correct",_columns&&hasColumnLayout&&"has-column-layout"]),role:_isRadio?"radiogroup":"group","aria-labelledby":ariaQuestion?null:(displayTitle||body||instruction)&&`${_id}-header`,"aria-label":ariaQuestion||null},props._items.map(((_ref,index)=>{let{text:text,_index:_index,_isActive:_isActive,_shouldBeSelected:_shouldBeSelected,_graphic:_graphic}=_ref;return React__default["default"].createElement("div",{className:classes([`gmcq-item item-${index}`,_shouldShowMarking&&_shouldBeSelected?"is-correct":null,_shouldShowMarking&&!_shouldBeSelected?"is-incorrect":null]),style:_columns&&hasColumnLayout?{width:`${100/_columns}%`}:null,key:_index},React__default["default"].createElement("input",{className:"gmcq-item__input",id:`${_id}-${index}-input`,name:_isRadio?`${_id}-item`:null,type:_isRadio?"radio":"checkbox",disabled:!_isEnabled,checked:_isActive,"aria-label":!_shouldShowMarking?`${a11y$1.normalize(text)} ${_graphic?.alt||""}`:`${_shouldBeSelected?ariaLabels.correct:ariaLabels.incorrect}, ${_isActive?ariaLabels.selectedAnswer:ariaLabels.unselectedAnswer}. ${a11y$1.normalize(text)} ${_graphic?.alt||""}`,"data-adapt-index":_index,onKeyPress:onKeyPress,onChange:onItemSelect,onFocus:onItemFocus,onBlur:onItemBlur}),React__default["default"].createElement("label",{className:classes(["gmcq-item__label","js-item-label","u-no-select",!_isEnabled&&"is-disabled",(_isCorrectAnswerShown?_shouldBeSelected:_isActive)&&"is-selected"]),"aria-hidden":true,htmlFor:`${_id}-${index}-input`,"data-adapt-index":_index},React__default["default"].createElement(templates.image,_extends({},_graphic,{classNamePrefixes:["gmcq-item"],attributionClassNamePrefixes:["component","gmcq"]})),React__default["default"].createElement("span",{className:"gmcq-item__option"},React__default["default"].createElement("span",{className:"gmcq-item__state"},React__default["default"].createElement("span",{className:classes(["gmcq-item__icon","gmcq-item__answer-icon",_isRadio?"is-radio":"is-checkbox"])},React__default["default"].createElement("span",{className:"icon"})),React__default["default"].createElement("span",{className:"gmcq-item__icon gmcq-item__correct-icon"},React__default["default"].createElement("span",{className:"icon"})),React__default["default"].createElement("span",{className:"gmcq-item__icon gmcq-item__incorrect-icon"},React__default["default"].createElement("span",{className:"icon"}))),text&&React__default["default"].createElement("span",{className:"gmcq-item__text"},React__default["default"].createElement("span",{className:"gmcq-item__text-inner",dangerouslySetInnerHTML:{__html:compile(text)}})))))}))),React__default["default"].createElement("div",{className:"btn__container"}))}));const LinkWrapper=_ref=>{let{href:href,children:children,target:target,className:className,role:role}=_ref;return href?React__default["default"].createElement("a",{href:href,target:target,className:className,role:role},children):children};register("graphic",(function Graphic(props){const{_id:_id,_isScrollable:_isScrollable,_scrollPercent:_scrollPercent,_graphic:_graphic,_globals:_globals}=props;const scrollableProperties=_isScrollable?{role:"slider",className:"component__widget graphic__widget js-graphic-scrollbar","aria-controls":`graphic__scroll__container__${_id}`,"aria-orientation":"horizontal","aria-valuemax":"100","aria-valuemin":"0","aria-valuenow":_scrollPercent,"aria-label":Handlebars.compile(_globals._components._graphic.scrollAriaLabel)(props),"aria-describedby":_graphic.longdescription?`graphic__longdescription__${_id}`:undefined,tabIndex:"0"}:{};return React__default["default"].createElement("div",{className:"component__inner graphic__inner"},React__default["default"].createElement(templates.header,props),React__default["default"].createElement("div",_extends({className:"component__widget graphic__widget"},scrollableProperties),React__default["default"].createElement(LinkWrapper,{href:_graphic._url,target:_graphic._target,className:"graphic__link js-graphic-link",role:"link"},React__default["default"].createElement(templates.image,_extends({},_graphic,{"aria-hidden":_isScrollable,id:`graphic__scroll__container__${_id}`,longDescriptionId:`graphic__longdescription__${_id}`,classes:"js-graphic-scroll-container",classNamePrefixes:["component","graphic"]})),_graphic.longdescription&&React__default["default"].createElement("div",{id:`graphic__longdescription__${_id}`,className:"graphic__longdescription"},React__default["default"].createElement("div",{className:"graphic__longdescription-inner"},_graphic.longdescription)))))}));register("hotgraphic",(function Hotgraphic(props){const{_graphic:_graphic,_useGraphicsAsPins:_useGraphicsAsPins}=props;return React__default["default"].createElement("div",{className:"component__inner hotgraphic__inner"},React__default["default"].createElement(templates.header,props),React__default["default"].createElement("div",{className:classes(["component__widget hotgraphic__widget",_useGraphicsAsPins?"is-tile":"is-pin",_graphic.attribution&&"has-attribution"])},_useGraphicsAsPins&&React__default["default"].createElement(templates.hotgraphicLayoutTiles,props),!_useGraphicsAsPins&&React__default["default"].createElement(templates.hotgraphicLayoutPins,props)))}));register("hotgraphicLayoutPins",(function HotgraphicLayoutPins(props){const globals=Adapt$1.course.get("_globals");const visitedLabel=globals?._accessibility?._ariaLabels.visited;const{_items:_items,_graphic:_graphic,_useNumberedPins:_useNumberedPins,_tooltip:_tooltip,onPinClicked:onPinClicked}=props;return React__default["default"].createElement("div",{className:"hotgraphic__pins"},React__default["default"].createElement("img",{className:"hotgraphic__image",src:_graphic.src,"aria-label":_graphic.alt||null,"aria-hidden":!_graphic.alt||null,"data-tooltip-id":_tooltip?._isEnabled&&_tooltip?._id}),_graphic.attribution&&React__default["default"].createElement("div",{className:"component__attribution hotgraphic__attribution"},React__default["default"].createElement("div",{className:"component__attribution-inner hotgraphic__attribution-inner"},_graphic.attribution)),React__default["default"].createElement("div",{className:"hotgraphic__pin-item-container",role:"list"},_items.map(((_ref,index)=>{let{_top:_top,_left:_left,_index:_index,_graphic:_graphic,_isVisited:_isVisited,_pin:_pin,title:title,_tooltip:_tooltip}=_ref;const visited=_isVisited?visitedLabel?.trim?.()+". ":"";const numbered=_useNumberedPins?index+1+". ":"";const itemTitle=(_pin.alt||title)?.trim?.()+". ";const itemCount=compile(globals._components?._hotgraphic?.popupPagination||"",{itemNumber:_index+1,totalItems:_items.length});const ariaLabel=`${visited}${numbered}${itemTitle}${itemCount}`;return React__default["default"].createElement("div",{className:"hotgraphic__pin-item",role:"listitem",key:_index},React__default["default"].createElement("button",{className:classes(["btn-icon hotgraphic__pin",`item-${_index}`,_graphic._classes,_isVisited&&"is-visited",_pin.src&&"has-pin-image"]),"data-index":_index,onClick:onPinClicked,style:{top:_top+"%",left:_left+"%"},"data-tooltip-id":_tooltip?._id},React__default["default"].createElement("span",{className:"aria-label",dangerouslySetInnerHTML:{__html:compile(ariaLabel)}}),_pin.src&&React__default["default"].createElement("span",{className:classes(["hotgraphic__pin-image-container",`item-${_index}`])},React__default["default"].createElement("img",{className:"hotgraphic__pin-image",src:_pin.src,"aria-hidden":"true"})),!_pin.src&&_useNumberedPins&&React__default["default"].createElement("span",{className:"hotgraphic__pin-number","aria-hidden":"true"},index+1),!_pin.src&&!_useNumberedPins&&React__default["default"].createElement("span",{className:"icon","aria-hidden":"true"})))}))))}));register("hotgraphicLayoutTiles",(function HotgraphicLayoutTiles(props){const globals=Adapt$1.course.get("_globals");const visitedLabel=globals?._accessibility?._ariaLabels.visited;const{_items:_items,onPinClicked:onPinClicked}=props;return React__default["default"].createElement("div",{className:"hotgraphic__tile-item-container",role:"list"},_items.map((_ref=>{let{_index:_index,_graphic:_graphic,_isVisited:_isVisited,title:title}=_ref;const visited=_isVisited?visitedLabel+". ":"";const itemTitle=title+". ";const itemCount=compile(globals._components._hotgraphic.item,{itemNumber:_index+1,totalItems:_items.length});const ariaLabel=visited+itemTitle+itemCount;return React__default["default"].createElement("div",{className:"hotgraphic__tile-item",role:"listitem",key:_index},React__default["default"].createElement("button",{className:classes(["hotgraphic__tile",`item-${_index}`,_graphic._classes,_isVisited&&"is-visited"]),"data-index":_index,onClick:onPinClicked},React__default["default"].createElement("span",{className:"aria-label"},ariaLabel),React__default["default"].createElement("img",{className:"hotgraphic__tile-image",src:_graphic.src,"aria-hidden":"true"}),React__default["default"].createElement("div",{className:"icon","aria-hidden":"true"})))})))}));register("hotgraphicPopup",(function HotgraphicPopup(props){const{_items:_items,_isRound:_isRound}=props;React.useEffect((()=>{const activeItem=_items.filter((item=>item._isActive));if(!activeItem.length)return;const activeItemIndex=activeItem[0]._index;const focusElement=$(`.hotgraphic-popup__item[data-index=${activeItemIndex}]`);a11y$1.focusFirst(focusElement)}));return React__default["default"].createElement("div",{className:"hotgraphic-popup__inner"},_items.map(((_ref,index)=>{let{title:title,body:body,_graphic:_graphic,_classes:_classes,_isVisited:_isVisited,_isActive:_isActive,_imageAlignment:_imageAlignment}=_ref;return React__default["default"].createElement("div",{className:classes(["hotgraphic-popup__item",_classes,_isRound&&"is-round",_isVisited&&"is-visited",_isActive&&"is-active",_imageAlignment&&`align-image-${_imageAlignment}`]),key:index,"data-index":index,"aria-hidden":!_isActive?true:null},React__default["default"].createElement("div",{className:"hotgraphic-popup__item-content"},React__default["default"].createElement("div",{className:"hotgraphic-popup__item-content-inner"},title&&React__default["default"].createElement("div",{className:classes(["hotgraphic-popup__item-title",_isActive&&"notify-heading"]),role:"heading","aria-level":a11y$1.ariaLevel({level:"notify"})},React__default["default"].createElement("div",{className:"hotgraphic-popup__item-title-inner",dangerouslySetInnerHTML:{__html:title}})),body&&React__default["default"].createElement("div",{className:"hotgraphic-popup__item-body"},React__default["default"].createElement("div",{className:"hotgraphic-popup__item-body-inner",dangerouslySetInnerHTML:{__html:compile(body)}})))),React__default["default"].createElement("div",{className:classes(["hotgraphic-popup__item-image-container",_graphic.attribution&&"has-attribution"])},React__default["default"].createElement("img",{className:"hotgraphic-popup__item-image",src:_graphic.src,"aria-label":_graphic.alt||null,"aria-hidden":!_graphic.alt||null}),_graphic.attribution&&React__default["default"].createElement("div",{className:"component__attribution hotgraphic-popup__attribution"},React__default["default"].createElement("div",{className:"component__attribution-inner hotgraphic-popup__attribution-inner",dangerouslySetInnerHTML:{__html:_graphic.attribution}}))))})),React__default["default"].createElement(templates.hotgraphicPopupToolbar,props))}));register("hotgraphicPopupToolbar",(function HotgraphicPopupToolbar(props){const a11yConfig=Adapt$1.config.get("_accessibility");const ariaLabels=Adapt$1.course.get("_globals")._accessibility._ariaLabels;const{onCloseClick:onCloseClick,onControlClick:onControlClick,shouldEnableBack:shouldEnableBack,shouldEnableNext:shouldEnableNext,popupCount:popupCount,backLabel:backLabel,nextLabel:nextLabel,_hidePagination:_hidePagination}=props;return React__default["default"].createElement("div",{className:classes(["hotgraphic-popup__toolbar",_hidePagination&&"hide-pagination"])},!_hidePagination&&React__default["default"].createElement("div",{className:classes(["hotgraphic-popup__nav",!shouldEnableBack&&"first",!shouldEnableNext&&"last"])},React__default["default"].createElement("button",{className:classes(["btn-icon hotgraphic-popup__controls back",!shouldEnableBack&&"is-disabled"]),"aria-label":backLabel,"aria-disabled":!shouldEnableBack||null,onClick:onControlClick,"data-direction":"back"},React__default["default"].createElement("span",{className:"icon","aria-hidden":"true"})),React__default["default"].createElement("div",{className:"hotgraphic-popup__count",dangerouslySetInnerHTML:{__html:popupCount},"aria-hidden":"true"}),React__default["default"].createElement("button",{className:classes(["btn-icon hotgraphic-popup__controls next",!shouldEnableNext&&"is-disabled"]),"aria-label":nextLabel,"aria-disabled":!shouldEnableNext||null,onClick:onControlClick,"data-direction":"next"},React__default["default"].createElement("span",{className:"icon","aria-hidden":"true"}))),React__default["default"].createElement("button",{className:"btn-icon hotgraphic-popup__close","aria-label":ariaLabels.closePopup,onClick:onCloseClick},React__default["default"].createElement("span",{className:"icon","aria-hidden":"true"})),a11yConfig._options._isPopupWrapFocusEnabled&&React__default["default"].createElement("a",{className:"a11y-focusguard a11y-ignore a11y-ignore-focus",tabIndex:"0",role:"presentation"}))}));register("matching",(function Matching(props){const{_id:_id,_isEnabled:_isEnabled,_isInteractionComplete:_isInteractionComplete,_isCorrect:_isCorrect,_shouldShowMarking:_shouldShowMarking,_isCorrectAnswerShown:_isCorrectAnswerShown,_items:_items,_options:_options,_globals:_globals,displayTitle:displayTitle,body:body,instruction:instruction,ariaQuestion:ariaQuestion}=props;const displayAsCorrect=_isInteractionComplete&&(_isCorrectAnswerShown||_isCorrect);return React__default["default"].createElement("div",{className:"component__inner matching__inner"},React__default["default"].createElement(templates.header,props),React__default["default"].createElement("div",{className:classes(["component__widget matching__widget",!_isEnabled&&"is-disabled",_isInteractionComplete&&"is-complete is-submitted show-user-answer",displayAsCorrect&&"is-correct"]),"aria-labelledby":ariaQuestion?null:(displayTitle||body||instruction)&&`${_id}-header`,"aria-label":ariaQuestion||null},_items.map(((_ref,index)=>{let{text:text,_index:_index}=_ref;const activeOption=_options.find((option=>option._itemIndex===_index&&option._isActive));const displayItemAsCorrect=!_isEnabled&&_shouldShowMarking&&(_isCorrectAnswerShown||activeOption?._shouldBeSelected);return React__default["default"].createElement("div",{key:_index,className:classes(["matching-item","item",`item-${index}`,"js-matching-item",_shouldShowMarking&&(displayItemAsCorrect?"is-correct":"is-incorrect")])},text&&React__default["default"].createElement("div",{className:"matching-item__title"},React__default["default"].createElement("div",{className:"matching-item__title_inner",dangerouslySetInnerHTML:{__html:text}})),React__default["default"].createElement("div",{className:"matching-item__select-container js-matching-item-select-container"},React__default["default"].createElement(templates.matchingDropDown,_extends({},props,{_itemIndex:_index})),React__default["default"].createElement("div",{className:"matching-item__select-state"},React__default["default"].createElement("div",{className:"matching-item__select-icon matching-item__select-correct-icon","aria-label":_globals._accessibility._ariaLabels.correct},React__default["default"].createElement("div",{className:"icon","aria-hidden":"true"})),React__default["default"].createElement("div",{className:"matching-item__select-icon matching-item__select-incorrect-icon","aria-label":_globals._accessibility._ariaLabels.incorrect},React__default["default"].createElement("div",{className:"icon","aria-hidden":"true"})))))}))),React__default["default"].createElement("div",{className:"btn__container"}))}));register("matchingDropDown",(function MatchingDropDown(props){const button=React.useRef(null);const list=React.useRef(null);const[wasOpen,setWasOpen]=React.useState(false);const[isOpen,setIsOpen]=React.useState(false);const[isShown,setIsShown]=React.useState(false);const[blurTimeoutHandle,setBlurTimeoutHandle]=React.useState(null);const[isListOffScreen,setIsListOffScreen]=React.useState(false);const[listHeight,setListHeight]=React.useState(null);const[buttonWidth,setButtonWidth]=React.useState(null);const[buttonOffsetLeft,setButtonOffsetLeft]=React.useState(null);const onStartInteraction=()=>setWasOpen(isOpen);const onButtonClick=()=>{if(wasOpen||isOpen){setIsOpen(false);return}if(blurTimeoutHandle){clearTimeout(blurTimeoutHandle);setBlurTimeoutHandle(null)}setIsShown(false);setIsOpen(true);setTimeout((()=>{const offset=list?.current.getBoundingClientRect();const height=$(list?.current).height();const windowHeight=$(window).height();setIsListOffScreen(offset.top+height>windowHeight);setListHeight(height);setButtonOffsetLeft(button?.current.offsetLeft);setButtonWidth($(button?.current).outerWidth());setIsShown(true);list?.current.focus();scrollToHighlightedListItem()}),100)};const scrollToHighlightedListItem=()=>{if(!list?.current)return;const highlighted=$("li[aria-selected]",list.current)[0];if(!highlighted)return;const height=list.current.clientHeight;const pos=highlighted.offsetTop-height/2;list.current.scrollTop=pos};const onOptionClicked=event=>{const li=$(event.target).closest("li");const optionIndex=$(li).val();const option=options.find((option=>option._index===optionIndex));chooseOption(option)};const chooseOption=option=>{setActiveOption(option._index);button?.current.focus()};const onListBlur=()=>{if(!isOpen)return;const handleBlur=()=>{setIsShown(false);setIsOpen(false)};setBlurTimeoutHandle(setTimeout(handleBlur,100))};const onDocumentClick=event=>{if(!isOpen)return;const parents=[document.activeElement,...$(document.activeElement).parents().toArray()];if(parents.includes(list?.current))return;onListBlur()};const KEYCODE={UP:38,DOWN:40,ENTER:13,SPACE:32,ESCAPE:27};const validKeyCodes=Object.values(KEYCODE);const onDocumentKeyDown=event=>{if(!isOpen||!validKeyCodes.includes(event.keyCode))return;switch(event.keyCode){case KEYCODE.UP:{event.preventDefault();const option=getPreviousOption()||getLastOption();highlightOption(option);break}case KEYCODE.DOWN:{event.preventDefault();const option=getNextOption()||getFirstOption();highlightOption(option);break}case KEYCODE.ENTER:case KEYCODE.SPACE:event.preventDefault();chooseOption(highlightedOption);break;case KEYCODE.ESCAPE:event.preventDefault();button?.current.focus()}};const getCurrentOptionIndex=()=>options.findIndex((option=>option===highlightedOption));const getPreviousOption=()=>options[getCurrentOptionIndex()-1];const getLastOption=()=>options[options.length-1];const getNextOption=()=>options[getCurrentOptionIndex()+1];const getFirstOption=()=>options[0];const highlightOption=option=>{setHighlightedOption(option._index);scrollToHighlightedListItem()};React.useEffect((()=>{document.addEventListener("click",onDocumentClick,{capture:true});document.addEventListener("keydown",onDocumentKeyDown);return()=>{document.removeEventListener("click",onDocumentClick,{capture:true});document.removeEventListener("keydown",onDocumentKeyDown)}}),[onDocumentKeyDown,onDocumentClick]);const{_id:_id,_isEnabled:_isEnabled,placeholder:placeholder,_itemIndex:_itemIndex,_options:_options,_isCorrectAnswerShown:_isCorrectAnswerShown,setActiveOption:setActiveOption,setHighlightedOption:setHighlightedOption}=props;const options=_options.filter((_ref=>{let{_itemIndex:itemIndex}=_ref;return itemIndex===_itemIndex||itemIndex===-1}));const activeOption=options.find((option=>option._itemIndex===_itemIndex&&option._isActive))||{text:placeholder};const highlightedOption=options.find((option=>option._itemIndex===_itemIndex&&option._isHighlighted))||{text:placeholder};const correctActiveOption=activeOption?._shouldBeSelected?activeOption:options.find((option=>option._shouldBeSelected));const displayActiveOption=_isCorrectAnswerShown?correctActiveOption:activeOption;return React__default["default"].createElement("div",{className:"dropdown",disabled:!_isEnabled},React__default["default"].createElement("button",{disabled:!_isEnabled,className:classes(["dropdown__btn js-dropdown-btn",!_isEnabled&&"is-disabled"]),"aria-haspopup":"listbox","aria-expanded":isOpen,onMouseDown:onStartInteraction,onTouchStart:onStartInteraction,onClick:onButtonClick,ref:button},React__default["default"].createElement("span",{className:"dropdown__inner js-dropdown-inner",dangerouslySetInnerHTML:{__html:displayActiveOption?.text}}),React__default["default"].createElement("span",{className:"dropdown__icon","aria-hidden":"true"},React__default["default"].createElement("span",{className:"icon"}))),React__default["default"].createElement("ul",{className:classes(["dropdown__list js-dropdown-list",!isOpen&&"u-display-none",isOpen&&!isShown&&"u-visibility-hidden"]),style:{top:!isShown||!isListOffScreen?"":-listHeight,left:buttonOffsetLeft,width:buttonWidth},role:"listbox",tabIndex:"-1",onBlur:onListBlur,ref:list,disabled:!_isEnabled,"aria-activedescendant":highlightedOption&&`dropdown__item__${_id}__${_itemIndex}__${highlightedOption._index}`},options.map((_ref2=>{let{displayText:displayText,text:text,_index:_index,_isHighlighted:_isHighlighted}=_ref2;return React__default["default"].createElement("li",{key:_index,id:`dropdown__item__${_id}__${_itemIndex}__${_index}`,className:"dropdown-item js-dropdown-list-item",role:"option",text:text,value:_index,"aria-selected":_isHighlighted||null,selected:_isHighlighted||null,onClick:onOptionClicked},React__default["default"].createElement("div",{className:"dropdown-item__inner js-dropdown-list-item-inner u-no-select",dangerouslySetInnerHTML:{__html:displayText||text}}))}))))}));register("mcq",(function Mcq(props){const ariaLabels=Adapt$1.course.get("_globals")._accessibility._ariaLabels;const{_id:_id,_isEnabled:_isEnabled,_isInteractionComplete:_isInteractionComplete,_isCorrect:_isCorrect,_isCorrectAnswerShown:_isCorrectAnswerShown,_shouldShowMarking:_shouldShowMarking,_isRadio:_isRadio,displayTitle:displayTitle,body:body,instruction:instruction,ariaQuestion:ariaQuestion,onKeyPress:onKeyPress,onItemSelect:onItemSelect,onItemFocus:onItemFocus,onItemBlur:onItemBlur}=props;return React__default["default"].createElement("div",{className:"component__inner mcq__inner"},React__default["default"].createElement(templates.header,props),React__default["default"].createElement("div",{className:classes(["component__widget","mcq__widget",!_isEnabled&&"is-disabled",_isInteractionComplete&&"is-complete is-submitted show-user-answer",_isCorrect&&"is-correct"]),role:_isRadio?"radiogroup":"group","aria-labelledby":ariaQuestion?null:(displayTitle||body||instruction)&&`${_id}-header`,"aria-label":ariaQuestion||null},props._items.map(((_ref,index)=>{let{text:text,_index:_index,_isActive:_isActive,_shouldBeSelected:_shouldBeSelected,_isHighlighted:_isHighlighted}=_ref;return React__default["default"].createElement("div",{className:classes([`mcq-item item-${index}`,_shouldShowMarking&&_shouldBeSelected&&"is-correct",_shouldShowMarking&&!_shouldBeSelected&&"is-incorrect"]),key:_index},React__default["default"].createElement("input",{className:"mcq-item__input",id:`${_id}-${index}-input`,name:_isRadio?`${_id}-item`:null,type:_isRadio?"radio":"checkbox",disabled:!_isEnabled,checked:_isActive,"aria-label":!_shouldShowMarking?a11y$1.normalize(text):`${_shouldBeSelected?ariaLabels.correct:ariaLabels.incorrect}, ${_isActive?ariaLabels.selectedAnswer:ariaLabels.unselectedAnswer}. ${a11y$1.normalize(text)}`,"data-adapt-index":_index,onKeyPress:onKeyPress,onChange:onItemSelect,onFocus:onItemFocus,onBlur:onItemBlur}),React__default["default"].createElement("label",{className:classes(["mcq-item__label","u-no-select",!_isEnabled&&"is-disabled",_isHighlighted&&"is-highlighted",(_isCorrectAnswerShown?_shouldBeSelected:_isActive)&&"is-selected"]),"aria-hidden":true,htmlFor:`${_id}-${index}-input`,"data-adapt-index":_index},React__default["default"].createElement("span",{className:"mcq-item__state"},React__default["default"].createElement("span",{className:classes(["mcq-item__icon","mcq-item__answer-icon",_isRadio?"is-radio":"is-checkbox"])},React__default["default"].createElement("span",{className:"icon"})),React__default["default"].createElement("span",{className:"mcq-item__icon mcq-item__correct-icon"},React__default["default"].createElement("span",{className:"icon"})),React__default["default"].createElement("span",{className:"mcq-item__icon mcq-item__incorrect-icon"},React__default["default"].createElement("span",{className:"icon"}))),React__default["default"].createElement("span",{className:"mcq-item__text"},React__default["default"].createElement("span",{className:"mcq-item__text-inner",dangerouslySetInnerHTML:{__html:compile(text)}}))))}))),React__default["default"].createElement("div",{className:"btn__container"}))}));register("narrative",(function Narrative(props){const{_id:_id,_items:_items,_translateXOffset:_translateXOffset,_hasNavigationInTextArea:_hasNavigationInTextArea,onNavigationClicked:onNavigationClicked,openPopup:openPopup,_itemWidth:_itemWidth,_totalWidth:_totalWidth,_mode:_mode,_isTextBelowImageResolved:_isTextBelowImageResolved,backLabel:backLabel,nextLabel:nextLabel,shouldEnableBack:shouldEnableBack,shouldEnableNext:shouldEnableNext}=props;return React__default["default"].createElement("div",{className:classes(["component__inner narrative__inner",_mode===MODE.LARGE?"mode-large":"mode-small",_isTextBelowImageResolved&&"items-are-full-width"])},React__default["default"].createElement(templates.header,props),React__default["default"].createElement("div",{className:classes(["component__widget narrative__widget",_hasNavigationInTextArea&&"narrative__text-controls"])},React__default["default"].createElement("div",{className:"narrative__content"},React__default["default"].createElement("div",{className:"narrative__content-inner"},_items.map((_ref=>{let{_index:_index,_isActive:_isActive,_isVisited:_isVisited,title:title,body:body,_ariaLevel:_ariaLevel}=_ref;return React__default["default"].createElement("div",{className:classes(["narrative__content-item",_isActive&&"is-active",_isVisited&&"is-visited"]),"aria-hidden":!_isActive||null,"data-index":_index,key:_index},title&&React__default["default"].createElement("div",{className:"narrative__content-title"},React__default["default"].createElement("div",{className:"narrative__content-title-inner",role:"heading","aria-level":a11y$1.ariaLevel({id:_id,level:"componentItem",override:_ariaLevel||null}),dangerouslySetInnerHTML:{__html:compile(title,props)}})),body&&React__default["default"].createElement("div",{className:"narrative__content-body"},React__default["default"].createElement("div",{className:"narrative__content-body-inner",dangerouslySetInnerHTML:{__html:compile(body,props)}})))})),React__default["default"].createElement("div",{className:"narrative__controls-container u-clearfix"},React__default["default"].createElement("button",{"data-direction":"left",className:classes(["btn-icon narrative__controls narrative__controls-left",!shouldEnableBack&&"is-disabled"]),"aria-label":backLabel,"aria-disabled":!shouldEnableBack||null,onClick:onNavigationClicked},React__default["default"].createElement("span",{className:"icon","aria-hidden":"true"})),React__default["default"].createElement("div",{className:"narrative__indicators"},_items.map((_ref2=>{let{_index:_index,_isVisited:_isVisited,_isActive:_isActive}=_ref2;return React__default["default"].createElement("div",{className:classes(["narrative__progress",_isVisited&&"is-visited",_isActive&&"is-selected"]),"data-index":_index,key:_index})}))),React__default["default"].createElement("button",{"data-direction":"right",className:classes(["btn-icon narrative__controls narrative__controls-right",!shouldEnableNext&&"is-disabled"]),"aria-label":nextLabel,"aria-disabled":!shouldEnableNext||null,onClick:onNavigationClicked},React__default["default"].createElement("span",{className:"icon","aria-hidden":"true"}))))),React__default["default"].createElement("div",{className:"narrative__strapline"},React__default["default"].createElement("div",{className:"narrative__strapline-header"},React__default["default"].createElement("div",{className:"narrative__strapline-header-inner u-clearfix",style:{width:`${_totalWidth}%`,transform:`translateX(${_translateXOffset}%)`}},_items.map((_ref3=>{let{_index:_index,_isActive:_isActive,_isVisited:_isVisited,strapline:strapline}=_ref3;return React__default["default"].createElement("button",{className:classes(["narrative__strapline-btn",_isVisited&&"is-visited"]),"aria-label":strapline,tabIndex:_isActive?0:-1,"aria-hidden":!_isActive||null,style:{width:`${_itemWidth}%`},onClick:openPopup,"data-index":_index,key:_index},React__default["default"].createElement("span",{className:"narrative__strapline-title"},React__default["default"].createElement("span",{className:"narrative__strapline-title-inner",dangerouslySetInnerHTML:{__html:compile(strapline,props)}})),React__default["default"].createElement("span",{className:"btn-icon narrative__strapline-icon"},React__default["default"].createElement("span",{className:"icon","aria-hidden":"true"})))}))))),React__default["default"].createElement("div",{className:"narrative__slide-container"},React__default["default"].createElement("div",{className:"narrative__slider u-clearfix",style:{width:`${_totalWidth}%`,transform:`translateX(${_translateXOffset}%)`}},_items.map((_ref4=>{let{_index:_index,_isActive:_isActive,_isVisited:_isVisited,_graphic:_graphic}=_ref4;return React__default["default"].createElement("div",{className:classes(["narrative__slider-image-container",_isActive&&"is-active",_isVisited&&"is-visited",_graphic.attribution&&"has-attribution"]),style:{width:`${_itemWidth}%`},"aria-hidden":!_isActive||null,"data-index":_index,key:_index},React__default["default"].createElement("img",{className:"narrative__slider-image js-narrative-swipe",src:_graphic.src,"aria-label":a11y$1.normalize(_graphic.alt)||null,"aria-hidden":!_graphic.alt||null,draggable:"false"}),_graphic.attribution&&React__default["default"].createElement("div",{className:"component__attribution narrative__attribution"},React__default["default"].createElement("div",{className:"component__attribution-inner narrative__attribution-inner",dangerouslySetInnerHTML:{__html:_graphic.attribution}})))}))),React__default["default"].createElement("button",{"data-direction":"left",className:classes(["btn-icon narrative__controls narrative__controls-left",!shouldEnableBack&&"is-disabled"]),"aria-label":backLabel,"aria-disabled":!shouldEnableBack||null,onClick:onNavigationClicked},React__default["default"].createElement("span",{className:"icon","aria-hidden":"true"})),React__default["default"].createElement("button",{"data-direction":"right",className:classes(["btn-icon narrative__controls narrative__controls-right",!shouldEnableNext&&"is-disabled"]),"aria-label":nextLabel,"aria-disabled":!shouldEnableNext||null,onClick:onNavigationClicked},React__default["default"].createElement("span",{className:"icon","aria-hidden":"true"}))),React__default["default"].createElement("div",{className:"narrative__indicators narrative__slide-indicators"},_items.map((_ref5=>{let{_index:_index,_isVisited:_isVisited,_isActive:_isActive}=_ref5;return React__default["default"].createElement("div",{className:classes(["narrative__progress",_isVisited&&"is-visited",_isActive&&"is-selected"]),"data-index":_index,key:_index})})))))}));register("slider",(function Slider(props){const{_id:_id,_globals:_globals,_shouldShowMarking:_shouldShowMarking,_isInteractionComplete:_isInteractionComplete,_isCorrectAnswerShown:_isCorrectAnswerShown,_isEnabled:_isEnabled,_isCorrect:_isCorrect,displayTitle:displayTitle,body:body,instruction:instruction,ariaQuestion:ariaQuestion,labelStart:labelStart,labelEnd:labelEnd,_selectedItem:_selectedItem,_scaleStart:_scaleStart,_scaleEnd:_scaleEnd,_marginDir:_marginDir,onNumberSelected:onNumberSelected,getIndexFromValue:getIndexFromValue,getCorrectAnswers:getCorrectAnswers,_items:_items,_showScale:_showScale,_showNumber:_showNumber,_showScaleNumbers:_showScaleNumbers,_showScaleIndicator:_showScaleIndicator,scaleStepPrefix:scaleStepPrefix="",scaleStepSuffix:scaleStepSuffix=""}=props;const sliderNumberSelectionRef=React.useRef(0);const getCorrectRangeMidpoint=()=>{const answers=getCorrectAnswers();return answers[Math.floor(answers.length/2)]};const calculatePercentFromIndex=index=>index/(_items.length-1)*100;const selectedValue=_isCorrectAnswerShown?getCorrectRangeMidpoint():_selectedItem?.value??_scaleStart;const selectedIndex=getIndexFromValue(selectedValue);const selectedWidth=calculatePercentFromIndex(selectedIndex);return React__default["default"].createElement("div",{className:"component__inner slider__inner"},React__default["default"].createElement(templates.header,props),React__default["default"].createElement("div",{className:classes(["component__widget slider__widget",!_isEnabled&&"is-disabled",_isInteractionComplete&&"is-complete is-submitted show-user-answer",_shouldShowMarking&&_isCorrect&&"is-correct",_shouldShowMarking&&!_isCorrect&&"is-incorrect"]),"aria-labelledby":ariaQuestion?null:(displayTitle||body||instruction)&&`${_id}-header`,"aria-label":ariaQuestion||null},(labelStart||labelEnd)&&React__default["default"].createElement("div",{className:"slider__label-container js-slider-label-container"},labelStart&&React__default["default"].createElement("div",{className:"slider__label-start"},React__default["default"].createElement("div",{className:"slider__label-start-inner"},React__default["default"].createElement("span",{className:"aria-label"},_globals._components._slider.labelStart," ",scaleStepPrefix,_scaleStart,scaleStepSuffix),labelStart)),labelEnd&&React__default["default"].createElement("div",{className:"slider__label-end"},React__default["default"].createElement("div",{className:"slider__label-end-inner"},React__default["default"].createElement("span",{className:"aria-label"},_globals._components._slider.labelEnd," ",scaleStepPrefix,_scaleEnd,scaleStepSuffix),labelEnd))),React__default["default"].createElement("div",{className:"slider__number-container"},_showScale&&_showScaleNumbers&&_items.map((_ref=>{let{index:index,value:value}=_ref;return React__default["default"].createElement("div",{key:index,className:"slider__number js-slider-number js-slider-number-click","data-id":value,"aria-hidden":"true",style:{left:`${calculatePercentFromIndex(index)}%`},onClick:e=>onNumberSelected(parseFloat(e.currentTarget.getAttribute("data-id")))},scaleStepPrefix,value,scaleStepSuffix)})),React__default["default"].createElement("div",{className:"slider__number-model-range js-slider-model-range"},_isCorrectAnswerShown&&getCorrectAnswers().map((correctAnswer=>React__default["default"].createElement("div",{className:"slider__number-model-answer",key:correctAnswer,style:{left:`${calculatePercentFromIndex(getIndexFromValue(correctAnswer))}%`}},_showNumber&&`${scaleStepPrefix}${correctAnswer}${scaleStepSuffix}`)))),React__default["default"].createElement("div",{className:"slider__number-answer"}),_showScaleIndicator&&React__default["default"].createElement("div",{className:"slider__number-selection js-slider-number-selection a11y-ignore","aria-hidden":"true",style:{left:`${calculatePercentFromIndex(selectedIndex)}%`},tabIndex:"-1",ref:sliderNumberSelectionRef},_showNumber&&`${scaleStepPrefix}${_selectedItem.value}${scaleStepSuffix}`)),React__default["default"].createElement("div",{className:"slider__scale-container js-slider-scale"},React__default["default"].createElement("div",{className:"slider__scale-notch slider__scale-notch-start"}),_showScale&&React__default["default"].createElement("div",{className:"slider__scale-notch-container js-slider-scale-notch-container"},_items.slice(1).map(((item,index)=>React__default["default"].createElement("div",{className:"slider__scale-notch",style:{left:`${calculatePercentFromIndex(index)}%`},key:item.value})))),React__default["default"].createElement("div",{className:"slider__scale-notch slider__scale-notch-end"})),React__default["default"].createElement("div",{className:classes(["slider__item",_shouldShowMarking&&_isCorrect&&"is-correct",_shouldShowMarking&&!_isCorrect&&"is-incorrect"])},React__default["default"].createElement("div",{className:"slider__item-input-track"},React__default["default"].createElement("div",{className:"slider__item-input-fill",style:{width:`${selectedWidth}%`}})),React__default["default"].createElement("input",{className:"slider__item-input js-slider-item-input",type:"range",role:"slider",value:selectedValue,min:_scaleStart,max:_scaleEnd,"aria-valuenow":selectedValue,"aria-valuemin":_scaleStart,"aria-valuemax":_scaleEnd,"data-direction":_marginDir==="right"??"rtl",disabled:!_isEnabled,onChange:e=>onNumberSelected(e.target.value)}))),React__default["default"].createElement("div",{className:"btn__container"}))}));register("text",(function Text(props){return React__default["default"].createElement("div",{className:"component__inner text__inner"},React__default["default"].createElement(templates.header,props))}));register("textinput",(function TextInput(props){const{_isInteractionComplete:_isInteractionComplete,_id:_id,_isEnabled:_isEnabled,_isCorrect:_isCorrect,_shouldShowMarking:_shouldShowMarking,_globals:_globals,displayTitle:displayTitle,body:body,instruction:instruction,ariaQuestion:ariaQuestion}=props;return React__default["default"].createElement("div",{className:"component__inner textinput__inner"},React__default["default"].createElement(templates.header,props),React__default["default"].createElement("div",{className:classes(["component__widget textinput__widget",!_isEnabled&&"is-disabled",_isInteractionComplete&&"is-complete is-submitted show-user-answer",_isCorrect&&"is-correct"]),"aria-labelledby":ariaQuestion?null:(displayTitle||body||instruction)&&`${_id}-header`,"aria-label":ariaQuestion||null},props._items.map(((_ref,index)=>{let{prefix:prefix,_index:_index,input:input,placeholder:placeholder,userAnswer:userAnswer,suffix:suffix}=_ref;return React__default["default"].createElement("div",{className:classes(["textinput-item js-textinput-item",_shouldShowMarking&&_isCorrect&&"is-correct",_shouldShowMarking&&!_isCorrect&&"is-incorrect"]),key:_index},prefix&&React__default["default"].createElement("div",{className:"textinput-item__prefix-container"},React__default["default"].createElement("label",{className:"textinput-item__prefix",id:`${_id}-${index}-aria`,htmlFor:`${_id}-${index}`,"aria-label":prefix,dangerouslySetInnerHTML:{__html:prefix}})),React__default["default"].createElement("div",{className:"textinput-item__textbox-container"},React__default["default"].createElement("input",{className:"textinput-item__textbox js-textinput-textbox",type:"text",placeholder:placeholder,"data-id":`${input}-${index}`,id:`${_id}-${index}`,"aria-labelledby":prefix&&`${_id}-${index}-aria`,"aria-label":placeholder,defaultValue:userAnswer,disabled:!_isEnabled}),React__default["default"].createElement("div",{className:"textinput-item__state"},React__default["default"].createElement("div",{className:"textinput-item__icon textinput-item__correct-icon","aria-label":_globals._accessibility._ariaLabels.correct},React__default["default"].createElement("div",{className:"icon","aria-hidden":"true"})),React__default["default"].createElement("div",{className:"textinput-item__icon textinput-item__incorrect-icon","aria-label":_globals._accessibility._ariaLabels.incorrect},React__default["default"].createElement("div",{className:"icon","aria-hidden":"true"})))),suffix&&React__default["default"].createElement("div",{className:"textinput-item__suffix-container"},React__default["default"].createElement("label",{className:"textinput-item__suffix",id:`${_id}-${index}-aria`,htmlFor:`${_id}-${index}`,"aria-label":suffix,dangerouslySetInnerHTML:{__html:suffix}})))}))),React__default["default"].createElement("div",{className:"btn__container"}))}));register("hotgrid",(function Hotgrid(props){const hotgridGlobals=Adapt$1.course.get("_globals")._components._hotgrid;const ariaLabels=Adapt$1.course.get("_globals")._accessibility._ariaLabels;const{_items:_items,_columnWidth:_columnWidth,_isRound:_isRound,onItemClicked:onItemClicked}=props;const itemAriaLabel=(_index,_graphic,_isVisited)=>{const arr=[];const separator=". ";if(_isVisited)arr.push(ariaLabels.visited);if(_graphic.title){arr.push(_graphic.title)}else{arr.push(`${hotgridGlobals.item} ${_index}`)}if(_graphic.alt)arr.push(_graphic.alt);return{__html:arr.join(separator)}};return React__default["default"].createElement("div",{className:"component__inner hotgrid__inner"},React__default["default"].createElement(templates.header,props),React__default["default"].createElement("div",{className:"component__widget hotgrid__widget"},React__default["default"].createElement("div",{className:"hotgrid__grid",role:"list"},_items.map((_ref=>{let{_index:_index,_graphic:_graphic,_isVisited:_isVisited,_isActive:_isActive}=_ref;return React__default["default"].createElement("div",{className:"hotgrid__item",role:"listitem",key:_index,style:{width:_columnWidth+"%"}},React__default["default"].createElement("button",{className:classes(["hotgrid__item-btn",`item-${_index}`,_graphic.srcHover&&_graphic.srcVisited?"is-image":"has-css-states",_isRound&&"is-round",_isVisited&&"is-visited",_isActive&&"is-active"]),onClick:onItemClicked,"data-index":_index},React__default["default"].createElement("span",{className:"aria-label",dangerouslySetInnerHTML:itemAriaLabel(_index,_graphic,_isVisited)}),React__default["default"].createElement("span",{className:"hotgrid__item-btn-inner","aria-hidden":"true"},React__default["default"].createElement("span",{className:"hotgrid__item-image-container"},React__default["default"].createElement("img",{className:"hotgrid__item-image is-default",src:_graphic.src}),_graphic.srcHover&&React__default["default"].createElement("img",{className:"hotgrid__item-image is-hover",src:_graphic.srcHover}),_graphic.srcVisited&&React__default["default"].createElement("img",{className:"hotgrid__item-image is-visited",src:_graphic.srcVisited}),(!_graphic.title||_graphic.title&&_isVisited)&&React__default["default"].createElement("span",{className:"btn-icon hotgrid__item-icon","aria-hidden":"true"},React__default["default"].createElement("span",{className:"icon"}))),_graphic.title&&React__default["default"].createElement("span",{className:"hotgrid__item-title","aria-hidden":"true"},React__default["default"].createElement("span",{className:"hotgrid__item-title-inner",dangerouslySetInnerHTML:{__html:_graphic.title}})))))})))))}));register("hotgridPopup",(function HotgridPopup(props){const{_items:_items,_isRound:_isRound}=props;React.useEffect((()=>{const activeItem=_items.filter((item=>item._isActive));if(!activeItem.length)return;const activeItemIndex=activeItem[0]._index;const focusElement=$(`.hotgrid-popup__item[data-index=${activeItemIndex}]`);a11y$1.focusFirst(focusElement)}));return React__default["default"].createElement("div",{className:"hotgrid-popup__inner"},_items.map(((_ref,index)=>{let{title:title,body:body,_itemGraphic:_itemGraphic,_graphic:_graphic,_classes:_classes,_isVisited:_isVisited,_isActive:_isActive,_imageAlignment:_imageAlignment}=_ref;return React__default["default"].createElement("div",{className:classes(["hotgrid-popup__item",_classes,_isRound&&"is-round",_isVisited&&"is-visited",_isActive&&"is-active",_imageAlignment&&`align-image-${_imageAlignment}`]),key:index,"data-index":index,"aria-hidden":!_isActive?true:null},React__default["default"].createElement("div",{className:"hotgrid-popup__item-content"},React__default["default"].createElement("div",{className:"hotgrid-popup__item-content-inner"},title&&React__default["default"].createElement("div",{className:classes(["hotgrid-popup__item-title",_isActive&&"notify-heading"]),role:"heading","aria-level":a11y$1.ariaLevel({level:"notify"})},React__default["default"].createElement("div",{className:"hotgrid-popup__item-title-inner",dangerouslySetInnerHTML:{__html:title}})),body&&React__default["default"].createElement("div",{className:"hotgrid-popup__item-body"},React__default["default"].createElement("div",{className:"hotgrid-popup__item-body-inner",dangerouslySetInnerHTML:{__html:compile(body)}})))),React__default["default"].createElement("div",{className:classes(["hotgrid-popup__item-image-container",_itemGraphic.attribution&&"has-attribution"])},React__default["default"].createElement("img",{className:"hotgrid-popup__item-image",src:_itemGraphic.src||_graphic.src,"aria-label":_itemGraphic.alt||_graphic.alt?_itemGraphic.alt||_graphic.alt:null,"aria-hidden":!_itemGraphic.alt&&!_graphic.alt?true:null}),_itemGraphic.attribution&&React__default["default"].createElement("div",{className:"component__attribution hotgrid-popup__attribution"},React__default["default"].createElement("div",{className:"component__attribution-inner hotgrid-popup__attribution-inner",dangerouslySetInnerHTML:{__html:_itemGraphic.attribution}}))))})),React__default["default"].createElement(templates.hotgridPopupToolbar,props))}));register("hotgridPopupToolbar",(function HotgridPopupToolbar(props){const a11yConfig=Adapt$1.config.get("_accessibility");const ariaLabels=Adapt$1.course.get("_globals")._accessibility._ariaLabels;const{onCloseClick:onCloseClick,onControlClick:onControlClick,shouldEnableBack:shouldEnableBack,shouldEnableNext:shouldEnableNext,itemCount:itemCount,backLabel:backLabel,nextLabel:nextLabel,_hidePagination:_hidePagination}=props;return React__default["default"].createElement("div",{className:classes(["hotgrid-popup__toolbar",_hidePagination&&"hide-pagination"])},!_hidePagination&&React__default["default"].createElement("div",{className:classes(["hotgrid-popup__nav",!shouldEnableBack&&"first",!shouldEnableNext&&"last"])},React__default["default"].createElement("button",{className:classes(["btn-icon hotgrid-popup__controls back",!shouldEnableBack&&"is-disabled"]),"aria-label":backLabel,"aria-disabled":!shouldEnableBack||null,onClick:onControlClick,"data-direction":"back"},React__default["default"].createElement("span",{className:"icon","aria-hidden":"true"})),React__default["default"].createElement("div",{className:"hotgrid-popup__count",dangerouslySetInnerHTML:{__html:itemCount},"aria-hidden":"true"}),React__default["default"].createElement("button",{className:classes(["btn-icon hotgrid-popup__controls next",!shouldEnableNext&&"is-disabled"]),"aria-label":nextLabel,"aria-disabled":!shouldEnableNext||null,onClick:onControlClick,"data-direction":"next"},React__default["default"].createElement("span",{className:"icon","aria-hidden":"true"}))),React__default["default"].createElement("button",{className:"btn-icon hotgrid-popup__close","aria-label":ariaLabels.closePopup,onClick:onCloseClick},React__default["default"].createElement("span",{className:"icon","aria-hidden":"true"})),a11yConfig._options._isPopupWrapFocusEnabled&&React__default["default"].createElement("a",{className:"a11y-focusguard a11y-ignore a11y-ignore-focus",tabIndex:"0",role:"presentation"}))}));register("list",(function List(_ref){let{_columns:_columns,_orderedList:_orderedList,_items:_items,...props}=_ref;const hasColumns=_columns>1;const{_id:_id,_ariaLevel:_ariaLevel,bodyAfter:bodyAfter}=props;const itemAriaLevel=_.isNumber(_ariaLevel)&&_ariaLevel!==0?_ariaLevel+1:_ariaLevel;return React__default["default"].createElement("div",{className:"component__inner list__inner"},React__default["default"].createElement(templates.header,props),React__default["default"].createElement("div",{className:"component__widget list__widget"},React__default["default"].createElement("div",{className:classes(["list__container",hasColumns&&"has-columns",_orderedList&&"is-ordered-list"]),role:"list"},_items.map(((_ref2,index)=>{let{_isActive:_isActive,title:title,body:body,_classes:_classes,_graphic:_graphic}=_ref2;return React__default["default"].createElement("div",{key:index,className:classes(["list-item",_isActive&&"is-animating",_graphic?.src&&"has-image",_classes]),role:"listitem",style:hasColumns&&device$1.isScreenSizeMin("medium")&&{width:`${100/_columns}%`}||null},React__default["default"].createElement("div",{className:"list-item__inner"},!_graphic?.src&&React__default["default"].createElement("div",{className:"list-item__bullet","aria-hidden":"true"}),_graphic?.src&&React__default["default"].createElement(templates.image,_extends({},_graphic,{classNamePrefixes:["component-item","list-item"],attributionClassNamePrefixes:["component","list"]})),React__default["default"].createElement("div",{className:"list-item__content"},title&&React__default["default"].createElement("div",{className:classes(["list-item__title",body&&"has-margin"]),role:"heading","aria-level":a11y$1.ariaLevel({id:_id,level:"componentItem",override:_ariaLevel??itemAriaLevel})},React__default["default"].createElement("div",{className:"list-item__title-inner",dangerouslySetInnerHTML:{__html:compile(title,props)}})),body&&React__default["default"].createElement("div",{className:"list-item__body"},React__default["default"].createElement("div",{className:"list-item__body-inner",dangerouslySetInnerHTML:{__html:compile(body,props)}})))))})))),bodyAfter&&React__default["default"].createElement("div",{className:"component__body-after list__body-after"},React__default["default"].createElement("div",{className:"component__body-after-inner list__body-after-inner",dangerouslySetInnerHTML:{__html:compile(bodyAfter,props)}})))}));register("tabs",(function Tabs(props){const{_id:_id,_items:_items,_minHeight:_minHeight,_globals:_globals,onTabItemClicked:onTabItemClicked,onTabItemKeyUp:onTabItemKeyUp,itemWidth:itemWidth}=props;return React__default["default"].createElement("div",{className:"tabs__inner component__inner"},React__default["default"].createElement(templates.header,props),React__default["default"].createElement("div",{className:"tabs__widget component__widget clearfix"},React__default["default"].createElement("div",{className:"tabs__nav"},React__default["default"].createElement("div",{className:"tabs__nav-inner",role:"tablist"},_items.map(((_ref,index)=>{let{tabTitle:tabTitle,_isActive:_isActive,_index:_index,_isVisited:_isVisited}=_ref;return React__default["default"].createElement("button",{key:_index,role:"tab","aria-selected":_isActive,"aria-controls":`${_id}-${index}-tabpanel`,"aria-label":`${tabTitle}.${_isVisited?` ${_globals._accessibility._ariaLabels.visited}`:""}`,className:classes(["tabs__nav-item-btn","js-tabs-nav-item-btn-click",_isVisited&&"is-visited",_isActive&&"is-selected"]),tabIndex:_isActive?0:-1,onClick:onTabItemClicked,onKeyUp:onTabItemKeyUp,style:{width:itemWidth},"data-index":_index},React__default["default"].createElement("div",{id:`${_id}-${index}-tabtitle`,className:"tabs__nav-item-btn-inner"},tabTitle))})))),React__default["default"].createElement("div",{className:"tabs__content",style:{minHeight:_minHeight}},React__default["default"].createElement("div",{className:"tabs__content-inner"},_items.map(((_ref2,index)=>{let{_isActive:_isActive,_classes:_classes,_index:_index,title:title,body:body,_graphic:_graphic}=_ref2;return React__default["default"].createElement("div",{key:_index,id:`${_id}-${index}-tabpanel`,role:"tabpanel","aria-hidden":!_isActive||null,"aria-labelledby":`${_id}-${index}-tabtitle`,tabIndex:_isActive?0:-1,"data-index":_index,className:classes(["tabs__content-item",`item-${index}`,`item-${index}-audio`,_classes,_isActive&&"is-active"])},React__default["default"].createElement("div",{className:"tabs__content-item-inner"},React__default["default"].createElement("div",{className:classes(["item-audio-container",`${_id}-${_index}`]),"data-audio-id":`${_id}-${_index}`}),title&&React__default["default"].createElement("div",{className:"tabs__content-item-title"},React__default["default"].createElement("div",{className:"tabs__content-item-title-inner",role:"heading","aria-level":a11y$1.ariaLevel({id:_id,level:"componentItem"}),dangerouslySetInnerHTML:{__html:compile(title)}})),body&&React__default["default"].createElement("div",{className:"tabs__content-item-body"},React__default["default"].createElement("div",{className:"tabs__content-item-body-inner",dangerouslySetInnerHTML:{__html:compile(body)}})),React__default["default"].createElement(templates.image,_extends({},_graphic,{classNamePrefixes:["component__item","tabs__content-item"],attributionClassNamePrefixes:["component","tabs__content-item"]}))))}))))))}));register("Visua11yPreview",(function Visua11yPreview(config){return React__default["default"].createElement("div",{className:"preview","aria-hidden":"true"},React__default["default"].createElement("div",{className:"preview__nav"}),React__default["default"].createElement("div",{className:"preview__header"},config._preview.title),React__default["default"].createElement("div",{className:"preview__content"},React__default["default"].createElement("div",{className:"preview__text"},React__default["default"].createElement("div",{className:"top"},React__default["default"].createElement("div",{className:"letter"},config._preview.character),React__default["default"].createElement("div",{className:"lines"},React__default["default"].createElement("div",{className:"line"}),React__default["default"].createElement("div",{className:"line"}),React__default["default"].createElement("div",{className:"line"}))),React__default["default"].createElement("div",{className:"line"}),React__default["default"].createElement("div",{className:"line"}),React__default["default"].createElement("div",{className:"line"})),React__default["default"].createElement("div",{className:"preview__comp"},React__default["default"].createElement("div",{className:"item"}),React__default["default"].createElement("div",{className:"item"}),React__default["default"].createElement("div",{className:"item"}),React__default["default"].createElement("div",{className:"btn"}))))}));register("Visua11ySettings",(function Visua11ySettings(config){const visua11y=Adapt$1.visua11y;function onReset(){visua11y.reset()}function onClose(){visua11y.settingsPrompt.closeNotify()}function onChange(event){const{name:name,checked:checked,value:value,type:type}=event.target;visua11y[name]=type==="checkbox"?checked:value}return React__default["default"].createElement("div",{className:"visua11ysettings__inner"},(config._colorProfile._isEnabled||config._highContrast._isEnabled||config._noTransparency._isEnabled||config._lowBrightness._isEnabled||config._invert._isEnabled)&&React__default["default"].createElement("div",{className:"visua11ysettings__group visua11ysettings__group-visualdisplay",role:"group","aria-labelledby":"visualdisplay"},config._groups.visualDisplay&&React__default["default"].createElement("div",{className:"visua11ysettings__group-title",id:"visualdisplay",role:"heading","aria-level":"2"},config._groups.visualDisplay),React__default["default"].createElement("div",{className:"visua11ysettings__group-profiles"},React__default["default"].createElement("div",{className:"colorprofiles"},config._colorProfile._isEnabled&&React__default["default"].createElement("div",{className:"colorprofileid"},React__default["default"].createElement(templates.Visua11yPreview,config),React__default["default"].createElement("label",{className:"visua11ysettings__item-label",htmlFor:"colorProfileId"},React__default["default"].createElement("div",{className:"icon","aria-hidden":"true"}),config._colorProfile.title),React__default["default"].createElement("select",{id:"colorProfileId",name:"colorProfileId",onChange:onChange,value:visua11y.colorProfileId},visua11y.colorProfiles.map((_ref=>{let{name:name,_id:_id}=_ref;return React__default["default"].createElement("option",{key:_id,value:_id},name)}))))),React__default["default"].createElement("div",{className:"otherprofiles"},config._highContrast._isEnabled&&React__default["default"].createElement("div",{className:"visua11ysettings__item highcontrast"},React__default["default"].createElement("label",{className:"visua11ysettings__item-label",htmlFor:"highContrast","aria-hidden":"true"},React__default["default"].createElement("div",{className:"icon","aria-hidden":"true"}),config._highContrast.title),React__default["default"].createElement("input",{type:"checkbox",id:"highContrast",name:"highContrast",checked:visua11y.highContrast,onChange:onChange,"aria-label":config._highContrast.title})),config._noTransparency._isEnabled&&React__default["default"].createElement("div",{className:"visua11ysettings__item notransparency"},React__default["default"].createElement("label",{className:"visua11ysettings__item-label",htmlFor:"notransparency","aria-hidden":"true"},React__default["default"].createElement("div",{className:"icon","aria-hidden":"true"}),config._noTransparency.title),React__default["default"].createElement("input",{type:"checkbox",id:"noTransparency",name:"noTransparency",checked:visua11y.noTransparency,onChange:onChange,"aria-label":config._noTransparency.title})),config._lowBrightness._isEnabled&&React__default["default"].createElement("div",{className:"visua11ysettings__item lowbrightness"},React__default["default"].createElement("label",{className:"visua11ysettings__item-label",htmlFor:"lowbrightness","aria-hidden":"true"},React__default["default"].createElement("div",{className:"icon","aria-hidden":"true"}),config._lowBrightness.title),React__default["default"].createElement("input",{type:"checkbox",id:"lowBrightness",name:"lowBrightness",checked:visua11y.lowBrightness,onChange:onChange,"aria-label":config._lowBrightness.title})),config._invert._isEnabled&&React__default["default"].createElement("div",{className:"visua11ysettings__item invert"},React__default["default"].createElement("label",{className:"visua11ysettings__item-label",htmlFor:"invert","aria-hidden":"true"},React__default["default"].createElement("div",{className:"icon","aria-hidden":"true"}),config._invert.title),React__default["default"].createElement("input",{type:"checkbox",id:"invert",name:"invert",checked:visua11y.invert,onChange:onChange,"aria-label":config._invert.title}))))),(config._noAnimations._isEnabled||config._noBackgroundImages._isEnabled)&&React__default["default"].createElement("div",{className:"visua11ysettings__group visua11ysettings__group-distractions",role:"group","aria-labelledby":"distractions"},config._groups.distractions&&React__default["default"].createElement("div",{className:"visua11ysettings__group-title",id:"distractions",role:"heading","aria-level":"2"},config._groups.distractions),config._noAnimations._isEnabled&&React__default["default"].createElement("div",{className:"visua11ysettings__item noanimations"},React__default["default"].createElement("label",{className:"visua11ysettings__item-label",htmlFor:"noanimations","aria-hidden":"true"},React__default["default"].createElement("div",{className:"icon","aria-hidden":"true"}),config._noAnimations.title),React__default["default"].createElement("input",{type:"checkbox",id:"noAnimations",name:"noAnimations",checked:visua11y.noAnimations,onChange:onChange,"aria-label":config._noAnimations.title})),config._noBackgroundImages._isEnabled&&React__default["default"].createElement("div",{className:"visua11ysettings__item nobackgroundimages"},React__default["default"].createElement("label",{className:"visua11ysettings__item-label",htmlFor:"nobackgroundimages","aria-hidden":"true"},React__default["default"].createElement("div",{className:"icon","aria-hidden":"true"}),config._noBackgroundImages.title),React__default["default"].createElement("input",{type:"checkbox",id:"noBackgroundImages",name:"noBackgroundImages",checked:visua11y.noBackgroundImages,onChange:onChange,"aria-label":config._noBackgroundImages.title}))),(config._fontSize._isEnabled||config._lineHeight._isEnabled||config._paragraphSpacing._isEnabled||config._letterSpacing._isEnabled||config._wordSpacing._isEnabled)&&React__default["default"].createElement("div",{className:"visua11ysettings__group visua11ysettings__group-readability",role:"group","aria-labelledby":"readability"},config._groups.readability&&React__default["default"].createElement("div",{className:"visua11ysettings__group-title",id:"readability",role:"heading","aria-level":"2"},config._groups.readability),config._fontSize._isEnabled&&React__default["default"].createElement("div",{className:"visua11ysettings__item fontsize"},React__default["default"].createElement("div",{className:"visua11ysettings__item-title",id:"fontsize"},React__default["default"].createElement("div",{className:"icon","aria-hidden":"true"}),config._fontSize.title),React__default["default"].createElement("div",{className:"visua11ysettings__item-option-container",role:"radiogroup","aria-labelledby":"fontsize"},React__default["default"].createElement("div",{className:"visua11ysettings__item-option"},React__default["default"].createElement("input",{type:"radio",value:config._fontSize._small,checked:visua11y.fontSize===config._fontSize._small,id:"fontSize-small",name:"fontSize",onChange:onChange}),React__default["default"].createElement("label",{htmlFor:"fontSize-small"},React__default["default"].createElement("div",{className:"item-text"},config._fontSize.smallLabel))),React__default["default"].createElement("div",{className:"visua11ysettings__item-option"},React__default["default"].createElement("input",{type:"radio",value:visua11y.originalFontSize,checked:visua11y.fontSize===visua11y.originalFontSize,id:"fontsize-medium",name:"fontSize",onChange:onChange}),React__default["default"].createElement("label",{htmlFor:"fontsize-medium"},React__default["default"].createElement("div",{className:"item-text"},config._fontSize.mediumLabel))),React__default["default"].createElement("div",{className:"visua11ysettings__item-option"},React__default["default"].createElement("input",{type:"radio",value:config._fontSize._large,checked:visua11y.fontSize===config._fontSize._large,id:"fontsize-large",name:"fontSize",onChange:onChange}),React__default["default"].createElement("label",{htmlFor:"fontsize-large"},React__default["default"].createElement("div",{className:"item-text"},config._fontSize.largeLabel))))),config._lineHeight._isEnabled&&React__default["default"].createElement("div",{className:"visua11ysettings__item lineheight"},React__default["default"].createElement("div",{className:"visua11ysettings__item-title",id:"lineheight"},React__default["default"].createElement("div",{className:"icon","aria-hidden":"true"}),config._lineHeight.title),React__default["default"].createElement("div",{className:"visua11ysettings__item-option-container",role:"radiogroup","aria-labelledby":"lineheight"},React__default["default"].createElement("div",{className:"visua11ysettings__item-option"},React__default["default"].createElement("input",{type:"radio",value:config._lineHeight._small,checked:visua11y.lineHeight===config._lineHeight._small,id:"lineheight-small",name:"lineHeight",onChange:onChange}),React__default["default"].createElement("label",{htmlFor:"lineheight-small"},React__default["default"].createElement("div",{className:"item-text"},config._lineHeight.smallLabel))),React__default["default"].createElement("div",{className:"visua11ysettings__item-option"},React__default["default"].createElement("input",{type:"radio",value:config._lineHeight._medium,checked:visua11y.lineHeight===config._lineHeight._medium,id:"lineheight-medium",name:"lineHeight",onChange:onChange}),React__default["default"].createElement("label",{htmlFor:"lineheight-medium"},React__default["default"].createElement("div",{className:"item-text"},config._lineHeight.mediumLabel))),React__default["default"].createElement("div",{className:"visua11ysettings__item-option"},React__default["default"].createElement("input",{type:"radio",value:config._lineHeight._large,checked:visua11y.lineHeight===config._lineHeight._large,id:"lineheight-large",name:"lineHeight",onChange:onChange}),React__default["default"].createElement("label",{htmlFor:"lineheight-large"},React__default["default"].createElement("div",{className:"item-text"},config._lineHeight.largeLabel))))),config._paragraphSpacing._isEnabled&&React__default["default"].createElement("div",{className:"visua11ysettings__item paragraphspacing"},React__default["default"].createElement("div",{className:"visua11ysettings__item-title",id:"paragraphspacing"},React__default["default"].createElement("div",{className:"icon","aria-hidden":"true"}),config._paragraphSpacing.title),React__default["default"].createElement("div",{className:"visua11ysettings__item-option-container",role:"radiogroup","aria-labelledby":"paragraphspacing"},React__default["default"].createElement("div",{className:"visua11ysettings__item-option"},React__default["default"].createElement("input",{type:"radio",value:config._paragraphSpacing._small,checked:visua11y.paragraphSpacing===config._paragraphSpacing._small,id:"paragraphSpacing-small",name:"paragraphSpacing",onChange:onChange}),React__default["default"].createElement("label",{htmlFor:"paragraphSpacing-small"},React__default["default"].createElement("div",{className:"item-text"},config._paragraphSpacing.smallLabel))),React__default["default"].createElement("div",{className:"visua11ysettings__item-option"},React__default["default"].createElement("input",{type:"radio",value:config._paragraphSpacing._medium,checked:visua11y.paragraphSpacing===config._paragraphSpacing._medium,id:"paragraphSpacing-medium",name:"paragraphSpacing",onChange:onChange}),React__default["default"].createElement("label",{htmlFor:"paragraphSpacing-medium"},React__default["default"].createElement("div",{className:"item-text"},config._paragraphSpacing.mediumLabel))),React__default["default"].createElement("div",{className:"visua11ysettings__item-option"},React__default["default"].createElement("input",{type:"radio",value:config._paragraphSpacing._large,checked:visua11y.paragraphSpacing===config._paragraphSpacing._large,id:"paragraphSpacing-large",name:"paragraphSpacing",onChange:onChange}),React__default["default"].createElement("label",{htmlFor:"paragraphSpacing-large"},React__default["default"].createElement("div",{className:"item-text"},config._paragraphSpacing.largeLabel))))),config._letterSpacing._isEnabled&&React__default["default"].createElement("div",{className:"visua11ysettings__item letterspacing"},React__default["default"].createElement("div",{className:"visua11ysettings__item-title",id:"letterspacing"},React__default["default"].createElement("div",{className:"icon","aria-hidden":"true"}),config._letterSpacing.title),React__default["default"].createElement("div",{className:"visua11ysettings__item-option-container",role:"radiogroup","aria-labelledby":"letterspacing"},React__default["default"].createElement("div",{className:"visua11ysettings__item-option"},React__default["default"].createElement("input",{type:"radio",value:config._letterSpacing._small,checked:visua11y.letterSpacing===config._letterSpacing._small,id:"letterSpacing-small",name:"letterSpacing",onChange:onChange}),React__default["default"].createElement("label",{htmlFor:"letterSpacing-small"},React__default["default"].createElement("div",{className:"item-text"},config._letterSpacing.smallLabel))),React__default["default"].createElement("div",{className:"visua11ysettings__item-option"},React__default["default"].createElement("input",{type:"radio",value:config._letterSpacing._medium,checked:visua11y.letterSpacing===config._letterSpacing._medium,id:"letterSpacing-medium",name:"letterSpacing",onChange:onChange}),React__default["default"].createElement("label",{htmlFor:"letterSpacing-medium"},React__default["default"].createElement("div",{className:"item-text"},config._letterSpacing.mediumLabel))),React__default["default"].createElement("div",{className:"visua11ysettings__item-option"},React__default["default"].createElement("input",{type:"radio",value:config._letterSpacing._large,checked:visua11y.letterSpacing===config._letterSpacing._large,id:"letterSpacing-large",name:"letterSpacing",onChange:onChange}),React__default["default"].createElement("label",{htmlFor:"letterSpacing-large"},React__default["default"].createElement("div",{className:"item-text"},config._letterSpacing.largeLabel))))),config._wordSpacing._isEnabled&&React__default["default"].createElement("div",{className:"visua11ysettings__item wordspacing"},React__default["default"].createElement("div",{className:"visua11ysettings__item-title",id:"wordspacing"},React__default["default"].createElement("div",{className:"icon","aria-hidden":"true"}),config._wordSpacing.title),React__default["default"].createElement("div",{className:"visua11ysettings__item-option-container",role:"radiogroup","aria-labelledby":"wordspacing"},React__default["default"].createElement("div",{className:"visua11ysettings__item-option"},React__default["default"].createElement("input",{type:"radio",value:config._wordSpacing._small,checked:visua11y.wordSpacing===config._wordSpacing._small,id:"wordSpacing-small",name:"wordSpacing",onChange:onChange}),React__default["default"].createElement("label",{htmlFor:"wordSpacing-small"},React__default["default"].createElement("div",{className:"item-text"},config._wordSpacing.smallLabel))),React__default["default"].createElement("div",{className:"visua11ysettings__item-option"},React__default["default"].createElement("input",{type:"radio",value:config._wordSpacing._medium,checked:visua11y.wordSpacing===config._wordSpacing._medium,id:"wordSpacing-medium",name:"wordSpacing",onChange:onChange}),React__default["default"].createElement("label",{htmlFor:"wordSpacing-medium"},React__default["default"].createElement("div",{className:"item-text"},config._wordSpacing.mediumLabel))),React__default["default"].createElement("div",{className:"visua11ysettings__item-option"},React__default["default"].createElement("input",{type:"radio",value:config._wordSpacing._large,checked:visua11y.wordSpacing===config._wordSpacing._large,id:"wordSpacing-large",name:"wordSpacing",onChange:onChange}),React__default["default"].createElement("label",{htmlFor:"wordSpacing-large"},React__default["default"].createElement("div",{className:"item-text"},config._wordSpacing.largeLabel)))))),React__default["default"].createElement("div",{className:"btn__container"},React__default["default"].createElement("div",{className:"btn__responsive-container is-reset"},React__default["default"].createElement("button",{className:"btn-text btn-reset",onClick:onReset,"aria-label":config._button.resetText},config._button.resetText)),React__default["default"].createElement("div",{className:"btn__response-container is-close"},React__default["default"].createElement("button",{className:"btn-text btn-close",onClick:onClose,"aria-label":config._button.closeText},config._button.closeText))))}));$("body").append(Handlebars.templates.loading());data$1.on("ready",(()=>{logging$1.debug("Calling Adapt.init");Adapt$1.init();Adapt$1.off("adaptCollection:dataLoaded courseModel:dataLoaded")})).init()}));window.__AMD=function(id,value){window.define(id,(function(){return value}));window.require([id]);return value};
